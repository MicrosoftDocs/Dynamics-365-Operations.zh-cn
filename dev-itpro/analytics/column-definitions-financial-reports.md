---
title: "财务报表中的列定义"
description: "本文提供了有关列定义的信息。 列定义是报表组件或构建基块，在报表上定义列的内容。 和行定义一样，基本列定义可以在多个报表中使用。"
author: RobinARH
manager: AnnBe
ms.date: 2016-08-09 21 - 27 - 36
ms.topic: article
ms.prod: 
ms.service: Dynamics365Operations
ms.technology: 
ms.search.form: FinancialReports
audience: Application User
ms.reviewer: RobinARH
ms.search.scope: Management Reporter, Core
ms.custom: 106601
ms.assetid: 66e72a48-edab-4e9d-815f-596a1623c258
ms.search.region: Global
ms.author: aolson
ms.search.validFrom: 
ms.dyn365.ops.version: 
translationtype: Human Translation
ms.sourcegitcommit: f707d45290682e79ee439ba0d504852429defa90
ms.openlocfilehash: af336db81f659d80248aa4ab1fbba96ed1ff48c2
ms.lasthandoff: 03/30/2017


---

# <a name="column-definitions-in-financial-reports"></a>财务报表中的列定义

本文提供了有关列定义的信息。 列定义是报表组件或构建基块，在报表上定义列的内容。 和行定义一样，基本列定义可以在多个报表中使用。

<a name="create-and-modify-a-column-definition"></a>创建和修改列定义
-------------------------------------

列定义可以包含 2 到 255 列。

### <a name="create-a-column-definition"></a>创建列定义

1.  在报表设计器的导航窗格中，单击**“列定义”**。
2.  在**“文件”**菜单上，单击**“新建”**，然后单击**“列定义”**。
3.  添加列定义内容。

### <a name="open-a-column-definition"></a>打开列定义

1.  在报表设计器的导航窗格中，单击**“列定义”**。
2.  双击列定义以将其打开。

### <a name="add-a-column-to-a-column-definition"></a>向列定义添加列

1.  在报表设计器中，单击**“列定义”**，然后打开列定义以修改。
2.  选择其中应插入新列的列。
3.  在**“编辑”**菜单上，单击**“插入列”**。 新列将显示在选定列的左侧。

### <a name="delete-a-column-from-a-column-definition"></a>从列定义中删除列

1.  在报表设计器中，单击**“列定义”**，然后打开列定义以修改。
2.  选择要删除的列。
3.  在**“编辑”**菜单上，单击**“删除列”**。

## <a name="contents-of-a-column-definition"></a>列定义的内容
列定义包含以下信息：

-   包含行定义描述的列
-   显示财务数据、Microsoft Excel 工作表或基于列定义中的其他数据的计算中的数据的金额列
-   格式列
-   属性列

此信息将显示在列定义中的下列区域：

-   列定义的标题区域包含报表中将出现的标题文本和格式。 标题可应用于单列数据，可跨多列，也可按条件应用于列。 列定义可包含所需数量的列标题行。 **注意：**列标题将应用于报表上的每列数据。 报表标题将应用于整个报表。 在报表定义的**“页眉和页脚”**选项卡上定义报表标题。
-   列详细信息行是位于列定义中标题行下面的行。 列详细信息行定义包括在报表中的信息。 下表列出并描述列详细信息行。

    | 列详细信息行名称                                                | 描述                                                                                            |
    |-----------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------|
    | 列类型                                                           | （必需）指定列中数据的类型。                                                     |
    | 帐簿代码/属性类别                                          | 为 **FD** 和 **ATTR** 类型的列指定财务数据信息。                       |
    | 会计年度期间包括的期间                                    | 为 **FD** 类型的列指定财务数据信息。                                     |
    | 配方                                                               | 为 **CALC** 类型的列指定计算公式。                                        |
    | 列宽 列前的额外空格 格式覆盖 打印控制 | 指定特定格式选项。                                                                        |
    | 列限制                                                   | 限制数据。                                                                                         |
    | 报告单位                                                        | 限制列，以便它只显示指定报告单位的数据。                      |
    | 币种显示币种筛选器                                      | 设置货币的格式。                                                                                       |
    | 维度筛选器                                                      | 指定筛选器以将数据限制为特定财务数据报告单位。                           |
    | 属性筛选器                                                      | 指定筛选器以限制财务数据。                                                       |
    | 开始日期结束日期                                                   | 将财务数据限制到特定日期。                                                         |
    | 理由                                                         | 左对齐、居中对齐或右对齐在行定义中指定的描述文本。 |

## <a name="column-restrictions-in-a-column-definition"></a>行定义中的列限制
您可使用列限制指定列定义使用数据或计算信息的方式。 您还可将报表列限制为特定单位或特定日期。 **注意：****“列限制”**代码将覆盖行定义中分配的任何冲突设置。

### <a name="column-restrictions-cell"></a>“列限制”单元格

**“列限制”**单元格可包含限制或隐藏信息（如列的行格式、详细信息和金额）的代码。

#### <a name="add-a-column-restriction-in-a-column-definition"></a>在列定义中添加列限制

1.  在报表设计器中，打开要修改的列定义。
2.  双击要限制的列的**“列限制”**单元格。
3.  在**“列限制”**对话框中，在列表中选择一个或多个代码，然后单击**“确定”**。

### <a name="column-restriction-codes"></a>列限制代码

下表描述列限制代码。

| 列限制代码 | 描述                                                                                                                                                                                                                                                                                                                             |
|-------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| SU                      | 隐藏其中在行定义中输入下划线命令 (**---**) 或双下划线命令 (**===**) 的列的下划线。 例如，您可能不希望对百分比计算得出的金额加下划线。                                                                        |
| ST                      | 隐藏汇总，以便列（例如，统计列）中仅显示详细信息。                                                                                                                                                                                                                                      |
| SD                      | 隐藏详细信息，以便列中仅显示 **TOT** 和 **CAL** 行（来自行定义）。                                                                                                                                                                                                                              |
| 删除行                      | 将 **FD** 列中的金额限制为借方金额。                                                                                                                                                                                                                                                                              |
| 贷                      | 将 **FD** 列中的金额限制为贷方金额。                                                                                                                                                                                                                                                                             |
| ADJ                     | 将列中的金额限制为期间调整金额（如果这些金额可用）。                                                                                                                                                                                                                                        |
| XAD                     | 限制列中的金额，以便不包含期间调整金额。                                                                                                                                                                                                                                                     |
| 计划转移                      | 限制列中的金额，以便仅包含已过帐的交易记录（如果这些交易记录可用）。                                                                                                                                                                                                                 |
| UPT                     | 限制列中的金额，以便仅包含未过帐的交易记录（如果这些交易记录可用）。 **注意：**并非所有数据提供商都支持未过帐的交易记录。 有关详细信息，请参阅适用于您的 Microsoft Dynamics ERP 系统的[数据集成指南](http://go.microsoft.com/fwlink/?LinkID=162565)。 |

### <a name="restrict-a-column-to-a-reporting-unit"></a>将列限制到报告单位

1.  在报表设计器中，打开要修改的列定义。
2.  双击要限制的列的**“报告单位”**单元格。
3.  在**“报告单位选择”**对话框的**“报告结构树”**列表中，选择报告结构树。
4.  展开或折叠单位列表，选择报告单位，然后单击**“确定”**。

## <a name="format-column-headers"></a>设置列标题的格式
您可添加、修改和删除报表的列顶部显示的标题。 您还可基于列定义中的**“期间”**字段和报表定义中的**“基准期间”**字段配置条件跨列标题。 基准期间功能在您创建累计预测报表时帮您节省时间。

### <a name="create-and-manage-column-headers"></a>创建和管理列标题

您可使用**“列标题”**对话框添加、修改和删除报表的列顶部显示的标题。 下表描述**“列标题”**对话框中的字段。

| 字段                 | 描述                                                                                                                                                                                                                                                                                                              |
|-----------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 列标题文本    | 此文本显示在列标题中。 您可在此字段中直接键入文本，也可单击**“插入自动图文集”**来选择在每次生成报表时更新列标题的选项。 要包含多个自动图文集代码，请再次单击**“插入自动图文集”**，然后单击列表中的其他代码。 |
| 格式选项        | 将格式应用于列标题，如框或下划线。                                                                                                                                                                                                                                                           |
| 展开开始范围 展开结束范围 | 定义标题文本将应用于的列。                                                                                                                                                                                                                                                            |
| 理由         | 指定应如何为列或在**“展开开始范围”**和**“展开结束范围”**字段中指定的列范围对齐列标题文本。                                                                                                                                                               |

### <a name="create-a-column-header"></a>创建列标题

1.  在报表设计器中，打开要修改的列定义。
2.  双击标题单元格。
3.  在**“列标题”**对话框中，输入列标题文本。 或者，单击**“插入自动图文集”**，然后选择一个选项。
4.  在**“格式选项”**字段中，选择标题的格式。
5.  在**“展开开始范围”**字段中，输入列标题应开始的列的字母。 在**“展开结束范围”**字段中，输入列标题应结束的列的字母。
6.  在**“对齐方式”**下，选择列标题文本应左对齐、居中对齐还是右对齐。
7.  单击“**OK**”。

### <a name="add-a-column-header-row"></a>添加列标题行

1.  在报表设计器中，打开要修改的列定义。
2.  选择标题行中的单元格。
3.  在**“编辑”**菜单上，单击**“插入行”**。 新行插入到您在第 2 步中选择的行上方。 **注意：**如果您在报表中具有四行或更多的报表标题行，当报表导出到 Excel 工作表时标题将重叠。 要查看报表上的所有标题，请增加报表定义中的上边距。

### <a name="delete-a-column-header-row"></a>删除列标题行

1.  在报表设计器中，打开要修改的列定义。
2.  在标题行中，选择要删除的单元格。
3.  在**“编辑”**菜单上，单击**“删除行”**。

### <a name="create-an-automatically-generated-header"></a>创建自动生成的标题

报表设计器可基于自动图文集代码自动生成列标题。 自动图文集代码是在每次生成报表时更新的变量。 所有列标题均可包含这些代码以指定可变化的报表信息（如日期或期间编号）。 因此，您可将一个列定义用于多个报表定义、时段和报告结构树。 由于自动图文集代码依赖列定义的详细信息行中的日历信息，因此它们仅受 **CALC**、**FD** 和 **WKS** 列支持。 自动图文集代码在列标题单元格中的显示方式影响信息在报表上的显示方式。 在**“列标题”**对话框中，自动图文集代码将以混合大小写的形式显示。 因此，该文本将以混合大小写的形式在报表上显示。 例如，在标准日历年中，**@CalMonthLong** 将 **7** 月解析为**七月**。 如果月份名称应为大写（例如 **JULY**），则在**列标题文本**字段中输入大写字符形式的自动图文集代码。 例如，输入 **@CALMONTHLONG**。 您可将代码和文本混合。 例如，输入以下标题文本：**Period @FiscalPeriod-@FiscalYear from @StartDate to @EndDate**。 生成的报表标题类似于以下文本：**Period 1-02 from 01/01/02 to 01/31/02**。 **注意：**某些文本（如长日期）的格式取决于您在 Dynamics 365 for Operations 服务器上的区域设置。 要更改这些设置，请单击**“开始”**按钮，单击**“控制面板”**，然后单击**“区域和语言”**。 下表列出了列标题的可用自动图文集选项。

| 自动图文集选项和代码                | 说明                                                                                                                                                                                                                                                                                      |
|-----------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 月份名称 (@CalMonthLong)              | 打印列标题中当前月份的名称。 如果您决定将报表中的金额化整到千分位、百万分位或十亿分位，或者您在报表上设置列宽小于 9 个字符，则月份名称将缩写为前三个字符。 |
| 缩写的月份名称 (@CalMonthShort) | 打印所选会计期间的月份的缩写名称。                                                                                                                                                                                                                          |
| 期间编号 (@FiscalPeriod)           | 打印为该列标识的会计期间的数字形式。 如果该列跨多个期间，则打印范围内的最后一个期间。                                                                                                                                   |
| 期间描述 (@FiscalPeriodName)  | 打印财务数据中标识的会计期间描述。                                                                                                                                                                                                                    |
| 会计年度 (@FiscalYear)               | 打印列的数字形式的会计年度。                                                                                                                                                                                                                                            |
| 日历年度 (@CalYear)                | 打印列的数字形式的日历年。                                                                                                                                                                                                                                          |
| 开始日期 (@StartDate)                 | 打印列的开始日期。                                                                                                                                                                                                                                                             |
| 结束日期 (@EndDate)                     | 打印列的结束日期。                                                                                                                                                                                                                                                               |
| 树中的单位名称 (@UnitName)         | 如果您将列限制到报告结构树的特定单位，请打印列标题中的单位名称。                                                                                                                                                                                     |
| 单位描述 (@UnitDesc)            | 如果您将列限制到报告结构树的特定单位，请打印列标题中的单位描述。                                                                                                                                                                              |
| 帐簿代码 (@BookCode)                   | 打印列中指定的帐簿代码。                                                                                                                                                                                                                                             |
| 空行 (@Blank)                     | 在列标题中插入空行。                                                                                                                                                                                                                                                       |

### <a name="create-a-conditional-spanning-header"></a>创建条件跨列标题

条件跨列标题可以跨基于特定期间数据的多个列。 例如，如果您具有会计年度的预算报表并且想同时显示过去月份的实际预算与将来月份的计划预算，则可使用条件跨列标题自动更新报表标题。 创建条件跨列标题时，请注意以下情况：

-   将忽略开始条件（**“展开开始范围”**）之前匹配的任何停止条件（**“展开结束范围”**）。 例如，列 B 具有定义为 BASE+1 到 BASE 的展开条件，BASE 在列 C 中，而 BASE+1 在列 D 中。在此示例中，将忽略列 C 中的停止条件，将从列 D 开始打印标题。
-   如果您指定重叠的列标题，则列标题将在打印到报表上时重叠。 将生成报表，但**报表队列状态**字段中将出现以下警告：“使用 Base 的列标题与其他列标题相交，并且可能导致重叠的文本”。 例如，列 B 上的标题定义为 B 到 BASE+1，而列 D 上的标题定义为 BASE+1 到 F。在此示例中，标题将互相打印在对方顶部，难以辨认。 在**“展开开始范围/展开结束范围”**定义中使用 BASE 时，务必查看生成的报表以查看标题是否重叠。
-   如果您在“非打印”(**NP**) 列中的展开定义中指定 BASE，则将忽略它，而不管列定义中的内容。 本质上，此方案等同于不创建列标题定义。
-   对于条件打印列（**P&lt;B**、**P&gt;=B**），条件跨列标题的行为与任何常规列标题定义类似。 例如，如果条件为 False，则匹配展开条件的所有后续列将开始打印标题。

#### <a name="create-a-conditional-spanning-header"></a>创建条件跨列标题

1.  在报表设计器中，打开要修改的列定义。
2.  双击标题单元格。
3.  在**“列标题”**对话框中，输入列标题文本。 或者，单击**“插入自动图文集”**，然后选择一个选项。
4.   在**“格式选项”**字段中，选择标题的格式样式。
5.  指定与在生成报表时指定的基准期间相对的期间。 在**“展开开始范围”**和**“展开结束范围”**字段中，输入下列值之一：**BASE**、**BASE-X** 或 **BASE+X**，其中 X 是从基准期间开始的期间数量。 例如，如果您在**“展开开始范围”**字段中输入 **BASE**，则条件跨列标题文本将于其中报表定义的**“基准期间”**值等于列定义的**“期间”**值的列标题中开始。 它将在**“展开结束范围”**字段中指示的列结束。 因此，如果展开为 BASE 到 M，并且报表定义的**“基准期间”**值为 **4**，则标题将于其中期间设置为 **4** 的列开始并于列 M 结束。标题仅在打印列上停止和开始。
6.  在**“对齐方式”**下，选择列标题文本应左对齐、居中对齐还是右对齐。
7.  单击“**OK**”。

#### <a name="example-of-a-conditional-spanning-header"></a>条件跨列标题示例

Phyllis 将为 6 个月的动态预测创建报表。 她希望在包含实际数据的列上打印“实际”一词，在包含预算预测的列上打印“预算”一词。 报表运行的每个月，实际列多了一个并且预算列少了一个。 虽然 Phyllis 可在每次生成报表时手动修改列定义来调整标题，但为了省时省力，她决定创建条件跨列标题以在报表每次运行时自动在相应列上创建标题。 Phyllis 打开报表设计器，单击导航窗格中的**“列定义”**，并打开报表的列定义。 之后她输入以下信息。 报表定义中的基准期间为 4。

|                     | A    | B             | C             | 日             | E             | 五             | G             | H             | I             | J             | K             | L             | 一             |
|---------------------|------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|
| 标题 1            |      | 实际        | 预算        |               |               |               |               |               |               |               |               |               |               |
| 标题 2            |      | @CalMonthLong | @CalMonthLong | @CalMonthLong | @CalMonthLong | @CalMonthLong | @CalMonthLong | @CalMonthLong | @CalMonthLong | @CalMonthLong | @CalMonthLong | @CalMonthLong | @CalMonthLong |
| 标题 3            |      |               |               |               |               |               |               |               |               |               |               |               |               |
| 列类型         | DESC | FD            | FD            | FD            | FD            | FD            | FD            | FD            | FD            | FD            | FD            | FD            | FD            |
| 帐簿代码/属性 |      | ACTUAL        | BUDGET2012    | ACTUAL        | BUDGET2012    | ACTUAL        | BUDGET2012    | ACTUAL        | BUDGET2012    | ACTUAL        | BUDGET2012    | ACTUAL        | BUDGET2012    |
| 会计年度         |      | BASE          | BASE          | BASE          | BASE          | BASE          | BASE          | BASE          | BASE          | BASE          | BASE          | BASE          | BASE          |
| 期间              |      | 1             | 1             | 2             | 2             | 3             | 3             | 4             | 4             | 5             | 5             | 6             | 6             |
| 包括的期间     |      | PERIODIC      | PERIODIC      | PERIODIC      | PERIODIC      | PERIODIC      | PERIODIC      | PERIODIC      | PERIODIC      | PERIODIC      | PERIODIC      | PERIODIC      | PERIODIC      |
| 列宽        | 30   | 10            | 10            | 10            | 10            | 10            | 10            | 10            | 10            | 10            | 10            | 10            | 10            |
| 打印控制       |      | P&lt;=B       | P&gt;B        | P&lt;=B       | P&gt;B        | P&lt;=B       | P&gt;B        | P&lt;=B       | P&gt;B        | P&lt;=B       | P&gt;B        | P&lt;=B       | P&gt;B        |

Phyllis 双击列标题单元格以打开**“列标题”**对话框，其中她输入以下信息。

| 字段              | 值                 |
|--------------------|-----------------------|
| 列标题文本 | 实际                |
| 插入自动图文集    | 未做出选择。 |
| 格式选项     | 框                   |
| 理由      | 未做出选择。 |
| 展开开始范围        | B                     |
| 展开结束范围          | BASE                  |
| 预算标题      | BASE+1 到结束列  |

在她完成信息输入后，Phyllis 单击**“确定”**。 之后她双击列 C 中的列标题单元格以打开**“列标题”**对话框，其中她输入以下信息。

| 字段              | 值                 |
|--------------------|-----------------------|
| 列标题文本 | 预算                |
| 插入自动图文集    | 未做出选择。 |
| 格式选项     | 框                   |
| 理由      | 未做出选择。 |
| 展开开始范围        | C                     |
| 展开结束范围          | BASE+2                |

现在，每次生成报表时，包含实际数据的列上将打印“实际”一词，包含预算预测的列上将打印“预算”一词。 此外，列数量每个月都会调整。

## <a name="apply-column-justification"></a>应用列对齐方式
**“对齐方式”**单元格用于对报表中的描述列应用对齐方式格式。 此选项仅影响列描述，不影响实际值。

1.  在报表设计器中，打开要修改的列定义。
2.  双击**“对齐方式”**单元格。
3.  在列表中选择以下值之一：
    -   **无** – 不应用对齐方式。
    -   **左** – 左对齐列描述。
    -   **居中** – 居中对齐列描述。
    -   **右** – 右对齐列描述。

## <a name="add-special-formatting-options"></a>添加特定格式选项
在列定义中，格式列详细信息行对选定列应用特定格式。 虽然一些**“打印控制”**选项和**“列限制”**选项特定于 **FD** 列，但大部分选项将应用于所有列类型。 列定义中指定的格式将覆盖报表定义中指定的格式。 但是，行定义中指定的格式将覆盖列定义中指定的格式。 下列行视为格式行：

-   列宽
-   列前的额外空格
-   格式/币种覆盖
-   打印控制

### <a name="changing-the-column-width"></a>更改列宽

**“列宽”**单元格指定用于此列在打印报表上的宽度的字符数。 列宽对包含金额（**CALC**、**WKS** 或 **FD** 类型的列）、描述（**DESC** 类型的列）或填充（**FILL** 类型的列）的列非常重要。 默认情况下，将选中**“自动调整”**选项，以便自动调整每个列的宽度来适应内容。

#### <a name="specify-the-width-of-a-column-on-a-report"></a>指定报表上的列宽

1.  在报表设计器中，打开要修改的列定义。
2.  在**“列宽”**单元格中，输入列宽对应的空格数。 任何列的最大宽度为 255 个字符（此数包括内容、逗号和括号）。 或者，要使报表设计器能够基于单元格内容选择合适的列宽，请双击**列宽**单元格，然后单击**自动调整**。

### <a name="add-space-between-columns"></a>在列之间添加空格

**“列前的额外空格”**单元格在列定义中指定一个列与相邻列之间的分隔符的宽度。 **“列前的额外空格”**设置影响列的所有列详细信息行，而不是列标题行。 使用此选项分隔列的组或在描述之前添加一些空格，以便描述列从报表上的左对齐标题缩进。 各列之间的默认空格数为 2。 您可在报表定义的**“设置”**选项卡上更改此设置。

#### <a name="specify-the-space-between-columns"></a>指定各列之间的空格

1.  在报表设计器中，打开要修改的列定义。
2.  在**“列前的额外空格”**单元格中，输入要插入各列之间的空格数量。

### <a name="specify-a-currency"></a>指定币种

**“格式/币种覆盖”**单元格指定列中小数、币种和百分比金额的格式。 此格式将覆盖在报表定义中指定的任何格式或系统默认格式。

#### <a name="assign-a-format-currency-override-to-a-report-column"></a>为报表列分配格式币种覆盖

1.  在报表设计器中，打开要修改的列定义。
2.  双击金额列中的**“格式/币种覆盖”**。
3.  在**“格式覆盖”**对话框中，选择格式选项。

### <a name="add-a-print-control-code"></a>添加打印控制代码

**“打印控制”**单元格可包含调整列的显示或打印特征的代码。 有两种打印控制代码：常规打印控制代码和条件打印控制代码。

#### <a name="regular-print-control-codes"></a>常规打印控制代码

| 打印控制代码 | 翻译                                     | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|--------------------|-------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| NP                 | 非打印                                     | 不打印和计算报表此列中的金额。 要在计算中包含非打印列，请直接在计算公式中引用此列。 例如，非打印列 C 包含在以下计算中：**B+C+D**。 但是，非打印列 C 未包含在以下计算中：**B:D**。                                                                                                                                          |
| XCR                | 如果行的典型余额为信用，则更改符号 | 创建其中任何不利差异（如收入不足或超支）始终为负的预算或比较报表。 如果指定行的典型余额为信用（如行定义的**“标准余额”**列中的 **C** 所标识），则将此代码应用于 **CALC** 列以改变列金额的符号。 **注意：**对于一般包含信用余额的 **TOT** 行和 **CAL** 行，务必在行定义的**“标准余额”**列中输入 **C**。 |
| X0                 | 如果全为零或空，则隐藏列。          | 如果 **FD** 列中的所有单元格都为空或包含零，则从报表中排除此列。                                                                                                                                                                                                                                                                                                                                                                                                                             |
| SR                 | 禁止化整                               | 防止此列中的金额化整。                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| XR                 | 禁止汇总                                 | 禁止汇总。 如果报表使用报告结构树，则此列中的金额不会汇总到后续父节点中。                                                                                                                                                                                                                                                                                                                                                                                                   |
| RP                 | 在每页上重复列                      | 在报表的每页上重复指定列。 例如，您可使用 **RP** 打印控制代码包括 **ROW** 类型的列以拉取每页上的行代码。                                                                                                                                                                                                                                                                                                                                           |
| WT                 |  自动换行                                      |  如果列中文本太长导致空间不足，则换行以保留列中的所有文本。                                                                                                                                                                                                                                                                                                                                                                                                                            |

#### <a name="conditional-print-control-codes"></a>条件打印控制代码

| 条件打印控制代码 | 说明                                                                             |
|--------------------------------|-----------------------------------------------------------------------------------------|
| （无）                         | 清除条件打印选择。                                                  |
| P&lt;B                         | 仅当期间小于基准期间时，显示指定列。             |
| P&gt;B                         | 仅当期间大于基准期间时，显示指定列。             |
| P=B                            | 仅当期间等于基准期间时，显示指定列。              |
| P&lt;=B                        | 仅当期间小于或等于基准期间时，显示指定列。 |
| P&gt;=B                        | 仅当期间大于或等于基准期间时，显示指定列。 |

#### <a name="add-print-control-codes-to-a-report-column"></a>将打印控制代码添加到报表列

1.  在报表设计器中，打开要修改的列定义。
2.  双击**“打印控制”**单元格。
3.  在**“打印控制”**对话框中，选择**“选择打印控制选项”**列表中的代码。 要选择多个代码，请在选择代码的同时按住 Ctrl 键。
4.  在**“条件打印选项”**字段中选择一个选项。 默认情况下，选择**“(无)”**。 您一次只能选择一个条件打印代码。
5.  单击“**OK**”。

**提示：**您还可直接在**“打印控制”**单元格中输入打印代码。 用逗号隔开多个打印控制代码。

### 

## <a name="column-types"></a>列类型
报表每列上包含的信息类型是由列定义的**“列类型”**行中的值指定的。 每个列定义必须包含至少一个描述 (**DESC**) 列和一个金额（**FD**、**WKS** 或 **CALC**）列。 **注意：**列类型代码不适用于所有会计系统。 如果您选择对您的会计系统无效的类型，则该列在报表上为空。

### <a name="specify-a-column-type"></a>指定列类型

1.  在报表设计器中，打开要修改的列定义。
2.  在相应列中，双击**“列类型”**行中的单元格。
3.  在列表中选择列类型。 下表描述各种列类型。
    <table>
    <colgroup>
    <col width="50%" />
    <col width="50%" />
    </colgroup>
    <thead>
    <tr class="header">
    <th>列类型代码</th>
    <th>描述</th>
    </tr>
    </thead>
    <tbody>
    <tr class="odd">
    <td>FD</td>
    <td>当您在行定义中使用<strong>“至财务维度的链接”</strong>列或<strong>“至工作表的链接”</strong>列时，显示财务数据或 Excel 工作表中的数据。 当您选择 <strong>FD</strong> 列类型时，将为下列行自动指定默认设置：
    <ul>
    <li><strong>帐簿代码/属性类别：</strong>ACTUAL</li>
    <li><strong>帐簿代码/属性类别：</strong>ACTUAL</li>
    <li><strong>会计年度：</strong>BASE</li>
    <li><strong>期间：</strong>BASE</li>
    <li><strong>包括的期间：</strong>定期</li>
    <li><strong>列宽：</strong>14</li>
    </ul>
    您可更改这些默认设置。</td>
    </tr>
    <tr class="even">
    <td>CALC</td>
    <td>显示在<strong>“公式”</strong>单元格中指定的简单或复杂计算的结果。 有关详细信息，请参阅 <a href="advanced-formatting-options-financial-reporting.md">财务申报中的高级格式选项</a>。</td>
    </tr>
    <tr class="odd">
    <td>DESC</td>
    <td>显示行定义中的行描述。 虽然描述列一般是报表上的第一列，但它可以位于任何位置。</td>
    </tr>
    <tr class="even">
    <td>ROW</td>
    <td>在行定义中显示<strong>“行代码”</strong>列中财务行的单独行代码。 有关详细信息，请参阅 <a href="row-definitions-financial-reporting.md">财务申报中的行定义</a>。</td>
    </tr>
    <tr class="odd">
    <td>ACCT（科目代码）</td>
    <td>显示适用于各行的财务数据段值或维度值。 对于科目和交易记录明细报表，将打印完全符合规则的科目（例如，<strong>110140-070-0101</strong>）。 如果范围是在关联行定义的<strong>“至财务维度的链接”</strong>列中指定的，则范围将包含在方括号中并且视为一个值（例如，<strong>[110140:110700]-070-[0101:0200]</strong>）。 对于财务报表和为若干科目的组合的高级报表，将打印行定义中的财务数据链接（例如，<strong>1100:1200</strong>）。</td>
    </tr>
    <tr class="even">
    <td>FILL</td>
    <td>用您包含在单引号中的字符填充单元格。 如果未输入字符，则列为空。 例如，要用省略号 (...) 填充列，请输入 <strong>FILL</strong> <strong>'.'</strong>。</td>
    </tr>
    <tr class="odd">
    <td>PAGE</td>
    <td>在报表中插入垂直分页符。 位于 <strong>PAGE</strong> 列右侧的列将显示在不同的页上。</td>
    </tr>
    <tr class="even">
    <td>WKS</td>
    <td>显示从 Excel 工作表提取的数据。 当您选择 <strong>WKS</strong> 列类型时，将为下列行自动指定默认设置：
    <ul>
    <li><strong>会计年度：</strong>PERIODIC</li>
    <li><strong>期间：</strong>BASE</li>
    </ul>
    您可更改这些默认设置。</td>
    </tr>
    <tr class="odd">
    <td>ATTR</td>
    <td>如果您的会计系统支持属性，则将在列中显示科目或交易记录属性。 必须应用于单个完整科目的属性从财务数据中提取基础科目或交易记录信息。 科目级别的属性显示科目数据，而交易记录级别的属性显示对交易记录过帐时出现的数据。 如果您选择 <strong>ATTR</strong> 作为列类型，则在列定义的<strong>帐簿代码/属性类别</strong>详细信息行中指定属性类别。</td>
    </tr>
    </tbody>
    </table>

### <a name="financial-dimensions-column"></a>财务维度列

以下**“列定义”**行定义将应用于具有 **FD** 列类型（财务维度中的金额）的列。

#### <a name="book-codeattribute-category-cell"></a>“帐簿代码/属性类别”单元格

**“帐簿代码/属性类别”**单元格识别 **FD** 列中数据的帐簿代码。 列定义可包含多个实际列、预算列和统计列。 列定义还可显示不同期间，如当前或本年迄今金额和不同的金额。 帐簿代码的列表反映在财务数据中已建立的实际、预算和统计（非财务）选项。

#### <a name="fiscal-year-cell"></a>“会计年度”单元格

**“会计年度”**单元格标识列应包含的会计年度。 年度可与在生成报表时指定的基准年相对。 下列选项可用。

| 选项  | 描述                                                                                                                  |
|---------|------------------------------------------------------------------------------------------------------------------------------|
| BASE    | 使用报表时间中指定的基准年。                                                                          |
| BASE+\# | 使用为基准年之后的第 \# 年的年度。 例如，要使用基准年之后的第三年，请输入 **BASE+3**。 |
| BASE-\# | 使用为基准年之前的第 \# 年的年度。 例如，要使用上一年，请输入 **BASE-1**。                 |
| \#      | 输入实际会计年度。                                                                                                |

#### <a name="period-cell"></a>“期间”单元格

**“期间”**单元格标识列应包含的会计期间。 期间可与在生成报表时指定的基准期间相对。 下列选项可用。

| 选项          | 说明                                                                                                                                                                                                                          |
|-----------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| BASE            | 使用基准期间。                                                                                                                                                                                                                 |
| BASE+\#         | 使用为基准期间之后的第 \# 期的期间。 例如，要使用基准期间之后的第三个期间，请输入 **BASE+3**。                                                                                               |
| BASE-\#         | 使用为基准期间之前的第 \# 期的期间。 例如，要使用上一个期间，请输入 **BASE-1**。                                                                                                                 |
| BASE-\#:BASE    | 使用多个期间，从基准期间之前的多个期间到基准期间。 例如，要使用之前的三个期间和基准期间，请输入 **BASE-3:BASE**。                                                |
| BASE:BASE+\#    | 使用多个期间，从基准期间到基准期间之后的多个期间。 例如，要使用基准期间和之后的两个期间，请输入 **BASE:BASE+2**。                                                  |
| BASE-\#:BASE+\# | 使用多个期间，从基准期间之前的多个期间到基准期间之后的多个期间。 例如，要使用之前的三个期间、基准期间和后面的两个期间，请输入 **BASE-3:BASE+2**。 |
| 1:BASE          | 使用多个期间，从第一个期间到基准期间。                                                                                                                                                                 |
| \#              | 请始终使用具体期间编号。 我们建议您不要使用此选项，因为它会降低列定义的灵活性。                                                                                       |
| \#                                      : \#           | 始终使用具体期间范围。 我们建议您不要使用此选项，因为它会降低列定义的灵活性。                                                                                    |

您可超出任何期间规范中的会计年度边界，并且可在期间范围中混合年度。 例如，将期间指定为 **BASE-5**（以表示过去 6 个期间）并运行具有 2 个基准期间的报表。 在此示例中，报表显示指定会计年度的 2 个期间以及上一会计年度的最后 4 个期间的数据。

### <a name="specify-the-periods-for-an-fd-column"></a>指定 FD 列的期间

1.  在报表设计器中，打开要修改的列定义。
2.  在 **FD** 列中，双击**“期间”**行中的单元格，然后选择列表中的选项。
3.  在导航窗格上方的公式栏中或**“期间”**单元格中，填写公式。 将任何数字符号 (\#) 替换为相应值。

#### <a name="periods-covered-cell"></a>“包括的期间”单元格

**“包括的期间”**单元格标识列应显示的金额。 此金额相对于列的**“会计年度”**和**“期间”**单元格中的值。 下列选项可用。

| 选项      | 描述                                                                 |
|-------------|-----------------------------------------------------------------------------|
| PERIODIC    | 显示当前期间或期间范围的活动之和。 |
| PERIODIC/BB | 显示当前期间或期间范围的期初余额。   |
| 年初至今         | 显示本年迄今活动之和。                               |
| YTD/BB      | 显示年度的期初余额。                                 |

### <a name="specify-the-periods-that-are-covered-for-an-fd-column"></a>指定 FD 列包含的期间

1.  在报表设计器中，打开要修改的列定义。
2.  在 **FD** 列中，双击**“包括的期间”**行中的单元格，然后选择列表中的选项。

### <a name="attribute-filter-in-a-column-definition"></a>列定义中的属性筛选器

属性是进一步定义科目或交易记录的财务数据值。 科目属性包括**“资产”**、**“负债”**、**“收入”**和**“支出”**。 交易记录属性包括**“交易记录描述”**和**“交易记录应用日期”**。 Microsoft Dynamics ERP 系统之间的属性支持可能不同。 **“属性筛选器”**单元格将 **FD** 列中的数据限制为属性类别的特定值或范围。 虽然此功能可与 **ATTR** 列一起使用，但 **ATTR** 列不是必需的。 在 **FD** 列中，报表将从属性筛选器中包含的科目和交易记录上存在限制。 **注意：**要查看您的 ERP 系统支持的属性，请参阅您的系统的集成指南。

#### <a name="apply-an-attribute-filter-for-an-fd-column-on-a-report"></a>对报表上的列应用属性筛选器

1.  在报表设计器中，打开要修改的列定义。
2.  双击 **FD** 列的**“属性筛选器”**单元格。
3.  在**“属性筛选器”**对话框中，双击**“属性”**列中的单元格，然后选择筛选器类型。
4.  要进一步限制结果，请在**“从”**和**“到”**列中输入范围。 **“从”**单元格必须包含值。
5.  单击“**OK**”。

#### <a name="example-of-an-attribute-filter"></a>属性筛选器的示例

以下示例显示在**“帐簿代码/属性类别”**行中具有科目属性的列描述的一部分。 此列的属性筛选器指定要包含在报表中的值的范围。

|                              | A    | B                    |
|------------------------------|------|----------------------|
| 列类型                  | DESC | FD                   |
| 帐簿代码/属性类别 |      | ACTUAL               |
| 会计年度                  |      | BASE                 |
| 期间                       |      | 1:BASE               |
| 包括的期间              |      | PERIODIC             |
| ...                          |      |                      |
| 列宽                 | 30   |                      |
| ...                          |      |                      |
| 属性筛选器             |      |  Reference=\[01:10\] |

### <a name="dimension-filter-in-a-column-definition"></a>列定义中的维度筛选器

维度筛选器用于将 **FD** 列限制到特定维度值。 筛选器可包含单个维度、一系列维度或一组维度。 筛选器还可包括维度值集。 由于维度值可能各不相同，因此基于 ...\财务维度\维度的系统不必对应于准确的长度。 将应用筛选器，不管报表是否包含报告结构树都是如此。 您可在任何位置中使用通配符（\* 或 ?）。 当您指定多个科目时，将在科目间放置逗号，如以下示例中所示：+Account=\[1200\], +Account=\[1100\], Department=\[01?\] 要接收特定科目的所有部门，您可从维度筛选器中排除“部门”维度。 例如，将以相同方式处理以下两个维度筛选器：

-   +Account=\[1100\],Department
-   +Account=\[1100\]

您还可使用字母数字字符的任何组合进行精确匹配，并且可定义部分维度。 例如，**Location = \[10\*\]** 包含以 10 开头的所有位置维度值。

#### <a name="apply-a-dimension-filter-for-a-column-on-a-report"></a>对报表上的列应用维度筛选器

1.  在报表设计器中，打开要修改的列定义。
2.  双击 **FD** 列的**“维度筛选器”**单元格。
3.  在**“维度”**对话框中，输入要应用的筛选器。
4.  单击“**OK**”。

### <a name="format-a-multiple-currency-report-in-a-column-definition"></a>设置列定义中多币种报表的格式

多币种报表可以自然（当地）币种、功能（默认）币种或申报币种显示金额。 公司的功能币种是在 Microsoft Dynamics ERP 系统中定义的。 请勿将此 ERP 设置与操作系统的区域选项设置混淆，您可在后者中配置报表上使用的默认币种符号。 下列币种相关单元格在列定义中可用：

-   **货币显示** – 指定显示交易记录采用的币种类型（自然、功能或申报）。 此功能有时称为“币种转换”。 币种转换是一种功能，采用可能不是公司的功能币种或输入交易记录时采用的币种报告总帐。
-   **币种筛选器** – 指定币种筛选器。 报表上仅显示采用选定币种输入的交易记录。

**注意：**要创建使用多个币种的报表，您必须选中报表定义的**“报表”**选项卡上的**“包括所有报表币种”**复选框。 要确定公司的功能币种，请执行下列步骤。

1.  在报表设计器的**“公司”**菜单上，单击**“公司”**。
2.  在**“公司”**对话框中，选择一个公司，然后单击**“查看”**。
3.  在**“查看公司”**对话框的**“区域选项”**下，您可查看为选定公司定义的币种。

#### <a name="specify-the-currency-on-a-multiple-currency-report"></a>指定多币种报表上的币种

1.  在报表设计器中，打开要修改的列定义。
2.  双击相应 **FD** 列中的**“币种显示”**单元格，然后选择显示币种信息的选项：**“自然/原始币种”**、**“公司信息中的功能币种”**或申报币种。
3.  双击相应 **FD** 列中的**“币种筛选器”**单元格，然后在列表中选择正确的币种代码。 报表上仅显示采用此币种输入的交易记录。

**注意：**此处介绍的选项可能根据 ERP 系统变化。 有关详细信息，请参阅您的 [Microsoft ERP 系统文档](https://www.microsoft.com/en-us/download/details.aspx?id=5916)。

### <a name="example-for-currency-display-and-currency-filter-cells"></a>“币种显示”单元格和“币种筛选器”单元格的示例

Phyllis 在列定义中做出了下列币种选择：

-   **币种筛选器：**日元
-   **币种显示：**功能（美元）

由于 Phyllis 选择的币种筛选器，报表仅包含采用日元 (JPY) 输入的交易记录。 由于她选择的币种显示，报表将显示采用功能币种（美元）的交易记录。

#### <a name="currency-filter-and-currency-display-combinations"></a>币种筛选器和币种显示组合

下表显示因为 Phyllis 在**“币种显示”**和**“币种筛选器”**单元格中选择的选项的各种组合可能产生的报表结果。 功能币种为美元。

| “币种显示”单元格                        | “币种筛选器”单元格 | 报表结果                                                                                                                                                                                    |
|----------------------------------------------|----------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 自然/原始币种                 | **YEN**              | **Y6,000** – 结果将仅显示采用 JPY 输入的交易记录。                                                                                                                        |
| 公司信息中的功能币种 | **YEN**              | **$60** – 结果仅显示采用 JPY 的交易记录并且采用美元显示交易记录。 **注意：**汇率约为一美元等于 100 日元。                    |
| 公司信息中的功能币种 | 空                | **$2,310\*\*** – 结果将以公司信息中指定的功能币种显示所有数据。 **注意：**此金额是采用功能币种的所有交易记录之和。 |
| 自然/原始币种                 | 空                | **$2,250** – 结果将以执行交易记录时采用的币种显示所有金额。                                                                                                 |

### <a name="calculation-column-in-a-column-definition"></a>列定义中的计算公式

列定义中的 **CALC** 列类型支持**公式**单元格中的复杂计算，并且可包含 **+**、**-**、**\*** 和 **/** 运算符以及 **IF/THEN/ELSE** 语句。 计算列还可引用任何其他列，甚至后续列。 此外，计算列还可包括会计年度和期间以支持列的标题。 计算公式的长度最多可为 1,024 个字符。 要以百分比形式表达计算结果，请使用特殊格式覆盖。 **注意：**计算公式的结果不包含非打印列范围中的值。 例如，**A:D** 将打印 **0**（零），而针对非打印值的 **A+B+C** 将计算此值。

#### <a name="operators-in-calculation-columns"></a>计算列中的运算符

要对列执行加、减、乘、除，请按计算顺序输入列字母，然后使用正确的运算符隔开每个列字母。 下表说明了可在计算列中使用的运算符。

| 操作员 | 计算示例 | 说明                                                                                                                                                                                                                                    |
|----------|---------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| +        | A+C                 | 用列 A 中的金额加上列 C 中的金额。                                                                                                                                                                                          |
| :        | A:C A:C-D           | 一系列连续列相加。 例如，公式 **A:C** 加上列 A 到 C 的总计，公式 **A:C-D** 加上列 A 到 C 的总计，然后减去列 D 中的金额。                          |
| -        | A-C                 | 从列 C 中减去列 A 中的金额。**注意：**您还可使用减号 (-) 改变列中的符号。 例如，使用 **- A+B** 在列 A 中添加与列 B 中的金额相反的金额。 |
| \*       | A\*C                | 用列 A 中的金额乘以列 C 中的金额。                                                                                                                                                                                     |
| /        | A/C                 | 用列 A 中的金额除以列 C 中的金额。                                                                                                                                                                                       |

#### <a name="use-a-calculation-formula-in-a-column-definition"></a>使用列定义中的计算公式

1.  在报表设计器中，打开要修改的列定义。
2.  在相应 **CALC** 列的**“公式”**单元格中输入公式。

#### <a name="complex-calculations"></a>复杂计算

复杂计算可包含单元格引用、运算符、值和嵌套括号级别的任何组合。 例如，要计算列 A 和 B 的平均值，请使用计算公式 **(A+B)/2)**。

#### <a name="specify-report-cells-in-a-column-calculation"></a>在列计算中指定报表单元格

您可通过输入列字母和行代码来引用特定报表单元格。 例如，**B.100** 引用列 B 中的行代码 100。您可用整列除以位于同一列中的特定报表单元格金额。 例如，计算 **B/B.100** 意味着列 B 中的金额应除以列 B 中行代码 100 中的值。如果计算引用依赖其他列的列，则先解析依赖列。 如果您对引用回第一列的另一列引用列，则将导致循环引用参考。 **注意：**如果您更改报表的计算优先级，则计算可能不正确。 您可在报表定义的**“设置”**选项卡上设置计算优先级。

#### <a name="multiply-or-divide-a-column-by-a-base-row"></a>用列乘以或除以基准行

您可创建以基数的百分比形式显示指定列中所有值的列。 因此，您可显示各行之间的关系，如销售行的百分比或总支出行的百分比。 要用特定列中的每行乘以或除以基准行，请输入要在计算中使用的列，然后输入 **\*BASEROW** 或 **/BASEROW**。 例如，输入 **C\*BASEROW** 或 **C/BASEROW**。 **注意：**当您在列定义中使用基准行计算时，确保用于此列定义的每个行定义至少包含一个计算基准行。

#### <a name="divide-the-amount-in-a-column-by-the-number-of-periods"></a>用列中的金额除以期间数量

您可用列中的金额除以指定期间数量。 例如，公式 **B/Periods** 用列 B 中的值除以列 B 中的期间数量。如果计算跨多列，则指定要在计算中使用的期间数量。 例如，公式 **(B+C)/Periods** 将列 B 和列 C 中的金额相加，然后用结果除以期间值。

<a name="see-also"></a>请参阅
--------

[财务申报中的行定义](row-definitions-financial-reporting.md)

[财务申报中的高级格式设置选项](advanced-formatting-options-financial-reporting.md)


