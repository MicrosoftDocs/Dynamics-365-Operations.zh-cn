---
title: "合并库存批次"
description: "本文提供有关如何将两个或多个库存批次整合到单个合并批次的信息。"
author: YuyuScheller
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-applications
ms.technology: 
ms.search.form: InventBatchJournalListPage, InventBatchJournalMerge
audience: Application User
ms.reviewer: yuyus
ms.search.scope: Core, AX 7.0.0, Operations, UnifiedOperations
ms.custom: 39782
ms.assetid: 07c5e98b-10fd-4f5c-b471-41d2150f47b0
ms.search.region: Global
ms.author: pjacobse
ms.search.validFrom: 2016-02-28T00:00:00.000Z
ms.dyn365.ops.version: AX 7.0.0
ms.translationtype: Human Translation
ms.sourcegitcommit: 9262dcaa3b326d8c31b7d7416b102920795da94b
ms.openlocfilehash: aec97976ef6a2b4c66118289f7f76b14351456f8
ms.contentlocale: zh-cn
ms.lasthandoff: 06/13/2017

---

# <a name="merge-inventory-batches"></a>合并库存批次

[!include[banner](../includes/banner.md)]


本文提供有关如何将两个或多个库存批次整合到单个合并批次的信息。 

合并批次时，计算有助于优化合并批次的特征和批次属性。 在选择源批次后，您可以在过帐前查看和更改合并批次。 您还可以将批次合并转移到库存日记帐，以供审核。 然后，可直接从库存日记帐预留或过帐库存。 过帐合并批次时，会针对源批次和合并批次调整库存。

## <a name="are-there-any-prerequisites"></a>有什么先决条件吗？
有，需要进行一些设置才能使用合并批次工具。 下表描述了先决条件。

<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th>页面</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>日记帐名称，库存</td>
<td>过帐库存日记帐中的批次合并时，必须创建默认情况下要使用的日记帐名称。 可选但推荐：您也可以指定在批次合并转移到库存日记帐时应进行自动预留。 否则，在设置批次合并详细信息且过帐日记帐后现有库存存在可能被更改的风险。 若要对日记帐名称启用自动预留，请在<strong><strong>预留</strong></strong>字段中选择<strong>自动</strong>。</td>
</tr>
<tr class="even">
<td>库存和仓库管理参数</td>
<td>必须为库存日记帐指定默认的日记帐名称。</td>
</tr>
<tr class="odd">
<td>已发布产品</td>
<td>以下是物料的推荐设置：
<ul>
<li>若要自动生成合并批次的批次编号，必须将向已发布产品分配批次编号组。 还可以在创建合并批次时手动输入批次编号或者选择现有批次编号。 如果选择现有批次编号，请确保所选批次尚未包含在任何库存交易记录中。</li>
<li>如果使用已发布产品的保质期或最佳使用日期，则将基于<strong>批次合并日期计算</strong>字段中的选择计算合并批次的日期。 选项如下：
<ul>
<li><strong>最早</strong> – 计算基于针对批次合并选择的源批次指定的最早日期。</li>
<li><strong>最近</strong> – 计算基于针对批次合并选择的源批次指定的最近日期。</li>
<li><strong>手动</strong> – 不进行计算。 如果所有源批次上日期均相同，将会建议一个日期。 可以更改该日期。 如果与源批次上的日期不同，可以手动输入日期。</li>
</ul></li>
</ul></td>
</tr>
<tr class="even">
<td>批处理号组</td>
<td>可选：若要在创建合并批次时生成批次编号，必须向已发布产品分配批次编号组。 或者，您可以手动输入批次编号。</td>
</tr>
</tbody>
</table>

## <a name="when-might-i-want-to-merge-batches-of-inventory"></a>我在何时可以合并库存批次？
以下是可能对合并批次比较有用的一些情况的示例：

-   Sammy 在巡逻仓库，他发现有几个批次的物料数量较少。 他期望收到一些新的装运，并且他意识到可以通过将奇数数量合并到新批次中来腾出一些空间。
-   Sammy 收到了一些库存，他想要将新批次与已收到的批次合并以改善现有批次的批次属性值。

## <a name="can-i-merge-batches-across-sites-and-legal-entities"></a>我可以跨站点和法人合并批次吗？
不能，您只能合并在一个法人中拥有相同站点和仓库存储维度的批次。 但是，您可以为合并批次指定不同的位置和托盘 ID。

## <a name="can-i-merge-partial-quantities"></a>我能否合并部分数量？
不，您只可以合并全部批次数量。 批次合并功能作为库存功能，而非生产功能。

## <a name="what-if-the-batches-have-different-batch-attribute-values"></a>批次具有不同的批次属性值怎么办？
选择要结合在合并批次中的源批次时，Finance and Operations 验证所有批次是否具有特征或属性值。 如果属性值相同，则会为合并批次建议一个值。 可以更改该值。 合并批次的不同属性值将留空，您可以手动输入这些值。 如果属性值的批次属性类型是整数或分数，且所有源批次的值不同，则将会使用加权平均计算来计算值。 计算的值将四舍五入为最接近的增量。 如果源批次的值为空，则批次和数量不会包括在计算中。 **示例**下面举例显示了合并批次的加权平均计算。 两个源批次对于为整数的批次属性类型提供了空值。 以下属性分配给了源批次。

| 属性 | 最小值 | 增量 | 最大值 |
|-----------|---------|-----------|---------|
| 等级     | 3       | 3         | 30      |

源批次为**分级批次**属性提供了以下属性值。

| 批次 | 数量 | 属性 | 属性值 |
|-------|----------|-----------|-----------------|
| B1    | 10       | 等级     | 空白           |
| B2    | 15       | 等级     | 15              |
| B3    | 20       | 等级     | 20              |
| B4    | 25       | 等级     | 空白           |
| B5    | 30       | 等级     | 25              |

将这些批次作为源批次添加时，会为合并批次分配以下值。

| 批次 | 数量 | 属性 | 属性值 |
|-------|----------|-----------|-----------------|
| B6    | 100      | 等级     | 21              |

批次 B1 和 B4 的值和数量不包括在加权平均计算中。 因此，以下是合并批次的值如何计算。

| 值 | 数量（重量）                              | 相对重量 | 相对重量 × 值                                               |
|-------|------------------------------------------------|-----------------|-----------------------------------------------------------------------|
| 15    | 15                                             | 0.230769231     | 3.461538462                                                           |
| 20    | 20                                             | 0.307692308     | 6.153846154                                                           |
| 25    | 30                                             | 0.461538462     | 11.53846154                                                           |
|       | **总计：**65，总重。 |                 | **总计：**21.5384615，四舍五入为 21（最接近的增量） |

## <a name="what-if-the-batches-have-different-batch-dates"></a>批次具有不同的批次日期怎么办？
如果批次具有不同的批次日期，某些日期基于**批次合并**页的**合并批次**快速选项卡上的**批次日期**组中的值计算。 系统计算**批次日期**组中的字段的值。 这些值包括生产日期、过期日期、建议存储日期以及最佳使用日期。 日期是基于**已发布产品详细信息**页上**物料数据**字段组中的物料的设置而计算的。 您可以更改值或手动输入值。 对于所有其他日期，不会进行计算。 批次属性值适用相同的原则。 如果对于所有源批次日期都相同，则将会为合并批次建议此日期。 如果所有源批次的日期并不相同，则合并批次的日期将留空，您可以手动输入日期。

## <a name="what-if-the-dimensions-are-different-on-the-batches-that-i-want-to-merge"></a>我要合并的批次上的维度不同怎么办？
以下是产品维度、跟踪维度以及存储维度如何处理：

-   **产品维度** – 所选物料的所有产品维度必须相同。 不能跨产品维度合并批次。
-   **跟踪维度** – 如果为物料指定了批次编号组，则会自动生成新的批次编号。 如果未为物料分配批次编号组，则可以选择现有批次或者手动输入编号。 序列号将从源批次转移到合并批次的库存日记帐行。
-   **存储维度** – 所有源批次和合并批次的站点和仓库存储维度必须相同。 但是，您可以为合并批次指定新的位置和托盘 ID。

## <a name="how-does-posting-work"></a>过帐的工作原理是什么？
过帐以两种方式操作，具体取决于您是否对日记帐使用审核流程。 您可以使用**转移到日记帐**和**过帐批次合并**操作将批次合并转移到其中可以对其进行验证和过帐的日记帐，或者您可以直接过帐批次合并。 两个操作的主要区别在于转移到日记帐不会过帐批次合并。 两个操作都会创建新批次（如果未选中现在有批次）、更新所有批次详细信息和属性值，并创建库存日记帐。

-   **转移到日记帐** – 将批次合并详细信息转移到新库存日记帐。 如果已设置自动预留，将预留源批次中的数量。 无法更改此批次合并的详细信息。 若要修改批次合并，则必须删除日记帐。 日记帐可用作其他员工以后必须执行的任务。 日记帐行的批次数量的预留受到保护。 此分摊允许质量规划员或仓库经理创建其员工的任务。
-   **过帐批次合并** – 直接过帐批次合并。 在实际合并发生后，可以执行此操作。

您可以从**所有批次合并**页审核批次合并的库存日记帐。 单击**日记帐** &gt; **过帐**。 在过帐日记帐后，您无法更改合并批次中的信息。 将批次合并转移到库存日记帐后，仅当删除日记帐后您才能更改详细信息。

## <a name="after-i-merged-a-catchweight-item-why-cant-i-see-the-catchweight-information-in-the-inventory-journal"></a>合并非定重物料后，我为什么看不到库存日记帐上的定重信息？
您可以像所有其他物料那样合并定重物料批次。 但是，库存日记帐上未显示定重信息。 我们建议您先验证定重信息，然后再将批次合并转移到库存日记帐。




