---
title: "具有实际成本和标记的加权平均"
description: 
author: YuyuScheller
manager: AnnBe
ms.date: 2016-03-17 15 - 15 - 52
ms.topic: article
ms.prod: 
ms.service: Dynamics365Operations
ms.technology: 
ms.search.form: InventJournalLossProfit, InventMarking, InventModelGroup, SalesTable
audience: Application User
ms.reviewer: YuyuScheller
ms.search.scope: AX 7.0.0, Operations, Core
ms.custom: 65501
ms.assetid: 25041ff0-bafe-484d-a94a-e1772ad43204
ms.search.region: Global
ms.search.industry: Retail
ms.author: yuyus
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
translationtype: Human Translation
ms.sourcegitcommit: 9ccbe5815ebb54e00265e130be9c82491aebabce
ms.openlocfilehash: 1afd7855fd05d0bacb60a7a45bba68e7041a4f4b
ms.lasthandoff: 03/29/2017


---

# <a name="weighted-average-with-physical-value-and-marking"></a>具有实际成本和标记的加权平均



在您执行库存结转时，将根据虚拟发货结算所有收货，这将保留收货总数量和值。 此虚拟发货具有将从其结算发货的相应虚拟收货。 通过这种方法，所有发货都具有相同的平均成本。 虚拟发货和收货可以视为虚拟转移，称为“加权平均库存结转转移”。
如果只存在一个收货，则可以根据该收货结算所有发货，并且将不创建虚拟转移。 在使用加权平均时，您可以标记库存交易记录，以便根据特定发货（而非使用加权平均规则）结算特定库存收货。 我们建议在您使用加权平均库存模型时使用每月库存结转。 加权平均库存成本计算方法按以下公式计算：
-   加权平均= (\*P1 Q1 + Q2 + Qn\*P2\*Pn)/(Q1 + Q2 + Qn)

保留库存问题的库存交易记录。 这包括销售订单、库存日志和生产订单（在过账时按估算的成本价而发生）。 此预估成本价也称作移动平均。 在库存结转时，将分析系统库存交易记录以前期间和当前期间并且确定应使用以下哪些结转原则。
-   直接结算
-   汇总结算

结算是在结转日期时将发货调整为正确的加权平均的库存结转过帐。 以下示例通过五个不同的配置阐释对使用加权平均的影响：
-   不具有“包括实际成本”选项的加权平均直接结算
-   没有“包括实际成本”选项的加权平均汇总结算
-   具有“包括实际成本”选项的加权平均直接结算
-   具有“包括实际成本”选项的加权平均汇总结算
-   具有标记的加权平均

## <a name="weighted-average-direct-settlement-without-include-physical-value"></a>不包括实际成本的加权平均直接结算
直接结算原则同样用于加权平均中的早期版本。 系统将直接在收货和发货之间进行结算。 系统在某些特定情况下使用这一直接结算原则：
-   已在期间中过帐一个收货以及一个或若干发货
-   在该期间中只过帐了发货，并且库存包含来自以前结转的现有物料

在下节的场景中，已过帐财务上更新的收货和发货。 在库存结转期间，系统将直接根据发货对收货结算，并且对成本价进行调整。则无需在问题。 该图阐释了以下交易记录。
-   1a. 为数量 5（单价 USD 10.00）更新的库存实际收货
-   1b. 为数量 5（单价 USD 10.00）更新的库存财务收货
-   2a. 为数量 2（单价 USD 10.00）更新的库存实际发货
-   2a. 为数量 2（单价 USD 10.00）更新的库存财务发货
-   3. 使用直接结算方法执行库存结转，以便结算对库存财务发货的库存财务收货。

下图说明在选择了加权平均库存模型和直接结算原则（没有“包括实际成本”选项）的情况下此系列的交易记录。 ![不具有“包括实际成本”的加权平均直接结算](./media/weightedaveragedirectsettlementwithoutincludephysicalvalue.gif) 图形要点
-   库存交易记录用垂直箭头表示。
-   入库用时间线上的垂直箭头表示。
-   出库用时间线下的垂直箭头表示。
-   找零 (以下内容) 每个垂直箭头上，库存交易记录的值。Quantity@Unitprice指定格式。
-   用括号括起来的库存交易记录值指示该库存交易记录实际过帐到库存中。
-   没有用括号括起来的库存交易记录值指示该库存交易记录财务过帐到库存中。
-   每个新的收货或发货交易记录都用一个新标签标明。
-   Each vertical arrow is labeled with a sequential identifier, such as *1a*. 这些标识符指示时间线中库存交易记录过帐的顺序。
-   库存结转用红色的垂直虚线以及“库存结转”标签表示。
-   由库存结转执行的结算用红色虚线箭头（沿对角方向从收货指向发货）表示。

## <a name="weighted-average-summarized-settlement-without-the-include-physical-value-option"></a>没有“包括实际成本”选项的加权平均汇总结算
加权平均原则使用结算所有收货都结算的期间汇总到它称作加权平均库存结转的交易记录。 该期间的所有收货都将根据新创建的库存转移交易记录的发货进行结算。 该期间的所有发货都将根据新的库存转移交易记录的收货进行结算。 如果在库存结转后，现有库存量为正值，则库存的现有库存量和值将汇总在新的库存转移交易记录（收货）上。 如果在库存结转后，现有库存量为负值，则库存的现有库存量和值将是尚未完全结算的各个单独发货之和。 在下面的场景中，已过帐若干财务上更新的收货和一个发货。 在库存结转期间，系统将生成和过帐汇总的库存转移交易记录的收货和结算期间汇总的库存转移发货交易记录。 为该期间过帐的所有发货都将根据汇总的库存转移收货交易记录进行结算。 该加权平均计算为 USD 15.00。 最初使用估算的成本价 USD 14.67 过账该发货。 因此，将创建并在该发货上过账负 USD 0.33 的调整。 截至库存结转日期，现有库存量为 3 件且价值为 USD 45.00。 下图阐释了以下交易记录：
-   1a. 为数量 2（单件成本为 USD 11.00）更新的库存实际收货。
-   1b. 为数量 2（单件成本为 USD 14.00）更新的库存财务收货。
-   2a. 为数量 1（单件成本为 USD 12.00）更新的库存实际收货。
-   2a. 为数量 1（单件成本为 USD 16.00）更新的库存财务收货。
-   3a. 为数量 1（单件成本为 USD 14.67）更新的库存实际发货（移动平均）。
-   3b. 为数量 1（单件成本为 USD 14.67）更新的库存财务发货（移动平均）。
-   4a. 为数量 1（单件成本为 USD 14.00）更新的库存实际收货。
-   4b. 为数量 1（单件成本为 USD 16.00）更新的库存财务收货。
-   5. 执行库存结转。
-   6a. 创建“加权平均库存结转交易记录”财务发货，以便计算所有库存财务收货结算之和。
-   6b. 创建“加权平均库存结转交易记录”财务收货，作为对 5a 的抵消。

下图说明在选择了加权平均库存模型和汇总结算原则（没有“包括实际成本”选项）的情况下此系列的交易记录。 ![不具有“包括实际成本”的加权平均汇总结算](./media/weightedaveragesummarizedsettlementwithoutincludephysicalvalue.gif) 图形要点
-   库存交易记录用垂直箭头表示。
-   入库用时间线上的垂直箭头表示。
-   出库用时间线下的垂直箭头表示。
-   找零 (以下内容) 每个垂直箭头上，库存交易记录的值。Quantity@Unitprice指定格式。
-   用括号括起来的库存交易记录值指示该库存交易记录实际过帐到库存中。
-   没有用括号括起来的库存交易记录值指示该库存交易记录财务过帐到库存中。
-   每个新的收货或发货交易记录都用一个新标签标明。
-   Each vertical arrow is labeled with a sequential identifier, such as *1a*. 这些标识符指示时间线中库存交易记录过帐的顺序。
-   库存结转用红色的垂直虚线以及“库存结转”标签表示。
-   由库存结转执行的结算用红色虚线箭头（沿对角方向从收货指向发货）表示。
-   红色箭头说明要结算到系统创建的发货交易记录的收货交易记录。
-   绿色箭头表示最初过帐的发货交易记录结算到的抵消系统生成的收货交易记录

## <a name="weighted-average-direct-settlement-with-the-include-physical-value-option"></a>具有“包括实际成本”选项的加权平均直接结算
不同参数包括实际成本使用加权平均库存模型不同于产品的早期版本。 为“物料模型组”窗体中的某一物料选中“包括实际成本”框。 然后系统将使用实际更新收货，在计算估计成本价时或移动平均。 将在期间中基于此估计的成本价过帐发货。 在库存结转期间，在加权平均计算时将只考虑财务更新的收货。 我们建议在您使用加权平均库存模型时使用每月库存结转。 在此加权平均直接结算示例中，将标记物料模型组以包括实际值。 下图阐释了以下交易记录：
-   1a. 为数量 1（单件成本为 USD 11.00）更新的库存实际收货。
-   1b. 为数量 1（单件成本为 USD 10.00）更新的库存财务收货。
-   2a. 为数量 1（单件成本为 USD 15.00）更新的库存实际收货。
-   3a. 为数量 1（单件成本为 USD 12.50）更新的库存实际发货（移动平均成本，因为考虑实际收货值）。
-   3b. 为数量 1（单件成本为 USD 12.50）更新的库存财务发货（移动平均成本，因为考虑实际收货值）。
-   4. 执行库存结转。 在库存结转期间，系统将不考虑只物理更新的所有库存交易记录。 而是将使用直接结算原则，因为只有一个财务收货存在。 USD 2.50 的调整将过帐到截至库存结转日期已财务发货的库存交易记录。 在库存结转后，现有库存量将为数量 1，且具有移动平均成本价 USD 15.00。

下图说明在选择了加权平均库存模型和直接结算原则（有“包括实际成本”选项）的情况下此系列的交易记录。 ![具有“包括实际成本”的加权平均直接结算](./media/weightedaveragedirectsettlementwithincludephysicalvalue.gif) 图形要点
-   库存交易记录用垂直箭头表示。
-   入库用时间线上的垂直箭头表示。
-   出库用时间线下的垂直箭头表示。
-   找零 (以下内容) 每个垂直箭头上，库存交易记录的值。Quantity@Unitprice指定格式。
-   用括号括起来的库存交易记录值指示该库存交易记录实际过帐到库存中。
-   没有用括号括起来的库存交易记录值指示该库存交易记录财务过帐到库存中。
-   每个新的收货或发货交易记录都用一个新标签标明。
-   Each vertical arrow is labeled with a sequential identifier, such as *1a*. 这些标识符指示时间线中库存交易记录过帐的顺序。
-   库存结转用红色的垂直虚线以及“库存结转”标签表示。
-   由库存结转执行的结算用红色虚线箭头（沿对角方向从收货指向发货）表示。

## <a name="weighted-average-summarized-settlement-with-the-include-physical-value-option"></a>具有“包括实际成本”选项的加权平均汇总结算
不同工作参数包括实际成本的加权平均不同于早期版本。 为“物料模型组”页中的某一物料选中“包括实际成本”框。 然后系统在估计成本价的计算将使用实际更新收货或移动平均。 将在期间中基于此估计的成本价过帐发货。 在库存结转期间，在加权平均计算时将只考虑财务更新的收货。 我们建议在您使用加权平均库存模型时使用每月库存结转。 在此加权平均汇总结算示例中，将标记库存模型以包括实际值。 下图阐释了以下交易记录：
-   1a. 为数量 2（单件成本为 USD 11.00）更新的库存实际收货。
-   1b. 为数量 2（单件成本为 USD 14.00）更新的库存财务收货。
-   2. 为数量 1（单件成本为 USD 10.00）更新的库存实际收货。
-   3a. 为数量 1（单件成本为 USD 12.00）更新的库存实际收货。
-   3b. 为数量 1（单件成本为 USD 16.00）更新的库存财务收货。
-   4a. 为数量 1（单件成本为 USD 13.50）更新的库存实际发货（移动平均成本，因为考虑实际收货值）。
-   4b. 为数量 1（单件成本为 USD 13.50）更新的库存财务发货（移动平均成本，因为考虑实际收货值）。
-   的 . 为数量 1（单件成本为 USD 14.00）更新的库存实际收货。
-   5b. 为数量 1（单件成本为 USD 16.00）更新的库存财务收货。
-   6. 执行库存结转。 在库存结转期间，系统将不考虑只物理更新的所有库存交易记录。 而是将使用汇总结算原则，因为只有一个财务收货存在。 USD 1.50 的调整将过帐到截至库存结转日期已财务发货的库存交易记录。 在库存结转后，现有库存量将为数量 3，且具有移动平均成本价 USD 15.00。
-   7a. 创建“加权平均库存结转交易记录”财务发货，以便计算所有库存财务收货结算之和。
-   7b. 创建“加权平均库存结转交易记录”财务收货，作为对 5a 的抵消。

下图说明在选择了加权平均库存模型和汇总结算原则（没有“包括实际成本”选项）的情况下此系列的交易记录。 ![具有“包括实际成本”的加权平均汇总结算](./media/weightedaveragesummarizedsettlementwithincludephysicalvalue.gif) 图形要点
-   库存交易记录用垂直箭头表示。
-   入库用时间线上的垂直箭头表示。
-   出库用时间线下的垂直箭头表示。
-   找零 (以下内容) 每个垂直箭头上，库存交易记录的值。Quantity@Unitprice指定格式。
-   用括号括起来的库存交易记录值指示该库存交易记录实际过帐到库存中。
-   没有用括号括起来的库存交易记录值指示该库存交易记录财务过帐到库存中。
-   每个新的收货或发货交易记录都用一个新标签标明。
-   每个垂直箭头用连续标识符标记，例如 1a。 这些标识符指示时间线中库存交易记录过帐的顺序。
-   库存结转用红色的垂直虚线以及“库存结转”标签表示。
-   由库存结转执行的结算用红色虚线箭头（沿对角方向从收货指向发货）表示。
-   红色箭头说明要结算到系统创建的发货交易记录的收货交易记录。
-   绿色箭头表示最初过帐的发货交易记录结算到的抵消系统生成的收货交易记录

## <a name="weighted-average-with-marking"></a>具有标记的加权平均
标记是可以链接的流程，或标记，到收货交易记录的发货交易记录。 标记可以在过帐交易记录之前或之后发生。 如果您想要在过帐交易记录时或执行库存结转时确保库存的准确成本，则可以使用标记。 例如，您的客户服务部接受了来自重要客户的一个紧急订单。 因为这是紧急订单，所以，您将需要为此物料支付更多成本以服务您的客户的请求。 您必须确保此库存物料的成本反映在此销售订单发票的毛利中或所售货物成本 (COGS) 中。 在过帐采购订单时，按 USD 120.00 的成本入库。 例如，如果在装箱单或发票过帐之前，此销售订单单据标记到采购订单。 然后，COGS 将是 USD 120.00 代替物料的当前移动平均成本。 如果在发生标记前过帐销售订单装箱单或发票，则将按移动平均成本价过帐 COGS。 在执行库存结转前，仍可以彼此标记这两个交易记录。 将收货交易记录标记到某一发货交易记录。 然后，为物料物料的模型组选择的评估方法将废弃，并且系统将彼此结算这些交易记录。 在过帐交易记录前，您可以将某一发货交易记录标记到某一收货交易记录。 您可以从“销售订单详细信息”页上的销售订单行执行此操作。 在“标记”页上查看未结收货交易记录。 在过账交易记录只看，您可以将某一发货交易记录标记到某一收货交易记录。 您可以匹配或标记已过帐库存调整日记帐的清查过物料的未结收货交易记录的发货交易记录。 下图阐释了以下交易记录：
-   1a. 数量 1（单件成本为 USD 10.00）的库存实际收货。
-   1b. 数量 1（单件成本为 USD 10.00）的库存财务收货。
-   2a. 数量 1（单件成本为 USD 20.00）的库存实际收货。
-   2a. 数量 1（单件成本为 USD 20.00）的库存财务收货。
-   3a. 数量 1（单件成本为 USD 25.00）的库存实际收货。
-   4a. 数量 1（单件成本为 USD 30.00）的库存实际收货。
-   4b. 数量 1（单件成本为 USD 30.00）的库存财务收货。
-   的 . 数量 1（单件成本价为 USD 21.25）的库存实际发货（财务和实际更新的交易记录的移动平均）。
-   5b. 在过帐交易记录前将数量为 1 的库存财务发货标记为库存收货 2b。 此交易记录用成本价 USD 20.00 过帐。
-   6a. 数量 1（单件成本价为 USD 21.25）的库存实际发货。
-   7. 执行库存结转。 因为财务更新的交易记录标记为现有收货，所以将彼此结算这些交易记录并且不进行调整。

新的移动平均成本价反映按 USD 27.50 的财务和实际更新的交易记录的平均价。 下图说明在选择具有标记的加权平均库存模型的情况下此系列的交易记录。 ![具有标记的加权平均](./media/weightedaveragewithmarking.gif) 图形要点
-   库存交易记录用垂直箭头表示。
-   入库用时间线上的垂直箭头表示。
-   出库用时间线下的垂直箭头表示。
-   找零 (以下内容) 每个垂直箭头上，库存交易记录的值。Quantity@Unitprice指定格式。
-   用括号括起来的库存交易记录值指示该库存交易记录实际过帐到库存中。
-   没有用括号括起来的库存交易记录值指示该库存交易记录财务过帐到库存中。
-   每个新的收货或发货交易记录都用一个新标签标明。
-   Each vertical arrow is labeled with a sequential identifier, such as *1a*. 这些标识符指示时间线中库存交易记录过帐的顺序。
-   库存结转用红色的垂直虚线以及“库存结转”标签表示。
-   由库存结转执行的结算用红色虚线箭头（沿对角方向从收货指向发货）表示。




