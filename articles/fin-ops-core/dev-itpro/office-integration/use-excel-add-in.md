---
title: 使用 Excel 查看和更新实体数据
description: 此主题介绍如何通过使用 Microsoft Dynamics Excel 加载项，在 Microsoft Excel 中打开实体数据，然后查看、更新和编辑这些数据。
author: jasongre
manager: AnnBe
ms.date: 01/22/2021
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
audience: Application User
ms.reviewer: sericks
ms.custom: 267914
ms.assetid: 4e6c7194-a059-4057-bd62-ec0c802c36fd
ms.search.region: Global
ms.author: jasongre
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 0a9486b3d700cdbe19fbcdba431f673d0a03014f
ms.sourcegitcommit: ca05440ee503bf15fe98fe138d317c1cdf21ad16
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/09/2021
ms.locfileid: "5141868"
---
# <a name="view-and-update-entity-data-with-excel"></a><span data-ttu-id="6e045-103">使用 Excel 查看和更新实体数据</span><span class="sxs-lookup"><span data-stu-id="6e045-103">View and update entity data with Excel</span></span> 

[!include [banner](../includes/banner.md)]
[!include [preview banner](../includes/preview-banner.md)]

<span data-ttu-id="6e045-104">此主题介绍如何通过使用 Microsoft Dynamics Excel 加载项，在 Microsoft Excel 中打开实体数据，然后查看、更新和编辑这些数据。</span><span class="sxs-lookup"><span data-stu-id="6e045-104">This topic explains how to open entity data in Microsoft Excel, and then view, update, and edit the data by using the Microsoft Dynamics Excel add-in.</span></span> <span data-ttu-id="6e045-105">若要打开实体数据，可从 Excel 或 Finance and Operations 应用开始。</span><span class="sxs-lookup"><span data-stu-id="6e045-105">To open entity data, you can start from either Excel or Finance and Operations apps.</span></span>

<span data-ttu-id="6e045-106">通过在 Excel 中打开实体数据，可以使用 Excel 加载项快速、轻松地查看和编辑这些数据。</span><span class="sxs-lookup"><span data-stu-id="6e045-106">By opening entity data in Excel, you can quickly and easily view and edit the data by using the Excel add-in.</span></span> <span data-ttu-id="6e045-107">此加载项需要 Microsoft Excel 2016 或更高版本。</span><span class="sxs-lookup"><span data-stu-id="6e045-107">This add-in requires Microsoft Excel 2016 or later.</span></span>

> [!NOTE]
> <span data-ttu-id="6e045-108">如果将您的 Microsoft Azure Active Directory (Azure AD) 租户配置为使用 Active Directory Federation Services (AD FS)，则必须确保已应用了 2016 年 5 月的 Office 更新，以便 Excel 加载项可以让您正确登录。</span><span class="sxs-lookup"><span data-stu-id="6e045-108">If your Microsoft Azure Active Directory (Azure AD) tenant is configured to use Active Directory Federation Services (AD FS), you must make sure that the May 2016 update for Office has been applied, so that the Excel add-in can correctly sign you in.</span></span>

<span data-ttu-id="6e045-109">若要了解有关如何使用 Excel 加载项的详细信息，请观看短片[为标头和行模式创建 Excel 模板](https://youtu.be/RTicLb-6dbI)。</span><span class="sxs-lookup"><span data-stu-id="6e045-109">To learn more about how to use the Excel add-in, watch the short [Create an Excel template for header and line patterns](https://youtu.be/RTicLb-6dbI) video.</span></span>

## <a name="open-entity-data-in-excel-when-you-start-from-a-finance-and-operations-app"></a><span data-ttu-id="6e045-110">从 Finance and Operations 应用开始时在 Excel 中打开实体数据</span><span class="sxs-lookup"><span data-stu-id="6e045-110">Open entity data in Excel when you start from a Finance and Operations app</span></span>
1. <span data-ttu-id="6e045-111">在 Finance and Operations 应用中的页面上，选择 **在 Microsoft Office 中打开**。</span><span class="sxs-lookup"><span data-stu-id="6e045-111">On a page in a Finance and Operations app, select **Open in Microsoft Office**.</span></span>

    <span data-ttu-id="6e045-112">如果该页面的根数据源（表）与任何实体的根数据源相同，将为该页面生成默认 **在 Excel 中打开** 选项。</span><span class="sxs-lookup"><span data-stu-id="6e045-112">If the root data source (table) for the page is the same as the root data source for any entities, default **Open in Excel** options are generated for the page.</span></span> <span data-ttu-id="6e045-113">可以在常用页面（如 **所有供应商** 和 **所有客户**）中找到 **在 Excel 中打开** 选项。</span><span class="sxs-lookup"><span data-stu-id="6e045-113">**Open in Excel** options can be found on frequently used pages, such as **All vendors** and **All customers**.</span></span>
 
2. <span data-ttu-id="6e045-114">选择 **在 Excel 中打开** 选项，然后打开生成的工作簿。</span><span class="sxs-lookup"><span data-stu-id="6e045-114">Select an **Open in Excel** option, and open the workbook that is generated.</span></span> <span data-ttu-id="6e045-115">此工作簿中包含实体的绑定信息、指向您的环境的指针，以及指向 Excel 加载项的指针。</span><span class="sxs-lookup"><span data-stu-id="6e045-115">This workbook has binding information for the entity, a pointer to your environment, and a pointer to the Excel add-in.</span></span>
3. <span data-ttu-id="6e045-116">在 Excel 中，选择 **启用编辑** 以启用并运行此 Excel 加载项。</span><span class="sxs-lookup"><span data-stu-id="6e045-116">In Excel, select **Enable editing** to enable the Excel add-in to run.</span></span> <span data-ttu-id="6e045-117">将在 Excel 窗口右侧的窗格中运行此 Excel 加载项。</span><span class="sxs-lookup"><span data-stu-id="6e045-117">The Excel add-in runs in a pane on the right side of the Excel window.</span></span>
4. <span data-ttu-id="6e045-118">如果首次运行此 Excel 加载项，则选择 **信任此加载项**。</span><span class="sxs-lookup"><span data-stu-id="6e045-118">If you're running the Excel add-in for the first time, select **Trust this Add-in**.</span></span>
5. <span data-ttu-id="6e045-119">如果系统提示您登录，选择 **登录**，然后使用用于登录 Finance and Operations 应用的相同凭据登录。</span><span class="sxs-lookup"><span data-stu-id="6e045-119">If you're prompted to sign in, select **Sign in**, and then sign in by using the same credentials that you used to sign in to the Finance and Operations app.</span></span> <span data-ttu-id="6e045-120">此 Excel 加载项将使用浏览器中之前的登录上下文，并自动让您登录（如果可以）。</span><span class="sxs-lookup"><span data-stu-id="6e045-120">The Excel add-in will use a previous sign-in context from the browser and automatically sign you in, if it can.</span></span> <span data-ttu-id="6e045-121">（有关基于操作系统使用的浏览器的信息，请参阅 [Office 加载项使用的浏览器](https://docs.microsoft.com/office/dev/add-ins/concepts/browsers-used-by-office-web-add-ins.)为确保登录成功，请在 Excel 加载项的右上角验证用户名。</span><span class="sxs-lookup"><span data-stu-id="6e045-121">(For information about the browser that is used based on the operating system, see [Browsers used by Office add-ins](https://docs.microsoft.com/office/dev/add-ins/concepts/browsers-used-by-office-web-add-ins.) To ensure that sign-in was successful, verify the user name in the upper-right corner of the Excel add-in.</span></span> 

<span data-ttu-id="6e045-122">此 Excel 加载项自动读取您所选实体的数据。</span><span class="sxs-lookup"><span data-stu-id="6e045-122">The Excel add-in automatically reads the data for the entity that you selected.</span></span> <span data-ttu-id="6e045-123">请注意，Excel 加载项读入数据之前，工作簿中无任何数据。</span><span class="sxs-lookup"><span data-stu-id="6e045-123">Note that there will be no data in the workbook until the Excel add-in reads it in.</span></span>

## <a name="open-entity-data-in-excel-when-you-start-from-excel"></a><span data-ttu-id="6e045-124">从 Excel 开始时在 Excel 中打开实体数据</span><span class="sxs-lookup"><span data-stu-id="6e045-124">Open entity data in Excel when you start from Excel</span></span>
1. <span data-ttu-id="6e045-125">在 Excel 中的 **插入** 选项卡上的 **加载项** 组中，选择 **应用商店** 打开 Office 应用商店。</span><span class="sxs-lookup"><span data-stu-id="6e045-125">In Excel, on the **Insert** tab, in the **Add-ins** group, select **Store** to open the Office Store.</span></span>
2. <span data-ttu-id="6e045-126">在 Office 应用商店中，搜索关键字 **Dynamics**，然后选择 **Microsoft Dynamics Office 加载项**（即此 Excel 加载项）旁边的 **添加**。</span><span class="sxs-lookup"><span data-stu-id="6e045-126">In the Office Store, search on the keyword **Dynamics**, and then select **Add** next to **Microsoft Dynamics Office Add-in** (the Excel add-in).</span></span>
3. <span data-ttu-id="6e045-127">如果首次运行此 Excel 加载项，请选择 **信任此加载项** 以启用并运行此 Excel 加载项。</span><span class="sxs-lookup"><span data-stu-id="6e045-127">If you're running the Excel add-in for the first time, select **Trust this Add-in** to enable the Excel add-in to run.</span></span> <span data-ttu-id="6e045-128">将在 Excel 窗口右侧的窗格中运行此 Excel 加载项。</span><span class="sxs-lookup"><span data-stu-id="6e045-128">The Excel add-in runs in a pane on the right side of the Excel window.</span></span>
4. <span data-ttu-id="6e045-129">选择 **添加服务器信息** 打开 **选项** 页面。</span><span class="sxs-lookup"><span data-stu-id="6e045-129">Select **Add server information** to open the **Options** pane.</span></span>
5. <span data-ttu-id="6e045-130">在浏览器中，复制目标 Finance and Operations 应用实例的 URL，将其粘贴到 **服务器 URL** 字段中，然后删除主机名后的所有内容。</span><span class="sxs-lookup"><span data-stu-id="6e045-130">In your browser, copy the URL of your target Finance and Operations app instance, paste it into the **Server URL** field, and then delete everything after the host name.</span></span> <span data-ttu-id="6e045-131">产生的 URL 应只有一个主机名。</span><span class="sxs-lookup"><span data-stu-id="6e045-131">The resulting URL should have only the host name.</span></span>

    <span data-ttu-id="6e045-132">例如，如果 URL 为 `https://xxx.dynamics.com/?cmp=usmf&amp;mi=CustTableListPage`，则删除除 `https://xxx.dynamics.com` 以外的所有内容。</span><span class="sxs-lookup"><span data-stu-id="6e045-132">For example, if the URL is `https://xxx.dynamics.com/?cmp=usmf&amp;mi=CustTableListPage`, delete everything except `https://xxx.dynamics.com`.</span></span>

6. <span data-ttu-id="6e045-133">选择 **确定**，然后选择 **是** 确认更改。</span><span class="sxs-lookup"><span data-stu-id="6e045-133">Select **OK**, and then select **Yes** to confirm the change.</span></span> <span data-ttu-id="6e045-134">此 Excel 加载项将重新启动并加载元数据。</span><span class="sxs-lookup"><span data-stu-id="6e045-134">The Excel add-in is restarted and loads metadata.</span></span>

    <span data-ttu-id="6e045-135">**设计** 按钮现在可用。</span><span class="sxs-lookup"><span data-stu-id="6e045-135">The **Design** button is now available.</span></span> <span data-ttu-id="6e045-136">如果此 Excel 加载项有 **加载小程序** 按钮，您可能无法作为正确用户登录。</span><span class="sxs-lookup"><span data-stu-id="6e045-136">If the Excel add-in has a **Load applets** button, you probably aren't signed in as the correct user.</span></span> <span data-ttu-id="6e045-137">有关详细信息，请参阅本主题[故障排除](https://docs.microsoft.com/dynamics365/unified-operations/dev-itpro/office-integration/use-excel-add-in#troubleshooting)部分中的“显示‘加载小程序’按钮”。</span><span class="sxs-lookup"><span data-stu-id="6e045-137">For more information, see "The Load applets button is shown" in the [Troubleshooting](https://docs.microsoft.com/dynamics365/unified-operations/dev-itpro/office-integration/use-excel-add-in#troubleshooting) section of this topic.</span></span>

7. <span data-ttu-id="6e045-138">选择 **设计**。</span><span class="sxs-lookup"><span data-stu-id="6e045-138">Select **Design**.</span></span> <span data-ttu-id="6e045-139">此 Excel 加载项将检索实体元数据。</span><span class="sxs-lookup"><span data-stu-id="6e045-139">The Excel add-in retrieves entity metadata.</span></span>
8. <span data-ttu-id="6e045-140">选择 **添加表**。</span><span class="sxs-lookup"><span data-stu-id="6e045-140">Select **Add table**.</span></span> <span data-ttu-id="6e045-141">将显示实体列表。</span><span class="sxs-lookup"><span data-stu-id="6e045-141">A list of entities appears.</span></span> <span data-ttu-id="6e045-142">将以“名称 - 标签”格式列出实体。</span><span class="sxs-lookup"><span data-stu-id="6e045-142">The entities are listed in "Name - Label" format.</span></span>
9. <span data-ttu-id="6e045-143">选择列表中的实体（如 **客户 - 客户**），然后选择 **下一步**。</span><span class="sxs-lookup"><span data-stu-id="6e045-143">Select an entity in the list, such as **Customer - Customers**, and then select **Next**.</span></span>
10. <span data-ttu-id="6e045-144">若要将 **可用字段** 列表中的字段添加到 **所选字段** 列表，选择该字段，然后选择 **添加**。</span><span class="sxs-lookup"><span data-stu-id="6e045-144">To add a field from the **Available fields** list to the **Selected fields** list, select the field, and then select **Add**.</span></span> <span data-ttu-id="6e045-145">或者，双击 **可用字段** 列表中的字段。</span><span class="sxs-lookup"><span data-stu-id="6e045-145">Alternatively, double-click the field in the **Available fields** list.</span></span>
11. <span data-ttu-id="6e045-146">将字段添加到 **所选字段** 列表之后，请确保光标在工作表中的正确位置（如单元格 A1），然后选择 **完成**。</span><span class="sxs-lookup"><span data-stu-id="6e045-146">After you've finished adding fields to the **Selected fields** list, make sure that the cursor is in the correct place in the worksheet (for example, cell A1), and then select **Done**.</span></span> <span data-ttu-id="6e045-147">然后选择 **完成** 退出设计器。</span><span class="sxs-lookup"><span data-stu-id="6e045-147">Then select **Done** to exit the designer.</span></span>
12. <span data-ttu-id="6e045-148">选择 **刷新** 以提取一组数据。</span><span class="sxs-lookup"><span data-stu-id="6e045-148">Select **Refresh** to pull in a set of data.</span></span>

## <a name="view-and-update-entity-data-in-excel"></a><span data-ttu-id="6e045-149">在 Excel 中查看和更新实体数据</span><span class="sxs-lookup"><span data-stu-id="6e045-149">View and update entity data in Excel</span></span>
<span data-ttu-id="6e045-150">此 Excel 加载项将实体数据读入工作簿之后，随时可通过选择 Excel 加载项中的 **刷新** 更新这些数据。</span><span class="sxs-lookup"><span data-stu-id="6e045-150">After the Excel add-in reads entity data into the workbook, you can update the data at any time by selecting **Refresh** in the Excel add-in.</span></span>

## <a name="edit-entity-data-in-excel"></a><span data-ttu-id="6e045-151">在 Excel 中编辑实体数据</span><span class="sxs-lookup"><span data-stu-id="6e045-151">Edit entity data in Excel</span></span>
<span data-ttu-id="6e045-152">可根据需要更改实体数据，然后通过选择 Excel 加载项中的 **发布** 将其发布回 Finance and Operations 应用。</span><span class="sxs-lookup"><span data-stu-id="6e045-152">You can change entity data as you require and then publish it back to Finance and Operations apps by selecting **Publish** in the Excel add-in.</span></span> <span data-ttu-id="6e045-153">若要编辑记录，请在工作表中选择单元格，然后更改单元格值。</span><span class="sxs-lookup"><span data-stu-id="6e045-153">To edit a record, select a cell in the worksheet, and then change the cell value.</span></span> <span data-ttu-id="6e045-154">若要创建新记录，请执行以下步骤之一：</span><span class="sxs-lookup"><span data-stu-id="6e045-154">To add a new record, follow one of these steps:</span></span>

- <span data-ttu-id="6e045-155">单击数据源表中的任意位置，然后选择此 Excel 加载项中的 **新建**。</span><span class="sxs-lookup"><span data-stu-id="6e045-155">Click anywhere in the data sources table, and then select **New** in the Excel add-in.</span></span>
- <span data-ttu-id="6e045-156">在数据源表最后一行中单击任何位置，然后按 Tab 键，直到光标移出该行的最后一列，并创建一个新行。</span><span class="sxs-lookup"><span data-stu-id="6e045-156">Click anywhere in the last row of the data sources table, and then press the Tab key until the cursor moves out of the last column of that row and a new row is created.</span></span>
- <span data-ttu-id="6e045-157">在数据源表正下方的行中单击任何位置，然后开始在单元格中输入数据。</span><span class="sxs-lookup"><span data-stu-id="6e045-157">Click anywhere in the row immediately below the data sources table, and start to enter data in a cell.</span></span> <span data-ttu-id="6e045-158">将光标移出该单元格时，表将扩展以容纳新行。</span><span class="sxs-lookup"><span data-stu-id="6e045-158">When you move the focus out of that cell, the table expands to include the new row.</span></span>
- <span data-ttu-id="6e045-159">要进行标题记录的字段绑定，选择其中一个字段，然后在 Excel 加载项中选择 **新建**。</span><span class="sxs-lookup"><span data-stu-id="6e045-159">For field bindings of header records, select one of the fields, and then select **New** in the Excel add-in.</span></span>

<span data-ttu-id="6e045-160">请注意，只有当所有重要的必填字段在工作表中绑定时，或当使用筛选条件填写默认值时，才能够创建新记录。</span><span class="sxs-lookup"><span data-stu-id="6e045-160">Note that a new record can be created only if all the key and mandatory fields are bound in the worksheet, or if default values were filled in by using the filter condition.</span></span>

<span data-ttu-id="6e045-161">若要删除记录，请执行以下步骤之一：</span><span class="sxs-lookup"><span data-stu-id="6e045-161">To delete a record, follow one of these steps:</span></span>

- <span data-ttu-id="6e045-162">右键单击应删除的工作表行旁边的行号，然后选择 **删除**。</span><span class="sxs-lookup"><span data-stu-id="6e045-162">Right-click the row number next to the worksheet row that should be deleted, and then select **Delete**.</span></span>
- <span data-ttu-id="6e045-163">右键单击应删除的工作表行旁边内的任何位置，然后选择 **删除** &gt; **表行**。</span><span class="sxs-lookup"><span data-stu-id="6e045-163">Right-click anywhere in the worksheet row that should be deleted, and then select **Delete** &gt; **Table Rows**.</span></span>

<span data-ttu-id="6e045-164">如果数据源添加为相关数据源，标题在行前面发布。</span><span class="sxs-lookup"><span data-stu-id="6e045-164">If data sources have been added as related data sources, the header is published before the lines.</span></span> <span data-ttu-id="6e045-165">如果其他数据源之间存在相关性，您可能必须更改默认发布顺序。</span><span class="sxs-lookup"><span data-stu-id="6e045-165">If there are dependencies between other data sources, you might have to change the default publishing order.</span></span> <span data-ttu-id="6e045-166">若要更改发布顺序，在 Excel 加载项中，选择 **选项** 按钮（齿轮符号），然后，在 **数据连接器** 快速选项卡上，选择 **配置发布顺序**。</span><span class="sxs-lookup"><span data-stu-id="6e045-166">To change the publishing order, in the Excel add-in, select the **Options** button (the gear symbol), and then, on the **Data Connector** FastTab, select **Configure publish order**.</span></span>

## <a name="add-or-remove-columns"></a><span data-ttu-id="6e045-167">添加或删除列</span><span class="sxs-lookup"><span data-stu-id="6e045-167">Add or remove columns</span></span>
<span data-ttu-id="6e045-168">可以使用设计器调整自动添加到工作表的列。</span><span class="sxs-lookup"><span data-stu-id="6e045-168">You can use the designer to adjust the columns that are automatically added to the worksheet.</span></span>

> [!NOTE]
> <span data-ttu-id="6e045-169">如果 **设计** 按钮未出现在 Excel 加载项中的 **筛选** 按钮下，您必须启用数据源设计器。</span><span class="sxs-lookup"><span data-stu-id="6e045-169">If the **Design** button doesn't appear below the **Filter** button in the Excel add-in, you must enable the data source designer.</span></span> <span data-ttu-id="6e045-170">选择 **选项** 按钮（齿轮符号），然后选择 **启用设计** 复选框。</span><span class="sxs-lookup"><span data-stu-id="6e045-170">Select the **Options** button (the gear symbol), and then select the **Enable design** check box.</span></span>

1. <span data-ttu-id="6e045-171">在 Excel 加载项中，选择 **设计**。</span><span class="sxs-lookup"><span data-stu-id="6e045-171">In the Excel add-in, select **Design**.</span></span> <span data-ttu-id="6e045-172">将列出所有数据源。</span><span class="sxs-lookup"><span data-stu-id="6e045-172">All the data sources are listed.</span></span>
2. <span data-ttu-id="6e045-173">选择数据源旁边的 **编辑** 按钮（铅笔符号）。</span><span class="sxs-lookup"><span data-stu-id="6e045-173">Next to the data source, select the **Edit** button (the pencil symbol).</span></span>
3. <span data-ttu-id="6e045-174">在 **所选字段** 列表中，根据需要调整字段列表：</span><span class="sxs-lookup"><span data-stu-id="6e045-174">In the **Selected fields** list, adjust the list of fields as you require:</span></span>

    - <span data-ttu-id="6e045-175">若要将 **可用字段** 列表中的字段添加到 **所选字段** 列表，选择该字段，然后选择 **添加**。</span><span class="sxs-lookup"><span data-stu-id="6e045-175">To add a field from the **Available fields** list to the **Selected fields** list, select the field, and then select **Add**.</span></span> <span data-ttu-id="6e045-176">或者，双击 **可用字段** 列表中的字段。</span><span class="sxs-lookup"><span data-stu-id="6e045-176">Alternatively, double-click the field in the **Available fields** list.</span></span>
    - <span data-ttu-id="6e045-177">若要删除 **所选字段** 列表中的字段，选择该字段，然后选择 **删除**。</span><span class="sxs-lookup"><span data-stu-id="6e045-177">To remove a field from the **Selected fields** list, select the field, and then select **Remove**.</span></span> <span data-ttu-id="6e045-178">或者双击该字段。</span><span class="sxs-lookup"><span data-stu-id="6e045-178">Alternatively, double-click the field.</span></span>
    - <span data-ttu-id="6e045-179">若要更改字段的顺序，请在 **所选字段** 列表中选择字段，然后选择 **向上** 或 **向下**。</span><span class="sxs-lookup"><span data-stu-id="6e045-179">To change the order of fields in the **Selected fields** list, select a field, and then select **Up** or **Down**.</span></span>

4. <span data-ttu-id="6e045-180">若要应用对数据源的更改，选择 **更新**。</span><span class="sxs-lookup"><span data-stu-id="6e045-180">To apply your changes to the data source, select **Update**.</span></span> <span data-ttu-id="6e045-181">然后选择 **完成** 退出设计器。</span><span class="sxs-lookup"><span data-stu-id="6e045-181">Then select **Done** to exit the designer.</span></span>
5. <span data-ttu-id="6e045-182">如果添加了字段（列），选择 **刷新** 提取更新后的数据集。</span><span class="sxs-lookup"><span data-stu-id="6e045-182">If you added a field (column), select **Refresh** to pull in an updated set of data.</span></span>

## <a name="change-the-publish-batch-size"></a><span data-ttu-id="6e045-183">更改发布批处理大小</span><span class="sxs-lookup"><span data-stu-id="6e045-183">Change the publish batch size</span></span>
<span data-ttu-id="6e045-184">当用户使用 Excel 加载项将更改发布到数据记录时，更新将成批提交。</span><span class="sxs-lookup"><span data-stu-id="6e045-184">When users publish changes to data records by using the Excel add-in, the updates are submitted in batches.</span></span> <span data-ttu-id="6e045-185">默认的发布批处理大小为 100 行。</span><span class="sxs-lookup"><span data-stu-id="6e045-185">The default publish batch size is 100 rows.</span></span> <span data-ttu-id="6e045-186">在版本 10.0.17 及更高版本中，**允许在 Excel 加载项中配置发布批处理大小** 功能让您可以灵活地控制发布批处理大小。</span><span class="sxs-lookup"><span data-stu-id="6e045-186">In version 10.0.17 and later, the **Allow configuration of the publish batch size in the Excel add-in** feature gives you flexible control over the publish batch size.</span></span>

<span data-ttu-id="6e045-187">系统管理员可以通过设置 **Office 应用参数** 页 **应用参数** 部分的 **发布批处理限制** 字段，来为“在 Excel 中打开”工作簿的发布批处理大小指定系统范围的限制。</span><span class="sxs-lookup"><span data-stu-id="6e045-187">System administrators can specify a system-wide limit on the publish batch size for "Open in Excel" workbooks by setting the **Publish batch limit** field in the **App parameters** section of the **Office app parameters** page.</span></span>

<span data-ttu-id="6e045-188">还可以使用 Excel 加载项为单个工作簿更改发布批处理大小。</span><span class="sxs-lookup"><span data-stu-id="6e045-188">The publish batch size can also be changed for an individual workbook by using the Excel add-in.</span></span>

1. <span data-ttu-id="6e045-189">在 Excel 中打开工作簿。</span><span class="sxs-lookup"><span data-stu-id="6e045-189">Open the workbook in Excel.</span></span>
2. <span data-ttu-id="6e045-190">选择 Excel 加载项右上方的 **选项**（齿轮）按钮。</span><span class="sxs-lookup"><span data-stu-id="6e045-190">Select the **Option** (gear) button in the upper right of the Excel add-in.</span></span>
3. <span data-ttu-id="6e045-191">根据需要设置 **发布批处理大小** 字段。</span><span class="sxs-lookup"><span data-stu-id="6e045-191">Set the **Publish batch size** field as desired.</span></span> <span data-ttu-id="6e045-192">您设置的值必须小于系统范围的发布批处理限制。</span><span class="sxs-lookup"><span data-stu-id="6e045-192">The value that you set must be less than the system-wide publish batch limit.</span></span>
4. <span data-ttu-id="6e045-193">选择 **确定**。</span><span class="sxs-lookup"><span data-stu-id="6e045-193">Select **OK**.</span></span>
5. <span data-ttu-id="6e045-194">保存工作簿。</span><span class="sxs-lookup"><span data-stu-id="6e045-194">Save the workbook.</span></span> <span data-ttu-id="6e045-195">如果您在更改加载项设置后未保存工作簿，重新打开工作簿时，这些更改不会保留。</span><span class="sxs-lookup"><span data-stu-id="6e045-195">If you don't save the workbook after you make changes to the add-in settings, those changes won't persist when the workbook is reopened.</span></span>

<span data-ttu-id="6e045-196">Excel 工作簿模板作者可以使用相同的过程来设置模板的发布批处理大小，然后再将其上载到系统。</span><span class="sxs-lookup"><span data-stu-id="6e045-196">Excel workbook template authors can use the same procedure to set the publish batch size for templates before they upload them into the system.</span></span>

## <a name="copy-environment-data"></a><span data-ttu-id="6e045-197">复制环境数据</span><span class="sxs-lookup"><span data-stu-id="6e045-197">Copy environment data</span></span>

<span data-ttu-id="6e045-198">读入一个环境的工作簿中的数据可以复制到另一个环境。</span><span class="sxs-lookup"><span data-stu-id="6e045-198">The data that is read into the workbook from one environment can be copied to another environment.</span></span> <span data-ttu-id="6e045-199">但是，您无法仅更改连接 URL，因为工作簿中的数据缓存会继续将该数据视为现有数据。</span><span class="sxs-lookup"><span data-stu-id="6e045-199">However, you can't just change the connection URL, because the data cache in the workbook will continue to treat the data as existing data.</span></span> <span data-ttu-id="6e045-200">您必须使用“复制环境数据”功能将数据作为新数据发布到新的环境。</span><span class="sxs-lookup"><span data-stu-id="6e045-200">Instead, you must use the Copy Environment Data functionality to publish the data to a new environment as new data.</span></span>

1. <span data-ttu-id="6e045-201">选择 **选项** 按钮（齿轮符号），然后，在 **数据连接器** 快速选项卡上，选择 **复制环境数据**。</span><span class="sxs-lookup"><span data-stu-id="6e045-201">Select the **Options** button (the gear symbol), and then, on the **Data Connector** FastTab, select **Copy Environment Data**.</span></span> 
2. <span data-ttu-id="6e045-202">输入新环境的服务器 URL。</span><span class="sxs-lookup"><span data-stu-id="6e045-202">Enter the server URL for the new environment.</span></span> 
3. <span data-ttu-id="6e045-203">选择 **确定**，然后选择 **是** 确认操作。</span><span class="sxs-lookup"><span data-stu-id="6e045-203">Select **OK**, and then select **Yes** to confirm the action.</span></span> <span data-ttu-id="6e045-204">Excel 加载项将重新启动并连接到新的环境。</span><span class="sxs-lookup"><span data-stu-id="6e045-204">The Excel add-in is restarted and connects to the new environment.</span></span> <span data-ttu-id="6e045-205">工作簿中的所有现有数据将被视为新数据。</span><span class="sxs-lookup"><span data-stu-id="6e045-205">Any existing data in the workbook is treated as new data.</span></span>

    <span data-ttu-id="6e045-206">在 Excel 加载项重新启动后，消息框显示工作簿处于环境复制模式。</span><span class="sxs-lookup"><span data-stu-id="6e045-206">After the Excel add-in is restarted, a message box states that the workbook is in Environment copy mode.</span></span>

4. <span data-ttu-id="6e045-207">若要作为新数据将数据复制到新环境，请选择 **发布**。</span><span class="sxs-lookup"><span data-stu-id="6e045-207">To copy the data into the new environment as new data, select **Publish**.</span></span> <span data-ttu-id="6e045-208">若要取消环境复制操作并在新环境中查看现有数据，选择 **刷新**。</span><span class="sxs-lookup"><span data-stu-id="6e045-208">To cancel the environment copy operation and review the existing data in the new environment, select **Refresh**.</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="6e045-209">疑难解答</span><span class="sxs-lookup"><span data-stu-id="6e045-209">Troubleshooting</span></span>
<span data-ttu-id="6e045-210">可通过某些简单步骤解决一些问题。</span><span class="sxs-lookup"><span data-stu-id="6e045-210">There are a few issues that can be resolved through some easy steps.</span></span>

- <span data-ttu-id="6e045-211">**将显示“加载小程序”按钮** – 如果登录后此 Excel 加载项有 **加载小程序** 按钮，您可能无法作为正确用户登录。</span><span class="sxs-lookup"><span data-stu-id="6e045-211">**The Load applets button is shown** – If the Excel add-in has a **Load applets** button after sign-in, you probably aren't signed in as the correct user.</span></span> <span data-ttu-id="6e045-212">若要解决此问题，请验证此 Excel 加载项右上角中是否显示正确的用户名。</span><span class="sxs-lookup"><span data-stu-id="6e045-212">To resolve this issue, verify that the correct user name appears in the upper-right corner of the Excel add-in.</span></span> <span data-ttu-id="6e045-213">如果显示错误的用户名，请选择该用户名，注销，然后再次登录。</span><span class="sxs-lookup"><span data-stu-id="6e045-213">If an incorrect user name appears, select it, sign out, and then sign back in.</span></span>
- <span data-ttu-id="6e045-214">**您收到“已禁止”消息** – 如果此 Excel 加载项加载元数据时收到“已禁止”消息，则登录了该 Excel 加载项的帐户无权使用目标服务、实例或数据库。</span><span class="sxs-lookup"><span data-stu-id="6e045-214">**You receive a "Forbidden" message** – If you receive a "Forbidden" message while the Excel add-in is loading metadata, the account that is signed in to the Excel add-in doesn't have permission to use the targeted service, instance, or database.</span></span> <span data-ttu-id="6e045-215">若要解决此问题，请验证此 Excel 加载项右上角中是否显示正确的用户名。</span><span class="sxs-lookup"><span data-stu-id="6e045-215">To resolve this issue, verify that the correct user name appears in the upper-right corner of the Excel add-in.</span></span> <span data-ttu-id="6e045-216">如果显示错误的用户名，请选择该用户名，注销，然后再次登录。</span><span class="sxs-lookup"><span data-stu-id="6e045-216">If an incorrect user name appears, select it, sign out, and then sign back in.</span></span>
- <span data-ttu-id="6e045-217">**Excel 上方显示空白网页** – 如果登录过程中打开空白网页，则帐户需要 AD FS，但是正在运行此 Excel 加载项的 Excel 版本不够高，无法加载登录对话框。</span><span class="sxs-lookup"><span data-stu-id="6e045-217">**A blank webpage is shown over Excel** – If a blank webpage is opened during the sign-in process, the account requires AD FS, but the version of Excel that is running the Excel add-in isn't recent enough to load the sign-in dialog box.</span></span> <span data-ttu-id="6e045-218">若要解决此问题，请更新正在使用的 Excel 版本。</span><span class="sxs-lookup"><span data-stu-id="6e045-218">To resolve this issue, update the version of Excel that you're using.</span></span> <span data-ttu-id="6e045-219">若要当您在处于推迟渠道中的企业内时更新 Excel 版本，请使用 [Office 部署工具](https://technet.microsoft.com/library/jj219422.aspx)[从推迟渠道转到当前渠道](https://technet.microsoft.com/library/mt455210.aspx)。</span><span class="sxs-lookup"><span data-stu-id="6e045-219">To update the version of Excel when you're in an enterprise that is on the deferred channel, use the [Office deployment tool](https://technet.microsoft.com/library/jj219422.aspx) to [move from the deferred channel to the current channel](https://technet.microsoft.com/library/mt455210.aspx).</span></span>
- <span data-ttu-id="6e045-220">**发布数据更改时收到超时** – 如果在尝试将数据更改发布到实体时收到超时消息，请考虑减少受影响工作簿的发布批处理大小。</span><span class="sxs-lookup"><span data-stu-id="6e045-220">**You receive a time-out while you publish data changes** – If you receive time-out messages while you're trying to publish data changes to an entity, consider reducing the publish batch size for the affected workbook.</span></span> <span data-ttu-id="6e045-221">在记录更改时触发大量逻辑的实体可能需要以较小的批处理发送更新，以帮助防止超时。</span><span class="sxs-lookup"><span data-stu-id="6e045-221">Entities that trigger larger amounts of logic on record changes might require updates to be sent in smaller batches to help prevent time-outs.</span></span>
