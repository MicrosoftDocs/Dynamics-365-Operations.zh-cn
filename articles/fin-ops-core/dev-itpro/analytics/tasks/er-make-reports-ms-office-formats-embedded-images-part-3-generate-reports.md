---
title: 以 Office 格式生成包含嵌入图像的报表
description: 以下步骤说明“系统管理员”或“电子申报开发人员”角色的用户如何设计电子申报 (ER) 配置，以便生成包含嵌入图像的 MS office 格式（Excel 和 Word）的电子单据。
author: NickSelin
manager: AnnBe
ms.date: 06/13/2017
ms.topic: business-process
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
audience: Application User
ms.reviewer: kfend
ms.search.scope: Operations
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-06-30
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 64fade6578e9cd4f8a51c524e4f6ebbf63b93f20
ms.sourcegitcommit: 3ba95d50b8262fa0f43d4faad76adac4d05eb3ea
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/27/2019
ms.locfileid: "2184753"
---
# <a name="generate-reports-in-office-format-that-have-embedded-images"></a>以 Office 格式生成包含嵌入图像的报表

[!include [task guide banner](../../includes/task-guide-banner.md)]

以下步骤说明“系统管理员”或“电子申报开发人员”角色的用户如何设计电子申报 (ER) 配置，以便生成包含嵌入图像的 MS office 格式（Excel 和 Word）的电子单据。

在此示例中，您将把创建的 ER 配置用于示例公司“Litware 公司”。  若要完成这些步骤，必须首先完成“ER 创建包含嵌入图像的 MS Office 格式报表（第 2 部分：审查配置）”任务指南中的步骤。 这些步骤可以在“USMF”公司执行。


## <a name="run-format-with-initial-model-mapping"></a>使用初始模型映射运行格式
1. 转至“现金和银行管理”>“银行帐户”>“银行帐户”。
2. 使用“快速筛选器”以筛选含有 'USMF OPER' 值的“银行帐户”。
3. 单击“操作窗格”上的“设置”。
4. 单击“确认”。
5. 单击“打印测试”。
    * 出于测试目的运行格式。  
6. 在“可转让支票格式”字段中，选择“是”。
7. 单击“确定”。
    * 检查创建的输出。 请注意，公司徽标在报表和授权人员的签名中显示。 签名图像取自与所选银行帐户关联的支票布局记录的“容器”数据类型的字段。  
8. 展开“份数”部分。
9. 单击“编辑”。
10. 在“水印”字段中，输入“将水印打印为失效”。
    * 更改水印布局设置以通过 Excel 形状元素在生成单据时显示水印文本。  
11. 单击“打印测试”。
12. 单击“确定”。
    * 检查创建的输出。 请注意，水印根据选择选项在创建的报表中显示。  
13. 关闭该页面。
14. 在“操作窗格”上，单击“管理付款”。
15. 单击“支票”。
16. 单击“显示筛选器”。
17. 应用以下筛选器：使用“之一”筛选器运算符在“支票编号”字段中输入筛选器值“381”、“385”、“389”之一。
18. 在列表中，标记所有行。
19. 单击“打印支票副本”。
    * 运行格式以重新打印所选支票。  
    * 检查创建的输出。 请注意，已重新打印了所选支票。 不打印公司徽标和标签，因为它们位于预打印表上。  

## <a name="modify-the-mapping-of-the-imported-data-model"></a>修改所导入数据模型的映射
1. 关闭该页面。
2. 关闭该页面。
3. 转到“组织管理”>“电子申报”>“配置”。
4. 在树中，选择“支票的模型”。
5. 单击“设计器”。
6. 单击“映射模型到数据源”。
7. 单击“设计器”。
    * 我们将更改数据模型的签名项的绑定，以便从已附加到与所选银行帐户关联的支票布局记录的文件获取签名图像。  
8. 关闭“显示详细信息”。
9. 在树中，展开“布局”。
10. 在树中，展开“布局\签名”。
11. 在树中，选择“布局\签名\图像 = chequesaccount.'<Relations'.BankChequeLayout.Signature1Bmp”。
12. 在树中，展开“支票金额”。
13. 在树中，展开“支票金额\<关系”。
14. 在树中，展开“支票金额\<关系\银行支票布局”。
15. 在树中，展开“支票金额\<关系\银行支票布局\<关系”。
16. 在树中，展开“支票金额\<关系\银行支票布局\<关系\<单据”。
17. 在树中，选择“支票金额\<关系\银行支票布局\<关系\<单据\getFileContentAsContainer()”。
18. 单击“绑定”。
19. 单击“保存”。
20. 关闭该页面。
21. 关闭该页面。
22. 关闭该页面。
23. 关闭该页面。

## <a name="run-format-using-the-adjusted-model-mapping"></a>使用调整后的模型映射运行格式
1. 转至“现金和银行管理”>“银行帐户”>“银行帐户”。
2. 使用“快速筛选器”以查找记录。 例如，在“银行帐户”字段中用一个值“USMF OPER”进行筛选。
3. 单击“操作窗格”上的“设置”。
4. 单击“确认”。
5. 单击“打印测试”。
6. 单击“确定”。
    * 检查创建的输出。 请注意，来自“单据管理附件”的图像表示为授权人员的签名。  

## <a name="use-ms-word-document-as-a-template-in-the-imported-format"></a>将 MS Word 文档用作所导入格式的模板
1. 关闭该页面。
2. 关闭该页面。
3. 转到“组织管理”>“电子申报”>“配置”。
4. 在树中，展开“支票的模型”。
5. 在树中，展开“支票的模型\支票打印格式“。
6. 单击“设计器”。
7. 单击“附加”。
8. 单击“删除”。
9. 单击“是”。
10. 单击“新建”。
11. 单击“文件”。
    * 单击“浏览”并选择提前下载的“支票模板 Word.docx”文件。  
12. 关闭该页面。
13. 在“模板”字段中，输入或选择一个值。
14. 单击“保存”。
15. 关闭该页面。
16. 单击“编辑”。
17. 在“运行草稿”字段中选择“是”。
18. 关闭该页面。
19. 转至“现金和银行管理”>“银行帐户”>“银行帐户”。
20. 使用“快速筛选器”以筛选含有 'USMF OPER' 值的“银行帐户”。
21. 单击“确认”。
22. 单击“打印测试”。
23. 单击“确定”。
    * 检查创建的输出。 请注意，已将输出生成为带有嵌入图像（用于显示公司徽标、授权人员的签名和所选水印文本）的 MS Word 文档。  

