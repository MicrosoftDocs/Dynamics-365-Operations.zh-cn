---
title: 电子报告组件
description: 本文介绍电子报告 (ER) 组件。
author: kfend
ms.date: 09/28/2021
ms.topic: overview
ms.prod: ''
ms.technology: ''
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.search.region: global
ms.author: filatovm
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.custom: 58941
ms.assetid: 5d51b6a6-ad12-4af9-a66d-a1eb820ae57f
ms.search.form: ERWorkspace
ms.openlocfilehash: 4851374ca4943a84d35f063e0ee65b537ec3b6cd
ms.sourcegitcommit: 87e727005399c82cbb6509f5ce9fb33d18928d30
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/12/2022
ms.locfileid: "9285022"
---
# <a name="electronic-reporting-components"></a>电子报告组件

[!include [banner](../includes/banner.md)]

电子报告 (ER) 支持以下组件类型：

- 数据模型
- 模型映射
- 格式
- 元数据

## <a name="data-model-component"></a>数据模型组件

数据模型组件是数据结构的抽象表现形式。 它用足够的详细信息描述一个特定的业务域领域以满足该域的报告要求。 数据模型组件由以下部分组成︰

- **数据模型** - 一组特定于域的业务实体以及这些实体之间的关系的分层式定义。
- **模型映射** - 将选定的应用程序数据源关联到数据模型的各个元素，该数据模型在运行时指定用于在数据模型组件中输入业务数据的数据流和规则。

数据模型的业务实体表示为容器或记录。 业务实体属性表示为数据项或字段。 每个数据项具有一个唯一的名称、标签、描述和值。 每个数据项的值可以设计，以便它被识别为字符串、整数、实数、日期、枚举或布尔值。 此外，数据项可以是另一条记录或记录列表。

单个数据模型组件可以包含特定域的业务实体的若干层次结构。 它还可以包含在运行时间支持特定报告的数据流的模型映射。 层次结构通过被选择为模型映射的根的单一记录区分。 例如，付款域区域的数据模型可支持以下映射：


- 公司 \> 供应商 \> AP 域的付款交易记录
- 客户 \> 公司 \> AP 域的付款交易记录

业务实体（如公司和付款交易记录）是仅一次性设计而成。 不同的映射可以根据需要重用它们。

## <a name="model-mapping-component"></a>模型映射组件

模型映射将应用程序数据源关联到数据模型的各个元素，这些元素在运行时指定用于在数据模型组件中输入业务数据的数据流和规则。

支持传出电子文档的模型映射具有以下功能：

- 它可以使用不同的数据类型作为数据模型的数据源。 这些数据类型包括表、数据实体、方法和枚举。
- 当某些数据必须在运行时指定时，它支持用户输入可定义为数据模型数据源的参数。
- 它支持将数据转换成所需的组。 您还可以对数据进行筛选、排序和汇总，并且还追加通过与 Microsoft Excel 公式类似的公式设计的逻辑计算字段。 有关详细信息，请参阅[电子申报 (ER) 中的公式设计器](general-electronic-reporting-formula-designer.md)。

支持传入电子文档的模型映射具有以下功能：

- 它可以使用不同的可更新数据元素作为目标。 这些数据元素包括表、数据实体和视图。 这些数据可以使用来自电子文档的传入数据进行更新。 可以在单个模型映射中使用多个目标。
- 当某些数据必须在运行时指定时，它支持用户输入可定义为数据模型数据源的参数。

数据模型组件是针对用作统一数据源进行报告的每个业务域设计的。 统一数据源将报告与数据源的实际实现隔离开来。 组件表示提高了报告格式的初始设计和后续维护的效率的窗体中特定于域的业务概念和功能。

## <a name="format-component"></a>格式组件

### <a name="format-components-for-outgoing-electronic-documents"></a>传出电子文档的格式组件

格式组件是在运行时生成的报告输出的方案。 方案由下列元素组成︰

- 定义在运行时生成的传出电子文档的结构和内容的格式。
- 数据源，形式为一组用户输入参数和使用所选模型映射的特定于域的数据模型。
- 一个格式映射，形式为具有某个格式的单独元素的格式数据源的一组绑定，该格式在运行时指定用于生成格式输出的数据流和规则。
- 一个格式验证，形式为在运行时根据运行上下文控制报表生成的一组可配置规则。 例如，可能存在规则在选定供应商的特定属性（例如银行帐号）缺失时停止供应商付款的输出生成并引发异常。

格式组件支持以下函数︰

- 使用不同格式（例如文本、XML、Microsoft Word 文档或工作表）作为单个文件创建报告输出
- 单独创建多个文件，并将这些文件封装为 zip 文件

格式组件能让您附加可在报告输出中使用的特定文件：

- 包含可用作使用 OPENXML 工作表格式输出的模板的工作表的 Excel 工作簿
- 包含可用作 Microsoft Word 文档格式的输出模板的文档的 Word 文件
- 其他文件可合并到格式的输出中以坐为预定义文件

下图显示这些格式的数据流情况。

[![传出格式组件的数据流](./media/ER-overview-02.png)](./media/ER-overview-02.png)

要运行单个 ER 格式配置和生成传出电子文档，您必须确定格式配置的映射。

#### <a name="format-components-for-incoming-electronic-documents"></a>传入电子文档的格式组件
格式组件是在运行时导入的传入文档的方案。 方案由下列元素组成︰

- 定义包含在运行时导入的数据的传入电子文档的结构和内容的格式。 格式组件用于分析不同格式（例如文本和 XML）的传入文档。
- 将各个格式元素绑定到特定于域的数据模型元素的格式映射。 在运行时，数据模型中的元素指定数据流和从传入文档导入数据的规则，然后将数据存储到数据模型中。
- 一个格式验证，形式为在运行时根据运行上下文控制数据导入的一组可配置规则。 例如，可能存在规则在特定供应商的属性缺失（例如供应商标识代码）时阻止导入具有供应商付款的银行对账单的数据并引发异常。

下图显示这些格式的数据流情况。

[![传入格式组件的数据流](./media/ER-overview-03.png)](./media/ER-overview-03.png)

要运行单个 ER 格式配置以从传入电子文档导入数据，您必须确定格式配置的预期映射，以及模型映射的集成点。 您可以使用不同的格式为不同类型的传入文档同时使用相同的模型映射和目标。


## <a name="component-versioning"></a>组件版本控制

ER 组件支持版本控制。 提供了以下工作流以便在 ER 组件中管理更改：

1. 最初创建的版本被标记为 **草稿** 版本。 此版本可进行编辑，并可用于测试运行。
2. **草稿** 版本可以转换为 **已完成** 版本。 此版本可在本地报告流程中使用。
3. **已完成** 版本可以转换为 **共享** 版本。 此版本在 Microsoft Dynamics Lifecycle Services (LCS) 上发布，并可在全球报告流程中使用。
4. **共享** 版本可以转换为 **已终止** 版本。 可以删除此版本。

状态为 **已完成** 或 **共享** 的版本可用于其他数据交换。 可以对具有这些状态的组件执行以下操作：

- 该组件可以以 XML 格式序列化并导出为 XML 格式的文件。
- 组件可以从 XML 文件重新序列化并作为 ER 组件的新版本导入到应用程序中。

有关详细信息，请参阅[导入新数据模型配置](er-quick-start1-new-solution.md#ImportDataModel)和[导出完成的派生格式版本](er-calculated-field-type.md#export-completed-version-of-a-derived-format)。

### <a name="draft-versions-at-runtime"></a>运行时的草稿版本

在 ER 框架的个人用户参数中，您可以启用允许您指定是否必须在运行时使用 ER 配置的草稿版本的选项。 有关如何使 **运行草稿** 选项可用于 ER 配置的信息，请参阅[将自定义格式标记为可运行](er-quick-start2-customize-report.md#MarkFormatRunnable)。

> [!NOTE]
> ER 用户参数是公司特定和用户特定参数。

### <a name="draft-format-versions-at-runtime"></a>运行时的草稿格式版本

默认情况下，当您运行 ER 解决方案时，将忽略其格式组件的草稿版本。 相反，只会使用状态为 **草稿** 之外的相关版本。 有时，您可能需要强制 ER 在运行时使用 ER 格式配置的草稿版本。 例如，在草稿版本中引入必要的更改后，您可以使用该草稿版本执行测试运行。 通过这种方式，您可以验证更改的正确性。 要开始使用草稿格式版本，您必须将相关 ER 配置的 **运营草稿** 选项 [设置](er-quick-start2-customize-report.md#MarkFormatRunnable)为 **是**。

### <a name="draft-model-mapping-versions-at-runtime"></a>运行时的草稿模型映射版本

默认情况下，当您运行 ER 解决方案时，将始终使用其模型映射组件的草稿版本。 有时，您可能需要强制 ER 在运行时忽略 ER 模型映射的草稿版本。 在 **版本 10.0.29 及更高版本** 中，您可以启用 **始终考虑 ER 模型映射的运行草稿选项** 功能，以控制运行时使用的模型映射版本。 在启用此功能后，会发生以下行为：

- 针对模型映射配置将 **运行草稿** 选项设置为 **否** 时，将在运行时使用该配置的最高非草稿版本。 如果配置在当前 Finance 实例中不可用，则会引发异常。
- 针对模型映射配置将 **运行草稿** 选项设置为 **是** 时，将在运行时使用该配置的草稿版本。

## <a name="component-date-effectivity"></a>组件日期有效性

ER 格式组件版本是有时限的。 可以设置 ER 格式组件的“生效日期”，以指定此组件开始对报告流程生效时的日期。 应用程序会话日期用于定义组件是否对执行有效。 当多个版本在特定日期生效时，最新版本将用于报告流程。

## <a name="component-access"></a>组件访问权限

运行时能否访问 ER 格式和模型映射组件取决于国际标准化组织 (ISO) 国家/地区代码的设置。 如果所选格式或模型映射配置的版本的这一设置为空，则可以在运行时从任何公司访问格式或模型映射组件。 如果此设置包含 ISO 国家/地区代码，则格式或模型映射组件只能从为格式组件 ISO 国家/地区代码之一定义了主要地址的公司访问。

不同版本的格式或模型映射组件可以有不同的 ISO 国家/地区代码设置。

有关详细信息，请参阅[配置与国家/地区上下文相关的电子报告模型映射](er-country-dependent-model-mapping.md)。

[!INCLUDE[footer-include](../../../includes/footer-banner.md)]

