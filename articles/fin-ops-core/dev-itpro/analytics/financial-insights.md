---
title: 财务分析
description: 财务分析使用 Microsoft Power BI 汇总财务关键绩效指标 (KPI)、图表和财务报表。
author: kweekley
ms.date: 04/22/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User, IT Pro
ms.reviewer: kfend
ms.custom: 106233
ms.assetid: 517e6a88-e7a1-4398-9971-b22fa83306ba
ms.search.region: Global
ms.author: kweekley
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: 7.2999999999999998
ms.openlocfilehash: 5654084232c2988ed844862b977945c04dbb0833
ms.sourcegitcommit: 9283caad2d0636f98579c995784abec19fda2e3f
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/22/2021
ms.locfileid: "5935875"
---
# <a name="financial-analysis"></a>财务分析

[!include [banner](../includes/banner.md)]

**财务分析** 使用 Microsoft Power BI 汇总财务关键绩效指标 (KPI)、图表和财务报表。 Power BI 嵌入在此应用程序中。 **财务分析** 的主要功能是分析报告。 组织中的人员可查看、研究、了解和采取行动。 

**财务分析** 合并来自总帐和子分类帐的数据，以提供更全面的组织财务状况介绍。

> [!NOTE]
> 本文档使用以下 Power BI 术语：
> 
> - **报表** – 所有选项卡上的所有视觉对象保存到的单个 .pbix 文件。
> - **页面** – 单个 .pbix 文件中的一个选项卡。 每个页面可以包含一个或多个视觉对象。
> - **视觉对象** – 一种数据源，如卡片、KPI、图表、图形、矩阵或财务报表。 因为受限于报告的数据大小，拥有一个财务报表作为视觉对象的页面不能再有其他视觉对象。

现在，**财务分析** 用于查看有效法人或所有法人的数据。 在将来的版本中，该工作区将发展成可在其中使用 Power BI 编辑和创建视觉对象的位置。

**CFO 概览** 工作区与 **财务分析** 显示的视觉对象相同，但是侧重于供您查看和筛选现有报表中的数据。 在将来的版本中，您可以向 **财务分析** 工作区添加新的视觉对象。 新的对象视觉也可能在侧重其他角色（如项目经理或应付帐款经理）的工作区中可用。 无论角色可访问哪些法人，**CFO 概览** 工作区都将继续显示所有法人的数据。

## <a name="dynamics-365-finance-setup"></a>Dynamics 365 Finance 设置
**总帐**

在 **财务分析** 中，将使用主科目类型和主科目类别填写 **资产负债表** 财务报表和各种 **收入报表** 财务报表中的响应相应主科目。

在 **主科目** 页面中，必须定义主科目，这样才能为其分配以下类型之一：

- 收入
- Expense
- 资产
- 负债
- 权益

请勿为主科目分配其他任何主科目类型，例如 **资产负债表** 或 **损益**。 如果分配了其他主科目类型，则报告不能确定主科目类型，因为粒状不足。 必须确定主科目类型，才能将负债和收入在财务报表上显示为正金额。

要使各主科目在财务报表中显示和包含在其他各种视觉对象（如 KPI）中，必须将其分配给主科目类别。 主科目类别已增强，所以现在包含显示属性。 在 **财务分析** 中，显示顺序专用于财务报表。 编辑或新增主科目类别之后，可更改 **显示顺序** 值以定义财务报表中应采用的主科目类别显示顺序。 如果必须更改多个主科目类别的显示顺序，可使用“在 Excel 中打开”功能快速编辑并将更改发布回应用程序。

## <a name="entity-store"></a>实体商店
**财务分析** 的数据是从实体商店（**系统管理** \> **设置** \> **实体商店**）提取的。 如果打开 **CFO 概览** 或 **财务分析** 工作区，然后发现视觉对象中显示了以下警告消息，说明必须更新实体。

![警告](./media/Cantdisplay.png)

必须更新以下实体，才能查看 **财务分析** 工作区中的数据：

- 财务报告交易记录数据版本 3 
- 信用和收款 V2
- LedgerCovLiquidityMeasurement
- 采购多维数据集
- 销售多维数据集

可定义重复执行的批处理以定期更新这些实体中的数据。 因为更新期间将完全重建每个实体，所以请仔细选择实体的更新时间和更新频率。 用于财务报表的主实体为 FinancialReportingTransactionData 实体。 因此，此实体的更新频率可能需要更频繁。

## <a name="security"></a>安全性
目前，不能将嵌入式 Power BI 报表中的数据限制为仅用户可访问的法人。 因此，通过安全设置中的职责控制嵌入式 Power BI 报表。 定义的职责允许访问所有法人的数据或仅有效公司的数据。 下表显示存在的职责及将其分配给的角色。 可根据组织的需求移除职责或将职责分配给其他角色。

| 责任                                    | 角色 | 说明 |
|-----------------------------------------|-------|------------|
| 查看所在公司的财务分析 | <ul><li>会计师</li><li>会计经理</li><li>会计主管</li><li>审计</li><li>预算管理器</li><li>首席执行官</li><li>首席财务官</li><li>财务总监</li></ul> | 此职责提供对财务分析的访问。 默认情况下，有效公司用作筛选器。 不能添加其他法人。 |
| 查看所有公司的财务分析   | 在 Microsoft Dynamics 365 for Finance and Operations Enterprise Edition 7.3 中，未将此职责分配给角色。 在下一版本中，将把此职责分配给首席财务官角色。 | 此职责提供对“CFO 概览”工作区菜单项的访问。 默认情况下，有效公司用作筛选器。 但是，无论用户是否可访问其他法人，您都可以添加所有法人。 |


## <a name="financial-reporting-vs-financial-analysis"></a>Financial Reporting 与财务分析
尽管 **财务分析** 中包含财务报表，但不能取代此应用程序中的“财务申报”。 **财务分析** 中的默认财务报表的范围受到限制，并且并非包含所有类型的财务报表。 “财务报告”仍然是用于设计、创建和生成法定财务报表的主要工具。

下面的对比图可帮助区分这两个选项：


|                                                          | Financial Reporting                                               | 财务分析 |
|----------------------------------------------------------|-------------------------------------------------------------------|--------------------|
| **编辑默认报表**                                 | 是                                                               | 不 |
| **创建新报表**                                   | 是                                                               | 不 |
| **打印报表**                                        | 是                                                               | 无 |
| **导出至 Excel**                                      | 是                                                               | 受限制，将原始数据导出到 Excel，而不是带格式的报表 |
| **支持报告层次结构/组织层次结构**   | 是                                                               | 无 |
| **报告子分类帐数据**                             | 是，限制为仅供应商、客户                              | 是，供应商、客户、供应商/客户组、供应商/客户地址等 |
| **申报币种**                                   | 是，会计币种，并转换为申报币种       | 否，仅限会计币种 |
| **安全性**                                             | 是，遵循 Finance 和申报树安全性 | 受限，查看所有公司（不受 Finance and Operations 安全性限制）或仅有效公司的报表  |
| **支持不同会计科目表和会计年度** | 是                                                               | 无 |
| **报告外部数据**                              | 无                                                                | 无 |
| **支持合并**                               | 是                                                               | 受限制，可报告多家公司，但是仅使用会计币种 |

以下财务报表可用：

- 试算平衡表
- 资产负债表
- 按区域分类的收入报表
- 利润报表实际与预算
- 收入报表（含差异）
- 12 个月趋势收入报表
- 费用三年趋势
- 按供应商分类的费用
- 按客户销售

## <a name="edit-visuals"></a>编辑视觉对象
在 **财务分析** 以前版本中，不能编辑任何视觉对象。 在将来的版本中，具有相应安全设置的用户可以新建视觉对象，复制现有视觉对象和编辑视觉对象。 尽管包含报表的 .pbix 文件以资源的形式提供，我们仍然不建议您编辑默认报表。 将对用于创建财务报表的数据模型、默认报表和自定义财务报表视觉对象执行更多更改。 因此，要利用下一版本中的新功能和对数据模型的更改，必须通过 Microsoft Power BI Desktop 重新执行已对默认报表执行的任何更改。

## <a name="filtering"></a>筛选
用户可使用左侧的 **筛选器** 窗格筛选报表。 此窗格是通过 Power BI Desktop 提供的同一个窗格。 有各种级别的筛选，其中一些可能不可用，具体取决于您在页面（选项卡）中选择的内容或您是否在使用钻取功能：

- **报表级别筛选器** – 这种筛选器应用于所有页面（选项卡）上的所有视觉对象。
- **页面级别筛选器** – 这种筛选器应用于活动选项卡上的所有视觉对象。这种筛选器的优先级高于报表级别筛选器。
- **视觉对象级别筛选器** – 这种筛选器仅应用于所选视觉对象。 这种筛选器的优先级高于页面级别筛选器。
- **钻取筛选器** – 从源视觉对象钻取到当前视觉对象时，此筛选器从应用于当前视觉对象的“源”视觉对象开始筛选。

![筛选选项](./media/filter.png)

若要删除特定筛选器值，请选择其旁边的橡皮擦符号。 请勿通过选择 X 移除筛选器。如果选择 X，将把正在筛选的字段作为筛选器选项移除。 如果从筛选器意外地删除了字段，请关闭工作区，然后重新打开它。 将重新应用默认筛选器设置。

默认情况下，首次打开工作区时，将把有效法人用作报表级别筛选器。 用户可能可以添加其他法人或更改筛选器中已选中的默认法人，具体取决于其安全设置。

需要 **会计日历** 筛选器，以便将正确的日历用于视觉对象。 默认情况下，报表级别筛选器设置为有效法人的会计日历。 如果将该筛选器更改为具有其他开始日期或结束日期的会计日历，将不包括期初余额。 因此，您的 **资产负债表** 财务报表将不会显示正确的余额。 如果在筛选器中再选择一个会计日历，将具有额外一组列。 每组额外列显示一个不同会计日历的金额。

还需要 **过帐层** 筛选器。 默认情况下，该筛选器设置为“当前”。 可在筛选器中选择更多过帐层以显示聚合的金额。

**日期** 和 **会计年度** 字段也支持筛选器。 这些筛选器通常在页面级别应用。 默认情况下，**日期** 筛选器使用您可以更改的关系日期。 也可以移除关系日期筛选器，改用 **会计年度** 筛选器。

## <a name="currency"></a>货币

报告总帐数据的所有视觉对象都以记帐币种显示金额。 因此，筛选法人时，必须小心地仅包含具有相同记帐币种的法人。 否则，将聚合不同币种的数据。

报告子分类帐数据的所有视觉对象（如 **现金流量预测** 和 **前 10 位** 视觉对象）以系统币种显示金额。 系统币种和系统汇率类型在 **系统参数** 页面中定义。

**按银行帐户分类的余额** 视觉对象以银行帐户的币种使用金额。

## <a name="dimensions"></a>维度

默认财务报表中不包含任何财务维度，而是仅以主科目为重点。 报表变为可编辑时，将来的版本中将支持财务维度。 然后，组织就可以筛选财务维度值。

某些财务报表中包含基于子分类帐交易记录的维度。 新财务报表的目标是对未设置为财务维度的维度启用筛选。 例如，默认的“按供应商分类的费用”报表可供您从主科目向下扩展，这样就可以查看按供应商细分的余额。 不会将供应商设置为财务维度。 相反，系统返回到原始子分类帐交易记录以查找供应商。

默认报表中使用以下维度。 这些维度全部都不是财务维度。

- 供应商
- 供应商组
- 客户
- 客户组
- 国家/地区
- 省/直辖市/自治区
- 城市

> [!IMPORTANT] 
> 如果使用财务日记帐将多个供应商或客户的交易记录汇总到一个凭证中，数据将不正确。 报告过程不能确定哪个供应商或客户与日记帐条目中的特定会计科目有关，因为任何位置均不维护该信息。 因此，建议不要在一个凭证中输入多个供应商、客户、固定资产或项目。

## <a name="drill-on-data"></a>钻取数据

Power BI 提供各种级别的钻取。 每个级别都有不同的名称和不同的功能。 也可以钻取行和列。 本部分通过将 **试算平衡表** 财务报表用作示例并显示如何钻取行，讨论各选项。 列具有相同功能。 您只需要更改 **钻取** 设置。

在下图中，**试算平衡表** 报表已折叠至行层次结构的最高级别，即主科目类型。

![试算余额对帐单](./media/trial-balance.png)

若要查看此层次结构的下一级别（即主科目类别），可将 **钻取** 字段设置为 **行**，然后选择 **展开** 按钮（“钻取”字段后的第三个按钮）。 现在可以看到展开的所有主科目类别。 Power BI 现在不允许仅展开一行或一列，但是仍然可以看到其他所有行或列。

![行中的试算余额向下钻取](./media/trial-balance2.png)

若要展开至所有行的主科目，可以再次使用 **展开** 按钮。 但是，若要向下钻取至仅一行的主科目，请首先选择 **向下钻取** 按钮（窗口右侧的单向向下箭头），然后选择要向下钻取的行。 下图显示选择 **向下钻取** 按钮后选择 **销售额** 行的结果。

![试算余额扩展按钮](./media/trial-balance3.png)

向下钻取一行后，需要单击多次才能返回到整个试算平衡表。 **向上钻取** 按钮（**钻取** 字段后的第一个按钮）仅在 **销售额** 类别的上下文中向上钻取，如下图所示。

![试算余额向上钻取按钮](./media/trial-balance4.png)

可以继续使用 **向上钻取** 按钮返回到行的最高级别汇总。

Power BI 也有一个按钮（**钻取** 字段后的第二个按钮）用于转到层次结构中的下一级别。 这个按钮的效果与 **展开** 按钮（**钻取** 字段后的第三个按钮）的效果不同，后者用于展开层次结构。 展开层次结构时，层次结构在报表中维护。 例如，就像前面所显示，如果展开主科目类型，仍然可以在报表中看到主科目类型。 但是，转至层次结构中的下一级别时，报表不再在层次结构中显示父级，如下图所示。

![试算余额向后钻取按钮](./media/trial-balance5.png)

若要查看汇总余额背后的交易记录细节，可选择一些金额以向后钻取到 Financial and Operations 中。

从财务报表向后钻取将转到会计源资源管理器 (ASE)，而不是转到凭证交易记录。 ASE 不仅显示总帐中的会计条目。 而是显示子分类帐交易记录的详细信息。 因此，您可以获取有关源交易记录的多得多的详细信息，并且将其用于分析。 例如，可查看供应商或客户是谁，客户购买或供应商销售了哪些商品，甚至是交易记录中涉及哪个项目。

将把财务报表中的以下筛选器发送到 ASE，以便 ASE 显示聚合的交易记录：

筛选的必需字段：

- 法人
- 会计日历
- 年
- 主科目 ID

筛选的可选字段：

- 季度
- 月
- 期间余额

如果在行中向下展开的程度不足，向下钻取将不起作用。 例如，如果仅向下展开到主科目类别，则不能向下钻取到余额的 ASE 中，因为主科目是在 ASE 中进行筛选所需的字段。

如果在行中向下钻取的程度过深，将不把财务报表的额外筛选器发送到 ASE。 因此，可能会发现数字有偏差。 例如，如果向下展开到“按地区分类的收入报表”财务报表的行中的国家或地区，则 ASE 中不将该国家或地区包含为筛选器。

> [!NOTE]
> 可在财务报表行或列中继续向下钻取，超过 ASE 当前支持的筛选范围。 因此，在某些情况下，ASE 中的详细交易记录总和与您向后钻取的余额不匹配。 将来将继续增强此功能。

## <a name="hierarchies"></a>层次结构

默认财务报表使用两个层次结构钻取和展开数据。 一个层次结构用于行，另一个层次结构用于列。 两个层次结构均是在设计财务报表时预定义的。 对于大多数财务报表，行层次结构为 **主科目类型** \> **主科目类别** \> **主科目**。 但是，某些报表有更多字段，如“国家和地区”。 层次结构的这些额外节点基于各交易记录的子分类帐数据。

对于列，层次结构以法人和会计期间为重点。 对于大多数财务报表，列层次结构为 **法人** \> **会计日历** \>  **会计年度** \> **季度** \> **期间**。

现在，财务报表不支持组织层次结构，这种层次结构用于聚合数据。

## <a name="data-limitations"></a>数据限制
财务报表视觉对象对可显示的行数有限制。 现在该限制设置为 30,000。 如果超过此限制，视觉对象将显示一个警告符号，通知您此情况。

![数据限制](./media/data-limit.png)

如果超过了最大值，财务报表中显示的总数将不正确，因为并非所有行都加载到了视觉对象中。

### <a name="empty-rows"></a>空行
Power BI 不提供用于隐藏和显示空行的选项。 如果行中没有任何数据，视觉对象中将不显示该行。


## <a name="additional-resources-for-power-bi"></a>Power BI 的其他资源

在生产环境中，不需要以下资源中的信息即可为 **财务分析** 工作区启用嵌入式报表。 不过它们对开发箱很有帮助，而您希望嵌入自己的 Power BI 报表时也有帮助。

- [在 1 盒环境中访问分析工作区和报表](/archive/blogs/dynamicsaxbi/accessing-analytical-workspaces-on-1box-environment)

- [使用 Power BI Embedded 将分析添加到工作区](/dynamics365/unified-operations/dev-itpro/analytics/add-analytics-tab-workspaces)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
