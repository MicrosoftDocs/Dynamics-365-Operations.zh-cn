---
title: 财务申报中的高级格式设置选项
description: 当您在财务申报中创建报表时，其他格式设置功能可用，包括维度筛选器、列和报告单位限制、非打印行和计算中的 IF/THEN/ELSE 语句。
author: ryansandness
manager: AnnBe
ms.date: 04/26/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: FinancialReports
audience: Application User
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: 106571
ms.assetid: 895b5127-01d6-4495-b127-343387b743aa
ms.search.region: Global
ms.author: aolson
ms.search.validFrom: 2016-11-30
ms.dyn365.ops.version: Version 1611
ms.openlocfilehash: 3b04f78f2a8210837e16c8246609ad2fddd804f0
ms.sourcegitcommit: 0dace221e8874021dd212271567666f717d39793
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/19/2020
ms.locfileid: "3071582"
---
# <a name="advanced-formatting-options-in-financial-reporting"></a><span data-ttu-id="18798-103">财务申报中的高级格式设置选项</span><span class="sxs-lookup"><span data-stu-id="18798-103">Advanced formatting options in financial reporting</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="18798-104">当您在财务申报中创建报表时，其他格式设置功能可用，包括维度筛选器、列和报告单位限制、非打印行和计算中的 IF/THEN/ELSE 语句。</span><span class="sxs-lookup"><span data-stu-id="18798-104">When you create a report in financial reporting, additional formatting functions are available, including filters for dimensions, restrictions for columns and reporting units, non-printing rows, and IF/THEN/ELSE statements in calculations.</span></span> 

<span data-ttu-id="18798-105">下表说明了在设计报表时可用的高级格式设置功能。</span><span class="sxs-lookup"><span data-stu-id="18798-105">The following table explains the advanced formatting functions that are available when you design reports.</span></span>

| <span data-ttu-id="18798-106">职能</span><span class="sxs-lookup"><span data-stu-id="18798-106">Function</span></span>                   | <span data-ttu-id="18798-107">描述</span><span class="sxs-lookup"><span data-stu-id="18798-107">Description</span></span> |
|----------------------------|-------------|
| <span data-ttu-id="18798-108">维度筛选器</span><span class="sxs-lookup"><span data-stu-id="18798-108">Dimension filter</span></span>           | <span data-ttu-id="18798-109">要访问特定数据集，您可以在行定义和列定义中使用维度。</span><span class="sxs-lookup"><span data-stu-id="18798-109">To access specific sets of data, you can use dimensions in the row definition and column definition.</span></span> <span data-ttu-id="18798-110">很多报表仅使用行格式的自然科目段。</span><span class="sxs-lookup"><span data-stu-id="18798-110">Many reports use only the natural segment in the row format.</span></span> <span data-ttu-id="18798-111">但是，可以修改行，以便让它们包含维度值。</span><span class="sxs-lookup"><span data-stu-id="18798-111">However, rows can be modified so that they include dimension values.</span></span> <span data-ttu-id="18798-112">列定义中的维度筛选器用于访问特定维度值。</span><span class="sxs-lookup"><span data-stu-id="18798-112">Dimension filters in the column definition are used to access specific dimension values.</span></span> |
| <span data-ttu-id="18798-113">报告单位限制</span><span class="sxs-lookup"><span data-stu-id="18798-113">Reporting unit restriction</span></span> | <span data-ttu-id="18798-114">您可以设置一个报表行，以便让它仅显示与特定报告单位关联的信息。</span><span class="sxs-lookup"><span data-stu-id="18798-114">You can set up a report row so that it shows only information that is linked to a specific reporting unit.</span></span> |
| <span data-ttu-id="18798-115">非打印 (NP) 行</span><span class="sxs-lookup"><span data-stu-id="18798-115">Non-printing (NP) rows</span></span>     | <span data-ttu-id="18798-116">非打印行对很多报表有用。</span><span class="sxs-lookup"><span data-stu-id="18798-116">Non-printing rows are useful on many reports.</span></span> <span data-ttu-id="18798-117">如果需要进行某些计算来获取一个值，则可在打印的报表上隐藏这些计算。</span><span class="sxs-lookup"><span data-stu-id="18798-117">If several calculations are required in order to obtain a value, these calculations can be hidden on the printed report.</span></span> <span data-ttu-id="18798-118">非打印行还有助于解决报表设计问题和用于高级单位格放置。</span><span class="sxs-lookup"><span data-stu-id="18798-118">Non-printing rows are also useful for troubleshooting report designs and for advanced cell placement.</span></span> |
| <span data-ttu-id="18798-119">列限制</span><span class="sxs-lookup"><span data-stu-id="18798-119">Column restriction</span></span>         | <span data-ttu-id="18798-120">行定义中的列限制用于隐藏仅与报表的某些行相关的值。</span><span class="sxs-lookup"><span data-stu-id="18798-120">The column restriction in the row definition is useful for hiding values that are relevant only on some rows of the report.</span></span> <span data-ttu-id="18798-121">当对行执行百分比计算时，如果这些数字不适用，列限制将阻止打印合计列或其他列。</span><span class="sxs-lookup"><span data-stu-id="18798-121">When percentage calculations are performed on a row, the column restriction prevents total columns or other columns from being printed when those numbers don't apply.</span></span> |
| <span data-ttu-id="18798-122">分列符</span><span class="sxs-lookup"><span data-stu-id="18798-122">Column break</span></span>               | <span data-ttu-id="18798-123">您可以在行定义中添加分列符以并排显示报表信息。</span><span class="sxs-lookup"><span data-stu-id="18798-123">You can add column breaks in a row definition to show report information side by side.</span></span> <span data-ttu-id="18798-124">您可以在单个行定义添加多个分列符，列标题将在每个列的顶部的分列符后重复。</span><span class="sxs-lookup"><span data-stu-id="18798-124">You can add multiple column breaks in a single row definition, and column headers are repeated at the top of each column after the column break.</span></span> <span data-ttu-id="18798-125">报表的注释在分列符之间显示。</span><span class="sxs-lookup"><span data-stu-id="18798-125">Comments for a report are shown between the column breaks.</span></span> |
| <span data-ttu-id="18798-126">IF/THEN/ELSE 语句</span><span class="sxs-lookup"><span data-stu-id="18798-126">IF/THEN/ELSE statement</span></span>     | <span data-ttu-id="18798-127">您可以修改行定义或列定义中的计算。</span><span class="sxs-lookup"><span data-stu-id="18798-127">You can modify calculations in a row definition or a column definition.</span></span> |
| <span data-ttu-id="18798-128">维度值使用单引号 ('') 和与号 (&)</span><span class="sxs-lookup"><span data-stu-id="18798-128">Use single quotes ('') and an ampersand (&) for dimension values</span></span> | <span data-ttu-id="18798-129">设计报表时可使用维度值，包括与号字符。</span><span class="sxs-lookup"><span data-stu-id="18798-129">You can use dimension values, including the ampersand character for report design.</span></span> |

## <a name="advanced-cell-placement"></a><span data-ttu-id="18798-130">高级单元格放置</span><span class="sxs-lookup"><span data-stu-id="18798-130">Advanced cell placement</span></span>
<span data-ttu-id="18798-131">高级单元格放置（也称为*强制放置*）涉及将特定值放到特定单元格中。</span><span class="sxs-lookup"><span data-stu-id="18798-131">Advanced cell placement, or *forcing*, involves the placement of specific values into specific cells.</span></span> <span data-ttu-id="18798-132">例如，强制放置通常用于将正确的余额移入现金流量表。</span><span class="sxs-lookup"><span data-stu-id="18798-132">For example, forcing is often used to move the correct balance in a cash flow statement.</span></span> <span data-ttu-id="18798-133">您可以将强制放置用于以下目的：</span><span class="sxs-lookup"><span data-stu-id="18798-133">You can use forcing for the following purposes:</span></span>

- <span data-ttu-id="18798-134">将值从 Microsoft Excel 移至特定单元格中。</span><span class="sxs-lookup"><span data-stu-id="18798-134">Move values from Microsoft Excel into specific cells.</span></span>
- <span data-ttu-id="18798-135">将特定值硬编码到报表中。</span><span class="sxs-lookup"><span data-stu-id="18798-135">Hard-code specific values into a report.</span></span>
- <span data-ttu-id="18798-136">通过复制上一个单元格中的值并将该值乘以 -1 来修改符号。</span><span class="sxs-lookup"><span data-stu-id="18798-136">Modify signs by copying a value from a previous cell and multiplying that value by -1.</span></span>

> [!NOTE]
> <span data-ttu-id="18798-137">在大多数情况下，您必须配置报表定义，以便让列计算在行计算之前完成。</span><span class="sxs-lookup"><span data-stu-id="18798-137">In many cases, you must configure your report definition so that column calculations are done before row calculations.</span></span> <span data-ttu-id="18798-138">若要完成此设置，请执行以下步骤。</span><span class="sxs-lookup"><span data-stu-id="18798-138">To complete this configuration, follow these steps.</span></span>
> 
> 1. <span data-ttu-id="18798-139">在报表设计器中，打开报表定义。</span><span class="sxs-lookup"><span data-stu-id="18798-139">In Report Designer, open the report definition.</span></span>
> 2. <span data-ttu-id="18798-140">在**设置**选项卡上的**计算优先级**下，选择**首先执行列计算然后执行行计算**。</span><span class="sxs-lookup"><span data-stu-id="18798-140">On the **Settings** tab, under **Calculation priority**, select **Perform column calculation first and then row**.</span></span>

## <a name="designing-the-report"></a><span data-ttu-id="18798-141">设计报表</span><span class="sxs-lookup"><span data-stu-id="18798-141">Designing the report</span></span>
<span data-ttu-id="18798-142">在设计报表时，您应先创建所有细节行以确保按预期方式拉入值。</span><span class="sxs-lookup"><span data-stu-id="18798-142">When you design a report, you should create all the detail rows first to make sure that values are pulled in as expected.</span></span> <span data-ttu-id="18798-143">然后添加 **NP**（不打印）格式覆盖以禁止显示包含最终值的详细信息。</span><span class="sxs-lookup"><span data-stu-id="18798-143">Then add **NP** (No Print) format overrides to suppress the detail that includes the final values.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="18798-144">在行定义中使用 **CAL** 格式代码时，您不能向下钻取到交易记录明细。</span><span class="sxs-lookup"><span data-stu-id="18798-144">When you use the **CAL** format code in the row definition, you can't drill down into transaction detail.</span></span>

<span data-ttu-id="18798-145">对于强制放置，公式使用以下格式：&lt;目标列&gt;=&lt;原始列&gt;.&lt;行代码&gt; 用逗号和空格分隔行的任何其他放置。</span><span class="sxs-lookup"><span data-stu-id="18798-145">For forcing, formulas use the following format: &lt;destination column&gt;=&lt;originating column&gt;.&lt;row code&gt; Separate any additional placements for a row by a comma and a space.</span></span> <span data-ttu-id="18798-146">下面是一个示例：D=C.190,E=C.100</span><span class="sxs-lookup"><span data-stu-id="18798-146">Here is an example: D=C.190,E=C.100</span></span>

## <a name="examples-of-advanced-formatting-options"></a><span data-ttu-id="18798-147">高级格式设置选项的示例</span><span class="sxs-lookup"><span data-stu-id="18798-147">Examples of advanced formatting options</span></span>
<span data-ttu-id="18798-148">以下示例显示了如何对行定义和列定义进行格式设置以强制放置基本现金流量表（示例 1）和统计报表（示例 2）。</span><span class="sxs-lookup"><span data-stu-id="18798-148">The following examples show how to format the row definition and column definition to force a basic cash flow report (example 1) and a statistical report (example 2).</span></span>

### <a name="example-1-basic-forcing"></a><span data-ttu-id="18798-149">示例 1：基本强制放置</span><span class="sxs-lookup"><span data-stu-id="18798-149">Example 1: Basic forcing</span></span>

<span data-ttu-id="18798-150">下表显示了使用基本强制放置的行定义的一个示例。</span><span class="sxs-lookup"><span data-stu-id="18798-150">The following table shows an example of a row definition that uses basic forcing.</span></span>

| <span data-ttu-id="18798-151">行代码</span><span class="sxs-lookup"><span data-stu-id="18798-151">Row Code</span></span> |           <span data-ttu-id="18798-152">说明</span><span class="sxs-lookup"><span data-stu-id="18798-152">Description</span></span>            | <span data-ttu-id="18798-153">格式代码</span><span class="sxs-lookup"><span data-stu-id="18798-153">Format Code</span></span> | <span data-ttu-id="18798-154">相关公式/行/单位</span><span class="sxs-lookup"><span data-stu-id="18798-154">Related Formulas/Rows/Units</span></span> |        <span data-ttu-id="18798-155">行修饰符</span><span class="sxs-lookup"><span data-stu-id="18798-155">Row Modifier</span></span>        | <span data-ttu-id="18798-156">指向财务维度的链接</span><span class="sxs-lookup"><span data-stu-id="18798-156">Link to Financial Dimensions</span></span> |
|----------|----------------------------------|-------------|-----------------------------|----------------------------|------------------------------|
| <span data-ttu-id="18798-157">100</span><span class="sxs-lookup"><span data-stu-id="18798-157">100</span></span>      | <span data-ttu-id="18798-158">期初的现金 (NP)</span><span class="sxs-lookup"><span data-stu-id="18798-158">Cash at Beginning of Period (NP)</span></span> |             |                             | <span data-ttu-id="18798-159">科目修饰符 = \[/BB\]</span><span class="sxs-lookup"><span data-stu-id="18798-159">Account Modifier = \[/BB\]</span></span> | <span data-ttu-id="18798-160">+Segment2 = \[1100\]</span><span class="sxs-lookup"><span data-stu-id="18798-160">+Segment2 = \[1100\]</span></span>         |
| <span data-ttu-id="18798-161">130</span><span class="sxs-lookup"><span data-stu-id="18798-161">130</span></span>      | <span data-ttu-id="18798-162">期初现金</span><span class="sxs-lookup"><span data-stu-id="18798-162">Cash at Beginning of Period</span></span>      | <span data-ttu-id="18798-163">CAL</span><span class="sxs-lookup"><span data-stu-id="18798-163">CAL</span></span>         | <span data-ttu-id="18798-164">C=C.100,F=D.100</span><span class="sxs-lookup"><span data-stu-id="18798-164">C=C.100,F=D.100</span></span>             |                            |                              |
| <span data-ttu-id="18798-165">160</span><span class="sxs-lookup"><span data-stu-id="18798-165">160</span></span>      |                                  |             |                             |                            |                              |
| <span data-ttu-id="18798-166">190</span><span class="sxs-lookup"><span data-stu-id="18798-166">190</span></span>      |                                  |             |                             |                            |                              |

> [!NOTE] 
> <span data-ttu-id="18798-167">出于显示目的，空列已从前面的表格中删除：格式替代、标准余额、打印控制和列限制列不显示。</span><span class="sxs-lookup"><span data-stu-id="18798-167">Empty columns were removed from the previous table for presentation purposes: Format Override, Normal Balance, Print Control, Column Restriction columns are not displayed.</span></span>

<span data-ttu-id="18798-168">下表显示了在行中使用基本强制放置的列定义的一个示例。</span><span class="sxs-lookup"><span data-stu-id="18798-168">The following table shows an example of column definition that uses basic forcing in the row.</span></span>

|                              | <span data-ttu-id="18798-169">A</span><span class="sxs-lookup"><span data-stu-id="18798-169">A</span></span>   | <span data-ttu-id="18798-170">B</span><span class="sxs-lookup"><span data-stu-id="18798-170">B</span></span>    | <span data-ttu-id="18798-171">C</span><span class="sxs-lookup"><span data-stu-id="18798-171">C</span></span>        | <span data-ttu-id="18798-172">日</span><span class="sxs-lookup"><span data-stu-id="18798-172">D</span></span>      | <span data-ttu-id="18798-173">E</span><span class="sxs-lookup"><span data-stu-id="18798-173">E</span></span>      | <span data-ttu-id="18798-174">五</span><span class="sxs-lookup"><span data-stu-id="18798-174">F</span></span>    |
|------------------------------|-----|------|----------|--------|--------|------|
| <span data-ttu-id="18798-175">标题 1</span><span class="sxs-lookup"><span data-stu-id="18798-175">Header 1</span></span>                     |     |      |          |        |        |      |
| <span data-ttu-id="18798-176">标题 2</span><span class="sxs-lookup"><span data-stu-id="18798-176">Header 2</span></span>                     | <span data-ttu-id="18798-177">A</span><span class="sxs-lookup"><span data-stu-id="18798-177">A</span></span>   | <span data-ttu-id="18798-178">B</span><span class="sxs-lookup"><span data-stu-id="18798-178">B</span></span>    | <span data-ttu-id="18798-179">C</span><span class="sxs-lookup"><span data-stu-id="18798-179">C</span></span>        | <span data-ttu-id="18798-180">日</span><span class="sxs-lookup"><span data-stu-id="18798-180">D</span></span>      | <span data-ttu-id="18798-181">E</span><span class="sxs-lookup"><span data-stu-id="18798-181">E</span></span>      | <span data-ttu-id="18798-182">五</span><span class="sxs-lookup"><span data-stu-id="18798-182">F</span></span>    |
| <span data-ttu-id="18798-183">标题 3</span><span class="sxs-lookup"><span data-stu-id="18798-183">Header 3</span></span>                     |     |      |          |        |        |      |
| <span data-ttu-id="18798-184">列类型</span><span class="sxs-lookup"><span data-stu-id="18798-184">Column Type</span></span>                  | <span data-ttu-id="18798-185">ROW</span><span class="sxs-lookup"><span data-stu-id="18798-185">ROW</span></span> | <span data-ttu-id="18798-186">DESC</span><span class="sxs-lookup"><span data-stu-id="18798-186">DESC</span></span> | <span data-ttu-id="18798-187">FD</span><span class="sxs-lookup"><span data-stu-id="18798-187">FD</span></span>       | <span data-ttu-id="18798-188">FD</span><span class="sxs-lookup"><span data-stu-id="18798-188">FD</span></span>     | <span data-ttu-id="18798-189">FD</span><span class="sxs-lookup"><span data-stu-id="18798-189">FD</span></span>     | <span data-ttu-id="18798-190">CALC</span><span class="sxs-lookup"><span data-stu-id="18798-190">CALC</span></span> |
| <span data-ttu-id="18798-191">帐簿代码/属性类别</span><span class="sxs-lookup"><span data-stu-id="18798-191">Book Code/Attribute Category</span></span> |     |      | <span data-ttu-id="18798-192">ACTUAL</span><span class="sxs-lookup"><span data-stu-id="18798-192">ACTUAL</span></span>   | <span data-ttu-id="18798-193">ACTUAL</span><span class="sxs-lookup"><span data-stu-id="18798-193">ACTUAL</span></span> | <span data-ttu-id="18798-194">ACTUAL</span><span class="sxs-lookup"><span data-stu-id="18798-194">ACTUAL</span></span> |      |
| <span data-ttu-id="18798-195">会计年度</span><span class="sxs-lookup"><span data-stu-id="18798-195">Fiscal Year</span></span>                  |     |      | <span data-ttu-id="18798-196">BASE</span><span class="sxs-lookup"><span data-stu-id="18798-196">BASE</span></span>     | <span data-ttu-id="18798-197">BASE</span><span class="sxs-lookup"><span data-stu-id="18798-197">BASE</span></span>   | <span data-ttu-id="18798-198">BASE</span><span class="sxs-lookup"><span data-stu-id="18798-198">BASE</span></span>   |      |
| <span data-ttu-id="18798-199">期间</span><span class="sxs-lookup"><span data-stu-id="18798-199">Period</span></span>                       |     |      | <span data-ttu-id="18798-200">BASE</span><span class="sxs-lookup"><span data-stu-id="18798-200">BASE</span></span>     | <span data-ttu-id="18798-201">BASE</span><span class="sxs-lookup"><span data-stu-id="18798-201">BASE</span></span>   | <span data-ttu-id="18798-202">BASE</span><span class="sxs-lookup"><span data-stu-id="18798-202">BASE</span></span>   |      |
| <span data-ttu-id="18798-203">涵盖的期间</span><span class="sxs-lookup"><span data-stu-id="18798-203">Periods Covered</span></span>              |     |      | <span data-ttu-id="18798-204">PERIODIC</span><span class="sxs-lookup"><span data-stu-id="18798-204">PERIODIC</span></span> | <span data-ttu-id="18798-205">YTD/BB</span><span class="sxs-lookup"><span data-stu-id="18798-205">YTD/BB</span></span> | <span data-ttu-id="18798-206">年初至今</span><span class="sxs-lookup"><span data-stu-id="18798-206">YTD</span></span>    |      |
| <span data-ttu-id="18798-207">公式</span><span class="sxs-lookup"><span data-stu-id="18798-207">Formula</span></span>                      |     |      |          |        |        | <span data-ttu-id="18798-208">E-D</span><span class="sxs-lookup"><span data-stu-id="18798-208">E-D</span></span>  |
| <span data-ttu-id="18798-209">列宽</span><span class="sxs-lookup"><span data-stu-id="18798-209">Column Width</span></span>                 | <span data-ttu-id="18798-210">5</span><span class="sxs-lookup"><span data-stu-id="18798-210">5</span></span>   | <span data-ttu-id="18798-211">30</span><span class="sxs-lookup"><span data-stu-id="18798-211">30</span></span>   | <span data-ttu-id="18798-212">14</span><span class="sxs-lookup"><span data-stu-id="18798-212">14</span></span>       | <span data-ttu-id="18798-213">14</span><span class="sxs-lookup"><span data-stu-id="18798-213">14</span></span>     | <span data-ttu-id="18798-214">14</span><span class="sxs-lookup"><span data-stu-id="18798-214">14</span></span>     | <span data-ttu-id="18798-215">14</span><span class="sxs-lookup"><span data-stu-id="18798-215">14</span></span>   |

### <a name="example-2-statistical-reports"></a><span data-ttu-id="18798-216">示例 2：统计报表</span><span class="sxs-lookup"><span data-stu-id="18798-216">Example 2: Statistical reports</span></span>

<span data-ttu-id="18798-217">下表显示了对统计报表使用强制放置的行定义的一个示例。</span><span class="sxs-lookup"><span data-stu-id="18798-217">The following table shows an example of a row definition that uses forcing for a statistical report.</span></span>

| <span data-ttu-id="18798-218">行代码</span><span class="sxs-lookup"><span data-stu-id="18798-218">Row Code</span></span> | <span data-ttu-id="18798-219">描述</span><span class="sxs-lookup"><span data-stu-id="18798-219">Description</span></span>               | <span data-ttu-id="18798-220">格式代码</span><span class="sxs-lookup"><span data-stu-id="18798-220">Format Code</span></span> | <span data-ttu-id="18798-221">相关公式/行/单位</span><span class="sxs-lookup"><span data-stu-id="18798-221">Related Formulas/Rows/Units</span></span>     | <span data-ttu-id="18798-222">格式替代</span><span class="sxs-lookup"><span data-stu-id="18798-222">Format Override</span></span>      | <span data-ttu-id="18798-223">标准余额</span><span class="sxs-lookup"><span data-stu-id="18798-223">Normal Balance</span></span> | <span data-ttu-id="18798-224">指向财务维度的链接</span><span class="sxs-lookup"><span data-stu-id="18798-224">Link to Financial Dimensions</span></span>               |
|----------|---------------------------|-------------|---------------------------------|----------------------|----------------|--------------------------------------------|
| <span data-ttu-id="18798-225">50</span><span class="sxs-lookup"><span data-stu-id="18798-225">50</span></span>       | <span data-ttu-id="18798-226">统计信息</span><span class="sxs-lookup"><span data-stu-id="18798-226">Statistical Information</span></span>   | <span data-ttu-id="18798-227">REM</span><span class="sxs-lookup"><span data-stu-id="18798-227">REM</span></span>         |                                 |                      |                |                                            |
| <span data-ttu-id="18798-228">100</span><span class="sxs-lookup"><span data-stu-id="18798-228">100</span></span>      | <span data-ttu-id="18798-229">人数 - 美国</span><span class="sxs-lookup"><span data-stu-id="18798-229">Headcount - US</span></span>            | <span data-ttu-id="18798-230">CAL</span><span class="sxs-lookup"><span data-stu-id="18798-230">CAL</span></span>         | <span data-ttu-id="18798-231">4</span><span class="sxs-lookup"><span data-stu-id="18798-231">4</span></span>                               | <span data-ttu-id="18798-232">\#\#\#0.;($\#\#\#0.)</span><span class="sxs-lookup"><span data-stu-id="18798-232">\#\#\#0.;($\#\#\#0.)</span></span> |                |                                            |
| <span data-ttu-id="18798-233">115</span><span class="sxs-lookup"><span data-stu-id="18798-233">115</span></span>      | <span data-ttu-id="18798-234">人数 - 国际</span><span class="sxs-lookup"><span data-stu-id="18798-234">Headcount - International</span></span> | <span data-ttu-id="18798-235">CAL</span><span class="sxs-lookup"><span data-stu-id="18798-235">CAL</span></span>         | <span data-ttu-id="18798-236">11</span><span class="sxs-lookup"><span data-stu-id="18798-236">11</span></span>                              | <span data-ttu-id="18798-237">\#\#\#0.;($\#\#\#0.)</span><span class="sxs-lookup"><span data-stu-id="18798-237">\#\#\#0.;($\#\#\#0.)</span></span> |                |                                            |
| <span data-ttu-id="18798-238">130</span><span class="sxs-lookup"><span data-stu-id="18798-238">130</span></span>      |                           |             |                                 |                      |                |                                            |
| <span data-ttu-id="18798-239">190</span><span class="sxs-lookup"><span data-stu-id="18798-239">190</span></span>      | <span data-ttu-id="18798-240">美国销售额</span><span class="sxs-lookup"><span data-stu-id="18798-240">US Sales</span></span>                  |             |                                 |                      | <span data-ttu-id="18798-241">C</span><span class="sxs-lookup"><span data-stu-id="18798-241">C</span></span>              | <span data-ttu-id="18798-242">+Segment2 = \[41\*\]、Segment3 = \[00\]</span><span class="sxs-lookup"><span data-stu-id="18798-242">+Segment2 = \[41\*\], Segment3 = \[00\]</span></span>    |
| <span data-ttu-id="18798-243">220</span><span class="sxs-lookup"><span data-stu-id="18798-243">220</span></span>      | <span data-ttu-id="18798-244">国际销售额</span><span class="sxs-lookup"><span data-stu-id="18798-244">International Sales</span></span>       |             |                                 |                      | <span data-ttu-id="18798-245">C</span><span class="sxs-lookup"><span data-stu-id="18798-245">C</span></span>              | <span data-ttu-id="18798-246">+Segment2 = \[41\*\]、Segment3 = \[01:99\]</span><span class="sxs-lookup"><span data-stu-id="18798-246">+Segment2 = \[41\*\], Segment3 = \[01:99\]</span></span> |
| <span data-ttu-id="18798-247">250</span><span class="sxs-lookup"><span data-stu-id="18798-247">250</span></span>      |                           |             |                                 |                      |                |                                            |
| <span data-ttu-id="18798-248">280</span><span class="sxs-lookup"><span data-stu-id="18798-248">280</span></span>      |                           |             |                                 |                      |                |                                            |
| <span data-ttu-id="18798-249">310</span><span class="sxs-lookup"><span data-stu-id="18798-249">310</span></span>      | <span data-ttu-id="18798-250">美国销售额</span><span class="sxs-lookup"><span data-stu-id="18798-250">US Sales</span></span>                  | <span data-ttu-id="18798-251">CAL</span><span class="sxs-lookup"><span data-stu-id="18798-251">CAL</span></span>         | <span data-ttu-id="18798-252">D=C.190,E=C.100,F=(C.100/C.190)</span><span class="sxs-lookup"><span data-stu-id="18798-252">D=C.190,E=C.100,F=(C.100/C.190)</span></span> |                      |                |                                            |
| <span data-ttu-id="18798-253">340</span><span class="sxs-lookup"><span data-stu-id="18798-253">340</span></span>      | <span data-ttu-id="18798-254">国际销售金额</span><span class="sxs-lookup"><span data-stu-id="18798-254">International Sales</span></span>       | <span data-ttu-id="18798-255">CAL</span><span class="sxs-lookup"><span data-stu-id="18798-255">CAL</span></span>         | <span data-ttu-id="18798-256">D=C.220,E=C115,F=(C.220/C.115)</span><span class="sxs-lookup"><span data-stu-id="18798-256">D=C.220,E=C115,F=(C.220/C.115)</span></span>  |                      |                |                                            |

> [!NOTE] 
> <span data-ttu-id="18798-257">出于显示目的，空列已从前面的表格中删除：打印控制、列限制和行修饰符列不显示。</span><span class="sxs-lookup"><span data-stu-id="18798-257">Empty columns were removed from the previous table for presentation purposes: Print Control,  Column Restriction, and Row Modifier columns are not displayed.</span></span>

<span data-ttu-id="18798-258">下表显示了对统计报表使用强制放置的列定义的一个示例。</span><span class="sxs-lookup"><span data-stu-id="18798-258">The following table shows an example of a column definition that uses forcing for a statistical report.</span></span>

|                              | <span data-ttu-id="18798-259">A</span><span class="sxs-lookup"><span data-stu-id="18798-259">A</span></span>   | <span data-ttu-id="18798-260">B</span><span class="sxs-lookup"><span data-stu-id="18798-260">B</span></span>    | <span data-ttu-id="18798-261">C</span><span class="sxs-lookup"><span data-stu-id="18798-261">C</span></span>      | <span data-ttu-id="18798-262">日</span><span class="sxs-lookup"><span data-stu-id="18798-262">D</span></span>            | <span data-ttu-id="18798-263">E</span><span class="sxs-lookup"><span data-stu-id="18798-263">E</span></span>     | <span data-ttu-id="18798-264">五</span><span class="sxs-lookup"><span data-stu-id="18798-264">F</span></span>            |
|------------------------------|-----|------|--------|--------------|-------|--------------|
| <span data-ttu-id="18798-265">标题 1</span><span class="sxs-lookup"><span data-stu-id="18798-265">Header 1</span></span>                     | <span data-ttu-id="18798-266">A</span><span class="sxs-lookup"><span data-stu-id="18798-266">A</span></span>   | <span data-ttu-id="18798-267">B</span><span class="sxs-lookup"><span data-stu-id="18798-267">B</span></span>    | <span data-ttu-id="18798-268">C</span><span class="sxs-lookup"><span data-stu-id="18798-268">C</span></span>      | <span data-ttu-id="18798-269">日</span><span class="sxs-lookup"><span data-stu-id="18798-269">D</span></span>            | <span data-ttu-id="18798-270">E</span><span class="sxs-lookup"><span data-stu-id="18798-270">E</span></span>     | <span data-ttu-id="18798-271">五</span><span class="sxs-lookup"><span data-stu-id="18798-271">F</span></span>            |
| <span data-ttu-id="18798-272">标题 2</span><span class="sxs-lookup"><span data-stu-id="18798-272">Header 2</span></span>                     | -   | -    | <span data-ttu-id="18798-273">年初至今</span><span class="sxs-lookup"><span data-stu-id="18798-273">YTD</span></span>    | <span data-ttu-id="18798-274">年销售额</span><span class="sxs-lookup"><span data-stu-id="18798-274">Yearly Sales</span></span> | <span data-ttu-id="18798-275">职员</span><span class="sxs-lookup"><span data-stu-id="18798-275">Staff</span></span> | <span data-ttu-id="18798-276">人均美元数</span><span class="sxs-lookup"><span data-stu-id="18798-276">$ Per Person</span></span> |
| <span data-ttu-id="18798-277">标题 3</span><span class="sxs-lookup"><span data-stu-id="18798-277">Header 3</span></span>                     |     |      |        |              |       |              |
| <span data-ttu-id="18798-278">列类型</span><span class="sxs-lookup"><span data-stu-id="18798-278">Column Type</span></span>                  | <span data-ttu-id="18798-279">ROW</span><span class="sxs-lookup"><span data-stu-id="18798-279">ROW</span></span> | <span data-ttu-id="18798-280">DESC</span><span class="sxs-lookup"><span data-stu-id="18798-280">DESC</span></span> | <span data-ttu-id="18798-281">FD</span><span class="sxs-lookup"><span data-stu-id="18798-281">FD</span></span>     | <span data-ttu-id="18798-282">CALC</span><span class="sxs-lookup"><span data-stu-id="18798-282">CALC</span></span>         | <span data-ttu-id="18798-283">CALC</span><span class="sxs-lookup"><span data-stu-id="18798-283">CALC</span></span>  | <span data-ttu-id="18798-284">CALC</span><span class="sxs-lookup"><span data-stu-id="18798-284">CALC</span></span>         |
| <span data-ttu-id="18798-285">帐簿代码/属性类别</span><span class="sxs-lookup"><span data-stu-id="18798-285">Book Code/Attribute Category</span></span> |     |      | <span data-ttu-id="18798-286">ACTUAL</span><span class="sxs-lookup"><span data-stu-id="18798-286">ACTUAL</span></span> |              |       |              |
| <span data-ttu-id="18798-287">会计年度</span><span class="sxs-lookup"><span data-stu-id="18798-287">Fiscal Year</span></span>                  |     |      | <span data-ttu-id="18798-288">BASE</span><span class="sxs-lookup"><span data-stu-id="18798-288">BASE</span></span>   |              |       |              |
| <span data-ttu-id="18798-289">期间</span><span class="sxs-lookup"><span data-stu-id="18798-289">Period</span></span>                       |     |      | <span data-ttu-id="18798-290">BASE</span><span class="sxs-lookup"><span data-stu-id="18798-290">BASE</span></span>   |              |       |              |
| <span data-ttu-id="18798-291">覆盖的期间</span><span class="sxs-lookup"><span data-stu-id="18798-291">Periods Covered</span></span>              |     |      | <span data-ttu-id="18798-292">年初至今</span><span class="sxs-lookup"><span data-stu-id="18798-292">YTD</span></span>    |              |       |              |
| <span data-ttu-id="18798-293">配方</span><span class="sxs-lookup"><span data-stu-id="18798-293">Formula</span></span>                      |     |      |        |              |       | <span data-ttu-id="18798-294">E-D</span><span class="sxs-lookup"><span data-stu-id="18798-294">E-D</span></span>          |
| <span data-ttu-id="18798-295">列宽度</span><span class="sxs-lookup"><span data-stu-id="18798-295">Column Width</span></span>                 | <span data-ttu-id="18798-296">5</span><span class="sxs-lookup"><span data-stu-id="18798-296">5</span></span>   | <span data-ttu-id="18798-297">30</span><span class="sxs-lookup"><span data-stu-id="18798-297">30</span></span>   | <span data-ttu-id="18798-298">14</span><span class="sxs-lookup"><span data-stu-id="18798-298">14</span></span>     | <span data-ttu-id="18798-299">14</span><span class="sxs-lookup"><span data-stu-id="18798-299">14</span></span>           | <span data-ttu-id="18798-300">14</span><span class="sxs-lookup"><span data-stu-id="18798-300">14</span></span>    | <span data-ttu-id="18798-301">14</span><span class="sxs-lookup"><span data-stu-id="18798-301">14</span></span>           |

## <a name="restricting-a-row-to-a-specific-reporting-unit"></a><span data-ttu-id="18798-302">将行限制到特定报告单位</span><span class="sxs-lookup"><span data-stu-id="18798-302">Restricting a row to a specific reporting unit</span></span>
<span data-ttu-id="18798-303">当报表行被限制到特定报告单位时，该行将仅显示命名报告单位的关联数据并忽略报告结构树中的其他报告单位的数据。</span><span class="sxs-lookup"><span data-stu-id="18798-303">When a report row is restricted to a specific reporting unit, that row shows the linked data only for the named reporting unit and ignores the data for other reporting units in the reporting tree.</span></span> <span data-ttu-id="18798-304">例如，您可以创建为特定部门的总运营费用提供详细信息的行。</span><span class="sxs-lookup"><span data-stu-id="18798-304">For example, you can create a row that provides details for the total operating expenses for a specific department.</span></span> <span data-ttu-id="18798-305">如果您的报表同时包含报告结构树和不仅包含自然科目的行定义，则该报表可以包含重复数据。</span><span class="sxs-lookup"><span data-stu-id="18798-305">Your report might contain duplicate data if the report contains both a reporting tree and a row definition that has more than just the natural account.</span></span> <span data-ttu-id="18798-306">例如，您有一个列出您组织中的六个部门的报告，并且您还有列出了行中的科目和部门的特定组合的行定义。</span><span class="sxs-lookup"><span data-stu-id="18798-306">For example, you have a reporting tree that lists the six departments in your organization, and you also have a row definition that lists a specific combination of an account and a department in the row.</span></span> <span data-ttu-id="18798-307">在生成报表时，某个科目和某个部门的特定组合将在报告结构树的每个级别上打印，即使该部门可能在该树中不匹配。</span><span class="sxs-lookup"><span data-stu-id="18798-307">When you generate the report, the specific combination of an account and a department is printed on every level of the reporting tree, even though that department might not match what is in the tree.</span></span> <span data-ttu-id="18798-308">此行为由通常由报表定义筛选出的行覆盖导致。</span><span class="sxs-lookup"><span data-stu-id="18798-308">This behavior occurs because the row overrides what is typically filtered out by the report definition.</span></span> <span data-ttu-id="18798-309">避免数据重复的一种方法是将行限制到特定报告单位。</span><span class="sxs-lookup"><span data-stu-id="18798-309">One way that you can avoid duplication of data is by restricting a row to a specific reporting unit.</span></span>

> [!NOTE]
> <span data-ttu-id="18798-310">如果某个行包含维度，并且您将该行限制到子报告单位，则将为该子单位及其父单位包含行金额，但不会进行复制。</span><span class="sxs-lookup"><span data-stu-id="18798-310">If a row includes dimensions, and you restrict that row to a child reporting unit, the row amount is included for that child unit and for its parent units, but no duplication occurs.</span></span>

### <a name="restrict-a-row-to-a-reporting-unit"></a><span data-ttu-id="18798-311">将行限制到报告单位</span><span class="sxs-lookup"><span data-stu-id="18798-311">Restrict a row to a reporting unit</span></span>

1. <span data-ttu-id="18798-312">在报表设计器中，单击**行定义**，然后选择行定义以修改。</span><span class="sxs-lookup"><span data-stu-id="18798-312">In Report Designer, click **Row Definitions**, and then select a row definition to modify.</span></span>
2. <span data-ttu-id="18798-313">双击相应的**相关公式/行/单位**单元格。</span><span class="sxs-lookup"><span data-stu-id="18798-313">Double-click the appropriate **Related Formulas/Rows/Units** cell.</span></span>
3. <span data-ttu-id="18798-314">在**报告单位选择**对话框的**报告树**字段中，选择在报表定义中指定的树。</span><span class="sxs-lookup"><span data-stu-id="18798-314">In the **Reporting Unit Selection** dialog box, in the **Reporting tree** field, select the tree that is assigned in the report definition.</span></span>
4. <span data-ttu-id="18798-315">选择一个报告单位，然后单击**确定**。</span><span class="sxs-lookup"><span data-stu-id="18798-315">Select a reporting unit, and then click **OK**.</span></span> <span data-ttu-id="18798-316">限制将显示在行定义的单元格中。</span><span class="sxs-lookup"><span data-stu-id="18798-316">The restriction appears in the cell of the row definition.</span></span>
5. <span data-ttu-id="18798-317">双击受限制的行的**链接到财务维度**列中的单元格，然后输入指向财务数据系统的链接。</span><span class="sxs-lookup"><span data-stu-id="18798-317">Double-click the cell in the **Link to Financial Dimensions** column of the restricted row, and then enter a link to the financial data system.</span></span>

## <a name="selecting-print-control-in-a-row-definition"></a><span data-ttu-id="18798-318">在行定义中选择打印控制</span><span class="sxs-lookup"><span data-stu-id="18798-318">Selecting print control in a row definition</span></span>
<span data-ttu-id="18798-319">您可以使用**打印控制**单元格为每个列指定打印控制代码。</span><span class="sxs-lookup"><span data-stu-id="18798-319">You can specify print control codes for each column by using the **Print Control** cell.</span></span>

### <a name="add-print-control-codes-to-a-report-row"></a><span data-ttu-id="18798-320">将打印控制代码添加到报表行</span><span class="sxs-lookup"><span data-stu-id="18798-320">Add print control codes to a report row</span></span>

1. <span data-ttu-id="18798-321">在报表设计器中，打开要修改的行定义。</span><span class="sxs-lookup"><span data-stu-id="18798-321">In Report Designer, open the row definition to modify.</span></span>
2. <span data-ttu-id="18798-322">双击**打印控制**单元格。</span><span class="sxs-lookup"><span data-stu-id="18798-322">Double-click the **Print Control** cell.</span></span>
3. <span data-ttu-id="18798-323">在**打印控制**对话框中，选择打印控制代码或按住 Ctrl 键选择多个代码。</span><span class="sxs-lookup"><span data-stu-id="18798-323">In the **Print Control** dialog box, select a print control code, or press and hold the Ctrl key to select multiple codes.</span></span> <span data-ttu-id="18798-324">您还可以直接在**打印控制**单元格中键入打印控制代码。</span><span class="sxs-lookup"><span data-stu-id="18798-324">You can also type print control codes directly in the **Print Control** cell.</span></span> <span data-ttu-id="18798-325">使用逗号分隔多个打印控制代码。</span><span class="sxs-lookup"><span data-stu-id="18798-325">Use commas to separate multiple print control codes.</span></span>
4. <span data-ttu-id="18798-326">选择所有有条件打印选项。</span><span class="sxs-lookup"><span data-stu-id="18798-326">Select any conditional print options.</span></span>
5. <span data-ttu-id="18798-327">单击**OK**。</span><span class="sxs-lookup"><span data-stu-id="18798-327">Click **OK**.</span></span>

### <a name="regular-print-control-codes"></a><span data-ttu-id="18798-328">常规打印控制代码</span><span class="sxs-lookup"><span data-stu-id="18798-328">Regular print control codes</span></span>

<span data-ttu-id="18798-329">下表说明了行定义的常规打印控制代码。</span><span class="sxs-lookup"><span data-stu-id="18798-329">The following table describes the regular print control codes for a row definition.</span></span>

| <span data-ttu-id="18798-330">打印控制代码</span><span class="sxs-lookup"><span data-stu-id="18798-330">Print control code</span></span> | <span data-ttu-id="18798-331">打印控制代码的解释</span><span class="sxs-lookup"><span data-stu-id="18798-331">Interpretation of the print control code</span></span>         | <span data-ttu-id="18798-332">描述</span><span class="sxs-lookup"><span data-stu-id="18798-332">Description</span></span> |
|--------------------|--------------------------------------------------|-------------|
| <span data-ttu-id="18798-333">NP</span><span class="sxs-lookup"><span data-stu-id="18798-333">NP</span></span>                 | <span data-ttu-id="18798-334">非打印行</span><span class="sxs-lookup"><span data-stu-id="18798-334">Non-printing row</span></span>                                 | <span data-ttu-id="18798-335">阻止行中的金额在报表上打印，并从计算中排除金额。</span><span class="sxs-lookup"><span data-stu-id="18798-335">Prevent the amounts in the row from being printed on the report, and exclude the amounts from calculations.</span></span> <span data-ttu-id="18798-336">要在计算中包含非打印列，请直接在计算公式中引用此列。</span><span class="sxs-lookup"><span data-stu-id="18798-336">To include a non-printing column in a calculation, refer to the column directly in the calculation formula.</span></span> <span data-ttu-id="18798-337">例如，非打印行 240 包含在以下计算中：**230+240+250**。</span><span class="sxs-lookup"><span data-stu-id="18798-337">For example, non-printing row 240 is included in the following calculation: **230+240+250**.</span></span> <span data-ttu-id="18798-338">但是，非打印行 240 不包含在以下计算中：**230:250**。</span><span class="sxs-lookup"><span data-stu-id="18798-338">However, non-printing row 240 isn't included in the following calculation: **230:250**.</span></span> |
| <span data-ttu-id="18798-339">CS</span><span class="sxs-lookup"><span data-stu-id="18798-339">CS</span></span>                 | <span data-ttu-id="18798-340">货币符号；在此行中使用货币格式</span><span class="sxs-lookup"><span data-stu-id="18798-340">Currency symbol; use currency format in this row</span></span> | <span data-ttu-id="18798-341">在将货币符号包含在所有非百分比金额中。</span><span class="sxs-lookup"><span data-stu-id="18798-341">Include the currency symbol in all non-percentage amounts.</span></span> <span data-ttu-id="18798-342">百分比值不接受货币符号。</span><span class="sxs-lookup"><span data-stu-id="18798-342">Percentage values never receive a currency symbol.</span></span> |
| <span data-ttu-id="18798-343">XD</span><span class="sxs-lookup"><span data-stu-id="18798-343">XD</span></span>                 | <span data-ttu-id="18798-344">在科目详细信息报表中禁止显示行</span><span class="sxs-lookup"><span data-stu-id="18798-344">Suppress row in account detail report</span></span>            | <span data-ttu-id="18798-345">禁止在分期付款详细信息报表和交易记录详细信息报表上显示科目。</span><span class="sxs-lookup"><span data-stu-id="18798-345">Suppress the display of accounts on account detail reports and transaction detail reports.</span></span> <span data-ttu-id="18798-346">当行包含不应在科目详细信息报表或交易记录详细信息报表上列出的多个科目时，此打印控制很有用。</span><span class="sxs-lookup"><span data-stu-id="18798-346">This print control is useful when a row includes multiple accounts that should not be listed on the account detail report or transaction detail report.</span></span> |
| <span data-ttu-id="18798-347">X0</span><span class="sxs-lookup"><span data-stu-id="18798-347">X0</span></span>                 | <span data-ttu-id="18798-348">在所有单元格均为零时禁止显示行</span><span class="sxs-lookup"><span data-stu-id="18798-348">Suppress row if all zeros</span></span>                        | <span data-ttu-id="18798-349">如果某个行中的所有单元格都是空或包含零，则从报表中排除该行。</span><span class="sxs-lookup"><span data-stu-id="18798-349">Exclude a row from the report if all cells in that row are either empty or contain zeros.</span></span> <span data-ttu-id="18798-350">仅当未在报表定义中选择禁止显示零余额的选项时，此打印控制才有意义。</span><span class="sxs-lookup"><span data-stu-id="18798-350">This print control is meaningful only when the option to suppress zero balance isn't selected in the report definition.</span></span> |
| <span data-ttu-id="18798-351">B0</span><span class="sxs-lookup"><span data-stu-id="18798-351">B0</span></span>                 | <span data-ttu-id="18798-352">将零列留空</span><span class="sxs-lookup"><span data-stu-id="18798-352">Leave zero columns blank</span></span>                         | <span data-ttu-id="18798-353">将行中包含零金额的列留空。</span><span class="sxs-lookup"><span data-stu-id="18798-353">Leave columns empty in a row that contain zero amounts.</span></span> |
| <span data-ttu-id="18798-354">XR</span><span class="sxs-lookup"><span data-stu-id="18798-354">XR</span></span>                 | <span data-ttu-id="18798-355">禁止显示累计</span><span class="sxs-lookup"><span data-stu-id="18798-355">Suppress rollup</span></span>                                  | <span data-ttu-id="18798-356">禁止汇总。</span><span class="sxs-lookup"><span data-stu-id="18798-356">Suppress a rollup.</span></span> <span data-ttu-id="18798-357">如果报表使用报告结构树，此行中的金额不会累计到后面的父节点。</span><span class="sxs-lookup"><span data-stu-id="18798-357">If the report uses a reporting tree, the amounts in this row aren't rolled up into subsequent parent nodes.</span></span> |
| <span data-ttu-id="18798-358">SR</span><span class="sxs-lookup"><span data-stu-id="18798-358">SR</span></span>                 | <span data-ttu-id="18798-359">禁止显示化整</span><span class="sxs-lookup"><span data-stu-id="18798-359">Suppress rounding</span></span>                                | <span data-ttu-id="18798-360">阻止化整此行中的金额。</span><span class="sxs-lookup"><span data-stu-id="18798-360">Prevent the amounts in this row from being rounded.</span></span> |
| <span data-ttu-id="18798-361">XT</span><span class="sxs-lookup"><span data-stu-id="18798-361">XT</span></span>                 | <span data-ttu-id="18798-362">在交易记录详细信息报表中禁止显示行</span><span class="sxs-lookup"><span data-stu-id="18798-362">Suppress row in transaction detail report</span></span>        | <span data-ttu-id="18798-363">禁止在交易记录详细信息报表上显示交易记录。</span><span class="sxs-lookup"><span data-stu-id="18798-363">Suppress the display of transactions on transaction detail reports.</span></span> <span data-ttu-id="18798-364">当行包含不应在交易记录详细信息报表上列出的多个科目时，此打印控制很有用。</span><span class="sxs-lookup"><span data-stu-id="18798-364">This print control is useful when a row includes multiple accounts that should not be listed on a transaction detail report.</span></span> |

### <a name="conditional-print-control-codes"></a><span data-ttu-id="18798-365">条件打印控制代码</span><span class="sxs-lookup"><span data-stu-id="18798-365">Conditional print control codes</span></span>

<span data-ttu-id="18798-366">下表说明了行定义的有条件打印控制代码。</span><span class="sxs-lookup"><span data-stu-id="18798-366">The following table describes the conditional print control codes for a row definition.</span></span>

| <span data-ttu-id="18798-367">打印控制代码</span><span class="sxs-lookup"><span data-stu-id="18798-367">Print control code</span></span> | <span data-ttu-id="18798-368">描述</span><span class="sxs-lookup"><span data-stu-id="18798-368">Description</span></span>                                  |
|--------------------|----------------------------------------------|
| <span data-ttu-id="18798-369">（无）</span><span class="sxs-lookup"><span data-stu-id="18798-369">(none)</span></span>             | <span data-ttu-id="18798-370">清除条件打印选择。</span><span class="sxs-lookup"><span data-stu-id="18798-370">Clear the conditional print selection.</span></span>       |
| <span data-ttu-id="18798-371">删除行</span><span class="sxs-lookup"><span data-stu-id="18798-371">DR</span></span>                 | <span data-ttu-id="18798-372">仅打印此行的借方余额。</span><span class="sxs-lookup"><span data-stu-id="18798-372">Print only the debit balances for this row.</span></span>  |
| <span data-ttu-id="18798-373">贷</span><span class="sxs-lookup"><span data-stu-id="18798-373">CR</span></span>                 | <span data-ttu-id="18798-374">仅打印此行的贷方余额。</span><span class="sxs-lookup"><span data-stu-id="18798-374">Print only the credit balances for this row.</span></span> |

## <a name="column-restriction-cell-in-a-row-definition"></a><span data-ttu-id="18798-375">行定义中的“列限制”单元格</span><span class="sxs-lookup"><span data-stu-id="18798-375">Column Restriction cell in a row definition</span></span>
<span data-ttu-id="18798-376">行定义中的**列限制**单元格具有多个用途。</span><span class="sxs-lookup"><span data-stu-id="18798-376">The **Column Restriction** cell in a row definition has multiple purposes.</span></span> <span data-ttu-id="18798-377">根据行的类型，您可以使用**列限制**单元格指定以下功能之一：</span><span class="sxs-lookup"><span data-stu-id="18798-377">Depending on the type of row, you can use the **Column Restriction** cell to specify one of the following functions:</span></span>

- <span data-ttu-id="18798-378">该单元格可限制行金额到特定列的打印。</span><span class="sxs-lookup"><span data-stu-id="18798-378">The cell can limit the printing of row amounts to a specific column.</span></span> <span data-ttu-id="18798-379">如果您要创建表格式资产负债表，那么此功能十分有用。</span><span class="sxs-lookup"><span data-stu-id="18798-379">This function is useful if you're creating a tabular balance sheet.</span></span>
- <span data-ttu-id="18798-380">该单元格可指定要排序的金额的列。</span><span class="sxs-lookup"><span data-stu-id="18798-380">The cell can specify the column of amounts to sort.</span></span>

## <a name="using-a-calculation-formula-in-a-row-definition"></a><span data-ttu-id="18798-381">使用行定义中的计算公式</span><span class="sxs-lookup"><span data-stu-id="18798-381">Using a calculation formula in a row definition</span></span>
<span data-ttu-id="18798-382">行定义中的计算公式可包含 **+**、**-**、**\*** 和 **/** 运算符，还可包含 **IF/THEN/ELSE** 语句。</span><span class="sxs-lookup"><span data-stu-id="18798-382">A calculation formula in a row definition can include the **+**, **-**, **\***, and **/** operators, and also **IF/THEN/ELSE** statements.</span></span> <span data-ttu-id="18798-383">此外，计算还可能涉及各个单元格和绝对金额（公式中包含的实际数字）。</span><span class="sxs-lookup"><span data-stu-id="18798-383">Additionally, a calculation can involve individual cells and absolute amounts (actual numbers that are included in the formula).</span></span> <span data-ttu-id="18798-384">此公式最多可包含 1,024 个字符。</span><span class="sxs-lookup"><span data-stu-id="18798-384">The formula can contain up to 1,024 characters.</span></span> <span data-ttu-id="18798-385">计算不能应用于包含**链接到财务维度**(FD) 类型的单元格的行。</span><span class="sxs-lookup"><span data-stu-id="18798-385">Calculations can't be applied to rows that contain cells of the **Link to Financial Dimensions** (FD) type.</span></span> <span data-ttu-id="18798-386">但是，您可以包含对连续的行的计算，禁止显示这些行的打印，然后将计算行合计在一起。</span><span class="sxs-lookup"><span data-stu-id="18798-386">However, you can include calculations on consecutive rows, suppress the printing of those rows, and then total the calculation rows.</span></span>

### <a name="operators-in-a-calculation-formula"></a><span data-ttu-id="18798-387">计算公式中的运算符</span><span class="sxs-lookup"><span data-stu-id="18798-387">Operators in a calculation formula</span></span>

<span data-ttu-id="18798-388">计算公式使用的运算符比行合计公式的更复杂。</span><span class="sxs-lookup"><span data-stu-id="18798-388">A calculation formula uses more complex operators than a row total formula.</span></span> <span data-ttu-id="18798-389">但是，您可以将 **\*** 和 **/** 运算符与其他运算符一起使用以对金额进行乘 (\*) 和除 (/) 运算。</span><span class="sxs-lookup"><span data-stu-id="18798-389">However, can you use the **\*** and **/** operators together with the additional operators to multiply (\*) and divide (/) amounts.</span></span> <span data-ttu-id="18798-390">要在计算公式中使用范围或合计，则必须在任何行代码前使用与号 (@)，除非您在行定义中使用了列。</span><span class="sxs-lookup"><span data-stu-id="18798-390">To use a range or sum in a calculation formula, you must use an at sign (@) in front of any row code, unless you're using a column in the row definition.</span></span> <span data-ttu-id="18798-391">例如，要将行 100 中的金额与 330 行中的金额相加，则可以使用行合计公式 **100+330** 或计算公式 **@ 100+@330**。</span><span class="sxs-lookup"><span data-stu-id="18798-391">For example, to add the amount in row 100 to the amount in row 330, you can use the row total formula **100+330** or the calculation formula **@100+@330**.</span></span>

> [!NOTE]
> <span data-ttu-id="18798-392">您必须在您在计算公式中使用的每个行代码前使用与号 (@)。</span><span class="sxs-lookup"><span data-stu-id="18798-392">You must use an at sign (@) before every row code that you use in a calculation formula.</span></span> <span data-ttu-id="18798-393">否则，该数字将作为绝对金额读取。</span><span class="sxs-lookup"><span data-stu-id="18798-393">Otherwise, the number is read as an absolute amount.</span></span> <span data-ttu-id="18798-394">例如，公式 **@100+330** 在行 100 中的金额中增加了 330 美元。</span><span class="sxs-lookup"><span data-stu-id="18798-394">For example, the formula **@100+330** adds USD 330 to the amount in row 100.</span></span> <span data-ttu-id="18798-395">当您引用计算公式中的列时，不需要使用 at 符号 (@)。</span><span class="sxs-lookup"><span data-stu-id="18798-395">When you reference a column in a calculation formula, an at sign (@) isn't required.</span></span>

### <a name="create-a-calculation-formula"></a><span data-ttu-id="18798-396">创建计算公式</span><span class="sxs-lookup"><span data-stu-id="18798-396">Create a calculation formula</span></span>

1. <span data-ttu-id="18798-397">在报表设计器中，单击**行定义**，然后打开行定义以修改。</span><span class="sxs-lookup"><span data-stu-id="18798-397">In Report Designer, click **Row Definitions**, and then open the row definition to modify.</span></span>
2. <span data-ttu-id="18798-398">双击**格式代码**单元格，然后选择**CAL**。</span><span class="sxs-lookup"><span data-stu-id="18798-398">Double-click the **Format Code** cell, and then select **CAL**.</span></span>
3. <span data-ttu-id="18798-399">在**相关公式/行/单位**单元格中，键入计算公式。</span><span class="sxs-lookup"><span data-stu-id="18798-399">In the **Related Formulas/Rows/Units** cell, type the calculation formula.</span></span>

### <a name="example-of-a-calculation-formula-for-specific-rows"></a><span data-ttu-id="18798-400">特定行的计算公式示例</span><span class="sxs-lookup"><span data-stu-id="18798-400">Example of a calculation formula for specific rows</span></span>

<span data-ttu-id="18798-401">在此示例中，计算公式 **@100+@330** 表示行 100 中的金额与行 330 中的金额相加。</span><span class="sxs-lookup"><span data-stu-id="18798-401">In this example, the calculation formula **@100+@330** means that the amount in row 100 is added to the amount in row 330.</span></span> <span data-ttu-id="18798-402">行总计公式 **340+370** 将行 340 中的金额与行 370 中的金额相加。</span><span class="sxs-lookup"><span data-stu-id="18798-402">The row total formula **340+370** adds the amount in row 340 to the amount in row 370.</span></span> <span data-ttu-id="18798-403">（行 370 中的金额是此计算公式生成的金额。）</span><span class="sxs-lookup"><span data-stu-id="18798-403">(The amount in row 370 is the amount from the calculation formula.)</span></span>

| <span data-ttu-id="18798-404">行代码</span><span class="sxs-lookup"><span data-stu-id="18798-404">Row Code</span></span> | <span data-ttu-id="18798-405">描述</span><span class="sxs-lookup"><span data-stu-id="18798-405">Description</span></span>                 | <span data-ttu-id="18798-406">格式代码</span><span class="sxs-lookup"><span data-stu-id="18798-406">Format Code</span></span> | <span data-ttu-id="18798-407">相关公式/行/单位</span><span class="sxs-lookup"><span data-stu-id="18798-407">Related Formulas/Rows/Unit</span></span> | <span data-ttu-id="18798-408">打印控制</span><span class="sxs-lookup"><span data-stu-id="18798-408">Print Control</span></span> | <span data-ttu-id="18798-409">行修饰符</span><span class="sxs-lookup"><span data-stu-id="18798-409">Row Modifier</span></span> | <span data-ttu-id="18798-410">链接到财务维度</span><span class="sxs-lookup"><span data-stu-id="18798-410">Link to Financial Dimensions</span></span> |
|----------|-----------------------------|-------------|----------------------------|---------------|--------------|------------------------------|
| <span data-ttu-id="18798-411">340</span><span class="sxs-lookup"><span data-stu-id="18798-411">340</span></span>      | <span data-ttu-id="18798-412">期初现金</span><span class="sxs-lookup"><span data-stu-id="18798-412">Cash at Beginning of Period</span></span> |             |                            | <span data-ttu-id="18798-413">NP</span><span class="sxs-lookup"><span data-stu-id="18798-413">NP</span></span>            | <span data-ttu-id="18798-414">BB</span><span class="sxs-lookup"><span data-stu-id="18798-414">BB</span></span>           | <span data-ttu-id="18798-415">+Account=\[1100:1110\]</span><span class="sxs-lookup"><span data-stu-id="18798-415">+Account=\[1100:1110\]</span></span>       |
| <span data-ttu-id="18798-416">370</span><span class="sxs-lookup"><span data-stu-id="18798-416">370</span></span>      | <span data-ttu-id="18798-417">年初现金</span><span class="sxs-lookup"><span data-stu-id="18798-417">Cash at Beginning of Year</span></span>   | <span data-ttu-id="18798-418">CAL</span><span class="sxs-lookup"><span data-stu-id="18798-418">CAL</span></span>         | <span data-ttu-id="18798-419">@100+@330</span><span class="sxs-lookup"><span data-stu-id="18798-419">@100+@330</span></span>                  | <span data-ttu-id="18798-420">NP</span><span class="sxs-lookup"><span data-stu-id="18798-420">NP</span></span>            |              |                              |
| <span data-ttu-id="18798-421">400</span><span class="sxs-lookup"><span data-stu-id="18798-421">400</span></span>      | <span data-ttu-id="18798-422">期初现金</span><span class="sxs-lookup"><span data-stu-id="18798-422">Cash at Beginning of Period</span></span> | <span data-ttu-id="18798-423">TOT</span><span class="sxs-lookup"><span data-stu-id="18798-423">TOT</span></span>         | <span data-ttu-id="18798-424">340+370</span><span class="sxs-lookup"><span data-stu-id="18798-424">340+370</span></span>                    |               |              |                              |

<span data-ttu-id="18798-425">当行定义中的行的格式代码为 **CAL**，并且您在**相关配方/行/单位**单元格中输入了数学计算时，您还必须输入与报表上的相关列和行的字母。</span><span class="sxs-lookup"><span data-stu-id="18798-425">When the row in a row definition has a format code of **CAL**, and you enter a mathematical calculation in the **Related Formulas/Rows/Units** cell, you must also enter the letter of the associated column and row on the report.</span></span> <span data-ttu-id="18798-426">例如，输入 **A.120** 表示列 A 行 120。</span><span class="sxs-lookup"><span data-stu-id="18798-426">For example, enter **A.120** to represent column A, row 120.</span></span> <span data-ttu-id="18798-427">也可以使用与号 (@) 表示所有列。</span><span class="sxs-lookup"><span data-stu-id="18798-427">Alternatively, you can use an at sign (@) to indicate all columns.</span></span> <span data-ttu-id="18798-428">例如，输入 **@120** 表示行 120 中的所有列。</span><span class="sxs-lookup"><span data-stu-id="18798-428">For example, enter **@120** to represent all columns in row 120.</span></span> <span data-ttu-id="18798-429">没有列字母或与号 (@) 的任何数学计算均被视为实数。</span><span class="sxs-lookup"><span data-stu-id="18798-429">Any mathematical calculation that doesn't have a column letter or an at sign (@) is assumed to be a real number.</span></span>

> [!NOTE]
> <span data-ttu-id="18798-430">如果您使用标签行代码来引用行，则必须使用句点 (.) 作为列字母和标签之间的分隔符（例如，**A.GROSS\_MARGIN/A.SALES**）。</span><span class="sxs-lookup"><span data-stu-id="18798-430">If you use a label row code to reference a row, you must use a period (.) as a separator between the column letter and the label (for example, **A.GROSS\_MARGIN/A.SALES**).</span></span> <span data-ttu-id="18798-431">如果您使用与号 (@)，则不需要分隔符（例如，**\@GROSS\_MARGIN/@SALES**）。</span><span class="sxs-lookup"><span data-stu-id="18798-431">If you use an at sign (@), a separator isn't required (for example, **\@GROSS\_MARGIN/@SALES**).</span></span>

### <a name="example-of-a-calculation-formula-for-a-specific-column"></a><span data-ttu-id="18798-432">特定列的计算公式的示例</span><span class="sxs-lookup"><span data-stu-id="18798-432">Example of a calculation formula for a specific column</span></span>

<span data-ttu-id="18798-433">在此示例中，计算公式 **E=C.340** 表示列 C、行 340 中单元格的计算，仅对列 E 执行。</span><span class="sxs-lookup"><span data-stu-id="18798-433">In this example, the calculation formula **E=C.340** means that the calculation in the cell in column C, row 340, is performed only on column E.</span></span>

> [!NOTE]
> <span data-ttu-id="18798-434">当您引用计算公式中的列时，不需要使用 at 符号 (@)。</span><span class="sxs-lookup"><span data-stu-id="18798-434">When you reference a column in a calculation formula, an at sign (@) isn't required.</span></span>

| <span data-ttu-id="18798-435">行代码</span><span class="sxs-lookup"><span data-stu-id="18798-435">Row Code</span></span> | <span data-ttu-id="18798-436">描述</span><span class="sxs-lookup"><span data-stu-id="18798-436">Description</span></span>                 | <span data-ttu-id="18798-437">格式代码</span><span class="sxs-lookup"><span data-stu-id="18798-437">Format Code</span></span> | <span data-ttu-id="18798-438">相关公式/行/单位</span><span class="sxs-lookup"><span data-stu-id="18798-438">Related Formulas/Rows/Unit</span></span> | <span data-ttu-id="18798-439">打印控制</span><span class="sxs-lookup"><span data-stu-id="18798-439">Print Control</span></span> | <span data-ttu-id="18798-440">行修饰符</span><span class="sxs-lookup"><span data-stu-id="18798-440">Row Modifier</span></span> | <span data-ttu-id="18798-441">链接到财务维度</span><span class="sxs-lookup"><span data-stu-id="18798-441">Link to Financial Dimensions</span></span> |
|----------|-----------------------------|-------------|----------------------------|---------------|--------------|------------------------------|
| <span data-ttu-id="18798-442">340</span><span class="sxs-lookup"><span data-stu-id="18798-442">340</span></span>      | <span data-ttu-id="18798-443">期初的现金</span><span class="sxs-lookup"><span data-stu-id="18798-443">Cash at Beginning of Period</span></span> |             |                            | <span data-ttu-id="18798-444">NP</span><span class="sxs-lookup"><span data-stu-id="18798-444">NP</span></span>            | <span data-ttu-id="18798-445">BB</span><span class="sxs-lookup"><span data-stu-id="18798-445">BB</span></span>           | <span data-ttu-id="18798-446">+Account=\[1100:1110\]</span><span class="sxs-lookup"><span data-stu-id="18798-446">+Account=\[1100:1110\]</span></span>       |
| <span data-ttu-id="18798-447">370</span><span class="sxs-lookup"><span data-stu-id="18798-447">370</span></span>      | <span data-ttu-id="18798-448">年初的现金</span><span class="sxs-lookup"><span data-stu-id="18798-448">Cash at Beginning of Year</span></span>   | <span data-ttu-id="18798-449">CAL</span><span class="sxs-lookup"><span data-stu-id="18798-449">CAL</span></span>         | <span data-ttu-id="18798-450">E=C.340</span><span class="sxs-lookup"><span data-stu-id="18798-450">E=C.340</span></span>                    | <span data-ttu-id="18798-451">NP</span><span class="sxs-lookup"><span data-stu-id="18798-451">NP</span></span>            |              |                              |
| <span data-ttu-id="18798-452">400</span><span class="sxs-lookup"><span data-stu-id="18798-452">400</span></span>      | <span data-ttu-id="18798-453">期初的现金</span><span class="sxs-lookup"><span data-stu-id="18798-453">Cash at Beginning of Period</span></span> | <span data-ttu-id="18798-454">TOT</span><span class="sxs-lookup"><span data-stu-id="18798-454">TOT</span></span>         | <span data-ttu-id="18798-455">340+370</span><span class="sxs-lookup"><span data-stu-id="18798-455">340+370</span></span>                    |               |              |                              |

### <a name="modifying-a-number-in-selected-columns"></a><span data-ttu-id="18798-456">修改所选列中的数字</span><span class="sxs-lookup"><span data-stu-id="18798-456">Modifying a number in selected columns</span></span>

<span data-ttu-id="18798-457">当您要修改特定行的一个列中的数字或计算但不想影响报表上的其他列时，则可以在行定义的**格式代码**列中指定**CAL**（计算）。</span><span class="sxs-lookup"><span data-stu-id="18798-457">When you modify a number or calculation in one column of a particular row but don't want to affect other columns on the report, you can specify **CAL** (Calculation) in the **Format Code** column of the row definition.</span></span>

- <span data-ttu-id="18798-458">要对所有报表 (**FD**) 列执行计算，则不要输入列分配。</span><span class="sxs-lookup"><span data-stu-id="18798-458">To perform a calculation on all report (**FD**) columns, don't enter a column assignment.</span></span>
- <span data-ttu-id="18798-459">要将公式限制到特定列，请依次输入列字母、等号 (**=**) 和公式。</span><span class="sxs-lookup"><span data-stu-id="18798-459">To restrict a formula to specific columns, enter the column letter, an equal sign (**=**), and then the formula.</span></span>
- <span data-ttu-id="18798-460">您可以指定多个列。</span><span class="sxs-lookup"><span data-stu-id="18798-460">You can specify multiple columns.</span></span> <span data-ttu-id="18798-461">在您使用与号 (@) 进行特定列放置时，与号 (@) 与行相关。</span><span class="sxs-lookup"><span data-stu-id="18798-461">When you use an at sign (@) with specific column placement, the at sign (@) is related to the row.</span></span>
- <span data-ttu-id="18798-462">您可以在一个行中输入多个列公式。</span><span class="sxs-lookup"><span data-stu-id="18798-462">You can enter multiple column formulas in one row.</span></span> <span data-ttu-id="18798-463">使用逗号分隔公式。</span><span class="sxs-lookup"><span data-stu-id="18798-463">Separate the formulas by using commas.</span></span>

### <a name="calculation-examples"></a><span data-ttu-id="18798-464">计算示例</span><span class="sxs-lookup"><span data-stu-id="18798-464">Calculation examples</span></span>

| <span data-ttu-id="18798-465">计算</span><span class="sxs-lookup"><span data-stu-id="18798-465">Calculation</span></span>            | <span data-ttu-id="18798-466">创建的操作</span><span class="sxs-lookup"><span data-stu-id="18798-466">Action that is created</span></span>                                                                                                   |
|------------------------|--------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="18798-467">@130\*.75</span><span class="sxs-lookup"><span data-stu-id="18798-467">@130\*.75</span></span>              | <span data-ttu-id="18798-468">对于每个列，行 130 中的值将乘以 0.75。</span><span class="sxs-lookup"><span data-stu-id="18798-468">For every column, the value in row 130 is multiplied by 0.75.</span></span> <span data-ttu-id="18798-469">结果随后会放入每个列的当前行。</span><span class="sxs-lookup"><span data-stu-id="18798-469">The result is then put in the current row of every column.</span></span> |
| <span data-ttu-id="18798-470">B=@130\*.75</span><span class="sxs-lookup"><span data-stu-id="18798-470">B=@130\*.75</span></span>            | <span data-ttu-id="18798-471">同一计算仅对列 B 执行。</span><span class="sxs-lookup"><span data-stu-id="18798-471">The same calculation is performed only on column B.</span></span>                                                                      |
| <span data-ttu-id="18798-472">A,B,C=(@100/@130)\*.75</span><span class="sxs-lookup"><span data-stu-id="18798-472">A,B,C=(@100/@130)\*.75</span></span> | <span data-ttu-id="18798-473">A=(A.100/A.130)\*.75 B=(B.100/B.130)\*.75 C=(C.100/C.130)\*.75</span><span class="sxs-lookup"><span data-stu-id="18798-473">A=(A.100/A.130)\*.75 B=(B.100/B.130)\*.75 C=(C.100/C.130)\*.75</span></span>                                                           |

### <a name="ifthenelse-statements-in-a-row-definition"></a><span data-ttu-id="18798-474">行定义中的 IF/THEN/ELSE 语句</span><span class="sxs-lookup"><span data-stu-id="18798-474">IF/THEN/ELSE statements in a row definition</span></span>

<span data-ttu-id="18798-475">**IF/THEN/ELSE** 报表可添加到任何有效计算并且可与 **CAL** 格式一起使用。</span><span class="sxs-lookup"><span data-stu-id="18798-475">**IF/THEN/ELSE** statements can be added to any valid calculation and used with the **CAL** format.</span></span> <span data-ttu-id="18798-476">您应在**相关配方/行/单位**列的单元格中输入**IF/THEN/ELSE**计算公式。</span><span class="sxs-lookup"><span data-stu-id="18798-476">You enter **IF/THEN/ELSE** calculation formulas in the cell in the **Related Formulas/Rows/Units** column.</span></span> <span data-ttu-id="18798-477">**IF/THEN/ELSE** 计算公式使用以下格式：IF &lt;true/false statement&gt; THEN &lt;formula&gt; ELSE &lt;formula&gt; 该语句的 **ELSE &lt;formula&gt;** 部分为可选。</span><span class="sxs-lookup"><span data-stu-id="18798-477">**IF/THEN/ELSE** calculation formulas use the following format: IF &lt;true/false statement&gt; THEN &lt;formula&gt; ELSE &lt;formula&gt; The **ELSE &lt;formula&gt;** part of the statement is optional.</span></span>

#### <a name="if-statements"></a><span data-ttu-id="18798-478">IF 语句</span><span class="sxs-lookup"><span data-stu-id="18798-478">IF statements</span></span>

<span data-ttu-id="18798-479">跟在 **IF** 语句后面的语句可以是计算结果为 true 或 false 的任何语句。</span><span class="sxs-lookup"><span data-stu-id="18798-479">The statement that follows the **IF** statement can be any statement that can be evaluated as true or false.</span></span> <span data-ttu-id="18798-480">跟在 **IF** 语句后面的语句可能涉及简单评估，也可能是包含多个表达式的复杂语句。</span><span class="sxs-lookup"><span data-stu-id="18798-480">The statement that follows the **IF** statement might involve a simple evaluation, or it might be a complex statement that can contain multiple expressions.</span></span> <span data-ttu-id="18798-481">下面举了一些示例加以说明：</span><span class="sxs-lookup"><span data-stu-id="18798-481">Here are some examples:</span></span>

- <span data-ttu-id="18798-482">**IF A.200&gt;0**（简单评估）</span><span class="sxs-lookup"><span data-stu-id="18798-482">**IF A.200&gt;0** (Simple evaluation)</span></span>
- <span data-ttu-id="18798-483">**IF A.200&gt;0 AND A.200&lt;10,000**（复杂语句）</span><span class="sxs-lookup"><span data-stu-id="18798-483">**IF A.200&gt;0 AND A.200&lt;10,000** (Complex statement)</span></span>
- <span data-ttu-id="18798-484">**IF A.200&gt;10000 OR ((A.340/B.1200)\*2 &lt;1200)**（包含多个表达式的复杂语句）</span><span class="sxs-lookup"><span data-stu-id="18798-484">**IF A.200&gt;10000 OR ((A.340/B.1200)\*2 &lt;1200)** (Complex statement that contains multiple expressions)</span></span>

<span data-ttu-id="18798-485">**IF** 语句中的 **Periods** 一词表示报表的期间数。</span><span class="sxs-lookup"><span data-stu-id="18798-485">The term **Periods** in an **IF** statement represents the number of periods for the report.</span></span> <span data-ttu-id="18798-486">此术语通常用于计算本年迄今的平均值。</span><span class="sxs-lookup"><span data-stu-id="18798-486">This term is typically used to calculate a year-to-date average.</span></span> <span data-ttu-id="18798-487">例如，当您运行期间 7 YTD 的报表时，语句 **B.150/Periods** 表示列 B 的行 150 的值除以 7。</span><span class="sxs-lookup"><span data-stu-id="18798-487">For example, when you run a report for period 7 YTD, the statement **B.150/Periods** means that the value in row 150 of column B is divided by 7.</span></span>

#### <a name="then-and-else-formulas"></a><span data-ttu-id="18798-488">THEN 和 ELSE 公式</span><span class="sxs-lookup"><span data-stu-id="18798-488">THEN and ELSE formulas</span></span>

<span data-ttu-id="18798-489">**THEN** 和 **ELSE** 公式可以是任何有效的计算 - 从非常简单的值分配到复杂的公式。</span><span class="sxs-lookup"><span data-stu-id="18798-489">The **THEN** and **ELSE** formulas can be any valid calculation, from very simple value assignments to complex formulas.</span></span> <span data-ttu-id="18798-490">例如，语句 **IF A.200&gt;0 THEN A=B.200** 表示，“如果行 200 的列 A 中的单元格大于 0（零），则将行 200 的列 B 中的值放入当前行的列 A 中的单元格。”</span><span class="sxs-lookup"><span data-stu-id="18798-490">For example, the statement **IF A.200&gt;0 THEN A=B.200** means, "If the value in the cell in column A of row 200 is more than 0 (zero), put the value from the cell in column B of row 200 into the cell in column A of the current row."</span></span> <span data-ttu-id="18798-491">前面的 **IF/THEN** 语句会将值放入当前行的一个列。</span><span class="sxs-lookup"><span data-stu-id="18798-491">The preceding **IF/THEN** statement puts a value in one column of the current row.</span></span> <span data-ttu-id="18798-492">但是，您还可以在 true/false 评估或公式中使用与号 (@) 来表示所有列。</span><span class="sxs-lookup"><span data-stu-id="18798-492">However, you can also use an at sign (@) in either true/false evaluations or the formula to represent all columns.</span></span> <span data-ttu-id="18798-493">下面是以下章节中所述的一些其他示例：</span><span class="sxs-lookup"><span data-stu-id="18798-493">Here are some other examples that are described in the following sections:</span></span>

- <span data-ttu-id="18798-494">**IF A.200 &gt;0 THEN B.200**：如果单元格 A.200 中的值为正，则将单元格 B.200 中的值放入当前行的每一列。</span><span class="sxs-lookup"><span data-stu-id="18798-494">**IF A.200 &gt;0 THEN B.200**: If the value in cell A.200 is positive, the value from cell B.200 is put into every column of the current row.</span></span>
- <span data-ttu-id="18798-495">**IF A.200 &gt;0 THEN @200**：如果单元格 A.200 中的值为正，则将行 200 中的每一列中的值放入当前行中的对应列。</span><span class="sxs-lookup"><span data-stu-id="18798-495">**IF A.200 &gt;0 THEN @200**: If the value in cell A.200 is positive, the value from each column in row 200 is put into the corresponding column in the current row.</span></span>
- <span data-ttu-id="18798-496">**IF @200 &gt;0 THEN @200**：如果当前列的行 200 中的值为正，则将行 200 中的值放入当前行中的同一列。</span><span class="sxs-lookup"><span data-stu-id="18798-496">**IF @200 &gt;0 THEN @200**: If the value in row 200 of the current column is positive, the value from row 200 is put into the same column in the current row.</span></span>

### <a name="restricting-a-calculation-to-a-reporting-unit-in-a-row-definition"></a><span data-ttu-id="18798-497">将计算限制到行定义中的报告单元</span><span class="sxs-lookup"><span data-stu-id="18798-497">Restricting a calculation to a reporting unit in a row definition</span></span>

<span data-ttu-id="18798-498">要将某个计算限制到报告结构树中的单个报告单元，以便让生成的金额不累计到较高的水平，您可使用行定义中的**相关配方/行/单位**中的 **@Unit** 代码。</span><span class="sxs-lookup"><span data-stu-id="18798-498">To restrict a calculation to a single reporting unit in a reporting tree, so that the resulting amount isn't rolled up to a higher-level unit, you can use the **@Unit** code in the **Related Formulas/Rows/Units** cell in the row definition.</span></span> <span data-ttu-id="18798-499">**@Unit** 代码在报告结构树的列 B**单位名称**中列出。</span><span class="sxs-lookup"><span data-stu-id="18798-499">The **@Unit** code is listed in column B of the reporting tree, **Unit Name**.</span></span> <span data-ttu-id="18798-500">当使用 **@Unit** 代码时，值不会累计，但计算会在报告结构树的每个级别评估。</span><span class="sxs-lookup"><span data-stu-id="18798-500">When you use the **@Unit** code, the values aren't rolled up, but the calculation is evaluated at every level of the reporting tree.</span></span>

> [!NOTE]
> <span data-ttu-id="18798-501">要使用此功能，则必须将报告结构树与行定义关联。</span><span class="sxs-lookup"><span data-stu-id="18798-501">To use this function, a reporting tree must be associated with the row definition.</span></span>

<span data-ttu-id="18798-502">该计算行可引用某个计算行或财务数据行。</span><span class="sxs-lookup"><span data-stu-id="18798-502">The calculation row can refer to a calculation row or a financial data row.</span></span> <span data-ttu-id="18798-503">该计算在行定义的**相关配方/行/单位**单元格和财务数据类型限制中记录。</span><span class="sxs-lookup"><span data-stu-id="18798-503">The calculation is recorded in the **Related Formulas/Rows/Units** cell of the row definition and the financial data–type restriction.</span></span> <span data-ttu-id="18798-504">该计算必须使用以 **IF @Unit** 开头的有条件计算。</span><span class="sxs-lookup"><span data-stu-id="18798-504">The calculation must use a conditional calculation that starts with an **IF @Unit** construction.</span></span> <span data-ttu-id="18798-505">下面是一个示例：IF @Unit(SALES) THEN @100 ELSE 0 此计算包含报表的每个列中的行 100 中的金额，但只针对销售单位。</span><span class="sxs-lookup"><span data-stu-id="18798-505">Here is an example: IF @Unit(SALES) THEN @100 ELSE 0 This calculation includes the amount from row 100 in every column of the report, but only for the SALES unit.</span></span> <span data-ttu-id="18798-506">如果有多个单位名为 SALES，金额将以所有这些单位显示。</span><span class="sxs-lookup"><span data-stu-id="18798-506">If multiple units are named SALES, the amount appears in each of those units.</span></span> <span data-ttu-id="18798-507">此外，行 100 可以是财务数据行，也可以定义为非打印。</span><span class="sxs-lookup"><span data-stu-id="18798-507">Additionally, row 100 can be a financial data row and can be defined as non-printing.</span></span> <span data-ttu-id="18798-508">在这种情况下，系统将阻止金额以树中的所有单位显示。</span><span class="sxs-lookup"><span data-stu-id="18798-508">In this case, the amount is prevented from appearing in all units in the tree.</span></span> <span data-ttu-id="18798-509">您还可以将金额限制到报表的单个列（如列 H），方法是使用列限制仅打印报表的该列中的值。</span><span class="sxs-lookup"><span data-stu-id="18798-509">You can also limit the amount to a single column of the report, such as column H, by using a column restriction to print the value only in that column of the report.</span></span> <span data-ttu-id="18798-510">您可以在 **IF** 语句中包含 **OR** 组合。</span><span class="sxs-lookup"><span data-stu-id="18798-510">You can include **OR** combinations in an **IF** statement.</span></span> <span data-ttu-id="18798-511">下面是一个示例：IF @Unit(SALES) OR @Unit (SALESWEST) THEN 5 ELSE @100 您可以使用以下方法之一在计算类型限制中指定单位：</span><span class="sxs-lookup"><span data-stu-id="18798-511">Here is an example: IF @Unit(SALES) OR @Unit(SALESWEST) THEN 5 ELSE @100 You can specify a unit in a calculation-type restriction in one of the following ways:</span></span>

- <span data-ttu-id="18798-512">输入单位名称以包含匹配的单位。</span><span class="sxs-lookup"><span data-stu-id="18798-512">Enter a unit name to include units that match.</span></span> <span data-ttu-id="18798-513">例如，**IF @Unit(SALES)** 可启用对名为 SALES 的任何单位的计算，即使报告结构树中有多个 SALES 单位。</span><span class="sxs-lookup"><span data-stu-id="18798-513">For example, **IF @Unit(SALES)** enables the calculation for any unit that is named SALES, even if there are several SALES units in the reporting tree.</span></span>
- <span data-ttu-id="18798-514">输入公司和单位名称以将计算限制到特定公司内的特定单位。</span><span class="sxs-lookup"><span data-stu-id="18798-514">Enter the company and unit name to restrict the calculation to specific units in a specific company.</span></span> <span data-ttu-id="18798-515">例如，输入 **IF @Unit(ACME:SALES**) 以将计算限制到 ACME 公司内的 SALES 单位。</span><span class="sxs-lookup"><span data-stu-id="18798-515">For example, enter **IF @Unit(ACME:SALES**) to restrict the calculation to SALES units in the ACME company.</span></span>
- <span data-ttu-id="18798-516">输入报告结构树中的完整层次结构代码以将计算限制到特定单位。</span><span class="sxs-lookup"><span data-stu-id="18798-516">Enter the full hierarchy code from the reporting tree to restrict the calculation to a specific unit.</span></span> <span data-ttu-id="18798-517">例如，输入 **IF @Unit(SUMMARY^ACME^WEST COAST^SALES)**。</span><span class="sxs-lookup"><span data-stu-id="18798-517">For example, enter **IF @Unit(SUMMARY^ACME^WEST COAST^SALES)**.</span></span>

> [!NOTE]
> <span data-ttu-id="18798-518">若要找到完整层次结构代码，请右键单击报告树定义，然后选择**复制报告单位标识符(H-代码)**。</span><span class="sxs-lookup"><span data-stu-id="18798-518">To find the full hierarchy code, right-click in the reporting tree definition, and then select **Copy Reporting Unit Identifier (H-code)**.</span></span>

#### <a name="restrict-a-calculation-to-a-reporting-unit"></a><span data-ttu-id="18798-519">将计算限定为报告单位</span><span class="sxs-lookup"><span data-stu-id="18798-519">Restrict a calculation to a reporting unit</span></span>

1. <span data-ttu-id="18798-520">在报表设计器中，单击**行定义**，然后打开要修改的行定义。</span><span class="sxs-lookup"><span data-stu-id="18798-520">In Report Designer, click **Row Definitions**, and then open the row definition to modify.</span></span>
2. <span data-ttu-id="18798-521">双击**格式代码**单元格，然后选择**CAL**。</span><span class="sxs-lookup"><span data-stu-id="18798-521">Double-click the **Format Code** cell, and then select **CAL**.</span></span>
3. <span data-ttu-id="18798-522">单击**相关配方/行/单位**单元格，然后输入以 **IF @Unit** 结构开头的有条件计算。</span><span class="sxs-lookup"><span data-stu-id="18798-522">Click the **Related Formulas/Rows/Units** cell, and then enter a conditional calculation that starts with an **IF @Unit** construction.</span></span>

### <a name="ifthenelse-statements-in-a-column-definition"></a><span data-ttu-id="18798-523">列定义中的 IF/THEN/ELSE 语句</span><span class="sxs-lookup"><span data-stu-id="18798-523">IF/THEN/ELSE statements in a column definition</span></span>

<span data-ttu-id="18798-524">**IF/THEN/ELSE** 语句可使所有计算依赖于来自任何其他列的结果。</span><span class="sxs-lookup"><span data-stu-id="18798-524">An **IF/THEN/ELSE** statement enables any calculation to depend on the results from any other column.</span></span> <span data-ttu-id="18798-525">您可以引用其他列，但不能引用 **IF** 语句中的报表单元格。</span><span class="sxs-lookup"><span data-stu-id="18798-525">You can refer to other columns, but you can't refer to a report cell in the **IF** statement.</span></span> <span data-ttu-id="18798-526">任何计算都必须应用于整个列。</span><span class="sxs-lookup"><span data-stu-id="18798-526">Any calculation must be applied to the whole column.</span></span> <span data-ttu-id="18798-527">例如，语句 **IF B&gt;100 THEN B ELSE C\*1.25** 表示，“如果列 B 中的金额大于 100，则将列 B 中的值放入 **CALC** 列。</span><span class="sxs-lookup"><span data-stu-id="18798-527">For example, the statement **IF B&gt;100 THEN B ELSE C\*1.25** means, "If the amount in column B is more than 100, put the value from column B into the **CALC** column.</span></span> <span data-ttu-id="18798-528">如果列 B 中的金额不大于 100，则将列 C 中的值乘以 1.25，并将结果放入 **CALC** 列。”</span><span class="sxs-lookup"><span data-stu-id="18798-528">If the amount in column B isn't more than 100, multiply the value in column C by 1.25, and put the result into the **CALC** column."</span></span> <span data-ttu-id="18798-529">始终在 **IF** 语句后面跟上可评估为 true 或 false 的逻辑语句。</span><span class="sxs-lookup"><span data-stu-id="18798-529">Always follow the **IF** statement with a logic statement that can be evaluated as true or false.</span></span> <span data-ttu-id="18798-530">用于 **THEN** 语句和 **ELSE** 语句的公式可包含对任意数量的列的引用，并且您可以根据需求设置这些公式的复杂度。</span><span class="sxs-lookup"><span data-stu-id="18798-530">The formulas that you use for both the **THEN** statement and the **ELSE** statement can contain references to any number of columns, and these formulas can be as complex as you want to make them.</span></span>

> [!NOTE]
> <span data-ttu-id="18798-531">您不能将计算的结果放入任何其他列。</span><span class="sxs-lookup"><span data-stu-id="18798-531">You can't put the results of a calculation into any other column.</span></span> <span data-ttu-id="18798-532">结果必须在包含公式的列中。</span><span class="sxs-lookup"><span data-stu-id="18798-532">The results must be in the column that contains the formula.</span></span>

#### <a name="use-single-quotes-and-an-ampersand-for-dimension-values-in-a-row-column-or-tree"></a><span data-ttu-id="18798-533">行、列和树中的维度值使用单引号和与号</span><span class="sxs-lookup"><span data-stu-id="18798-533">Use single quotes and an ampersand for dimension values in a row, column, or tree</span></span>

<span data-ttu-id="18798-534">可使用包含与号 (&) 的维度值设计报表。</span><span class="sxs-lookup"><span data-stu-id="18798-534">You can design reports using dimension values that contain an ampersand (&).</span></span> 

<span data-ttu-id="18798-535">在任何**链接到财务维度**字段中，均可输入 **'P&L'** 这样的值。</span><span class="sxs-lookup"><span data-stu-id="18798-535">Within any **Link to Financial Dimension** field, you can enter a value such as **'P&L'**.</span></span> <span data-ttu-id="18798-536">如果维度值两端都有单引号 (' ')，说明使用的是文字值，如包括与号字符 (&)。</span><span class="sxs-lookup"><span data-stu-id="18798-536">Including single quotes (' ') on both sides of the dimension value indicates that you are using the literal value, such as including the (&) ampersand character.</span></span> 
