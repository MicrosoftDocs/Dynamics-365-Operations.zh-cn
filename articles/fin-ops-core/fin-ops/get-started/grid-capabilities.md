---
title: 网格功能
description: 本主题介绍网格控件的几个强大功能。 必须启用新的网格功能才能访问这些功能。
author: jasongre
manager: AnnBe
ms.date: 01/22/2021
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-platform
ms.technology: ''
ms.search.form: DefaultDashboard
audience: Application User, Developer, IT Pro
ms.reviewer: sericks
ms.search.region: Global
ms.author: jasongre
ms.search.validFrom: 2020-02-29
ms.dyn365.ops.version: Platform update 33
ms.openlocfilehash: f8ec45208ea86f4b1782eaeb1d14bb414e3b577f
ms.sourcegitcommit: e88c96d1cb817a22db81856cadb563c095ab2671
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/02/2021
ms.locfileid: "5104301"
---
# <a name="grid-capabilities"></a>网格功能

[!include [banner](../includes/banner.md)]
[!include [preview banner](../includes/preview-banner.md)]

新的网格控件提供了多个有用而强大的功能，您可以用来提高用户生产率、构造更有趣的数据视图并获得有意义的数据见解。 本文将介绍以下功能： 

-  正在计算合计
-  先于系统键入
-  评估数学表达式 
-  为表格式数据分组（已使用 **(预览版) 网格中的分组** 功能单独启用）
-  锁定列

## <a name="calculating-totals"></a>正在计算合计
在 Finance and Operations 应用中，用户可以在网格中数字列的底部查看总计。 网格底部的页脚部分显示这些总计。 

### <a name="showing-the-grid-footer"></a>显示网格页脚
下面是 Finance and Operations 应用中每个选项卡式网格底部的页脚区域。 此页脚可显示与网格中显示的数据有关的宝贵信息。 下面是这些信息的一些示例：

- 表中选定的行数（当选择多个记录时）
- 已配置数字列底部的总计
- 数据集中的行数 

默认情况下，此页脚为隐藏状态，您可以将其打开。 要显示网格的页脚，右键单击网格中的列标题，然后选择 **显示页脚** 选项。 在为特定网格打开页脚后，该设置将被记住，直到用户选择隐藏页脚为止。 要隐藏页脚，右键单击列标题，选择 **隐藏页脚**。  （**显示页脚/隐藏页脚** 操作的位置可能在以后的更新中移到新位置。 

### <a name="specifying-columns-with-totals"></a>指定包含总计的列
当前，默认情况下，没有列会显示总计。 而是将此视为一次性设置活动，类似于调整网格中列的宽度。 指定要查看某列的总计后，该设置将在您下次访问页面时被记住。  

有两种方法可以配置列以显示总计： 

- 在您想查看总计的列中右键单击，然后选择 **计算此列总计**。 此操作将导致发生三个事件：

    1. 显示页脚。 
    2. 保存您查看此列总计的首选项。 
    3. 将启动此列以及您之前配置为查看总计的其他任何列的总计计算。 何时需要显示总计取决于要计算其总计的数据集的大小。

- 页脚显示后，选择要查看其总计的列底部页脚区域中的 **显示总计**。 如果没有配置的列，**显示总计** 按钮将对所有数字列可用。 

    在为总计配置了至少一列后，**显示总计** 按钮将仅在悬停或聚焦时可用。 选择 **显示总计** 这一操作仅保存有关在此列中查看总计的首选项，因此将来访问此页面时间应用此首选项。 在页脚中，此状态由列中显示的破折号表示。 （或者，如果数据集足够小，将立即显示总计。）

如果您输入有误，并且不想再查看特定列中的总计，右键单击该列，然后选择 **隐藏总计** 或选择该列页脚中的 **隐藏总计** 按钮。 此首选项也将被保存以供将来访问该页面时使用。 

### <a name="calculating-totals"></a>正在计算合计
当您进入页脚可见且已为总计配置了列的页面时，总计可能会显示在页脚中，也可能不会显示。 此行为取决于页面上数据集的大小。 如果数据集足够小，则会自动显示总计以及数据集中的行数。 如果您在为总计配置的列下的页脚中有破折号，则说明数据集太大，系统无法立即显示总计，因此需要执行明确操作来计算总计。 若要执行此操作，单击页脚中的 **计算** 按钮，或右键单击要计算总计的列，然后选择 **计算此列总计**。  

如果计算时间过长，可以选择 **取消** 按钮取消运算。 但是，有时数据集太大而无法计算总数（组织施加的限制），而是会通知您进一步筛选数据。

总计将在您更新、删除或创建数据集中的行时自动更新。  

## <a name="typing-ahead-of-the-system"></a>先于系统键入
在许多业务场景中，快速将数据输入系统的能力非常重要。 在引入新的网格控件之前，用户只能在当前行中更改数据。 他们不得不等待系统成功验证任何更改，然后才能够创建新行或切换到其他行。 为了减少用户等待这些验证完成的时间并提高用户的工作效率，新的网格调整了这些验证以使其实现异步。 因此，用户可以在之前行的验证等待处理时移至其他行进行更改。 

为了支持此新行为，当网格处于编辑模式时，一个新的行状态列已被添加到行选择列的右侧。 此列指示以下状态之一：

- **空白** – 没有状态图像指示行已被系统成功保存。
- **等待处理** – 此状态指示行中的更改尚未由服务器保存，但处于必须处理的更改队列中。 您必须等待所有待处理更改均得到处理，然后才能在网格外执行操作。 此外，这些行中的文本采用斜体来指示这些行处于未保存状态。 
- **无效状态** – 此状态指示在处理行期间触发了一些警告或消息，这可能阻止了系统将更改保存在该行中。 在旧网格中，如果保存操作失败，您将不得不返回该行来立即解决问题。 但是，在新网格中，将通知您遇到了验证问题，但是您可以决定希望何时解决行中的问题。 当您准备好解决问题时，可以手动将焦点移回该行。 或者，您可以选择 **解决此问题** 操作。 此操作将立即将焦点移至出现问题的行，并允许您在网格内部或外部进行编辑。 请注意，在解决此验证警告之前，将停止处理后续等待处理的行。 
- **暂停** – 此状态指示服务器的处理已暂停，因为对该行的验证触发了一个需要用户输入的弹出对话框。 由于用户可能正在其他行中输入数据，因此不会立即向该用户显示弹出对话框。 而是会在用户选择恢复处理时显示。 此状态伴随一个通知，通知用户相关情况。 通知包括一个将触发弹出对话框的 **恢复处理** 操作。  
    
当用户在服务器要处理的地方之前输入数据时，他们的数据输入体验可能会有所下降，如缺少查找、控制级别验证和默认值输入。 建议需要下拉列表来查找值的用户等待服务器开始处理当前行时再操作。 当服务器处理该行时，也将进行控制级验证和默认值的输入。   

### <a name="pasting-from-excel"></a>从 Excel 粘贴
通过使用 **导出到 Excel** 机制，用户始终能够将 Finance and Operations 应用中网格中的数据导出到 Excel。 但是，能够提前于系统输入数据的功能使新网格能够支持从 Excel 复制表并将其直接粘贴到 Finance and Operations 应用内的网格中。 从其发起粘贴操作的网格单元确定复制表开始粘贴的位置。 网格的内容将被复制表的内容覆盖，以下两种情况除外：

- 如果复制表中的列数超过网格中剩余的列数（从粘贴位置开始），将通知用户多余列已被忽略。 
- 如果复制表中的行数超过网格中的行数（从粘贴位置开始），现有单元将被粘贴的内容覆盖，复制表中多余的行将作为新行插入到网格底部。 

## <a name="evaluating-math-expressions"></a>评估数学表达式
随着生产力的迅速提高，用户可以在网格中的数值列内输入数学公式。 不必在系统外的应用内进行计算。 例如，如果输入 **=15\*4**，然后按 **Tab** 键离开字段，系统将计算该表达式，并保存该字段的值 **60**。

要使系统将值识别为表达式，请将值以等号 (**=**) 开头。 有关受支持的运算符和语法的详细信息，请参阅[支持的数学符号](http://bugwheels94.github.io/math-expression-evaluator/#supported-maths-symbols)。

## <a name="grouping-tabular-data"></a>为表格式数据分组
业务用户通常需要执行专门的数据分析。 尽管可以通过将数据导出到 Microsoft Excel 并使用数据透视表来完成此操作，但依赖于新网格控件功能的 **网格中的分组**（在 10.0.16/平台更新 40 中公开发布）功能允许用户在 Finance and Operations 应用中以有趣的方式组织其表格式数据。 因为此功能扩展 **总计** 功能，**分组** 允许您通过在组级别提供小计来获得有意义的数据见解。

要使用此功能，右键单击分组所基于的列，然后选择 **按此列分组**。 此操作将按所选列对数据进行排序，将新的 **分组依据** 列添加到网格的开头，并在每个组的开头插入“标题行”。 这些标题行提供有关每个组的以下信息： 
-  组的数据值 
-  列名（在采用多级分组之后，此信息特别有用）  
-  该组中的数据行数
-  配置为显示总计的所有列的小计

启用[保存的视图](saved-views.md)后，可以通过个性化将分组保存为视图的一部分，以便下次访问页面时快速访问。  

### <a name="multiple-levels-of-grouping"></a>多层分组
按单列为数据分组之后，可以通过在所需列中选择 **按此列分组** 来按其他列为数据分组。 可以重复此过程，直到您具有 5 级嵌套分组（这是最大支持深度）为止。 此时，您将不再能够按其他列分组。  

在任何时候，您都可以通过右键单击该列并选择 **取消分组** 来删除任何列上的分组。 您还可以通过依次选择 **网格选项** 和 **全部取消分组** 从所有列中删除分组。   

请注意，在版本 10.0.16 /平台更新 40 之前，仅支持一级分组。 在这些版本中，如果将数据分组并为其他列选择 **按此列分组**，将替换原始分组。  


### <a name="expanding-and-collapsing-groups"></a>展开和折叠组
数据的初始分组将扩展所有组。 可以通过折叠单个组来创建数据的汇总视图，也可以使用组展开和折叠功能帮助浏览数据。 若要展开或折叠组，请选择相应组标题行中的 V 形按钮 (>)。 请注意，单个组的展开/折叠状态 **不** 保存到个性化设置中。

### <a name="selecting-and-unselecting-rows-at-the-group-level"></a>在组级别选择和取消选择行
也可以按照通过选中网格中第一列顶部的复选框选择（或取消选择）网格中的所有行的相同方法，通过选中相应组标题行中的复选框快速选中（或取消选中）组中的所有行。 组标题行中的复选框始终反映该组中行的当前选择状态，无论是选中了所有行，未选中任何行，还是仅选中了部分行。

### <a name="hiding-column-names"></a>隐藏列名
对数据分组时，默认行为是在组标题行中显示列名。 从版本 10.0.14/平台更新 38 开始，可以通过选择 **网格选项** > **隐藏组列名** 在组标题行中隐藏列名。

## <a name="freezing-columns"></a>锁定列
网格中的某些列对于上下文而言可能足够重要，您不希望它们滚动到视图之外。 相反，您希望这些列中的值始终可见。 在版本 10.0.17 中，**锁定网格中的列** 功能将为用户提供这种灵活性。 

要锁定列，右键单击列标题，然后选择 **锁定列**。 第一次完成此步骤时，所选列将成为第一列，不会再滚动到视图之外。 后续您锁定的所有列都将被添加到最后锁定的列的右侧。 您可以根据需要使用标准的“移动”功能对锁定列进行重新排序。 但是，锁定列无法移动，这样它们会出现在未锁定列集中。 同样，未锁定的列无法移动，这样它们会出现在锁定列集中。

要取消列的锁定，右键单击锁定列标题，然后选择 **取消锁定列**。 

请注意，新网格中的行选择和行状态列始终锁定为前两列。 因此，当这些列包含在网格中时，无论网格中的水平滚动位置如何，用户会始终看到它们。 这两列不能重新排序。

## <a name="frequently-asked-questions"></a>常见问题
### <a name="how-do-i-enable-the-new-grid-control-in-my-environment"></a>如何在我的环境中启用新的网格控件？ 

**10.0.9/平台更新 33 及更高版本**

在任何环境中，**新建网格控件** 功能均可直接在“功能管理”中使用。 与其他公共预览功能一样，在生产环境中启用此功能取决于[补充使用条款协议](https://go.microsoft.com/fwlink/?linkid=2105274)。  

**10.0.8/平台更新 32 和 10.0.7/平台更新 31**

可以在第 1 层（开发/测试）和第 2 层（沙盒）环境中启用 **新建网格控件** 功能，以按照以下步骤进行其他测试和设计更改。

1.  **启用外部测试版**：执行以下 SQL 语句： 

    `INSERT INTO SYSFLIGHTING (FLIGHTNAME, enabled, FLIGHTSERVICEID, PARTITION) VALUES('CLIReactGridEnableFeature', 1, 0, 5637144576);`

2. **重置 IIS**，用于清空静态外部测试缓存。 

3.  **查找功能**：转到 **功能管理** 工作区。 如果所有功能列表中不显示 **新网格控件**，请选择 **检查更新**。   

4.  **启用功能**：在功能列表中找到 **新网格控件** 功能，然后选择详细信息窗格上的 **立即启用**。 请注意，必须刷新浏览器。 

所有后续用户会话都将从启用新网格控件开始。

## <a name="developer-opting-out-individual-pages-from-using-the-new-grid"></a>[开发人员] 让单个页面退出使用新网格 
如果您的组织发现使用新网格时存在一些问题的页面，从版本 10.0.13/平台更新 37 开始，可以使用 API 允许单个窗体使用旧版网格控件，同时仍然允许系统的其余部分使用新网格控件。 要让单个页面退出新网格，请在窗体的 `run()` 方法中添加以下 post `super()` 调用。

 ```this.forceLegacyGrid();```

在新网格控件在 2021 年 10 月发布中被强制使用之前，此 API 一直可以使用。 如果有任何问题需要使用此 API，请向 Microsoft 报告。

## <a name="developer-size-to-available-width-columns"></a>[开发人员]尺寸到可用宽度列
如果开发人员将新网格内的列的 **WidthMode** 属性设置为 **SizeToAvailable**，这些列的初始宽度会与将此属性设置为 **SizeToContent** 时的宽度相同。 不过，它们会拉伸以使用网格内任何可用的额外宽度。 如果将多个列的此属性设置为 **SizeToAvailable**，所有这些列将在网格内共享任何可用的额外宽度。 但是，如果用户手动调整这些列中一个列的大小，该列将变为静态。 它将保持该宽度，不会再拉伸，占用可用的额外网格宽度。  

## <a name="known-issues"></a>已知问题
本节维护新网格控件的已知问题列表。  

### <a name="open-issues"></a>未解决问题
-  启用 **新网格控件** 功能后，某些页面将继续使用现有的网格控件。 在以下情况下会发生这种情况：  
    -  页面上存在以多列呈现的卡列表。
    -  页面上存在分组卡列表。
    -  具有非反应性可扩展控件的网格列。

    当用户第一次遇到这些情况之一时，将显示一条有关刷新页面的消息。 出现此消息后，页面将继续为所有用户使用现有网格，直到下一个产品版本更新。 将来的更新中会考虑更好地处理这些情况，以可以使用新网格。    
    
-  [KB 4582758] 将缩放从 100 更改为其他任何百分比时，记录将变得模糊
-  [KB 4592012] 从 Excel 粘贴多行时，IE11 中出现意外的客户端错误
    -  Microsoft 没有寻找解决此问题的方法

### <a name="fixed-as-part-of-10016"></a>已作为 10.0.16 的一部分修复

-  [KB 4598335] 多行字符串控件未采用列表/卡中的 DisplayHeights 
-  [KB 4591891] 取消对行的标记时，发票方案行消失
-  [KB 4592104] 单击“解决问题”并移到另一行后，在没有解决验证问题的情况下，无法编辑记录
-  [KB 4594449] 日期选择器中缺少“从不”和“清除”按钮 
-  [KB 4594448] 新网格对输入时间的处理不同
-  [KB 4600059] 电子邮件限制导致意外的客户端错误
-  [KB 4574584] 将鼠标悬停在收据图标上时，费用附件预览不可用

### <a name="fixed-as-part-of-10015"></a>已作为 10.0.15 的一部分修复    

-  （质量更新）[KB 4594444] 分段式录入控件预览出现意外的客户端错误
-  [KB 4582723] 显示以后在窗体生命周期中完成时不显示的选项
-  [KB 4591988] 使用键盘从 ReferenceGroup 查找中选择值时出现问题
-  [KB 4588958] Regression Suite Automation Tool (RSAT) 测试失败，显示错误：TypeError: 无法读取未定义的属性“text”
-  [KB 4591970] 单击网格后，从 Excel 粘贴立即完成时发生意外的客户端错误
-  [KB 4591904] 如果在编辑控件后，用户立即单击并打开其他控件的查找，不会保存数据更改
-  [KB 4584752] “项目发票提案”页面出现意外的客户端错误
-  [KB 4584540] 将单行粘贴到日记帐行后无法离开网格
-  [KB 4591908] 创建新行时，焦点一直停留在您所在的列

### <a name="fixed-as-part-of-10014"></a>已作为 10.0.14 的一部分修复

-  （质量更新）[KB 4584752] “项目发票提案”页面出现意外的客户端错误
-  [KB 4583880] Regression Suite Automation Tool (RSAT) OpenLookup 操作的测试失败，错误消息为“无法读取未定义的 RowIndex 属性”
-  [KB 4583847] 浏览查找时出现意外的客户端错误

### <a name="fixed-as-part-of-10013"></a>已作为 10.0.13 的一部分修复

-  （质量更新）[KB 4584752] “项目发票提案”页面出现意外的客户端错误
-  （质量更新）[KB 4583880] Regression Suite Automation Tool (RSAT) OpenLookup 操作的测试失败，错误消息为“无法读取未定义的 RowIndex 属性”
-  （质量更新）[KB 4583847] 浏览查找时出现意外的客户端错误 
-  （质量更新）[错误 471777] 无法选择网格中的字段来编辑或创建移动应用
-  [KB 4582727] 用户获取具有多个数量的项目的对话后，网格锁定
-  [错误 474851] 参考组控件中的超链接打不开 
-  [错误 474848] 带有网格的增强预览不显示
-  [KB 4582726] 不考虑 RotateSign 属性  
-  [错误 470173] 单击单元格中的空白时，非活动行中的复选框会切换
-  [错误 474848] 带有网格的增强预览不显示
-  [错误 474851] 参考组控件中的超链接打不开 
-  [错误 471777] 无法选择网格中的字段来编辑或创建移动应用
-  [KB 4569441] 呈现多列卡列表、图像上的工具提示以及某些字段上的显示选项时存在问题
-  [KB 4575279] 不能在普通日记帐中删除所有标记行
-  [KB 4575233] 移至另一行后，显示选项不能恢复
-  [错误 477884] 如果激活新网格控件，查找将返回错误值/记录
-  [KB 4571095] 不小心按 Enter 键时会发生产品收货过帐（在正确处理页面的默认操作的情况下）
-  [KB 4575437] 使用可编辑控件的查找意外关闭
-  [KB 4569418] 在交货计划窗体中创建重复行
-  [KB 4575435] 即使鼠标指针不在字段附近，增强预览有时仍会持续
-  [KB 4575434] 修改字段后，查找不能进行筛选
-  [KB 4575430] 密码字段中的值不能在网格中隐藏
-  [KB 4569438] 在结算供应商交易时标记行后，显示“由于验证问题处理已停止”
-  [KB 4569434] 刷新法人窗体会让记录减少
-  [KB 4575297] 在编辑网格以及在网格之间移动时，焦点会一直移至任务录制器窗格
-  [KB 4566773] 凭证交易记录查询中的更正交易记录不能显示为负数 
-  [KB 4575288] 在简单列表中选择行之间的边框时，焦点会重置到活动行
-  [KB 4575287] 使用向下箭头在日记帐中创建新行时，焦点不会返回到第一列
-  [KB 4564819] 无法删除普通发票中的行（因为数据源 ChangeGroupMode=ImplicitInnerOuter）
-  [KB 4563317] 图像不显示工具提示/增强预览

### <a name="fixed-as-part-of-10012"></a>已作为 10.0.12 的一部分修复

- [KB 4558545] 表控件不更新显示项目的内容。
- [KB 4558570] 删除记录后，项目仍显示在页面上。
- [KB 4558572] 与列表面板 **ExtendedStyle** 关联的样式不能使用。
- [KB 4558573] 当所需的更改在网格外部时，无法修复验证错误。
- [KB 4558584] 负数呈现不正确。
- [KB 4560726] 使用“列表视图”控件完成列表之间的交换后，发生“意外的客户端错误”。
- [KB 4562141] 网格索引在添加新记录后关闭。
- [KB 4562151] **验证** 和 **复制** 任务录制器选项不能用于日期/数字控件。 
- [KB 4562153] 多选复选框在列表/卡片网格中不可见。
- [KB 4562646] 在网格中选择多行后，有时无法在网格外单击。
- [KB 4562647] 在安全角色网格中添加新行之后，焦点将重置到 **发布** 对话框中的第一个控件。
- [KB 4563310] 行更改后，增强预览不关闭。
- [KB 4563313] 在查询中选择一个值时，Internet Explorer 中发生“意外的客户端错误”。
- [KB 4564557] 在 Internet Explorer 中无法打开查找和下拉菜单
- [KB 4563324] 打开 **人事管理** 工作区后，导航不起作用。

### <a name="fixed-as-part-of-10011"></a>已作为 10.0.11 的一部分修复

- [问题 432458] 某些子集合的开头显示空行或重复行。
- [KB 4549711] 启用新的网格控件后，无法正确删除付款方案中的行。
- [KB 4558374] 无法创建需要多态选择器对话框的记录。
- [KB 4558375] 帮助文本不显示在新网格中的列上。
- [KB 4558376] 在 Internet Explorer 中，列表面板网格不以正确高度呈现。
- [KB 4558377] 在某些页面上不呈现具有 **SizeToAvailable** 宽度的组合框列。
- [KB 4558378] 钻取有时会打开错误的记录。
- [KB 4558379] 当在 **ReplaceOnLookup**=**否** 的位置打开查找时发生错误。
- [KB 4558380] 折叠页面某个部分后，网格中的可用空间不能立即填充。
- [KB 4558381] 负数呈现不正确/遇到验证问题后，用户有时会卡住。
- [KB 4558382] 发生意外的客户端错误。
- [KB 4558383] 删除最后一条记录后，不更新网格外部的控件。
- [KB 4558587] 具有替换字段组合框的参考组不显示值。
- [KB 4562143] 更改行后，字段不更新/删除行后，网格处理卡住。
- [KB 4562645] 在 Regression Suite Automation Tool (RSAT) 测试运行的同时打开查找发生异常。

### <a name="fixed-as-part-of-10010"></a>已作为 10.0.10 的一部分修复

- [问题 414301] 创建新行时，前几行的一些数据将消失。
- [错误 417044] 列表样式网格没有空网格消息。
- [KB 4539058] 某些网格（通常在快速选项卡上）有时不呈现（但是如果缩小，它们将呈现）。
- [KB 4549734] 如果隐藏标记列，不能将活动行视为已标记。
- [KB 4549796] 处于查看模式时，无法在网格中编辑值。
- [KB 4558367] 更改行时，文本选择不一致。
- [KB 4558368] 在单选场景中允许通过键盘进行多选。
- [KB 4558369] 状态图像在分层网格中消失。
- [KB 4558370] 新行不能滚动到视图中。
- [KB 4558372] 如果所粘贴内容中的列数超过网格中的剩余列数，新网格将卡在处理模式。
- [KB 4562631] 时间值格式不正确。

### <a name="quality-update-for-1009platform-update-33"></a>10.0.9/平台更新 33 的质量更新

- [KB 4550367] 时间值格式不正确。
