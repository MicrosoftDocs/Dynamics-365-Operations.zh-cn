---
title: 在 POS 中创建退货
description: 本文介绍了如何在 Microsoft Dynamics 365 Commerce 销售点 (POS) 应用程序中为现金和结转交易或客户订单启动退货。
author: hhainesms
ms.date: 04/27/2022
ms.topic: article
audience: Application User, Developer, IT Pro
ms.reviewer: v-chgriffin
ms.search.region: Global
ms.author: hhaines
ms.search.validFrom: 2020-02-20
ms.dyn365.ops.version: Release 10.0.20
ms.openlocfilehash: a49e9abd0143d480cc1cafb05be5e995fb3cebdd
ms.sourcegitcommit: 52b7225350daa29b1263d8e29c54ac9e20bcca70
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/03/2022
ms.locfileid: "8856990"
---
# <a name="create-returns-in-pos"></a>在 POS 中创建退货

[!include [banner](includes/banner.md)]

本文介绍了如何在 Microsoft Dynamics 365 Commerce 销售点 (POS) 应用中为现金和结转交易或客户订单启动退货。

> [!NOTE]
> 在 Commerce 版本 10.0.20 及更高版本中，提供了名为 **POS 中的统一退货处理体验** 的新功能。 此功能在 POS 中提供更加一致和统一的退货流程，无论交易类型（现金和结转交易或客户订单）或创建订单的原始渠道如何。 我们建议所有组织都打开此新功能，以帮助提高通过 POS 进行退货处理的整体可靠性。
>
> 该功能在打开后，无法关闭。

## <a name="process-returns-by-using-the-return-transaction-operation"></a>使用退货交易操作处理退货

我们建议您将退货交易操作添加到您的 POS [屏幕布局](pos-screen-layouts.md)。 在 Commerce 版本 10.0.20 之前的版本中，退货交易操作仅正确支持现金和结转交易的退货处理。 打开 Commerce 版本 10.0.20 或更高版本中的 **POS 的统一退货处理体验** 功能后，退货交易操作还支持源自客户订单（例如已开具发票的“领料”或“送货上门”订单）的退货处理。

在退货交易操作中，用户可以通过输入以下四个搜索条件中的任何一个来搜索针对其进行退货的现金和结转交易或客户订单。 用户可以使用设备键盘、屏幕键盘或条码扫描仪输入这些条件。

- 收据 ID
- 转移单编号
- 渠道引用 ID（也称为订单确认 ID）
- 发票 ID

如果找到符合搜索条件的交易或订单，将显示 **可退货产品** 页面。 在该页面中，用户可以指定要退回的物料。 他们还可以输入退货数量和原因代码。

对于可退货产品列表中的每个订单行，POS 会显示有关原始采购数量和先前处理的任何退货数量的信息。 用户为订单行输入的退货数量必须小于或等于 **可以退货** 字段的值。

![可退货产品页面。](media/returnslist.png)

在退货处理期间，如果用户有实物产品，并且该产品有条码，用户可以扫描条码进行退货登记。 每扫描一次条码，退货数量就会增加一件。 但是，如果条码标签具有嵌入的数量，该数量将在 **立即退回** 字段中输入。

用户还可以在 **可退货产品** 页面上手动选择要返回的物料，然后使用右侧的详细信息窗格更新 **立即退回** 字段。

如果为交易指定了可用的最大 **立即退回** 数量，用户可以在 POS 应用栏上选择 **全选** 操作以在所有行上设置最大可退回数量。

对于具有 **立即退回** 数量的每一行，用户必须使用详细信息窗格选择退货原因代码。 对于现金和结转交易的退货，退货原因代码配置为商店的功能配置文件中的信息代码。 对于客户订单的退货，在 Dynamics 365 Commerce Headquarters 中的 **退货原因代码** 页面上配置退货原因代码。

为每个必须退货的物料设置退货数量和原因代码后，用户可以在 POS 原因上选择 **退货** 操作以继续处理。 将显示 POS 交易页面，其中已将在上一页面上选定的可退货物料添加到购物车。 物料的 **立即退回** 数量在交易上显示为负数量行，并将计算总退款。

如果用户正在创建交换订单，他们可以将行添加到退货交易。 用户还可以针对已添加的选定正数量销售行使用 **退货产品** 操作，将更多临时退货物料添加到退货交易。

> [!NOTE]
> POS 中的 **退货产品** 操作不针对任何原始交易提供任何验证，并允许退回任何产品。 因此，我们建议只允许授权用户执行此操作，或者如果使用此操作，则需要经理替代功能。

如果在结帐时退款到期，组织可以配置[退款付款策略](refund_policy_returns.md)，以限制可用于向客户退款的付款方式。 如果使用信用卡支付了原始交易，根据付款处理器和系统配置，用户可以选择[将退款发放到原卡](dev-itpro/linked-refunds.md)。 在这种情况下，无需客户再次刷信用卡即可处理退款。 原始付款令牌用于发放退款。

## <a name="other-return-options-in-pos"></a>POS 中的其他退货选项

当打开 **POS 中的统一退货处理体验** 功能时，用户还可以在 POS 中使用 **显示日记帐** 操作以为现金和结转交易或客户订单启动退货。 然后，他们可以在日记帐中选择一个交易，随后在 POS 应用栏上选择 **退货** 操作。 此操作仅在订单上有可退货行时可用。 它启动与 **退货交易** 操作相同的用户体验。

用户还可以在 POS 中使用 **撤回订单** 操作以搜索和撤回客户订单。 （此操作不能用于现金和结转交易）。 在这种情况下，在选择客户订单后，POS 应用栏上的 **退货** 操作可用于为客户订单启动退货。 此操作仅在订单上有可退货行时可用。 它启动与 **退货交易** 或 **显示日记帐** 操作相同的用户体验。

## <a name="return-orders-are-posted-to-commerce-headquarters-as-sales-orders"></a>退货订单作为销售订单过帐到 Commerce Headquarters 

当打开 **POS 中的统一退货处理体验** 功能时，在 POS 中创建的所有退货将作为具有负行的销售订单写入 Commerce Headquarters。 在 Commerce 版本 10.0.20 之前的版本中，用户可以选择退货订单应作为具有负行的销售订单过帐，还是应作为通过退货授权 (RMA) 流程创建的退货订单过帐。 

在 **POS 中的统一退货处理体验** 功能中，使用 RMA 流程在 POS 中创建退货的选项已弃用。 打开此功能后，所有退货都将创建为具有负行的销售订单。

## <a name="offline-return-processing-improvements"></a>脱机退货处理改进

在大多数情况下，当在 POS 中处理退货时，系统会尝试向 Commerce Headquarters 发出实时服务 (RTS) 呼叫以验证当前可用于退货的数量。 此验证有助于防止出现客户试图在多个地点退回同一物料的欺诈情况。

若要处理由于网络或连接问题而无法发出 RTS 呼叫的情况，已经实施了一个流程来定期将退货数量数据从 Commerce Headquarters 同步到商店的渠道数据库。 此渠道端退货跟踪有助于确保 POS 中显示的 **可以退货** 数量相当准确，即使 POS 处于脱机状态。 它还确保 POS 可以继续验证渠道端信息，以帮助防止欺诈性退货。

若要以适当的方式使用脱机退货流程，组织应在 Commerce Headquarters 中计划 **更新退货数量** 批处理作业，以便其频繁运行。 我们建议此作业的运行频率与将新交易从 Commerce 渠道拉入 Commerce Headquarters 的 P 作业相同。

**更新退货数量** 作业计算可用于在 Commerce Headquarters 中找到的所有销售订单的退货的数量。 然后，必须将作业计算的数据发送到渠道数据库，以便可以更新商店渠道。 出于此目的，使用 **退货数量** (1200) 分发作业。 因为从 Commerce Headquarters 同步有关可退货数量的数据，因此如果在 POS 中处理退货，但无法发出 RTS 呼叫，则 POS 可以使用渠道端退货信息验证给定销售行的 **可以退货** 数量。

当无法发出 RTS 呼叫，并且 POS 正在使用渠道端数据进行退货验证时，将显示一条警告消息，通知用户他们正在创建“脱机”退货。 因此，他们意识到，POS 中显示的 **可以退货** 数量可能已过时且不再准确，具体取决于 **更新退货数量** 作业上次处理并同步到渠道的时间。

例如，客户最近在另一个渠道中处理了订单行的退货，但该数据尚未通过 **更新退货数量** 作业同步到渠道数据库。 然后，客户前往另一家商店并尝试再次退回相同的物料。 在这种情况下，如果商店无法向 Commerce Headquarters 发出 RTS 呼叫来获取实时退货数据，POS 将允许再次退回该物料。 但是，用户将收到警告，用于验证的退货的信息可能已过时。 用户收到的消息只是一条警告消息。 它不会阻止用户继续处理退货。

如果渠道端信息出于某种原因不是最新的，并且针对超出实际 **可以退货** 数量的数量处理脱机退货，在运行对帐单过帐以在 Commerce Headquarters 中创建交易时，可能会生成一个错误。

> [!NOTE]
> 当打开 **POS 中的统一退货处理体验** 功能时，支持验证序列化产品退货的新可选功能变得可用。 有关详细信息，请参阅[在销售点 (POS) 中退回序列号控制的产品](POS-serial-returns.md)。

## <a name="version-details"></a>版本详细信息

以下列表提供了各个组件的最低版本要求。
- Commerce headquarters：版本 10.0.20
- Commerce Scale Unit (CSU)：版本 9.30
- 销售点 (POS)：版本 9.30

## <a name="enable-proper-tax-calculation-for-returns-with-partial-quantity"></a>对具有部分数量的退货启用正确的税金计算

此功能可确保在使用多个发票进行订单退货时，最终的税金等于最初收取的税额。

1. 在 **功能管理** 工作区中搜索 **对具有部分数量的退货启用正确的税金计算**。
1. 选择 **对具有部分数量的退货启用正确的税金计算** 功能，然后选择 **启用**。

## <a name="set-up-return-locations-for-retail-stores"></a>设置零售商店的退货场所

Commerce 允许您设置基于零售信息代码和销售和市场营销原因代码的退货场所。 当客户退还所购商品时，收银员通常会指明退货的原因。 您可以根据收银员在 POS 收银机上选择的信息代码和原因代码，指定退回的产品应该分配到库存中不同的退货场所。

例如，客户退回有缺陷的产品，收银员处理退货交易。 当 Retail POS 显示退货信息代码时，收银员选择缺陷产品退货的子代码。 然后，退回的产品会自动分配到特定的退货地点。

根据组织设置的库存场所，退货场所可以是仓库、仓库中的一个场所或者甚至是一个特定托盘。 您可以将每个退货场所映射到一个或多个零售信息代码，以及销售和市场营销原因代码。

### <a name="prerequisites"></a>先决条件

在设置退货场所之前，您必须设置以下元素：

- **零售信息代码** – 在 **零售** 模块中设置 POS 收银机中的提示。 有关详细信息，请参阅[设置信息代码](/dynamicsax-2012/appuser-itpro/setting-up-info-codes)。
- **销售和市场营销原因代码** – 在 **销售和市场营销** 模块中设置 POS 收银机中的提示。 有关详细信息，请参阅[设置原因代码](/dynamicsax-2012/appuser-itpro/set-up-return-reason-codes)。
- **库存库位** – 库存存放的位置。 有关详细信息，请参阅[设置库存库位](/dynamicsax-2012/appuser-itpro/about-locations)。
    
### <a name="set-up-return-locations"></a>设置退货库位

若要设置退货场所，请执行以下步骤。

1. 转到 **Retail 和 Commerce \> 渠道设置 \> 仓库**，然后选择仓库。
1. 在 **零售** 快速选项卡上，在 **默认退货库位** 字段中，选择要用于未将信息代码或原因代码映射到退货库位的退货的库存库位。
1. 在 **默认退货托盘** 字段中，选择要用于未将信息代码或原因代码映射到退货库位的退货的库存库位。
1. 转到 **Retail 和 Commerce \> 库存管理 \> 退货场所**。
1. 选择 **新建** 以创建退货场所政策。
1. 为退货场所输入唯一名称和描述。

    > [!NOTE]
    > 如果设置了退货场所的编号规则，则将自动输入名称。

1. 在 **常规** 快速选项卡上，将 **打印标签** 选项设置为 **是**，以打印分配给退货库位的所有产品的标签。
1. 将 **锁定库存** 选项设置为 **是**，以将位于默认退货场所的退回产品从库存中除去，并防止它们进行销售。
1. 要将特定零售信息代码和子代码映射到退货场所，请执行以下步骤：

    1. 在 **零售信息代码** 快速选项卡上，选择 **添加**。
    1. 在 **信息代码** 字段中，选择退货的信息代码。
    1. 在 **子代码** 字段中，选择退回原因的子代码。 **说明** 字段显示选定子代码的描述。
    1. 在 **商店** 字段中，选择使用信息代码的商店。
    1. 使用 **仓库**、**库位** 和 **托盘 ID** 字段指定退货场所。 例如，要在商店中指定特定场所，请在 **商店** 字段中选择一个商店，并在 **场所** 字段中选择一个场所。
    1. 选择 **锁定库存** 复选框以将退回产品从库存中除去，并防止它们进行销售。

1. 要将特定的销售和市场营销原因代码映射到退货场所，请执行以下步骤：

    1. 在 **销售和市场营销原因代码** 快速选项卡上，选择 **添加**。
    1. 在 **原因代码** 字段中，选择退货的原因代码。 **说明** 字段显示选定原因代码的描述。
    1. 在 **商店** 字段中，选择使用原因代码的商店。
    1. 使用 **仓库**、**库位** 和 **托盘 ID** 字段指定退货场所。 例如，要指定仓库场所中的托盘，请在 **仓库** 字段中选择一个仓库，在 **场所** 字段中选择一个场所，在 **托盘 ID** 字段中选择一个托盘。
    1. 选择 **锁定库存** 复选框以将退回产品从库存中除去，并防止它们进行销售。

    > [!NOTE]
    > 如果退货场所政策用于物料，但出纳选择的退货原因与 **零售信息代码** 或 **销售和市场营销原因代码** 快速选项卡上指定的任何代码都不匹配，则该物料将发送到 **仓库** 页面上定义的默认退货场所。 此外，**退货场所** 页面 **常规** 快速选项卡上的 **锁定库存** 复选框设置将确定是否应对退回的物料锁定库存。

1. 转到 **Retail 和 Commerce \> Commerce 产品层次结构**。
1. 在 **管理库存类别属性** 快速选项卡上的 **退货场所** 字段中，选择一个退货场所。 因为可以为同一个商店定义多个退货场所政策，所以您在此处选择的值决定了所使用的退货场所政策。

## <a name="additional-resources"></a>其他资源

[在销售点 (POS) 中退回序列号控制的产品](POS-serial-returns.md)

[以前批准和确认的交易的关联退款](dev-itpro/linked-refunds.md)

[创建和更新渠道的退货和退款政策](refund_policy_returns.md)

[POS 用户界面视觉效果配置](pos-screen-layouts.md)
