---
title: 销售点 (POS) 中的产品搜索和客户搜索
description: 此主题概述 Dynamics 365 Commerce 中的产品和客户搜索的增强功能。
author: ShalabhjainMSFT
ms.date: 03/10/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application user
ms.reviewer: josaw
ms.custom: 141393
ms.assetid: ''
ms.search.region: Global
ms.search.industry: Retail
ms.author: shajain
ms.search.validFrom: 2017-06-30
ms.dyn365.ops.version: Retail April 2017 update
ms.openlocfilehash: 043a630408d6b03e528f0afd5443de73ad5f3802c968b9d9bd7a5c51bfe1fb03
ms.sourcegitcommit: 42fe9790ddf0bdad911544deaa82123a396712fb
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/05/2021
ms.locfileid: "6716383"
---
# <a name="product-search-and-customer-search-in-the-point-of-sale-pos"></a>销售点 (POS) 中的产品搜索和客户搜索

[!include [banner](includes/banner.md)]

现代销售点 (MPOS) 和云销售点 (CPOS) 提供易于使用的搜索功能，便于搜索产品和客户。 由于搜索栏始终显示在 MPOS 和 CPOS 窗口顶部，因此员工可以快速搜索产品和客户。

员工可以在与当前商店关联的分类和目录中搜索产品。 还可以在与公司其他任何商店关联的分类和目录中搜索。 因此，出纳可以销售和退回商店分类以外的产品。 同样，员工可以搜索与当前商店或公司中的任何其他商店关联的客户。 此外，员工可以搜索与父组织中的不同公司关联的客户。

## <a name="product-search"></a>产品搜索

默认情况下，对商店分类执行产品搜索。 此类搜索被称为 *本地产品搜索*。 但是，员工可以轻松切换到与当前商店关联的任何目录，或在不同商店中进行搜索。 此类搜索被称为 *远程产品搜索*。 若要更改目录，请选择页面左侧的 **类别** 按钮。 在显示的窗格顶部，选择 **更改目录** 按钮，然后选择一个可用的目录进行浏览。 系统将在选定目录中搜索产品。

在 **更改目录** 页上，员工可以轻松选择任何商店，或者可以跨所有商店搜索产品。

![更改目录。](./media/Changecatalog.png "更改目录")

本地产品搜索在以下产品属性中进行搜索：

- 产品编号
- 产品名称
- 说明
- 维度
- 条码
- 搜索姓名

### <a name="additional-local-product-search-capabilities"></a>其他本地产品搜索功能

- 对于多个关键字搜索（即使用搜索词的搜索），零售商可以配置搜索结果是否包括匹配 *任何* 搜索词的结果或仅包括匹配 *所有* 搜索词的结果。 此功能的设置在 POS 功能配置文件中命名为 **产品搜索** 的新组中可用。 默认设置为 **匹配任何搜索词**。 此设置也是建议的设置。 如果使用 **匹配任何搜索词** 设置，将把完全或部分匹配一个或多个搜索词的所有产品作为结果返回。 这些结果将自动按照关键字匹配项（完全或部分）最多的产品的升序排序。

    **匹配所有搜索词** 设置仅返回（完全或部分）匹配所有搜索词的产品。 当产品名称较长，且员工只想查看搜索结果中的有限产品时，此设置有用。 但是，该搜索类型有两个限制：

    - 对单独的产品属性进行搜索。 例如，仅返回在至少一个产品属性中具有所有搜索关键字的产品。
    - 不搜索维度。

- 零售商可以将产品搜索配置为当用户键入产品名称时显示搜索建议。 此功能的新设置在 POS 功能配置文件中命名为 **产品搜索** 的组中可用。 设置命名为 **在键入时显示搜索建议**。 此功能使员工无需手动键入全部名称，因此可以帮助员工快速查找其搜索的产品。
- 产品搜索算法现在可以搜索在产品的 **搜索名称** 属性中搜索的词语。

![产品建议。](./media/Productsuggestions.png "产品建议")

## <a name="customer-search"></a>客户搜索

客户搜索用于根据不同目的查找客户。 例如，出纳可能想要查看客户的愿望列表或购买历史记录，或将客户添加到交易记录。 搜索算法将搜索词与以下客户属性中的值进行比较：

- 姓名
- 电子邮件地址
- 电话号码
- 会员卡号
- 地址
- 帐号

在这些属性中，名称为多关键字搜索贡献的灵活性最大，因为算法会返回与任何搜索关键字匹配的所有客户。 匹配最多关键字的客户显示在结果的顶部。 这种行为在以下情况下可以帮助收银员：键入全名进行搜索，但是最初录入数据时截断了姓氏和名字。 但是，出于性能原因，其他所有属性会保持搜索关键字的顺序。 因此，如果搜索关键字的顺序与数据的存储顺序不匹配，则不返回任何结果。

默认情况下，客户搜索在与商店关联的客户通讯簿中执行。 此类搜索被称为 *本地客户搜索*。 但是，员工也可以搜索全局客户。 换而言之，他们可以跨公司及所有其他法人的商店进行搜索。 此类搜索被称为 *远程客户搜索*。

要执行全局搜索，员工可以选择页面底部的 **筛选结果** 按钮，然后选择 **搜索所有商店** 选项，如下图中所示。 在这种情况下，不止返回客户。 也返回属于总部中的任何通讯簿的所有类型的相关方。 这些相关方包括工作人员、供应商、联系人和竞争对手。

> [!NOTE]
> 远程客户搜索中必须输入至少四个字符才能返回结果。

系统不显示其他法人查询的客户的客户 ID，因为没有在当前公司为这些相关方创建客户 ID。 但是，如果员工打开客户详细信息页，系统将自动为相关方生成一个客户 ID，且将商店的客户通讯簿与该客户相关联。 因此，该客户将在以后执行的本地商店搜索中可见。

![全局客户搜索。](./media/Globalcustomersearch.png "全局客户搜索")

### <a name="additional-local-customer-search-capabilities"></a>其他本地客户搜索功能

当用户搜索电话号码时，系统会忽略创建客户时可能已添加的特殊字符（如空格、连字符和括号）。 因此，收银员在进行搜索时无需担心电话号码格式。 例如，如果输入的客户电话号码为 **123-456-7890**，则收银员可以通过键入 **1234567890** 来搜索客户，也可以通过输入电话号码的前几个数字来搜索客户。

> [!NOTE]
> 一个客户可以有多个电话号码和多个电子邮件。 客户搜索算法也会搜索这些辅助电子邮件和电话号码，但是客户搜索结果页仅显示主要电子邮件和电话号码。 这可能会造成一些混乱，因为返回的客户结果将不会显示搜索到的电子邮件或电话号码。 在将来的版本中，我们计划改进客户搜索结果屏幕来显示此信息。

传统的客户搜索可能很费时间，因为要在多个字段中进行搜索。 不过，收银员可在单个客户属性（如姓名、电子邮件地址或电话号码）中进行搜索。 客户搜索算法使用的属性统称为 *客户搜索条件*。 系统管理员可以轻松地将一个或多个条件配置为 POS 中显示的快捷方式。 因为搜索限制为单个条件，所以将仅显示相关搜索结果，而性能则比标准客户搜索的性能好得多。 下图显示 POS 中的客户搜索快捷方式。

![客户搜索快捷方式。](./media/SearchShortcutsPOS.png "客户搜索快捷方式")

若要设置搜索条件快捷方式，管理员必须在 Commerce 中打开 **商业参数** 页，然后在 **POS 搜索条件** 选项卡上选择所有应显示为快捷方式的条件。

![配置搜索快捷方式。](./media/ConfigureShortcutsAX.png "配置搜索快捷方式")

> [!NOTE]
> 如果添加的快捷方式过多，POS 中搜索栏上的下拉菜单将变得杂乱不堪，从而可能影响员工的搜索体验。 建议仅根据需要添加快捷方式。

**显示顺序** 字段确定快捷方式在 POS 中的显示顺序。 显示的条件是客户搜索算法用于搜索客户的自带属性。 但是，合作伙伴可以添加自定义属性作为搜索快捷方式。 若要将自定义属性添加为搜索快捷方式，系统管理员必须扩展用于客户搜索条件的可扩展枚举，然后将合作伙伴的自定义属性标记为快捷方式。 合作伙伴负责编写代码以在其自定义快捷方式用于搜索时查找结果。

> [!NOTE]
> 添加到枚举的自定义属性不影响标准客户搜索算法。 换言之，客户搜索算法不在自定义属性中进行搜索。 仅当自定义属性添加为快捷方式时或替代了默认搜索算法时，用户才能将该自定义属性用于搜索。

零售商还可以将 POS 中的默认客户搜索模式设置为 **搜索所有商店**。 如果必须立即搜索在 POS 外部创建的客户（例如，即使在运行配送作业之前），则此配置可能非常有用。 为此，零售商必须在 POS 功能配置文件中打开 **默认客户搜索模式** 选项。 将其设置为 **是** 后，每次尝试搜索客户都会实时调用总部。

为了帮助避免意外的性能问题，此配置隐藏在名称为 **CUSTOMERSEARCH_ENABLE_DEFAULTSEARCH_FLIGHTING** 的战旗后面。 因此，若要在设置用户界面 (UI) 时显示 **默认客户搜索模式**，零售商应该为其用户接受测试 (UAT) 环境和生产环境创建支持工单。 收到工单后，工程团队将与零售商合作，以确保零售商在非生产环境中进行测试来评估性能和实施需要的所有优化。

## <a name="cloud-powered-customer-search"></a>云助力的客户搜索

使用 Azure 认知搜索服务的客户搜索功能的公开预览版已作为 Commerce 10.0.18 版本的一部分发布。 除了性能改进之外，服务的用户还可以从丰富的改进功能和改进的相关功能中受益。 当使用 POS 的全局搜索功能（“搜索所有商店”）时，性能改进尤其明显。 这是因为搜索结果从 Azure 搜索索引中获得，而不是通过查询 Commerce Headquarters 中的数据获得。 

### <a name="enable-the-cloud-powered-search-feature"></a>启用云助力搜索功能

> [!NOTE]
> Commerce Headquarters 和 Commerce Scale Unit 都必须更新到版本 10.0.18。 不需要更新 POS。

要在 Commerce Headquarters 中启用云助力搜索功能，请按照下列步骤操作。

1. 转到 **系统管理 \> 工作区 \> 功能管理**。
1. 找到并选择 **（预览版）云助力客户搜索** 功能，然后选择 **立即启用**。
1. 转到 **Retail 和Commerce > 总部设置 > 商业调度 > 初始化商业调度**，然后选择 **确定** 以在 **配送计划** 窗体上显示新的 **1010_CustomerSearch** 作业。
1. 转到 **Retail 和 Commerce > Retail 和 Commerce IT > 配送计划**。
1. 运行 **1010_CustomerSearch** 作业。 该作业将日期发布到 Azure 搜索索引。 索引发布完成后，作业状态将设置为 **已应用**。
1. 将 **1010_CustomerSearch** 作业状态设置为 **已应用** 之后，运行 **1110 - 全局配置** 作业，以在 **功能管理** 中更新刚启用的功能的 POS 渠道。
1. 随后，定期运行 **1010_CustomerSearch** 作业，以将客户更新信息发送到搜索索引。

> [!NOTE]
> 对于初始索引发布，**1010_CustomerSearch** 作业可能需要几个小时才能完成，因为它会将所有客户记录发送到 Azure 搜索索引。 随后的更新应该会需要几分钟。 在启用云助力搜索功能但尚未完成索引发布的时间段内，从 POS 进行的客户搜索将默认为现有的基于 SQL 的搜索。 这样可以确保商店运营不会中断。

### <a name="functional-differences-from-the-existing-search"></a>与现有搜索之间的功能差异

下表显示了云助力客户搜索功能与现有搜索功能的不同之处。 

- 运行 **1010_CustomerSearch** 作业时，在 Commerce Headquarters 中创建和编辑的客户会发送到 Azure 搜索索引。 这些更新至少需要 15 到 20 分钟才能更新索引。 在 Commerce Headquarters 中发生更新后大约 15 到 20 分钟，POS 用户将能够搜索新客户（或基于更新的信息进行搜索）。 如果您的业务流程要求可以在 POS 中立即搜索在 Commerce Headquarters 创建的客户，那么这可能不是适合您的服务。
- 在 POS 中创建的新客户会从 Commerce Scale Unit 发送到 Azure 搜索索引，并且可以在任何商店中立即搜索。 但是，如果启用了异步客户创建功能，则在客户信息与 Commerce Headquarters 同步并为异步客户生成客户 ID 之前，新的客户记录将不会从 Commerce Scale Unit 发布到 Azure 搜索索引，并且将无法从 POS 进行搜索。 然后，**1010_CustomerSearch** 作业将能够将异步客户记录发送到 Azure 搜索索引。 平均而言，大约需要 30 分钟才能在 POS 上搜索新创建的异步客户。 此估算假设 **1010_CustomerSearch**、**P 作业** 以及 **从异步模式同步客户和业务合作伙伴** 作业被计划为每 15 分钟运行一次。
- 云助力搜索还可以搜索客户的备用电子邮件和电话号码，但是当前客户搜索结果仅显示客户的主要电话号码和主要电子邮件地址。 乍看起来，似乎返回了不相关的搜索结果，但是通过检查搜索结果中客户的备用电子邮件和电话号码，可以帮助验证所搜索的关键字是否给出了匹配的客户。 为了避免这种混乱，可通过计划来改进搜索结果页面，以使用户易于了解为什么会返回某个搜索结果。
- 在全局搜索（“搜索所有商店”）中使用至少 4 个字符进行搜索这一要求不适用于此服务。

> [!NOTE]
> 使用 Azure 认知搜索服务的客户搜索功能仅在有限的区域中可用以进行预览。 客户搜索功能在以下地区中 *不* 可用：
> - 巴西
> - 印度
> - 加拿大
> - 英国

[!INCLUDE[footer-include](../includes/footer-banner.md)]
