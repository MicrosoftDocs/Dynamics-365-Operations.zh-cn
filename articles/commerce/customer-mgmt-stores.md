---
title: 商店中的客户管理
description: 本主题说明零售商如何在 Microsoft Dynamics 365 Commerce 中启用销售点 (POS) 客户管理功能。
author: josaw1
ms.date: 03/05/2021
ms.topic: article
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
ms.search.form: RetailOperations
audience: Application User, IT Pro
ms.reviewer: v-chgri
ms.search.region: Global
ms.search.industry: retail
ms.author: shajain
ms.search.validFrom: 2021-01-31
ms.dyn365.ops.version: 10.0.14
ms.openlocfilehash: 46a18d36a389e8a52253c2c3a153e0eae95c0e57
ms.sourcegitcommit: 3cdc42346bb653c13ab33a7142dbb7969f1f6dda
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/31/2021
ms.locfileid: "5799413"
---
# <a name="customer-management-in-stores"></a><span data-ttu-id="ca89d-103">商店中的客户管理</span><span class="sxs-lookup"><span data-stu-id="ca89d-103">Customer management in stores</span></span>

[!include [banner](includes/banner.md)]

<span data-ttu-id="ca89d-104">本主题说明零售商如何在 Microsoft Dynamics 365 Commerce 中启用销售点 (POS) 客户管理功能。</span><span class="sxs-lookup"><span data-stu-id="ca89d-104">This topic explains how retailers can enable customer management capabilities at the point of sale (POS) in Microsoft Dynamics 365 Commerce.</span></span>

<span data-ttu-id="ca89d-105">店员必须可以在 POS 上创建和编辑客户记录，这一点很重要。</span><span class="sxs-lookup"><span data-stu-id="ca89d-105">It's important that store associates can create and edit customer records at the POS.</span></span> <span data-ttu-id="ca89d-106">这样，他们可以捕获诸如电子邮件地址、电话号码和地址之类的客户信息的任何更新。</span><span class="sxs-lookup"><span data-stu-id="ca89d-106">In that way, they can capture any updates to customer information such as the email address, phone number, and address.</span></span> <span data-ttu-id="ca89d-107">此信息对于下游系统（如市场营销）很有用，因为这些系统的有效性取决于其客户数据的准确性。</span><span class="sxs-lookup"><span data-stu-id="ca89d-107">This information is helpful in downstream systems such as marketing, because the effectiveness of those systems depends on the accuracy of their customer data.</span></span>

<span data-ttu-id="ca89d-108">销售助理可以从两个 POS 入口点触发客户创建工作流。</span><span class="sxs-lookup"><span data-stu-id="ca89d-108">Sales associates can trigger the customer creation workflow from two POS entry points.</span></span> <span data-ttu-id="ca89d-109">他们可以选择一个映射到 **添加客户** 操作的按钮，或者他们可以在搜索结果页面上的应用栏中选择 **创建客户**。</span><span class="sxs-lookup"><span data-stu-id="ca89d-109">They can select a button that is mapped to the **Customer add** operation, or they can select **Create customer** on the app bar on the search results page.</span></span> <span data-ttu-id="ca89d-110">在这两种情况下，**新客户** 对话框都会出现，销售助理可以在其中输入所需的客户详细信息，例如客户的姓名、电子邮件地址、电话号码、地址，以及与业务相关的任何其他信息。</span><span class="sxs-lookup"><span data-stu-id="ca89d-110">In both cases, the **New customer** dialog box appears, where sales associates can enter required customer details, such as the customer's name, email address, phone number, address, and any additional information that is relevant to the business.</span></span> <span data-ttu-id="ca89d-111">可以使用与客户相关联的客户属性来捕获这些附加信息。</span><span class="sxs-lookup"><span data-stu-id="ca89d-111">That additional information can be captured by using the customer attributes that are associated with the customer.</span></span> <span data-ttu-id="ca89d-112">有关客户属性的更多信息，请参见[客户属性](dev-itpro/customer-attributes.md)。</span><span class="sxs-lookup"><span data-stu-id="ca89d-112">For more information about customer attributes, see [Customer attributes](dev-itpro/customer-attributes.md).</span></span>

<span data-ttu-id="ca89d-113">销售助理还可以捕获备用电子邮件地址和电话号码。</span><span class="sxs-lookup"><span data-stu-id="ca89d-113">Sales associates can also capture secondary email addresses and phone numbers.</span></span> <span data-ttu-id="ca89d-114">此外，他们可以捕获关于通过这些备用电子邮件地址或电话号码中的任何一个来接收营销信息的客户偏好。</span><span class="sxs-lookup"><span data-stu-id="ca89d-114">Additionally, they can capture the customer's preference about receiving marketing information via any of those secondary email addresses or phone numbers.</span></span> <span data-ttu-id="ca89d-115">要启用此功能，零售商必须在 Commerce Headquarters 内的 **功能管理** 工作区（**系统管理 \> 工作区 \> 功能管理**）中开启 **捕获多个电子邮件和电话号码，并同意对这些联系人进行营销** 功能。</span><span class="sxs-lookup"><span data-stu-id="ca89d-115">To enable this capability, retailers must turn on the **Capture multiple emails and phone numbers and consent for marketing on these contacts** feature in the **Feature management** workspace in Commerce headquarters (**Systems administration \> Workspaces \> Feature management**).</span></span>

## <a name="default-customer-properties"></a><span data-ttu-id="ca89d-116">默认客户属性</span><span class="sxs-lookup"><span data-stu-id="ca89d-116">Default customer properties</span></span>

<span data-ttu-id="ca89d-117">零售商可以使用 Commerce Headquarters 中的 **所有商店** 页面（**Retail 和 Commerce \> 渠道 \> 商店**），以将默认客户与每个商店相关联。</span><span class="sxs-lookup"><span data-stu-id="ca89d-117">Retailers can use the **All stores** page in Commerce headquarters (**Retail and Commerce \> Channels \> Stores**) to associate a default customer with each store.</span></span> <span data-ttu-id="ca89d-118">然后，Commerce 将为默认客户定义的属性复制到创建的所有新客户记录中。</span><span class="sxs-lookup"><span data-stu-id="ca89d-118">Commerce then copies the properties that are defined for the default customer to all new customer records that are created.</span></span> <span data-ttu-id="ca89d-119">例如，**创建客户** 对话框会显示从与商店关联的默认客户继承的属性。</span><span class="sxs-lookup"><span data-stu-id="ca89d-119">For example, the **Create customer** dialog box shows properties that are inherited from the default customer that is associated with the store.</span></span> <span data-ttu-id="ca89d-120">这些属性包括客户类型、客户组、收据首选项、货币和语言。</span><span class="sxs-lookup"><span data-stu-id="ca89d-120">Those properties include the customer type, customer group, receipt preference, currency, and language.</span></span> <span data-ttu-id="ca89d-121">任何隶属关系（客户组）也将从默认客户那里继承。</span><span class="sxs-lookup"><span data-stu-id="ca89d-121">Any affiliations (groupings of customers) are also inherited from the default customer.</span></span> <span data-ttu-id="ca89d-122">但是，财务维度从与默认客户关联的客户组那里继承，而不是从默认客户本身继承。</span><span class="sxs-lookup"><span data-stu-id="ca89d-122">However, financial dimensions are inherited from the customer group that is associated with the default customer, not from the default customer itself.</span></span>

<span data-ttu-id="ca89d-123">销售助理可以捕获客户的多个地址。</span><span class="sxs-lookup"><span data-stu-id="ca89d-123">Sales associates can capture multiple addresses for a customer.</span></span> <span data-ttu-id="ca89d-124">客户的姓名和电话号码是从与每个地址关联的联系信息中继承的。</span><span class="sxs-lookup"><span data-stu-id="ca89d-124">The customer's name and phone number are inherited from the contact information that is associated with each address.</span></span> <span data-ttu-id="ca89d-125">客户记录的 **地址** 快速选项卡包括销售助理可以编辑的 **目的** 字段。</span><span class="sxs-lookup"><span data-stu-id="ca89d-125">The **Addresses** FastTab of a customer record includes a **Purpose** field that sales associates can edit.</span></span> <span data-ttu-id="ca89d-126">如果客户类型是 **人员**，则默认值为 **家庭**。</span><span class="sxs-lookup"><span data-stu-id="ca89d-126">If the customer type is **Person**, the default value is **Home**.</span></span> <span data-ttu-id="ca89d-127">如果客户类型是 **组织**，则默认值为 **公司**。</span><span class="sxs-lookup"><span data-stu-id="ca89d-127">If the customer type is **Organization**, the default value is **Business**.</span></span> <span data-ttu-id="ca89d-128">此字段支持的其他值包括 **家庭**、**办公室** 和 **邮政信箱**。</span><span class="sxs-lookup"><span data-stu-id="ca89d-128">Other values that this field supports include **Home**, **Office**, and **Post box**.</span></span> <span data-ttu-id="ca89d-129">地址中的 **国家/地区** 字段的值继承自 Commerce Headquarters 内 **运营单位** 页（**组织管理 \> 组织 \> 运营单位**）上指定的主要地址。</span><span class="sxs-lookup"><span data-stu-id="ca89d-129">The value of the **Country** field for an address is inherited from the primary address that is specified on the **Operating unit** page in Commerce headquarters at **Organization administration \> Organizations \> Operating units**.</span></span>

## <a name="sync-customers-and-async-customers"></a><span data-ttu-id="ca89d-130">同步客户和异步客户</span><span class="sxs-lookup"><span data-stu-id="ca89d-130">Sync customers and Async customers</span></span>

<span data-ttu-id="ca89d-131">在 Commerce 中，有两种客户创建模式：同步和异步。</span><span class="sxs-lookup"><span data-stu-id="ca89d-131">In Commerce, there are two modes of customer creation: Synchronous (or Sync) and Asynchronous (or Async).</span></span> <span data-ttu-id="ca89d-132">默认情况下，系统会同步创建客户。</span><span class="sxs-lookup"><span data-stu-id="ca89d-132">By default, customers are created synchronously.</span></span> <span data-ttu-id="ca89d-133">换句话说，客户是在 Commerce Headquarters 中实时创建的。</span><span class="sxs-lookup"><span data-stu-id="ca89d-133">In other words, they are created in Commerce headquarters in real time.</span></span> <span data-ttu-id="ca89d-134">同步客户创建模式很有用，因为可以跨渠道立即搜索新客户。</span><span class="sxs-lookup"><span data-stu-id="ca89d-134">The Sync customer creation mode is beneficial because new customers are immediately searchable across channels.</span></span> <span data-ttu-id="ca89d-135">但是，它也有一个缺点。</span><span class="sxs-lookup"><span data-stu-id="ca89d-135">However, it also has a drawback.</span></span> <span data-ttu-id="ca89d-136">因为它会向 Commerce Headquarters 发出 [Commerce Data Exchange：实时服务](dev-itpro/define-retail-channel-communications-cdx.md#realtime-service)请求，如果同时发出许多客户创建请求，则性能可能会受到影响。</span><span class="sxs-lookup"><span data-stu-id="ca89d-136">Because it generates [Commerce Data Exchange: Real-time Service](dev-itpro/define-retail-channel-communications-cdx.md#realtime-service) calls to Commerce headquarters, performance can be affected if many concurrent customer creation calls are made.</span></span>

<span data-ttu-id="ca89d-137">如果在商店的功能配置文件（**Retail 和 Commerce \> 渠道设置 \> 在线商店设置 \> 功能配置文件**）中将 **以异步模式创建客户** 选项设置为 **是**，则实时服务请求不会用于在渠道数据库中创建客户记录。</span><span class="sxs-lookup"><span data-stu-id="ca89d-137">If the **Create customer in async mode** option is set to **Yes** in the store's functionality profile (**Retail and Commerce \> Channel setup \> Online store setup \> Functionality profiles**), Real-time Service calls aren't used to create customer records in the channel database.</span></span> <span data-ttu-id="ca89d-138">异步客户创建模式不会影响 Commerce Headquarters 的性能。</span><span class="sxs-lookup"><span data-stu-id="ca89d-138">The Async customer creation mode doesn't affect the performance of Commerce headquarters.</span></span> <span data-ttu-id="ca89d-139">临时全局唯一标识符 (GUID) 会分配给每个新的异步客户记录，并用作客户帐户 ID。</span><span class="sxs-lookup"><span data-stu-id="ca89d-139">A temporary globally unique identifier (GUID) is assigned to every new Async customer record and used as the customer account ID.</span></span> <span data-ttu-id="ca89d-140">该 GUID 不会显示给 POS 用户。</span><span class="sxs-lookup"><span data-stu-id="ca89d-140">This GUID isn't shown to POS users.</span></span> <span data-ttu-id="ca89d-141">相反，这些用户看到的客户帐户 ID 为 **待同步**。</span><span class="sxs-lookup"><span data-stu-id="ca89d-141">Instead, those users will see **Pending sync** as the customer account ID.</span></span> <span data-ttu-id="ca89d-142">尽管此配置会强制异步创建客户，但是请注意，对客户记录所做的编辑始终会同步完成。</span><span class="sxs-lookup"><span data-stu-id="ca89d-142">Although this configuration forces customers to be created asynchronously, note that edits to customer records are always done synchronously.</span></span>

### <a name="convert-async-customers-to-sync-customers"></a><span data-ttu-id="ca89d-143">将异步客户转换为同步客户</span><span class="sxs-lookup"><span data-stu-id="ca89d-143">Convert Async customers to Sync customers</span></span>

<span data-ttu-id="ca89d-144">要将异步客户转换为同步客户，必须首先运行 P 作业将异步客户发送到 Commerce Headquarters。</span><span class="sxs-lookup"><span data-stu-id="ca89d-144">To convert Async customers to Sync customers, you must first run the P-job to send the Async customers to Commerce headquarters.</span></span> <span data-ttu-id="ca89d-145">然后运行 **从异步模式同步客户和业务合作伙伴** 作业，以创建客户帐户 ID。</span><span class="sxs-lookup"><span data-stu-id="ca89d-145">Then run the **Synchronize customers and business partners from async mode** job to create customer account IDs.</span></span> <span data-ttu-id="ca89d-146">最后，运行 **1010** 作业，以将新客户帐户 ID 同步到渠道。</span><span class="sxs-lookup"><span data-stu-id="ca89d-146">Finally, run the **1010** job to sync the new customer account IDs to the channels.</span></span>

### <a name="async-customer-limitations"></a><span data-ttu-id="ca89d-147">异步客户限制</span><span class="sxs-lookup"><span data-stu-id="ca89d-147">Async customer limitations</span></span>

<span data-ttu-id="ca89d-148">异步客户功能当前具有以下限制：</span><span class="sxs-lookup"><span data-stu-id="ca89d-148">The Async customer functionality currently has the following limitations:</span></span>

- <span data-ttu-id="ca89d-149">除非已在 Commerce Headquarters 中创建了客户，并且新客户帐户 ID 已被重新同步到渠道，否则无法编辑异步客户记录。</span><span class="sxs-lookup"><span data-stu-id="ca89d-149">Async customer records can't be edited unless the customer has been created in Commerce headquarters and the new customer account ID has been synced back to the channel.</span></span>
- <span data-ttu-id="ca89d-150">隶属关系不能与异步客户关联。</span><span class="sxs-lookup"><span data-stu-id="ca89d-150">Affiliations can't be associated with Async customers.</span></span> <span data-ttu-id="ca89d-151">因此，新的异步客户不会继承默认客户的隶属关系。</span><span class="sxs-lookup"><span data-stu-id="ca89d-151">Therefore, new Async customers don't inherit affiliations from the default customer.</span></span>
- <span data-ttu-id="ca89d-152">除非新客户帐户 ID 已被重新同步到渠道，否则不能将会员卡发给异步客户。</span><span class="sxs-lookup"><span data-stu-id="ca89d-152">Loyalty cards can't be issued to Async customers unless the new customer account ID has been synced back to the channel.</span></span>
- <span data-ttu-id="ca89d-153">无法对异步客户捕获备用电子邮件地址和电话号码。</span><span class="sxs-lookup"><span data-stu-id="ca89d-153">Secondary email addresses and phone numbers can't be captured for Async customers.</span></span>

### <a name="customer-creation-in-pos-offline-mode"></a><span data-ttu-id="ca89d-154">在 POS 脱机模式下创建客户</span><span class="sxs-lookup"><span data-stu-id="ca89d-154">Customer creation in POS offline mode</span></span>

<span data-ttu-id="ca89d-155">如果在启用异步客户创建模式时 POS 脱机，则会异步创建新客户记录。</span><span class="sxs-lookup"><span data-stu-id="ca89d-155">If the POS goes offline while the Async customer creation mode is enabled, new customer records are created asynchronously.</span></span> <span data-ttu-id="ca89d-156">如果在禁用异步客户创建模式时 POS 脱机，系统将自动切换到异步客户创建模式。</span><span class="sxs-lookup"><span data-stu-id="ca89d-156">If the POS goes offline while the Async customer creation mode is disabled, the system automatically switches to the Async customer creation mode.</span></span> <span data-ttu-id="ca89d-157">换句话说，即使禁用了异步客户创建模式，也可能会异步创建客户记录。</span><span class="sxs-lookup"><span data-stu-id="ca89d-157">In other words, customer records might be created asynchronously even if the Async customer creation mode is disabled.</span></span> <span data-ttu-id="ca89d-158">因此，Commerce Headquarters 管理员必须为 P 作业、**从异步模式同步客户和业务合作伙伴** 作业和 **1010** 作业创建并计划一个重复执行的批处理作业，以便在 Commerce Headquarters 中将任何异步客户转换为同步客户。</span><span class="sxs-lookup"><span data-stu-id="ca89d-158">Therefore, Commerce headquarters administrators must create and schedule a recurring batch job for the P-job, the **Synchronize customers and business partners from async mode** job, and the **1010** job, so that any Async customers are converted to Sync customers in Commerce headquarters.</span></span>

> [!NOTE]
> <span data-ttu-id="ca89d-159">如果在 **商业渠道架构** 页（**Retail 和 Commerce \> Headquarters 设置 \> 商业调度 \> 渠道数据库组**）上将 **筛选共享的客户数据表** 选项设置为 **是**，则不会在 POS 联机模式下创建客户记录。</span><span class="sxs-lookup"><span data-stu-id="ca89d-159">If the **Filter shared customer data tables** option is set to **Yes** on the **Commerce channel schema** page (**Retail and Commerce \> Headquarters setup \> Commerce scheduler \> Channel database group**), customer records aren't created in POS offline mode.</span></span> <span data-ttu-id="ca89d-160">有关详细信息，请参阅[脱机数据排除](dev-itpro/implementation-considerations-cdx.md#offline-data-exclusion)。</span><span class="sxs-lookup"><span data-stu-id="ca89d-160">For more information, see [Offline data exclusion](dev-itpro/implementation-considerations-cdx.md#offline-data-exclusion).</span></span>

## <a name="additional-resources"></a><span data-ttu-id="ca89d-161">其他资源</span><span class="sxs-lookup"><span data-stu-id="ca89d-161">Additional resources</span></span>

[<span data-ttu-id="ca89d-162">客户属性</span><span class="sxs-lookup"><span data-stu-id="ca89d-162">Customer attributes</span></span>](dev-itpro/customer-attributes.md)

[<span data-ttu-id="ca89d-163">脱机数据排除</span><span class="sxs-lookup"><span data-stu-id="ca89d-163">Offline data exclusion</span></span>](dev-itpro/implementation-considerations-cdx.md#offline-data-exclusion)
