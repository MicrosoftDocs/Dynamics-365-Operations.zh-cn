--- 
title: "修改格式以使用应用程序数据生成单据"
description: "若要完成此过程中的步骤，首先必须完成“ER 使用应用程序数据更新生成单据（第 3 部分 - 修改模型和映射）”这一过程。"
author: NickSelin
manager: AnnBe
ms.date: 06/19/2017
ms.topic: business-process
ms.prod: 
ms.service: dynamics-ax-applications
ms.technology: 
audience: Application User
ms.reviewer: kfend
ms.search.scope: Operations
ms.search.region: Global
ms.author: nselin
ms.search.validFrom: 2016-06-30
ms.dyn365.ops.version: AX 7.0.0
ms.translationtype: HT
ms.sourcegitcommit: a8b5a5af5108744406a3d2fb84d7151baea2481b
ms.openlocfilehash: 6c7455e4293993f297aeede4d9d6a50f25ca6c07
ms.contentlocale: zh-cn
ms.lasthandoff: 04/13/2018

---
# <a name="modify-format-to-generate-documents-with-application-data"></a>修改格式以使用应用程序数据生成单据

[!include [task guide banner](../../includes/task-guide-banner.md)]

若要完成此过程中的步骤，首先必须完成“ER 使用应用程序数据更新生成单据（第 3 部分：修改模型和映射）”这一过程。

此过程中的步骤介绍如何设计电子申报 (ER) 配置以生成电子单据和更新应用程序数据。 在此过程中，您将修改 ER 配置以不仅将其用于生成电子单据，还用于更新应用程序数据。 此过程是为向其分配了系统管理员角色或电子申报开发人员角色的用户创建的。 可使用 DEMF 数据集完成这些步骤。


## <a name="modify-format-to-collect-details-of-reporting"></a>修改格式以收集报告的详细信息
1. 转到“组织管理”>“电子申报”>“配置”。
2. 在树中，展开“内部统计(模型)”。
3. 在树中，选择“内部统计(模型)\内部统计(格式)”。
4. 单击“设计器”。
5. 在树中，展开“文件”。
6. 在树中，展开“文件\申报”。
7. 在树中，选择“文件\申报\数据”。
8. 在“多样性”字段中，选择“一个 多个”。
    * 配置此格式元素以存档内部统计报告流程的详细信息。 此项表示存档的标题记录。  
9. 在树中，展开“文件\申报\数据”。
10. 在树中，选择“文件\申报\数据\物料”。
11. 在“多样性”字段中，选择“零个 多个”。
    * 配置此格式元素以存档内部统计报告流程的详细信息。 此项将表示存档的行的列表。  
12. 在树中，展开“文件\申报\数据\物料”。
13. 在树中，选择“文件\申报\数据\物料\Dim1”。
14. 在“已排除”字段中选择“是”。
    * 您将不存档此数据，所以可从内部统计报告详细信息的数据源排除此格式元素。  
15. 在树中，展开“文件\申报\数据\物料\Dim1”。
16. 在树中，选择“文件\申报\数据\物料\Dim1\属性”。
17. 在“已排除”字段中选择“是”。
18. 在树中，选择“文件\申报\数据\物料\Dim1\日期”。
19. 在“已排除”字段中选择“是”。
20. 在树中，选择“文件\申报\数据\物料\Dim2”。
21. 在“已排除”字段中选择“是”。
22. 在树中，展开“文件\申报\数据\物料\Dim2”。
23. 在树中，选择“文件\申报\数据\物料\Dim2\属性”。
24. 在“已排除”字段中选择“是”。
25. 在树中，选择“文件\申报\数据\物料\Dim2\代码”。
26. 在“已排除”字段中选择“是”。
27. 在树中，选择“文件\申报\数据\物料\Dim3”。
    * 多个格式元素的名称可以相同。 例如，Dim。将此格式用作存档内部统计报告详细信息的数据源时，不能明确识别它们，所以需要为这些格式元素定义备用名称。   
28. 在“名称”字段中，键入“金额”。
    * 本币金额  
29. 在“多样性”字段中，选择“正好一个”。
30. 在树中，选择“文件\申报\数据\物料\Dim4”。
31. 在“名称”字段中，键入“物料”。
    * 项目  
32. 在“多样性”字段中，选择“正好一个”。
    * 除了设计格式元素，还必须存档以下内部统计报告详细信息：报告的各商品物料的唯一记录标识和所生成文件的名称。 因为将不在内部统计报表中填充此数据，所以您需要将与这些详细信息元素有关的格式作为数据源项添加。  
33. 在树中，选择“文件\申报\数据”。
34. 单击“添加”以打开下拉对话框。
35. 在树中，选择“数据源\物料”。
36. 在“名称”字段中，键入“文件名”。
    * 文件名  
37. 在“数据类型”字段中，选择“字符串”。
38. 单击“确定”。
39. 在树中，选择“文件\申报\数据\物料”。
40. 单击“添加物料”。
41. 在“名称”字段中，键入“商品记录标识”。
    * 商品记录标识  
42. 在“数据类型”字段中，选择“Int64”。
43. 单击“确定”。
44. 单击“映射”选项卡。
45. 在树中，选择“文件\申报\数据\文件名”。
46. 单击“绑定”。
47. 在树结构中，展开“模型”。
48. 在树中，展开“模型\交易记录”。
49. 在树中，选择“文件\申报\数据\物料 = model.Transactions\商品记录标识”。
50. 在树结构中，选择“模型\交易记录\商品记录标识”。
51. 单击“绑定”。
52. 单击“保存”。

## <a name="modify-format-to-memorize-details-of-reporting"></a>修改格式以记住报告的详细信息
1. 单击”将格式映射到模型“。
2. 单击“新建”。
3. 在“定义”字段中，输入或选择“用于应用程序数据更新”根项。
    * 对于应用程序数据更新  
4. 在“名称”字段中，键入“映射以更新数据”。
    * 映射以更新数据  
5. 单击“保存”。
    * 此映射定义如何在数据模型（其结构由所选根项“用于应用程序数据更新”指定）中收集内部统计报表的详细信息。 这些详细信息、具有相同根项“用于应用程序数据更新”的模型映射和方向“截止目标”将用于应用程序数据更新。 生成传出内部统计报表之后立即开始执行应用程序数据更新。 请注意，运行时可跳过应用程序数据更新，但是数据模型必须为空（包含空记录列表）。   
6. 单击“设计器”。
    * 请注意，传出内部统计报表格式添加为此模型映射的数据源。  
    * 将设计的报表（表示为数据源）的元素绑定到数据模型（基于所选模型的根项过滤）的元素。  
7. 在树中，展开“存档标题”。
8. 在树中，展开“存档标题\存档行”。
9. 在树中，展开“格式”。
10. 在树中，展开“格式\申报: XML 元素(申报)”。
11. 在树中，展开“格式\申报: XML 元素(申报)\数据: XML 元素 1..* (数据)”。
12. 在树中，展开“格式\申报: XML 元素(申报)\数据: XML 元素 1..* (数据)\物料: XML 元素 0..* (物料)”。
13. 在树中，展开“格式\申报: XML 元素(申报)\数据: XML 元素 1..* (数据)\物料: XML 元素 0..* (物料)\Dim3: XML 元素 1..1 (金额)”。
14. 在树中，展开“格式\申报: XML 元素(申报)\数据: XML 元素 1..* (数据)\物料: XML 元素 0..* (物料)\Dim4: XML 元素 1..1 (物料)”。
15. 在树中，选择“存档标题\行数”。
16. 单击“编辑”。
17. 在树中，选择“列表\COUNT”。
18. 单击“添加”功能。
19. 在树中，展开“格式”。
20. 在树中，展开“格式\申报: XML 元素(申报)”。
21. 在树中，展开“格式\申报: XML 元素(申报)\数据: XML 元素 1..* (数据)”。
22. 在树中，选择“格式\申报: XML 元素(申报)\数据: XML 元素 1..* (数据)\物料: XML 元素 0..* (物料)”。
23. 单击“添加数据源”。
24. 在“公式”字段中，输入“COUNT(format.Declaration.Data.Item)”。
    * COUNT(format.Declaration.Data.Item)  
25. 单击“保存”。
26. 关闭该页面。
27. 在树中，选择“存档标题\文件名”。
28. 在树中，选择“格式\申报: XML 元素(申报)\数据: XML 元素 1..* (数据)\文件名: 物料字符串(文件名)”。
29. 单击“绑定”。
30. 在树中，选择“格式\申报: XML 元素(申报)\数据: XML 元素 1..* (数据)\物料: XML 元素 0..* (物料)\Dim4: XML 元素 1..1 (物料)\编号: 字符串(编号)”。
31. 在树中，选择“存档标题\存档行\物料编号”。
32. 单击“绑定”。
33. 在树中，选择“格式\申报: XML 元素(申报)\数据: XML 元素 1..* (数据)\物料: XML 元素 0..* (物料)\Dim3: XML 元素 1..1 (金额)\值: 实数(值)”。
34. 在树中，选择“存档标题\存档行\金额”。
35. 单击“绑定”。
36. 在树中，选择“格式\申报: XML 元素(申报)\数据: XML 元素 1..* (数据)\物料: XML 元素 0..* (物料)\商品记录标识: 物料 Int64(商品记录标识)”。
37. 在树中，选择“存档标题\存档行\商品记录标识”。
38. 单击“绑定”。
39. 在树中，选择“存档标题\存档行”。
40. 在树中，选择“格式\申报: XML 元素(申报)\数据: XML 元素 1..* (数据)\物料: XML 元素 0..* (物料)”。
41. 单击“绑定”。
42. 在树中，选择“存档标题”。
43. 在树中，选择“格式\申报: XML 元素(申报)\数据: XML 元素 1..* (数据)”。
44. 单击“绑定”。
45. 单击“保存”。
46. 关闭该页面。
47. 关闭该页面。
48. 关闭该页面。


