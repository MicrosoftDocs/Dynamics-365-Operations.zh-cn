---
title: "使用普通日记帐实体导入凭证的最佳实践"
description: "本主题提供使用普通日记帐实体将数据导入到普通日记帐的建议。"
author: twheeloc
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: 
ms.service: dynamics-ax-platform
ms.technology: 
audience: Application User
ms.reviewer: twheeloc
ms.search.scope: Core, Operations
ms.custom: 94363
ms.assetid: 0b8149b5-32c5-4518-9ebd-09c9fd7f4cfc
ms.search.region: Global
ms.author: kweekley
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.translationtype: HT
ms.sourcegitcommit: 2771a31b5a4d418a27de0ebe1945d1fed2d8d6d6
ms.openlocfilehash: 688fa17072cb340d6d02be31528339fb98601825
ms.contentlocale: zh-cn
ms.lasthandoff: 11/03/2017

---

# <a name="best-practices-for-importing-vouchers-using-the-general-journal-entity"></a><span data-ttu-id="368f9-103">使用普通日记帐实体导入凭证的最佳实践</span><span class="sxs-lookup"><span data-stu-id="368f9-103">Best practices for importing vouchers using the General journal entity</span></span>

[!include[banner](../includes/banner.md)]


<span data-ttu-id="368f9-104">本主题提供使用普通日记帐实体将数据导入到普通日记帐的建议。</span><span class="sxs-lookup"><span data-stu-id="368f9-104">This topic provides tips for importing data into the General journal by using the General journal entity.</span></span>  

<span data-ttu-id="368f9-105">您可以使用一般日记帐实体导入类型为**分类帐、客户或银行**的科目或对方科目。</span><span class="sxs-lookup"><span data-stu-id="368f9-105">You can use the General journal entity to import vouchers that have an account or offset account type of **Ledger, Customer, Vendor, or Bank**.</span></span> <span data-ttu-id="368f9-106">凭证可以同时使用**科目**字段和**对方科目**字段输入为一行，也可以输入为多行凭证，这种情况下仅使用**科目**字段（每行中将**对方科目**保留为空。）</span><span class="sxs-lookup"><span data-stu-id="368f9-106">The voucher can be entered as one line, using both the **Account** field and the **Offset account** field, or as a multi-line voucher, where only the **Account** field is used (and the **Offset account** is left blank on each line).</span></span> <span data-ttu-id="368f9-107">普通日记帐实体并非支持每个科目类型。</span><span class="sxs-lookup"><span data-stu-id="368f9-107">The General journal entity doesn't support every account type.</span></span> <span data-ttu-id="368f9-108">相反，其他实体在需要帐户类型的不同组合的情况下存在。</span><span class="sxs-lookup"><span data-stu-id="368f9-108">Instead, other entities exist for scenarios where different combinations of account types are required.</span></span> <span data-ttu-id="368f9-109">例如，要导入项目交易记录，请使用项目费用日记帐实体。</span><span class="sxs-lookup"><span data-stu-id="368f9-109">For example, to import a project transaction, use the Project expense journal entity.</span></span> <span data-ttu-id="368f9-110">每个实体设计为支持特定方案，这意味着这些方案的实体中可能有更多字段，但是在其他方案的实体中则未必。</span><span class="sxs-lookup"><span data-stu-id="368f9-110">Each entity is designed to support specific scenarios, which means additional fields may be available in entities for those scenarios but not in entities for a different scenario.</span></span>

## <a name="setup"></a><span data-ttu-id="368f9-111">设置</span><span class="sxs-lookup"><span data-stu-id="368f9-111">Setup</span></span>
<span data-ttu-id="368f9-112">在使用一般日记帐实体导入之前，请验证以下设置︰</span><span class="sxs-lookup"><span data-stu-id="368f9-112">Before you import by using the General journal entity, validate the following setup:</span></span>

-   <span data-ttu-id="368f9-113">**日记帐批处理号的编号规则设置** – 默认情况下，当您使用一般日记帐实体导入时，日记帐批处理号将使用在总帐参数中定义的编号规则。</span><span class="sxs-lookup"><span data-stu-id="368f9-113">**Number sequence setup for the journal batch number** - By default, when you import by using the General journal entity, the journal batch number uses the number sequence that is defined in the General ledger parameters.</span></span> <span data-ttu-id="368f9-114">对于到日记帐批处理号，如果设置编号规则为**手动**，则不应用默认编号。</span><span class="sxs-lookup"><span data-stu-id="368f9-114">If you set the number sequence for the journal batch number to **Manual**, a default number isn't applied.</span></span> <span data-ttu-id="368f9-115">不支持此设置。</span><span class="sxs-lookup"><span data-stu-id="368f9-115">This setup isn't supported.</span></span>
-   <span data-ttu-id="368f9-116">**财务维度配置** – 当实体用于导入交易记录时，每个组织必须定义财务维度的顺序。</span><span class="sxs-lookup"><span data-stu-id="368f9-116">**Financial dimension configuration** - Every organization must define the order of financial dimensions when entities are used to import transactions.</span></span> <span data-ttu-id="368f9-117">为**分类帐维度集成**格式定义顺序，在**总帐** &gt; **会计科目表** &gt; **维度** &gt; **用于集成应用程序的财务维度配置**&gt; **选择数据实体**。</span><span class="sxs-lookup"><span data-stu-id="368f9-117">The order is defined for the **Ledger dimensions integration** format, at **General ledger** &gt; **Chart of accounts** &gt; **Dimensions** &gt; **Financial dimension configuration for integrating applications** &gt; **Select data entities**.</span></span> <span data-ttu-id="368f9-118">导入的会计科目的段必须具有相同的顺序。</span><span class="sxs-lookup"><span data-stu-id="368f9-118">The segments of the ledger account that is imported must have the same order.</span></span> <span data-ttu-id="368f9-119">否则，导入过程中将发生错误。</span><span class="sxs-lookup"><span data-stu-id="368f9-119">Otherwise, an error will occur during import.</span></span>

## <a name="general-journal-entity-setup"></a><span data-ttu-id="368f9-120">普通日记帐实体设置</span><span class="sxs-lookup"><span data-stu-id="368f9-120">General journal entity setup</span></span>
<span data-ttu-id="368f9-121">数据管理的两个设置影响如何应用默认日记帐批处理号或凭证号︰</span><span class="sxs-lookup"><span data-stu-id="368f9-121">Two settings in Data management affect how the default journal batch number or voucher number is applied:</span></span>

-   <span data-ttu-id="368f9-122">**基于集的处理**（在数据实体上）</span><span class="sxs-lookup"><span data-stu-id="368f9-122">**Set-based processing** (on the data entity)</span></span>
-   <span data-ttu-id="368f9-123">**自动生成**（在字段映射时）)</span><span class="sxs-lookup"><span data-stu-id="368f9-123">**Auto-generated** (on the field mapping)</span></span>

<span data-ttu-id="368f9-124">以下各部分描述了这些设置的效果，还介绍了如何生成日记帐批处理号和凭证号。</span><span class="sxs-lookup"><span data-stu-id="368f9-124">The following sections describe the effect of these settings, and also explain how journal batch numbers and voucher numbers are generated.</span></span>

### <a name="journal-batch-number"></a><span data-ttu-id="368f9-125">日记帐批处理号</span><span class="sxs-lookup"><span data-stu-id="368f9-125">Journal batch number</span></span>

-   <span data-ttu-id="368f9-126">在普通日记帐实体上设置的**基于集的处理**不会影响生成日记帐批处理号的方式。</span><span class="sxs-lookup"><span data-stu-id="368f9-126">The **Set-based processing** setting on the General journal entity doesn't affect the way that journal batch numbers are generated.</span></span>
-   <span data-ttu-id="368f9-127">如果**日记帐批处理号**字段设置为**自动生成**，则为导入的每一行创建新的日记帐批处理号。</span><span class="sxs-lookup"><span data-stu-id="368f9-127">If the **Journal batch number** field is set to **Auto-generated**, a new journal batch number is created for every line that is imported.</span></span> <span data-ttu-id="368f9-128">不建议此行为。</span><span class="sxs-lookup"><span data-stu-id="368f9-128">This behavior isn't recommended.</span></span> <span data-ttu-id="368f9-129">**自动生成**设置在导入项目中，在**查看地图**下，**映射详细信息**选项卡上。</span><span class="sxs-lookup"><span data-stu-id="368f9-129">The **Auto-generated** setting is found on the import project, under **View map**, on the **Mapping details** tab.</span></span>
-   <span data-ttu-id="368f9-130">如果**日记帐批处理号**字段未设置为**自动生成**，则按如下方式创建日记帐批处理号：</span><span class="sxs-lookup"><span data-stu-id="368f9-130">If the **Journal batch number** field isn't set to **Auto-generated**, the journal batch number is created as follows:</span></span>
    -   <span data-ttu-id="368f9-131">如果在导入文件中定义的日记帐批处理号匹配现有的未过帐的每日日记帐，具有匹配日记帐批处理号的所有行导入到现有日记帐。</span><span class="sxs-lookup"><span data-stu-id="368f9-131">If the journal batch number that is defined in the imported file matches an existing, unposted daily journal, all lines that have a matching journal batch number are imported into the existing journal.</span></span> <span data-ttu-id="368f9-132">行不会导入已过帐的日记帐批处理号。</span><span class="sxs-lookup"><span data-stu-id="368f9-132">Lines are never imported into a posted journal batch number.</span></span> <span data-ttu-id="368f9-133">相反，将创建新编号。</span><span class="sxs-lookup"><span data-stu-id="368f9-133">Instead, a new number is created.</span></span>
    -   <span data-ttu-id="368f9-134">如果在导入文件中定义的日记帐批处理号不匹配现有的未过帐的每日日记帐，相同日记帐批处理号将在新日记帐下分组。</span><span class="sxs-lookup"><span data-stu-id="368f9-134">If the journal batch number that is defined in the imported file doesn't match an existing, unposted daily journal, all lines that have the same journal batch number are grouped under a new journal.</span></span> <span data-ttu-id="368f9-135">例如，有 1 日记帐批处理号的所有行都导都入到某一新日记帐，并且日记帐批处理号为 2 的所有行都导入到第二个新的日记帐。</span><span class="sxs-lookup"><span data-stu-id="368f9-135">For example, all lines that have a journal batch number of 1 are imported into a new journal, and all lines that have a journal batch number of 2 are imported into a second new journal.</span></span> <span data-ttu-id="368f9-136">通过使用在总帐参数中定义的编号规则创建日记帐批处理号。</span><span class="sxs-lookup"><span data-stu-id="368f9-136">The journal batch number is created by using the number sequence that is defined in the General ledger parameters.</span></span>

### <a name="voucher-number"></a><span data-ttu-id="368f9-137">凭证号</span><span class="sxs-lookup"><span data-stu-id="368f9-137">Voucher number</span></span>

-   <span data-ttu-id="368f9-138">当您在普通日记帐实体中使用**基于集的处理**设置时，凭证号必须在导入的文件中提供。</span><span class="sxs-lookup"><span data-stu-id="368f9-138">When you use the **Set-based processing** setting on the General journal entity, the voucher number must be provided in the imported file.</span></span> <span data-ttu-id="368f9-139">普通日记帐中的每个交易记录被分配在导入文件中提供的凭证编号，即使凭证不均衡。</span><span class="sxs-lookup"><span data-stu-id="368f9-139">Every transaction in the General journal is assigned the voucher number that is provided in the imported file, even if the voucher isn’t balanced.</span></span> <span data-ttu-id="368f9-140">如果您想要使用基于集的处理，但还需要使用为凭证号定义的编号规则，则为 2016 年 2 月版本提供修复程序。</span><span class="sxs-lookup"><span data-stu-id="368f9-140">If you want to use set-based processing, but you also want to use the number sequence that is defined for voucher numbers, a hotfix has been provided for the February 2016 release.</span></span> <span data-ttu-id="368f9-141">修补程序编号为 3170316，可从 Lifecycle services (LCS) 下载。</span><span class="sxs-lookup"><span data-stu-id="368f9-141">The hotfix number is 3170316 and available for download from Lifecycle services (LCS).</span></span> <span data-ttu-id="368f9-142">有关详细信息，请参阅[从 Lifecycle Services 下载修补程序](..\migration-upgrade\download-hotfix-lcs.md)。</span><span class="sxs-lookup"><span data-stu-id="368f9-142">For more information, see [Download hotfixes from Lifecycle Services](..\migration-upgrade\download-hotfix-lcs.md).</span></span>
    -   <span data-ttu-id="368f9-143">若要启用此功能，在用于导入的日记帐名称中，将**过帐时分配编号**设置为**是**。</span><span class="sxs-lookup"><span data-stu-id="368f9-143">To enable this functionality, on the journal name that is used for imports, set **Number allocation at posting** to **Yes**.</span></span>
    -   <span data-ttu-id="368f9-144">仍然必须在导入文件中定义一个凭证号。</span><span class="sxs-lookup"><span data-stu-id="368f9-144">A voucher number must still be defined in the imported file.</span></span> <span data-ttu-id="368f9-145">但是，此数字是临时的并在过帐日记帐时由凭证号覆盖。</span><span class="sxs-lookup"><span data-stu-id="368f9-145">However, this number is temporary and is overwritten by the voucher number when the journal is posted.</span></span> <span data-ttu-id="368f9-146">您必须确保日记帐的各行按临时凭证号进行正确分组。</span><span class="sxs-lookup"><span data-stu-id="368f9-146">You must make sure that the lines of the journal are grouped correctly by temporary voucher number.</span></span> <span data-ttu-id="368f9-147">例如，在过帐期间，发现三行具有临时凭证号 1。</span><span class="sxs-lookup"><span data-stu-id="368f9-147">For example, during posting, three lines are found that have a temporary voucher number of 1.</span></span> <span data-ttu-id="368f9-148">所有三个行的临时凭证号由编号规则中的下一个编号覆盖。</span><span class="sxs-lookup"><span data-stu-id="368f9-148">The temporary voucher number of all three lines is overwritten by the next number in the number sequence.</span></span> <span data-ttu-id="368f9-149">如果这三行不是平衡条目，将不过帐凭证。</span><span class="sxs-lookup"><span data-stu-id="368f9-149">If those three lines aren’t a balanced entry, the voucher isn't posted.</span></span> <span data-ttu-id="368f9-150">接下来，如果找到具有临时凭证号 2 的行，这个数字将由编号规则中的下个凭证号覆盖，依此类推。</span><span class="sxs-lookup"><span data-stu-id="368f9-150">Next, if lines are found that have a temporary voucher number of 2, this number is overwritten by the next voucher number in the number sequence, and so on.</span></span>

<!-- -->

-   <span data-ttu-id="368f9-151">当您不使用**基于集的处理**设置时，无需在导入的文件中提供凭证号。</span><span class="sxs-lookup"><span data-stu-id="368f9-151">When you don't use the **Set-based processing** setting, you do not need to provide a voucher number in the imported file.</span></span> <span data-ttu-id="368f9-152">在基于日记帐名称的设置导入过程中创建凭证号（**仅一个凭证**，**与余额有关联**等）。</span><span class="sxs-lookup"><span data-stu-id="368f9-152">The voucher numbers are created during import, based on the setup of the journal name (**One voucher only**, **In connection of balance**, and so on).</span></span> <span data-ttu-id="368f9-153">例如，如果日记帐名称定义为**与余额有关联**，第一行接收新的默认凭证号。</span><span class="sxs-lookup"><span data-stu-id="368f9-153">For example, if the journal name is defined as **In connection of balance**, the first line receives a new default voucher number.</span></span> <span data-ttu-id="368f9-154">然后，系统评估行以确定借方是否等于贷方。</span><span class="sxs-lookup"><span data-stu-id="368f9-154">The system then evaluates the line to determine whether the debits equal the credits.</span></span> <span data-ttu-id="368f9-155">如果行上存在对方科目，导入的下一行接收新的凭证号。</span><span class="sxs-lookup"><span data-stu-id="368f9-155">If an offset account exists on the line, the next line that is imported receives a new voucher number.</span></span> <span data-ttu-id="368f9-156">如果对方科目不存在，系统会评估借方是否等于贷方，因为将导入每个新行。</span><span class="sxs-lookup"><span data-stu-id="368f9-156">If no offset account exists, the system evaluates whether the debits equal the credits as each new line is imported.</span></span>
-   <span data-ttu-id="368f9-157">如果**凭证号**字段设置为**自动生成**，导入将不会成功。</span><span class="sxs-lookup"><span data-stu-id="368f9-157">If the **Voucher number** field is set to **Auto-generated**, the import won't succeed.</span></span> <span data-ttu-id="368f9-158">**凭证号**字段的**自动生成**设置不受支持。</span><span class="sxs-lookup"><span data-stu-id="368f9-158">The **Auto-generated** setting for the **Voucher number** field isn't supported.</span></span>

<span data-ttu-id="368f9-159">默认情况下，普通日记帐实体使用基于集的处理。</span><span class="sxs-lookup"><span data-stu-id="368f9-159">By default, the General journal entity uses set-based processing.</span></span> <span data-ttu-id="368f9-160">评估您的组织的业务需求之后，您可以通过单击**数据管理**工作区的**数据实体**更改**基于集的处理**设置。</span><span class="sxs-lookup"><span data-stu-id="368f9-160">After you evaluate the business requirements for your organization, you can change the **Set-based processing** setting by clicking **Data entities** in the **Data management** workspace.</span></span> <span data-ttu-id="368f9-161">基于集的处理用于加快导入流程。</span><span class="sxs-lookup"><span data-stu-id="368f9-161">Set-based processing is used to speed up the import process.</span></span> <span data-ttu-id="368f9-162">如果不使用基于集的处理，普通日记帐实体导入的导入将变慢。</span><span class="sxs-lookup"><span data-stu-id="368f9-162">If you don't use set-based processing, import of the General journal entity import will be slower.</span></span>




