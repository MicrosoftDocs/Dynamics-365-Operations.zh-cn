---
title: 编辑和审计零售商店交易记录
description: 本主题将介绍用于编辑和审计零售商店交易记录的功能。
author: josaw1
manager: AnnBe
ms.date: 10/14/2019
ms.topic: index-page
ms.prod: ''
ms.service: dynamics-365-retail
ms.technology: ''
audience: Application User
ms.reviewer: josaw
ms.search.scope: Core, Operations, Retail
ms.custom: ''
ms.assetid: ed0f77f7-3609-4330-bebd-ca3134575216
ms.search.region: global
ms.search.industry: Retail
ms.author: josaw
ms.search.validFrom: 2019-09-29
ms.dyn365.ops.version: ''
ms.openlocfilehash: b0201d31cd83b4360f96a7d8e2113caf9d913715
ms.sourcegitcommit: 0262a19e32b2c0c84c731d9f4fbe8ba91822afa3
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/15/2019
ms.locfileid: "2622519"
---
# <a name="edit-and-audit-retail-store-transactions"></a>编辑和审计零售商店交易记录

[!include [banner](includes/banner.md)]

[!include [banner](includes/preview-banner.md)]

Dynamics 365 Retail 客户使用第一方和第三方销售点 (POS) 应用程序。 借助第一方 POS 应用程序，可以通过批处理将渠道中的零售商店交易记录导入到 Retail Headquarters。 借助第三方应用程序，可以通过集成将交易记录导入到 Retail Headquarters。 在这两种情况下，将交易记录导入 Retail Headquarters 中之后，都需要执行一致性检查过程，该过程对交易记录执行多个验证，以便仅成功通过验证的交易记录将导入到要在 Retail Headquarters 中进行过帐的对帐单中。 

零售交易记录会由于各种原因而验证失败。 例如，集成代码中的 Bug 或 POS 应用程序中的 Bug 可能会导致数据不一致，用户错误（例如在将产品同步到渠道之后删除该产品，或者对会计期间结帐而不过帐该期间的零售交易记录）也会导致数据不一致。

虽然这些交易记录会被标记并从对帐单中排除，但是它们会中断客户将每日零售销售过帐到财务的每日流程。

在 Retail 中，可以编辑验证失败的特定零售交易记录，同时保持对所有更改的审计。 

## <a name="edit-and-audit-transactions"></a>编辑和审计交易记录

在 Retail 版本 10.0.5 中，现金和结转交易记录（例如销售和退货）是唯一可以编辑的交易记录。 不支持编辑客户订单或在线订单。 在 Retail 版本 10.0.6 及更高版本中，还支持编辑现金管理交易记录。

1. 安装 Dynamics Excel 加载项。

2. 转至**零售商店财务**工作区。 **交易记录验证失败**磁贴提供在一个或多个规则中验证失败的零售交易记录窗体的预筛选视图。
 
3. 打开该窗体。 单击验证失败的记录，然后依次单击 **Office 加载项**、**编辑所选交易记录**。 随即打开包含所选交易记录详细信息的一个 Excel 文件，其中包含以下工作表：

    - 行：此工作表包含该交易记录的标头、产品行和相关数据。
    - 付款：此工作表包含该交易记录的付款行的详细信息。
    - 折扣：此工作表包含该交易记录的折扣相关详细信息。
    - 纳税：此工作表包含该交易记录的纳税相关详细信息。
    - 费用：此工作表包含该交易记录的费用相关数据。

4. 在 Excel 文件中，修改相应的字段，然后使用 Dynamics Excel 加载项发布功能将数据重新上载到 Retail Headquarters。 发布后，所做的更改将反映在系统中。 在发布期间，将不会对用户所做的更改进行验证。

5. 通过单击标头级别更改的**零售交易记录**标头中的**查看审计线索**以及在相应交易记录页面的相关部分和记录中，可以查看所做更改的完整审计线索。 例如，与销售行相关的所有更改将在**销售交易记录**页面上可见，与付款相关的更改将在**付款交易记录**页面上可见等等。针对更改而维护的审计详细信息如下。

   - 修改日期和时间
   - 字段 
   - 原值
   - 新值
   - 修改者

6. 在做出更改并发布后，请再次运行**验证商店交易记录**选项，以验证所做的更改是否一致和有效。

> [!NOTE]
> 只能编辑验证失败的交易记录。 如果要编辑通过验证的交易记录，请将要更改的交易记录的验证状态更改为**错误**或者**无**，之后您便可以编辑该交易记录。 


## <a name="bulk-edit-transactions"></a>批量编辑交易记录

在 Retail 版本 10.0.6 及更高版本中，支持在对帐单级别对零售交易记录进行批量编辑的选项。 

1. 使用 Excel 加载项打开包含您要按照上述 1-3 步修改的交易记录的对帐单。

2. 选择以下选项之一。

    - **编辑现金和结转交易记录**。 通过此选项可以编辑对帐单中包括的所有现金和结转交易记录。 提供了以下 Excel 工作表。
    
       - **交易记录**：此工作表包含销售交易记录的所有标头级别信息。
       - **销售交易记录**：此工作表包含销售交易记录的所有行级别信息。
       - **付款交易记录**：此工作表包含销售交易记录的所有付款行信息。
       - **折扣交易记录**：此工作表包含销售交易记录的所有折扣行信息。
       - **纳税交易记录**：此工作表包含销售交易记录的所有纳税行信息。
       - **费用交易记录**：此工作表包含销售交易记录的所有费用行信息。

    - **编辑现金管理交易记录**。 通过此选项可以编辑对帐单中包括的所有现金管理交易记录。 提供了以下 Excel 工作表。
     
       - **交易记录**：此工作表包含现金管理交易记录的所有标头级别信息。
       - **存款支付交易记录**：此工作表包含所有银行投箱交易记录详细信息。
       - **金库支付交易记录**：此工作表包含所有金库投箱交易记录详细信息。
       - **钱币清点**：此工作表包含所有钱币清点交易记录详细信息。
       - **收入-支出交易记录**：此工作表包含所有收入-支出交易记录行详细信息。
       - **付款交易记录**：此工作表包含**付款发票**操作以及收入-支出交易记录的所有付款相关信息。

3.  发布批量编辑的交易记录时，将不会执行验证。 您必须确保您的所有编辑都是准确的，并在工作表之间保持数据的真实度。 例如，如果想要更改交易记录日期，以管理结帐未结零售交易记录的会计或库存期间的方案，则您需要更改具有**业务日期**列的所有 Excel 工作表的日期。 若要在编辑交易记录之后对其进行验证，可以使用**零售对帐单**页面上的**重新验证交易记录**。
