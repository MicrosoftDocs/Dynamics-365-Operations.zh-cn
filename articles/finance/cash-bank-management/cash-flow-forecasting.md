---
title: 现金流量预测
description: 本文提供现金流量预测流程的概览。 它还介绍了现金流量预测如何与系统中的其他模块集成。
author: angelad116
ms.date: 02/16/2022
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: LedgerCovParameters
audience: Application User
ms.reviewer: kfend
ms.search.region: Global
ms.author: angelading
ms.search.validFrom: 2017-06-30
ms.dyn365.ops.version: July 2017 update
ms.openlocfilehash: d76e47fc1456dfab7606f337f070a149b0c8e586
ms.sourcegitcommit: 0b7a034e644f4d93fe55c7baca5a3f89dbe56898
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/14/2022
ms.locfileid: "9151931"
---
# <a name="cash-flow-forecasting"></a>现金流量预测

[!include [banner](../includes/banner.md)]
[!include [preview banner](../includes/preview-banner.md)]

您可以使用现金流量预测工具分析即将发生的现金流量和币种要求，因此可以估计公司对现金的未来需求。 要获取现金流量的预测，您必须完成以下任务：

- 标识并列出所有流动性科目。 流动性科目是现金或现金等价物的公司帐户。
- 配置影响公司的流动性科目的交易记录预测行为。

完成这些任务之后，您可以计算和分析现金流量和即将发生的币种要求的预测。

## <a name="cash-flow-forecasting-integration"></a>现金流量预测集成

现金流量预测可与总帐、应付帐款、应收帐款、预算和库存管理集成。 预测流程使用在系统中输入的交易记录信息，而计算流程预测各个交易记录的预期现金影响。 在计算现金流量时考虑以下类型的交易记录：

- **销售订单** - 尚未开票且导致实际销售或财务销售的销售订单。
- **普通发票** – 尚未开票且导致实际销售的普通发票。 
- **采购订单** - 尚未开票且导致实际采购或财务采购的采购订单。
- **应收帐款** - 未结客户交易记录（尚未付款的发票）。
- **应付帐款** - 未结供应商交易记录（尚未付款的发票）。
- **分类帐交易记录** –指定未来将发生过帐的交易记录。
- **预算登记分录** –为现金流量预测选择的预算登记分录。
- **需求预测** –为现金流量预测选择的库存预测模型行。
- **供应预测** –为现金流量预测选择的库存预测模型行。
- **外部数据源** - 使用电子表格模板输入或导入到现金流预测中的外部数据。
- **项目预测** - 使用预测模型进行项目管理和会计预测。
- **现金流量销售税机构付款** - 导致财务付款的所预测销售税机构付款金额和时间安排。 启用现金流销售税机构付款功能。

## <a name="configuration"></a>配置

要配置现金流量预测流程，请使用 **现金流量预测设置** 页。 在此页上，您指定要跟踪的流动性科目和各区域的默认预测行为。

### <a name="general-ledger"></a>总帐

您必须先定义要通过现金流量预测跟踪的流动性科目。 通常，这些流动性科目是与将要收到和支出现金的银行帐户相关联的主科目。 在 **现金流量预测设置** 页上的 **总帐** 选项卡上，选择预测要包含的主科目。 如果银行帐户已与 **银行帐户** 页上的主科目相关联，它将在 **银行帐户** 字段中显示。

对于包含与其他主科目中的交易记录直接相关的交易记录的主科目，您可为其设置相关的现金流量预测。 您在 **在相关科目中** 部分添加的各行在相关的主科目中创建一个现金流量预测金额。 此金额是现金流量金额占您选择的主要主科目的百分比。

首先，将 **主科目** 字段设置为希望首先发生交易记录的主要主科目。 将 **相关的主科目** 字段设置为将受主要主科目初始交易记录影响的科目。 为行上的其他字段设置适当的值。 您可以更改 **百分比** 字段中的值以反映主要主科目对相关主科目的影响。 对于销售或采购预测，选择适用于大多数客户或供应商的典型的 **付款期限** 值。 将 **过帐类型** 字段设置为与现金流量预测相关的预期过帐类型。

### <a name="accounts-payable"></a>应付帐款

您可以使用 **现金流量预测设置** 页的 **应付帐款** 选项卡上的设置选项计算采购预测。 您可以为应付帐款配置现金流量预测前，必须配置付款期限、供应商组和供应商过帐模板。

在 **采购预测默认值** 部分，可以为现金流量预测选择默认采购行为。 三个字段确定现金影响的时间：**交货日期和发票日期之间的时间**、**付款期限** 和 **发票到期日期和付款日期之间的时间**。 如果交易记录中未指定值，预测将仅使用 **付款期限** 字段的默认设置。 使用付款期限描述流程各部分最典型的天数。

**付款的流动性科目** 字段指定付款最常用的流动性科目。 使用 **要分配到现金流量预测的金额百分比** 字段指定是否应在预测期间使用金额百分比。 如果应在预测期间使用完整交易记录金额，则将此字段留空。

您可以覆盖特定供应商组的 **发票到期日期与付款日期之间的时间** 字段的默认设置。 预测将使用来自 **采购预测默认值** 部分的默认值，除非为与交易记录上的供应商关联的供应商组指定不同的值。 要覆盖默认值，请选择供应商组，然后为 **采购时间** 字段设置新值。

您可以覆盖用于特定供应商过帐模板的 **流动性科目** 字段的默认设置。 预测将使用来自 **采购预测默认值** 部分的默认值，除非为与交易记录上的供应商关联的过帐模板指定不同的流动性科目。 要覆盖默认值，请选择过帐模板，然后指定预计将受影响的流动性科目。

### <a name="accounts-receivable"></a>应收帐款

您可以使用 **现金流量预测设置** 页的 **应收帐款** 选项卡上的设置选项计算销售预测。 您可以为应收帐款配置现金流量预测前，必须配置付款期限、客户组和客户过帐模板。

在 **销售预测默认值** 部分，可以为现金流量预测选择默认销售行为。 三个字段确定现金影响的时间：**发货日期和发票日期之间的时间**、**付款期限** 和 **发票到期日期和付款日期之间的时间**。 如果交易记录中未指定值，预测将仅使用 **付款期限** 字段的默认设置。 使用付款期限描述流程各部分最典型的天数。 

**付款的流动性科目** 字段指定付款最常用的流动性科目。 使用 **要分配到现金流量预测的金额百分比** 字段指定是否应在预测期间使用金额百分比。 如果应在预测期间使用完整交易记录金额，则将此字段留空。

您可以覆盖特定客户组的 **发票到期日期与付款日期之间的时间** 字段的默认设置。 预测将使用来自 **销售预测默认值** 部分的默认值，除非为与交易记录上的客户关联的客户组指定不同的值。 要覆盖默认值，请选择客户组，然后为 **销售时间** 字段设置新值。

您可以覆盖用于特定客户过帐模板的 **流动性科目** 字段的默认设置。 预测将使用来自 **销售预测默认值** 部分的默认值，除非为与交易记录上的客户关联的过帐模板指定不同的流动性科目。 要覆盖默认值，请选择过帐模板，然后设置预计将受影响的流动性科目。

### <a name="budgeting"></a>预算编制

现金流量预测中可以包括从预算模型创建的预算。 在 **现金流量预测设置** 页的 **预算** 选项卡上，选择要包括在预测中的预算模型。 默认情况下，为现金流量预测启用预算模型后，在预测中包括新预算登记分录。

预算登记条目可以通过个性化操作单独包含在现金流量预测中。 当您将“包含在现金流量预测中”列添加到 **预算登记条目** 页时，系统将覆盖 **现金流量预测设置** 页面上的设置，以便在预测中包括单个预算登记条目。


### <a name="inventory-management"></a>库存管理

现金流量预测中可以包括库存供应和需求预测。 在 **现金流量预测设置** 页的 **库存管理** 选项卡上，选择要包括在现金流量预测中的预测模型。 可以在各个供应和需求预测行上覆盖包括在现金流量预测中。

### <a name="setting-up-dimensions-for-cash-flow-forecasting"></a>设置现金流预测的维度
 **现金流预测设置** 页上的一个新选项卡可让您控制将使用哪些财务维度在 **现金流预测** 工作区中进行筛选。 仅当启用现金流预测功能后，此选项卡才会出现。

在 **维度** 选项卡上，从要用于筛选的维度列表中进行选择，然后使用箭头键将其移至右侧列。 只能选择两个维度来筛选现金流预测数据。 

### <a name="setting-up-external-source"></a>设置外部源
配置 Finance Insights 后，可以将外部数据输入或导入到现金流预测中。 在输入或导入外部数据之前，必须设置外部源。 在 **外部源** 选项卡上，设置外部现金流类别。 类别可以是 **传出** 或 **传入**。 应选择 **流动性** 作为过帐类型。 在 **法人设置** 网格中，选择外部现金流类别适用的法人和相应的主科目。

有关详细信息，请参阅[现金流预测中的外部数据](../../finance/finance-insights/external-data-in-cash-flow.md)。 

### <a name="project-management-and-accounting"></a>项目管理与核算

在版本 10.0.17 中，新功能允许集成项目管理和会计与现金流量预测。 在 **功能管理** 工作区中，打开 **现金流量项目预测** 功能以在现金流量预测中包括预测的成本和收入。 在 **现金流量预测设置** 页面的 **项目管理和会计** 选项卡上，选择应包括在现金流量预测中的项目类型和交易类型。 然后，选择项目预测模型。 缩减类型子模型最有效。 在“应收帐款”设置中输入的流动性科目用作默认流动性科目。 因此，在设置现金流量预测时，您不必输入默认的流动性科目。 也可以使用预算模型，但仅可以在项目管理和会计的 **现金流量预测设置** 页面上选择一种类型。 当使用项目管理和会计或 Project Operations 时，预测模型提供最大的灵活性。

打开现金流量项目预测后，可以在 **所有项目** 页面上查看每个项目的现金流量预测。 在操作窗格上，在 **计划** 选项卡上的 **预测** 组中，选择 **现金流量预测**。 在 **现金概览** 工作区中（请参阅本文后面的[报告](#reporting)一节），项目预测交易类型显示流入量（项目预测收入）和流出量（项目预测成本）。 仅在 **现金概览** 工作区中的 **项目阶段** 字段设置为 **进行中** 时才包括金额。

项目交易仍通过几种方式包括在现金流量预测中，无论是否已打开 **现金流量项目预测** 功能。 已过帐的项目发票作为未结客户交易记录的一部分包括在预测中。 项目启动的销售订单和采购订单在系统中输入后作为未结订单包括在预测中。 您还可以将项目预测转移到分类帐预算模型。 此分类帐预算模型再作为预算登记分录的一部分包括在现金流量预测中。 如果已打开 **现金流量项目预测** 功能，请勿将项目预测转移到分类帐预算模型，因为此操作将导致项目预测计数两次。

### <a name="sales-tax-authority-payments"></a>销售税机构付款 

现金流销售税机构付款功能可预测销售税付款对现金流的影响。 它使用未付款的销售税交易、税务结算期间和纳税期间付款期限来预测现金流付款的日期和金额。 

### <a name="calculation"></a>计算

在可以查看现金流量预测分析前，您必须运行现金流量计算流程。 计算流程将预测已经输入的交易记录的未来现金影响。

使用 **计算现金流量预测** 页计算现金流量预测。 您可以计算完整现金流量预测或递增现金流量预测。 

- 要清除所有现金流量预测交易记录并重新计算，将 **现金流量预测计算方法** 字段设置为 **总计**。 如果您长时间未更新现金流量预测，我们建议您使用此方法。 
- 若要仅更新新交易记录的现有现金流量信息，将 **现金流量预测计算方法** 字段设置为 **新**。 此页将显示上次运行现金流量计算的日期。

您还可以为您的现金流量预测使用批处理。 为了帮助确保定期更新您的预测分析，为现金流量预测计算设置重复执行的批处理。

在版本 10.0.13 中，发布了计算流程的增强功能，可以使用流程自动化框架来计划现金流计算作业。 可使用 **功能管理** 工作区中的 **现金流预测自动化** 功能启用此增强功能。 启用后，选择 **现金流预测自动化** 链接可以显示新的自动化页面，您可以在其中计划现金流计算流程。 要创建新的现金流预测计划，请选择 **创建新流程自动化**，然后在 **计划类型** 下拉菜单中选择 **现金流预测自动化**。 您必须为要为其更新现金流预测数据的每个公司设置计划。  此页面还显示哪些现金流预测自动化作业正在等待处理，以及最后一个作业在何时完成。  

> [!NOTE] 
> 如果已经为现金流预测计划了现有批处理作业，则会收到错误消息，您将无法启用此功能。 要启用此功能，需要先清除现有的批处理作业。 

有关详细信息，请参阅[流程自动化](../../fin-ops-core/dev-itpro/sysadmin/process-automation.md)。

### <a name="reporting"></a>申报

计算现金流量预测后，您必须刷新用于分析报告的关联实体信息。 在 **实体商店** 页，选择 **LedgerCovLiquidityMeasurement 合计** 度量，然后单击 **刷新**。

有两个工作区包含现金流量预测数据。 一个工作区包含所有公司的数据，另一个工作区仅包含当前公司的数据。

对所有公司工作区的访问权限通过 **查看现金流量 - 所有公司工作区** 责任进行控制。 默认情况下，**现金概览–所有公司** 工作区适用于以下角色：

- 首席执行官
- 首席财务官
- 财务总监

对当前公司工作区的访问权限通过 **查看现金流量 - 当前公司** 工作区责任进行控制。 默认情况下，**现金概览–当前公司** 工作区适用于以下角色：

- 会计师
- 会计经理
- 会计主管
- 应付帐款经理
- 应收帐款经理

**现金概览–所有公司** 工作区显示系统币种的现金流量预测分析。 用于分析的系统币种和系统汇率类型在 **系统参数** 页上进行定义。 此工作区显示所有公司的现金流量预测和银行帐户余额概览。 现金流入和流出图表提供未来现金移动和系统币种的余额的概览，以及关于预测交易记录的详细信息。 您还可以看到预测币种余额。

**现金概览 – 当前公司** 工作区以公司定义的会计币种显示现金流量预测分析。 用于分析的记帐币种在 **分类帐** 页上进行定义。 此工作区显示当前公司的现金流量预测和银行帐户余额概览。 现金流入和流出图表提供未来现金移动和记帐币种的余额的概览，以及关于预测交易记录的详细信息。 您还可以看到预测币种余额。

有关现金流量预测分析的详细信息，请参阅[现金概览 Power BI 内容](Cash-Overview-Power-BI-content.md)。

此外，您还可以在以下页面上查看特定帐户、订单和物料的现金流量预测数据：

- **试算平衡表**：选择 **现金流量预测** 可查看所选主科目的未来现金流量。
- **所有销售订单**：在 **发票** 选项卡上，选择 **现金流量预测** 可查看所选销售订单的预测现金影响。
- **所有采购订单**：在 **发票** 选项卡上，选择 **现金流量预测** 可查看所选采购订单的预测现金影响。
- **供应预测**：选择 **现金流量预测** 可查看与所选物料供应关联的未来现金流量预测。
- **需求预测**：选择 **现金流量预测** 可查看与所选物料需求关联的未来现金流量预测。



[!INCLUDE[footer-include](../../includes/footer-banner.md)]
