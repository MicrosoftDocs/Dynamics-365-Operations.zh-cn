---
title: 定期合同计费中的定期任务
description: 本文介绍了定期合同计费中可用的定期任务。
author: JodiChristiansen
ms.date: 04/29/2022
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ''
audience: Application User
ms.reviewer: twheeloc
ms.search.scope: Core, Operations
ms.custom: 539093
ms.search.region: Global
ms.author: jchrist
ms.search.validFrom: 2021-11-05
ms.dyn365.ops.version: 10.0.24
ms.openlocfilehash: d834d1d7aa34448b4ef21606974538eb294b5d7d
ms.sourcegitcommit: 52b7225350daa29b1263d8e29c54ac9e20bcca70
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 06/03/2022
ms.locfileid: "8904779"
---
# <a name="periodic-tasks-in-recurring-contract-billing"></a>定期合同计费中的定期任务

本文介绍了定期合同计费中可用的定期任务。

## <a name="generate-invoice"></a>生成发票

使用 **生成发票** 页面，根据您在 **所有计费计划** 和 **查看计费详细信息** 页面上设置的信息创建批量每月经常性发票。 创建发票后，将使用已开票的计划行的物料描述和计费开始日期和结束日期更新销售订单处理行的物料描述。

## <a name="generate-invoice-batch-processing"></a>生成发票批处理

使用 **生成发票批处理** 页面通过定期批处理流程创建经常性发票。 可用的参数与 **生成发票** 页面上的参数相同，但可以在可多次运行的批处理中保存可用的参数。

## <a name="price-update"></a>价格更新

使用价格更新实用程序在单个操作中更新多个计费计划中的多个物料的价格。 可以根据指定的百分比或指定的金额来更新价格。 行列表仅显示物料的当前单位价格。 它未显示价格更新后的价格。

请注意有关价格更新实用程序的以下要点：

- 如果已创建特定年度的销售订单（即物料已计费），则行物料的价格不会受到影响。
- 价格更新实用程序可用于状态为 **有效** 或 **暂停** 的行物料。 对于处于暂停状态的物料，置于暂停状态时，**调整计划** 选项必须已设置为 **否**。
- 价格更新实用程序不能用于本身是用量物料并且使用升级、里程碑计费或收入分解的行物料。

### <a name="price-update-example"></a>价格更新示例

已创建计费计划，并且已添加续订物料。 单价为 $750。 第一年的物料于 2021 年 12 月 15 日支付。 计费计划是为 2022 年 1 月 1 日至 12 月 31 日这一期间创建的。

在续订时，**生成发票** 流程将创建 2022 年的销售订单。 运行价格更新实用程序后，价格将从 $750 更新为 $800。

2022 年销售订单和记帐计划未受影响，并且单价仍 $750，因为 2022 年计费计划已计费。 2023 年的计费计划行和行详细信息已更新为 $800，因为 2023 年的计费计划尚未计费。

### <a name="update-prices--flat-pricing-method"></a>更新价格 – 统一定价方法

当您更新使用统一定价方法的物料的价格时，您可以指定要提高价格的百分比或金额。

要对使用统一定价方法的物料运行价格更新实用程序，请按照以下步骤进行操作。

1. 在 **价格更新实用程序** 页面上，选择 **统一** 定价方法。
2. 在 **增加方法** 字段中，选择用于更新物料价格的增加方法。
3. 根据您选择的增加方法，在 **百分比** 字段中指定百分比，或在 **金额** 字段中指定金额。
4. 在 **要包括的记录** 快速选项卡上，使用 **筛选器** 按钮添加数据筛选器。
5. 选择 **查看预览** 查看记录范围。
6. 您不想处理某些行，请标记它们，然后选择 **删除**。
7. 选择 **确定**。

### <a name="update-prices--standard-pricing-method"></a>更新价格 – 标准定价方法

如果在物料记录中更改了物料的价格，并且物料使用标准定价方法，则可以针对所有计费计划行更新此价格。

1. 在 **价格更新** 实用程序页面上，选择 **标准** 定价方法。
2. 在 **要包括的记录** 快速选项卡上，使用 **筛选器** 按钮添加数据筛选器。
3. 选择 **查看预览** 查看记录范围。
4. 您不想处理某些行，请标记它们，然后选择 **删除**。
5. 选择 **确定**。

## <a name="mass-hold-processing"></a>批量暂停处理

使用 **批量暂停** 页面将暂停选项同时应用于多个计费计划。

要仅暂停一个计费计划或一个计费计划行，请打开 **所有计费计划** 页面，然后选择 **暂停**。 要删除暂停，请使用 **删除暂停** 页面。

### <a name="put-billing-schedules-on-hold"></a>暂停计费计划

要暂停多个计费计划，请按照以下步骤操作。

1. 在 **批量暂停** 页面上，将 **流程选项** 字段设置为 **应用暂停**。
2. 在 **原因代码** 字段中，选择原因代码。
3. 设置 **调整计划** 选项：

    - **是** - 如果将此选项设置为 **是**，请在 **暂停日期** 字段中指定暂停日期。 暂停日期之后的任何计费计划行会被删除。
    - **否** - 计费计划行未更改。 仅更改了状态 。 状态已更新为 **暂停**。

4. 在 **要包括的记录** 快速选项卡上，使用 **筛选器** 按钮添加数据筛选器。
5. 选择 **查看预览** 查看记录范围。
6. 您不想处理某些行，请标记它们，然后选择 **删除**。
7. 选择 **确定**。

当您返回到计费计划列表时，您应看到计费计划的状态已更改为 **暂停**。

### <a name="remove-a-hold-from-several-billing-schedules"></a>从多个计费计划中删除暂停

1. 在 **批量暂停** 页面上，将 **流程选项** 字段设置为 **删除暂停**。
2. 在 **原因代码** 字段中，输入原因代码。
3. 在 **删除日期** 字段中，选择应删除暂停的日期。
4. 根据需要设置 **恢复日期** 和 **延期日期** 字段。 延期日期将添加到可延期的所有行。
5. 在 **要包括的记录** 快速选项卡上，使用 **筛选器** 按钮添加数据筛选器。
6. 选择 **查看预览** 查看记录范围。
7. 您不想处理某些行，请标记它们，然后选择 **删除**。
8. 选择 **确定**。

> [!NOTE]
> 若要删除暂停，您必须在 **定期合同计费参数** 页上设置 **删除暂停用户组覆盖** 值。

例如，计费行的开始日期为 2022 年 2 月 1 日，结束日期为 2022 年 2 月 28 日。 计费金额为 $200。 **暂停日期** 字段被设置为 2022 年 2 月 10 日。 因此，将调整 2 月期间以排除 2 月 10 日之后的任何日期。 新期间为 2 月 1 日至 2 月 9 日，金额为 $64.29（通过每日按比例分配）。 将删除 2 月 10 日或之后的所有计费计划行。

如果 **删除暂停** 流程已完成，并且 **删除日期** 字段已设置为 2022 年 2 月 10 日，则将有两个计费周期。 第一个计费周期为 2 月 1 日至 2 月 9 日，金额为 $64.29。 第二个计费周期为 2 月 10 日至 2 月 28 日，金额为 $135.71。

## <a name="mass-termination-processing"></a>批量终止处理

使用 **批量终止** 页面，以通过指定终止日期来终止当前显示的计费计划行。

如果您正在使用收入和支出延期，则 **终止日期** 字段设置为 **所有计费计划** 页面上的 **调整计划** 的计费计划将有资格获得退款。

使用多元素分配 (MEA) 功能的计费计划未显示在 **批量终止** 页面上。 您仍可以通过在计费计划中使用终止功能来终止单个计费计划。

> [!NOTE]
> 当前包含在 **生成发票** 批处理中的计费计划行无法用于此流程。

有关每个字段和流程的信息，请参阅[终止计费计划](terminate-billing-schedule.md)。

## <a name="mass-archive-process"></a>批量存档流程

使用 **批量存档** 页面存档多个计费计划。 只能存档已终止的计费计划。

在存档计费计划后，将发生以下事件：

- 状态将更改为 **已存档**。
- 计费计划会被永久锁定。
- 计费计划行在查询页面上不再可用。

> [!NOTE]
> 计费计划的存档是永久性操作，无法撤销。

要存档计费计划，请按照以下步骤操作。

1. 在 **批量存档** 页面上的 **计费结束日期** 字段中，指定计费结束日期。 若要查看所有终止的计费计划，请将此字段留空。
2. 在 **要包括的记录** 快速选项卡上，使用 **筛选器** 按钮限制所显示的记录。
3. 选择 **查看预览版**。
4. 如果您不想存档某些记录，请标记它们，然后选择 **删除**。
5. 选择 **确定** 以存档页面上的记录。

## <a name="mass-stubbing-process"></a>批量存根流程

使用 **批量存根** 页面将所有选定的计费计划行标记为已计费（存根）或未计费（冲销存根）。 对于以前在其他系统中计费的已导入计费计划行，最常执行的是存根或冲销存根。 存根计费计划行显示为存根，不会为客户创建发票。

### <a name="stub-records"></a>存根记录

1. 在 **批量存根** 页面上的 **流程选项** 字段中，选择 **存根**。
2. 在 **截止日期** 字段中，设置截止日期以指定要将流程应用于的行。 将仅显示计费开始日期在指定的截止日期或其之前的记录。
3. 选择 **查看预览版** 以显示要用作存根的行。
4. 要从流程中排除行，请标记此行，然后选择 **删除**。
5. 选择 **流程** 以将行用作存根。

### <a name="reverse-stub-records"></a>冲销存根记录

1. 在 **批量存根** 页面上的 **流程选项** 字段中，选择 **冲销存根**。
2. 在 **截止日期** 字段中，设置截止日期以指定要将流程应用于的行。 将仅显示计费开始日期在指定的截止日期或其之前的记录。
3. 选择 **查看预览版** 以显示要冲销存根的行。
4. 要从流程中排除行，请标记此行，然后选择 **删除**。
5. 选择 **流程** 以冲销存根行。

## <a name="update-completion-date-process"></a>更新完成日期流程

使用 **更新完成日期** 页更新多个计费计划或用户的特定里程碑物料的完成日期。 您还可以更新使用 **完成百分比** 方法的里程碑模板上的物料的完成百分比。

1. 在 **更新完成日期** 页面上，转到 **里程碑处理**，然后选择 **更新完成百分比**。
2. 在 **百分比金额** 字段中，输入已完成的总百分比。
3. 选择与里程碑模板相关的物料编号。
4. 在 **要包括的记录** 快速选项卡上，选择 **筛选器** 以选择特定的 **最终用户帐户**、**计费计划编号** 或 **物料编号** 值作为筛选条件。
5. 选择 **确定** 以处理更改。 处理完成后，将向里程碑分配添加新行。 此行表示针对里程碑模板完成的百分比。

## <a name="unbilled-revenue-mass-processing"></a>未计费收入批量处理

使用 **未计费收入批量处理** 页面创建未计费的收入日记帐条目，或针对一个或多个所选计费计划或计费详细信息行将日记帐条目用作存根。

- **创建日记帐条目** - 为多个计费计划行创建未计费的收入日记帐条目。 使用 **要包括的记录** 快速选项卡上的 **筛选器** 按钮选择列表中显示的记录范围。 该列表仅显示未为其创建未计费的收入日记帐条目的计费计划行。 已创建初始日记帐条目。 对于延期物料，还将创建延期计划。
- **存根日记帐条目** - 标记已为其创建未记帐日记帐条目的计费计划行。 如果未计费日记帐条目已在另一个系统中过帐，则使用此选项。 它将未计费的收入日记帐标记为已存根，并且不会将交易过帐到总帐。
- **冲销存根日记帐条目** - 冲销已处理的存根日记帐条目。 如果在处理 **存根日记帐条目** 期间出错，则此选项将对计费计划行清除 **已存根** 复选框。
- **存根计费详细信息行** - 在外部系统中处理未计费收入并且某些计费详细信息行已计费时使用此流程。 此流程将确保未计费收入帐户中显示正确的金额。
- **冲销存根计费详细信息行** - 撤销任何 **存根计费详细信息行** 操作。

**日记帐名称** 字段用于将 **创建日记帐条目** 过帐到总帐。

> [!NOTE]
> 存根流程未将金额过帐到总帐。 **日记帐名称** 字段不适用于所有存根和撤销存根流程。

### <a name="unbilled-revenue-stub-example"></a>未计费收入存根示例

计费计划设置为一年，从 2021 年 10 月到 2022 年 9 月。 未计费收入已在外部系统中处理。 九个月的计费计划的已计费。 每个计费周期的金额为 $250。 在年初，已过帐到未计费收入的总金额为 $3,000。 九个月后，已计费 $2,250，还有 $750 的未计费收入。

若要设置仅保留三个月的未计费收入的计费计划，请执行以下步骤。

1. 在 **查看计费详细信息** 页面上，为从 2021 年 10 月到 2022 年 9 月的期间、物料编号 S0001 和每月 $250 的金额创建计费计划。
2. 为计费计划选择 **创建日记帐条目**。 $3,000 的金额会过帐到未计费收入。
3. 选择 **存根计费明细行**，并指定 2022 年 6 月（9 个月）的交易日期。 计费计划行将不会显示在预览版中。 受影响的行基于交易日期。
4. 选择 **确定**。

已计费的前九个月已用作存根。

[![查看计费明细行存根。](./media/01_View-billing-detail-stub.png)](./media/01_View-billing-detail-stub.png)

已从未计费收入中冲销 $3,000，并且 $750 美元的剩余未计费收入已过帐。 若要查看未计费的收入过帐，请在行详细信息页的 **续订** 选项卡上选择 **未计费的收入日记帐条目审计**。

[![未计费的收入日记帐条目审计。](./media/02_Unbilled-rev-journal-audit.png)](./media/02_Unbilled-rev-journal-audit.png)

> [!NOTE]
> 可以为任何续订期限创建未计费的收入日记帐条目，前提是已对上一个期限中的所有计费明细行计费。 例如，计费计划行具有 12 个月期间（从 2021 年 1 月到 2021 年 12 月）的每月计费频率。 该行有三个期限：初始期限、第二个期限（2022 年 1 月到 12 月）和第三个期限（2023 年 1 月到 12 月）。 在为 2021 年初始 12 个月中的所有计费明细行创建发票后，可以为第二个期限创建未计费收入的日记帐条目。
>
> 对于使用未计费收入功能的延期物料，将处理计费行和折扣行。 对于这些物料，将创建未计费的收入日记帐条目以及计费行和折扣行的延期计划。
>
> 为不可延期物料和可延期物料创建的日记帐条目将贷记过帐到不同的收入帐户。
