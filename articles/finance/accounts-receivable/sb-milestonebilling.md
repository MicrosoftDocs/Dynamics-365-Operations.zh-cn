---
title: 里程碑模板
description: 本主题说明如何在订阅计费中设置里程碑开票功能。
author: JodiChristiansen
ms.date: 11/04/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: ''
audience: Application User
ms.reviewer: twheeloc
ms.custom: 539093
ms.search.region: Global
ms.author: jchrist
ms.search.validFrom: 2021-11-05
ms.dyn365.ops.version: 10.0.24
ms.openlocfilehash: ecc4ddbb4d22eefac36f8cf8205d3b6084bd7d9d
ms.sourcegitcommit: a58dfb892e43921157014f0784bd411f5c40e454
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/04/2022
ms.locfileid: "8686482"
---
# <a name="milestone-billing"></a>里程碑开票

[!include [banner](../includes/banner.md)]

本主题说明如何为订阅计费中的里程碑开票功能定义模板。 对于里程碑模板中的每一行，您可以定义分配百分比或金额。 然后，您可以将里程碑模板分配给使用里程碑开票功能的计费计划物料。

## <a name="add-a-template"></a>添加模板

要添加里程碑模板，请执行以下步骤。

1. 转到 **订阅计费 \> 定期合同计费 \> 设置 \> 里程碑模板**。
2. 选择 **新建**。
3. 在 **里程碑模板** 字段中，为新模板输入一个唯一标识符。
4. 在 **描述** 字段中，输入描述。
5. 在 **分配方法** 字段中，选择一个分配方法。
6. 可选：在 **总金额** 字段中，指定模板的总金额。
7. 要添加行，选择 **添加**。 然后，在 **物料编号** 字段中，为新行选择物料编号。
8. 执行以下步骤之一，具体取决于您在 **分配方法** 字段中选择的值：

    - 如果您选择 **百分比** 作为分配方法，在 **百分比** 字段中为每个行指定分配百分比。 如果您指定百分比，显示在 **总百分比** 字段中的百分比总和必须等于 **100**。
    - 如果您选择 **可变金额** 作为分配方法，在 **金额** 字段中为每个行指定金额。
    - 如果您选择 **等额** 作为分配方法，则不必指定金额。 每一行都将根据添加到模板的物料数量更新为正确的百分比和金额。

9. 选择 **保存**。

## <a name="delete-a-template"></a>删除模板

要删除里程碑模板，请执行以下步骤。

1. 选择要删除的一行或多行，然后选择 **删除**。
2. 提示您确认操作时，选择 **是**。

## <a name="milestone-template-fields"></a>里程碑模板字段

**里程碑模板** 页包含以下字段。

| 字段 | Description |
|-------|-------------| 
| 里程碑模板 | 里程碑模板的唯一标识符。 |
| Description | 里程碑模板的描述。 |
| 分配方法 | <p>选择分配方法：</p><ul><li>**完成百分比** – 为每一行使用累计完成值。</li><li>**百分比** – 可以为分配指定百分比金额。 所有百分比的总和必须等于 100。</li><li>**可变金额** – 可以为分配指定金额。 分配金额在交易级别指定。</li><li>**等额** – 分配百分比是自动计算的，在模板中的物料之间平均拆分。</li></ul> |
| 总数 | 指定模板的里程碑金额。 |
| **行** | |
| 物料编号 | 选择里程碑模板的物料编号。 |
| 产品名称 | 物料的名称。 |
| 百分比 | <p>输入行的分配百分比：</p><ul><li>如果 **分配方法** 字段设置为 **百分比**，指定行的百分比。</li><li>如果将 **分配方法** 字段设置为 **等额**，百分比会根据模板中的物料数量自动划分为相等百分比。</li></ul><p>所有百分比的总和必须等于 100。</p><p>如果在标头中指定了 **总金额** 值，并且您更改了行的 **百分比** 值，**金额** 值将更新。 相反，如果您更改 **金额** 值，**百分比** 值将更新。</p> |
| 金额 | <p>行的分配金额：</p><ul><li>如果 **分配方法** 字段设置为 **可变金额**，指定行的金额。</li><li>如果将 **分配方法** 字段设置为 **等额**，金额会根据模板中的物料数和标头上指定的 **总金额** 值自动划分为等额。</li></ul><p>所有金额的总和必须等于标头中指定的 **总金额** 值。</p><p>如果在标头中指定了 **总金额** 值，并且您更改了行的 **金额** 值，**百分比** 值将更新。 相反，如果您更改 **百分比** 值，**金额** 值将更新。</p> |
| **合计** | |
| 总百分比 | 百分比的总和。 所有百分比的总和必须等于 100。 |
| 总数 | 所有行的 **金额** 值的总和。 总和必须等于标头中指定的 **总金额** 值。 |
| 余额 | 余额。 此值的计算方法是标头中的 **总金额** 值减去所有行的 **金额** 值的总和。|

## <a name="milestone-allocation"></a>里程碑分配

在开始使用里程碑功能之前，您应该完成这些任务。

1. 添加一个或多个里程碑模板。
2. 创建计费计划组。 将 **里程碑** 指定为物料类型，然后选择一个模板。
3. 在 **物料设置** 页面（**订阅计费 \> 定期合同计费 \> 设置 \>物料**），为物料设置选择物料关系和里程碑模板。

创建里程碑模板、计费计划组和物料后，您可以创建使用里程碑功能的计费计划。

要设置使用里程碑的计费计划，请按照这些步骤操作。

1. 从 **计费计划** 页面上的 **所有/有效计费计划** 列表中，选择 **新建**。
2. 在 **所有计费计划** 页面上，创建一个新的计费计划，并指定一个客户帐户和开始日期。
3. 在 **计费计划行** 部分，选择 **添加行**。 然后添加物料编号，并将 **物料类型** 字段设置为 **里程碑**。

    如果为物料设置了默认里程碑模板，里程碑事件将自动添加到计费计划行。 里程碑行的结束日期为空。

    如果没有为物料设置里程碑模板，选择 **里程碑分配**。 然后，在 **里程碑分配** 页面上，选择一个里程碑模板，并进行任何必要的更新。 然后选择 **关闭** 返回计费计划，完成计费计划的创建。

4. 要为计费计划创建发票，您必须更新每个里程碑事件的结束日期。 对于单个计费计划，您可以更新计费计划行上里程碑事件的结束日期。 要更新多个计费计划，选择 **更新完成日期流程**。
5. 更新结束日期后，您可以创建发票。 对于单个计费计划，在 **所有计费计划** 页上选择 **生成发票**。 要为多个计费计划创建发票，在 **定期任务** 下选择 **生成发票** 或 **生成发票批处理**。

## <a name="edit-milestone-allocation-on-a-billing-schedule-line"></a>编辑计费计划行上的里程碑分配

要编辑计费计划行上的里程碑分配，请执行以下步骤。

1. 在 **计费计划** 页面 > **所有或有效计费计划** 中，在 **计划编号** 字段中，选择计费计划的计划编号。
2. 在 **计费计划行** 部分，输入一个物料，指定 **里程碑** 作为物料，然后选择 **里程碑分配**。
3. 在 **里程碑模板** 字段中，选择里程碑模板。
4. 选择 **流程**。 里程碑模板行会自动添加到计费计划行。

## <a name="milestone-allocation-fields"></a>里程碑分配字段

**里程碑分配** 页包含以下字段。

| 字段 | Description |
|-------|-------------|
| 父物料 | 父级的物料编号。 |
| 延伸价格 | <p>物料的延伸价格。 此值对应于计费计划行的 **净额** 值。</p></p>对于里程碑父物料，默认值是为里程碑模板指定的 **总金额** 值。 如果总金额为 0（零），默认值为计费计划行的 **净额** 值。</p> |
| 里程碑模板 | 行物料的里程碑模板 ID。 |
| 模板描述 | 里程碑模板的描述。 |
| 分配方法 | 用于里程碑模板的分配方法。 |
| **行** | 所有行的默认值均基于选定的里程碑模板。 您可以根据需要进行更改。 |
| 物料编号 | 里程碑分配模板的物料编号。 |
| 产品名称 | 产品名称。 |
| 百分比 | <p>行的分配百分比。 所有百分比的总和必须等于 100。</p><p>如果您更改行的 **百分比** 值，**净额** 值将更新。 相反，如果您更改 **净额** 值，**百分比** 将更新。</p> |
| 净额 | <p>行的分配金额。 所有行的净额总和必须等于标头中指定的 **延伸价格** 值。</p><p>如果您更改行的 **净额** 值，**百分比** 值将更新。 相反，如果您更改 **百分比** 值，**净额** 值将更新。</p> |
| **合计** | |
| 百分比总计 | 所有行的 **百分比** 值的总和。 总和必须等于 100。 |
| 总数 | 所有行的 **净额** 值的总和。 总和必须等于标头中指定的 **延伸价格** 值。 |
| 余额 | 余额。 此值的计算方法是标头中的 **延伸价格** 值减去所有行的 **净额** 值的总和。 最终金额必须为 0（零）。 |
