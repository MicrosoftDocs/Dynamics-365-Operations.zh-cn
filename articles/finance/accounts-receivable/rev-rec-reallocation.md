---
title: 收入确认重新分配
description: 本文将提供有关重新分配的信息，这使组织可以在更改合同销售条款时重新计算收入价格。 它包含指向其他主题的链接，这些主题介绍如何在多种情况下确认收入。
author: bking
ms.date: 09/09/2021
ms.topic: index-page
ms.prod: ''
ms.technology: ''
ms.search.form: Customer
audience: Application User
ms.reviewer: twheeloc
ms.search.region: Global
ms.author: bking
ms.search.validFrom: 2020-12-21
ms.dyn365.ops.version: 10.0.14
ms.openlocfilehash: 6c7e2149058ebbff85cbc2ac86dac3231fbcc41d
ms.sourcegitcommit: 1909d18a74cef85aad020a6a7473281e451f58c7
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/24/2022
ms.locfileid: "9348142"
---
# <a name="revenue-recognition-reallocation"></a>收入确认重新分配

[!include [banner](../includes/banner.md)]

组织可以通过重新分配来在更改合同销售条款时重新计算收入价格。 出于收入确认目的，销售订单文档将视为合同。

您的组织必须自行确定是否需要重新分配。 对销售订单添加新行或为客户添加新销售订单可能不会视为对合同的更改。 以下情况可能需要重新分配：

- 在对销售订单全部或部分开票后，客户向销售订单中添加了项目，或者从销售订单中删除了项目。
- 对于同一份协商合同，输入了处于确认状态或已开票状态的多个销售订单。
- 在对原始销售订单全部或部分开票后，客户返回或收到项目的贷项。

重新分配流程存在一些重要限制：

- 该流程只能运行一次。 因此，请务必注意，只有在完成所有更改后才能运行该流程。

    - 在版本 10.0.17 及更高版本中删除了此项限制。

- 不能对项目销售订单运行该流程。

    - 在版本 10.0.17 及更高版本中删除了此项限制。

- 如果涉及多个销售订单，这些订单必须属于同一个客户帐户。
- 重新分配的所有销售订单必须使用相同的交易币种。
- 该流程在运行后无法冲销或撤消。

    - 在版本 10.0.17 及更高版本中删除了此项限制。

- 只能对销售订单或项目销售订单执行重新分配。 无法对销售订单和项目销售订单的组合执行此项操作。

    - 在版本 10.0.17 及更高版本中删除了此项限制。

## <a name="set-up-reallocation"></a>设置重新分配

此参数影响重新分配流程。

由于可以对部分或全部开票的销售订单执行重新分配，因此必须使用新的、重新分配的收入价格来更正发票的任何先前会计条目。 执行此更正的方法是：冲销原始发票的会计条目，并过帐基于重新分配的收入价格的新会计条目。

每个组织都必须决定更正应仅更新总帐，还是应更新应收帐款。 达成的决定确定 **总帐参数** 页面的 **收入确认** 选项卡上 **将发票更正过帐到应收帐款** 选项的合适设置（**收入确认 \> 设置 \> 总帐参数**）。 合适的设置取决于特定的方案。 有关可能的方案的详细信息，请使用本文后面的[重新分配方案](#scenarios-for-reallocation)部分中的链接。

[![“总帐参数”页面上的“收入确认”选项卡。](./media/01_RevRecScenarios.png)](./media/01_RevRecScenarios.png)

如果 **将发票更正过帐到应收帐款** 选项设置为 **是**，重新分配流程将产生以下结果：

- 在应收帐款中创建贷方凭证以冲销需要更正的发票。

    - 贷方凭证将重用原始发票编号，但会在其后追加“-1”。
    - 将根据原始发票自动结算贷方凭证。 如果使用其他贷方凭证或付款结算了原始发票，则将自动冲销该结算。
    - 贷方凭证将过帐到总帐，以冲销原始发票上过帐的会计条目。 但是，不会冲销库存和所售货物成本 (COGS) 交易记录条目。

- 将在应收帐款中创建基于新的、重新分配的价格金额的新发票。

    - 新发票将重用原始发票编号，但会在其后追加“-2”。
    - 新的发票将根据以前使用原始发票结算的任何贷方凭证或付款自动结算。
    - 新的发票将使用新的、重新分配的收入价格金额过帐到总帐。 它不会重新过帐到库存和 COGS 帐户，因为这些条目将保留在原始发票的会计条目中。

如果 **将发票更正过帐到应收帐款** 选项设置为 **否**，重新分配流程将产生以下结果：

- 冲销会计条目将仅过帐到总帐。 将冲销原始发票中的所有会计，库存和 COGS 帐户条目除外。
- 根据新的、重新分配的收入价格，新的会计条目将仅过帐到总帐。 它不会重新过帐到库存和 COGS 帐户，因为这些条目将保留在原始发票的会计条目中。
- **客户交易记录** 页面上的发票未受影响或更改，但仍反映原始会计条目。 不存在对冲销的或新的会计条目的引用。

如前所述，您可以仅更新总帐，也可以同时更新总帐和应收帐款。 这两种方法各有利弊。 我们建议您评估组织的要求，以确定应该使用哪个选项。 如果同时更新总帐和应收帐款，则正确的会计条目将显示在新发票上，并且可以从 **客户交易记录** 页面上的文档中查看。 此外，结算流程将使用更新的会计条目以过帐任何现金折扣和损益。 另一方面，就像其他贷方凭证和客户发票一样，贷方凭证和新发票将显示在客户对帐单和帐龄报告中。 这些文档的说明将指示它们是通过会计更正而创建的。

## <a name="run-the-reallocation-process"></a>运行重新分配流程

要启动重新分配流程，请在必须重新分配的任何销售订单中选择 **使用新订单行重新分配价格**。 或者，转到 **收入确认 \> 定期任务 \> 使用新订单行重新分配价格**，然后输入合适的筛选器，例如客户帐户。

[![“使用新订单行重新分配价格”页面。](./media/02_RevRecScenarios.png)](./media/02_RevRecScenarios.png)

**使用新订单行重新分配价格** 页面上的上方网格命名为 **销售**。 它列出了客户的销售订单。 选择必须重新分配的销售订单。 如果销售订单具有重新分配 ID，则它已由另一个用户标记为重新分配。 如果一个或多个销售订单之前已重新分配，并必须包含在其他重新分配中，则必须先撤消这些销售订单的重新分配。 然后，即可将其包含在新的重新分配中。 有关更多详细信息，请参阅本文后面的[撤消重新分配](#undo-a-reallocation)和[多次重新分配](#reallocate-multiple-times)部分。

页面上的下方网格命名为 **行**。 选择 **销售** 网格中的一个或多个销售订单后，**行** 网格将显示销售订单行。 选择必须重新分配的销售订单行。 如果仅选择一个销售订单，则必须重新分配同一销售订单上的行。 如果先前为一个销售订单行进行了开票，然后添加了一个新行，或者删除或取消了一个现有行，可能会发生此情况。 如果删除了一行，它将不会显示在网格中。 因此，无法选择它。 但是，在运行重新分配流程时，仍将会考虑该行。

选择完所需的销售订单行后，按如下所述使用操作窗格上的按钮：

- **更新重新分配** - 计算所选销售订单行的新收入价格金额。 如果删除或取消了某行，则将仅对您选择的现有行执行重新分配。 下图显示了在更新重新分配之前销售订单行的一个示例。

    [![更新重新分配之前的销售订单行。](./media/03_RevRecScenarios.png)](./media/03_RevRecScenarios.png)

    新的收入价格金额将显示在 **Lines** 网格的 **重新分配的金额** 列中。 此时，重新分配已经处理完毕，但尚未进行计算。 下图显示了在更新重新分配之后销售订单行的一个示例。

    [![更新重新分配之后的销售订单行。](./media/04_RevRecScenarios.png)](./media/04_RevRecScenarios.png)

- **处理** – 处理或过帐重新分配的收入价格。 选择此按钮后，将无法反转重新分配。 如果您在选择 **处理** 之前未选择 **更新重新分配**，将自动运行重新分配。

    - 如果尚未对销售订单行开票，将更新所选要重新分配的任何销售订单中的收入价格金额。
    - 如果已对一个或多个销售订单行开票，则将过帐更正的会计条目，并将更正为已开票的销售订单行创建的任何收入计划详细信息。

- **预期凭证** - 显示为已开票的任何销售订单行创建的会计条目的预览。 如果尚未对任何行开票，将不会显示任何内容。 如果您在选择 **预期凭证** 之前未选择 **更新重新分配**，将自动运行重新分配。
- **收入重新分配** - 打开一个页面，其中显示所有选定行的收入价格分配。 无法更改该页面上的任何信息。 它显示了用于执行重新分配的行金额。

    [![用于重新分配的行金额。](./media/05_RevRecScenarios.png)](./media/05_RevRecScenarios.png)

- **重置所选客户的数据** - 如果重新分配流程已开始但尚未完成，将仅清除重新分配表中所选客户的数据。 例如，您将多个销售订单行标记为重新分配，将页面保持打开状态而未选择 **处理**，然后页面超时。在这种情况下，销售订单行将保持标记状态，其他用户无法完成重新分配流程。 该页面甚至可能在打开时是空白的。 在这种情况下，**重置所选客户的数据** 按钮可用于清除未处理的销售订单，以便其他用户可以完成重新分配流程。

## <a name="undo-a-reallocation"></a>撤消重新分配

通过运行其他重新分配来撤消重新分配。 再次执行重新分配，并由用户选择要包含在第二个重新分配流程中的不同销售订单行。

如果针对两个或更多单独的销售订单执行了重新分配，则可从重新分配中包含的任何销售订单中选择 **使用新订单行重新分配价格** 来进行撤消。 无法通过转到 **收入确认 \> 定期任务 \> 使用新订单行重新分配价格** 来撤消重新分配，因为以这种方式打开此页面仅会显示没有重新分配 ID 的销售订单。 重新分配单据后，系统将分配重新分配 ID。

在 **使用新订单行重新分配价格** 页面上，取消标记应从合同协议中排除的任何销售订单。 使用“操作”窗格上的相应按钮（例如 **更新重新分配** 和 **处理**）来处理重新分配。 如果除有效销售订单之外的所有销售订单均未标记，则在处理更改时将删除重新分配 ID。

如果已通过将新行添加到完全或部分开票的销售订单执行了重新分配，则只能从销售订单中删除该行，然后再次运行重新分配来撤消重新分配。 由于系统假定销售订单上的所有行均属于同一合同，因此必须删除销售订单行。 当您位于 **使用新订单行重新分配价格** 页面上时，无法取消标记销售订单行。

## <a name="reallocate-multiple-times"></a>多次重新分配

如果对合同进行了多次更改，则可针对同一销售订单执行多次重新分配。 每次重新分配都会触发将重新分配 ID 分配到销售订单或销售订单组的操作，从而将所做的更改组合在一起。 如果执行了多次重新分配，则每次额外的重新分配都会使用与第一次重新分配相同的重新分配 ID。

例如，输入了销售订单 00045，并且该订单具有多行。 对销售订单完全开票后，将新的销售订单行添加到该订单。 然后，从销售订单 00045 中打开 **使用新订单行重新分配价格** 页面，或转到 **收入确认 \>定期任务 \>使用新订单行重新分配价格** 来运行重新分配。 为销售订单分配了重新分配 ID **Reall000001**。

为同一合同创建了第二个销售订单 00052。 可从销售订单 00045 中打开 **使用新订单行重新分配价格** 页面，再次运行重新分配，但不可从销售订单 00052 中打开此页面。 如果您从销售订单 00052 中打开 **使用新订单行重新分配价格** 页面，则销售订单 00045 将不会显示，因为已为其分配重新分配 ID。 此页面仅显示没有重新分配 ID 的销售订单。

可通过两种方式来执行第二次重新分配。 可以撤消销售订单 00045 的重新分配。 在这种情况下，会删除重新分配 ID，然后可以从销售订单 00045 或销售订单 00052 中执行重新分配。 或者，也可以从销售订单 00045 中打开 **使用新订单行重新分配价格** 页面，然后添加第二个销售订单。 在处理重新分配时，将为销售订单 00045 和销售订单 00052 分配重新分配 ID **Reall000001**。

## <a name="scenarios-for-reallocation"></a>重新分配方案

以下主题介绍了各种收入确认方案：

- [收入确认重新分配 – 方案 1](rev-rec-reallocation-scenario-1.md) - 输入了两个销售订单，但仅对它们进行了确认。 如果两个以上的销售订单处于确认状态，则相同的方案将产生相似的结果。
- [收入确认重新分配 - 方案 2](rev-rec-reallocation-scenario-2.md) - 输入了两个销售订单，然后在对第一个销售订单开票后，客户将一个项目添加到合同中。
- [收入确认重新分配 - 方案 3](rev-rec-reallocation-scenario-3.md) - 将一个新行添加到现有的、已开票的销售订单中。
- [收入确认重新分配 - 方案 4](rev-rec-reallocation-scenario-4.md) - 从现有的、已部分开票的销售订单中删除一行。

[!INCLUDE[footer-include](../../includes/footer-banner.md)]
