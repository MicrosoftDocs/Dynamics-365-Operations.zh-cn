---
title: 批次平衡
description: 此主题介绍批次平衡流程。
author: johanhoffmann
manager: tfehr
ms.date: 01/04/2021
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: BOMTable, WHSReservationHierarchy, WHSInventTableReservationHierarchy
audience: Application User
ms.reviewer: kamaybac
ms.custom: 1705903
ms.assetid: 427e01b3-4968-4cff-9b85-1717530f72e4
ms.search.region: Global
ms.author: johanho
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 8.0.0
ms.openlocfilehash: 8c1f52239b2050425c37a8130507e689b29205a8
ms.sourcegitcommit: 38d40c331c8894acb7b119c5073e3088b54776c1
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/15/2021
ms.locfileid: "4966547"
---
# <a name="batch-balancing"></a>批次平衡

[!include [banner](../includes/banner.md)]

此主题介绍对批次平衡流程的支持。

有关详细信息，请观看[有关批次平衡的视频](https://www.youtube.com/watch?v=4SNLWsU9KyI&feature=youtu.be)。

在批次平衡流程中，生产批次中使用的成分量通过所选产品批次中的有效成分浓度计算。

## <a name="products-that-have-an-active-ingredient"></a>具有有效成分的产品

可通过有效成分量定义产品。 产品有效成分的建模方法是，使用产品特定且具有最小值、最大值和目标级别的批次属性。

批次属性的目标级别表示产品中的有效成分的预计百分比。 最小值和最大值表示接受与目标级别之间的偏差。 例如，可将其在收货时用作接受的批次容差。

一个产品只能有一种有效成分。 若要指定产品的有效成分，必须首先定义产品特定的批次属性。 然后将属性作为产品的基本属性关联。

在产品级别，还必须指定应如何记录产品批次有效成分的级别：作为采购收货流程的一部分，还是作为质检订单流程的一部分。

若要将基本属性与产品关联，需执行以下设置：

- 产品必须受批次控制。 若要使产品受批次控制，必须为产品分配具有有效批次维度的跟踪维度组。

- 必须将用于指示成分级别的属性定义为特定于产品的产品批次属性。

要查找和编辑批次有效成分的实际值：
1. 转到 **库存管理 \> 查询和报表 \> 跟踪维度 \> 批次**。
1. 从网格中选择一个批号。
1. 在操作窗格上，打开 **视图** 选项卡，然后选择 **库存批次属性**。

## <a name="ingredient-types-and-how-they-interact-in-the-batch-balancing-process"></a>成分类型及其在批次平衡流程中的交互方式

创建的配方行可以包含以成分类型之一：

- None
- 活动
- 补偿
- 填写人

本节的其余部分提供了示例，用于显示各种成分类型如何工作。 这些示例基于以下配方，该配方的总批次大小为 100 升。

| 成分类型 | 物料编号 | 配方行数量 | 单位 |
|---|---|---|---|
| None | A | 20 | 升 |
| 可用 | B | 30 | 升 |
| 补偿 | C | 10 | 升 |
| 填写人 | 日 | 40 | 升 |

下表提供了每个示例的结果的概览。

| 物料编号 | 成分类型 | 估计数量 | 结余数量 | 有效数量 | 单位 | 基值 |
|---|---|---|---|---|---|---|
| A | None | 20 | 20 | | 升 | |
| B | 活动 | 30 | 25.71 | 9.00 | 升 | 30.00 |
| C | 补偿 | 10 | 14.72 | | 升 | |
| 日 | 填写人 | 40 | 39.57 | | 升 | |

### <a name="active-ingredients"></a>有效成分

如果向配方行添加具有基本属性的产品，该产品在配方中将称为 *有效成分*。 可将具有包含有效成分的配方的批次订单用于批次平衡流程。 对于配方中的各成分，批次平衡流程去除生成产品所需量。 量的去除基于所选批次中的有效成分浓度。

#### <a name="active-ingredient-example"></a>有效成分示例

成分 B 的基本属性为 X，目标级别为 30，并且其所在的配方为每 100 升产品需要 30 升成分 B。 将创建批次大小为 100 升的批次订单。 将启动批次订单，而在批次平衡流程中，用户将选择含量级别为 35 的成分 B 的批次。 由于含量级别 35 超过了 30 这一目标级别，所以将减少成分 B 的平衡数量，方法是含量值除以批次目标级别，然后乘以估计的数量。 下面是平衡数量的计算方法：balanced quantity looks like this:

(30 ÷ 35) × 30 升 = 25.71 升

### <a name="none-ingredients"></a>无成分

如果在 **成分类型** 为 *无* 时应用批次平衡流程，批次订单中的配方行估计数量将与平衡数量相同。

#### <a name="none-ingredient-example"></a>无成分示例

将成分 A 分配给类型为 *无* 的成分，然后添加到成品的配方。 此配方要求每 100 升成品需要 10 升成分 A。 如果批次订单需要 200 升，则成分 A 的估计数量和平衡数量的计算结果均应为 20 升。

### <a name="compensating-ingredients"></a>补偿成分

补偿成分可以抵消或补偿产品中有效成分的作用。 因此，使用的补偿成分数量取决于产品的含量：

- **抵消作用** – 如果有效成分的量超过了预期量，则必须减少补偿成分。

- **补偿作用** – 如果有效成分的量低于预期量，则必须增加补偿成分。

有效成分与补偿成分之间的关系在 **补偿原则** 页中设置。

请按照以下步骤设置成分之间的关系。

1. 选择 **产品信息管理 \> 物料清单和配方 \> 配方**。
1. 打开一个配方行，然后选择 **成分** 打开 **补偿原则** 页。
1. 选择表示补偿原则的行，然后选择要补偿的有效成分。

在补偿原则中，还输入正或负补偿系数以指定补偿量，以及原则应为抵消还是补偿。 正系数表示补偿作用，负系数表示抵消作用。

#### <a name="compensating-ingredient-example"></a>补偿成分示例

成分 B 是基本属性为 X 且目标级别为 30 的有效成分。 其所在配方要求每 100 升产品需要 30 升成分 B。 成分 C 是补偿成分，同一个配方中包含的数量为 10。 为补偿原则设置了补偿系数 1.10。 因此，平衡的补偿成分数量将减去有效成分平衡数量与估计所需数量，然后乘以 1.10。

在此示例中，对于 *有效* 成分类型，所需有效成分的平衡数量计算结果为 25.71，预计所需数量计算结果为 30。 在此情况下，平衡的补偿成分数量计算方法如下：

1. 确定估计数量与平衡数量之差：  
    25.71 – 30 = –4.29

1. 结果乘以补偿系数：  
    4.29 × 1.10 = –4.72

1. 估计补偿数量减去 –4.72 以确定平衡补偿数量：  
    10 – (–4.72) = 14.72

因为 1.10 是正补偿系数，所以此补偿原则具有补偿作用。 在此情况下，有效成分比预期效果更强。 因此，需要更多补偿成分。

### <a name="filler-ingredients"></a>填充料成分

*填充料成分* 是用于达到所需成品输出数量的中性成分。 填充料数量调节的计算方法基于有效成分和补偿成分与标准数量相比之差。

#### <a name="filler-ingredient-example"></a>填充料成分示例

您已配置了包含成分 A、B、C 和 D 的一个产品的配方，该配方的大小为 100 升。 您计算了除一行上使用的 *填充料* 成分类型之外的其他所有成分类型的数量。
填充料成分平衡数量的计算结果是批次大小 100 升减去成分 A、B 和 C 之和：

100 – (20 + 25.71 + 14.72) = 39.57

## <a name="the-batch-balancing-process"></a>批次平衡流程

批次平衡流程从 **批次平衡** 页执行。
选择 **成本管理 \> 批次订单**，然后在 **流程** 选项卡上，选择 **批次平衡**。 批次平衡可用于状态为 **已开始** 的批次订单。

一般而言，如果配方至少有一个配方行中的 **成分类型** 为 *有效*，则可为批次订单应用批次平衡。 （有关此规则的例外，请参阅此主题后文的“不适用批次平衡的批次订单”章节。）

批次平衡流程可分为两个子流程：

1. 平衡批次成分
1. 确认和下达配方

### <a name="balance-batch-ingredients"></a>平衡批次成分

在平衡批次成分子流程中，生产批次使用的成分量基于具有有效成分的所选批次计算。 通常，只有涵盖所有成分，才能完成计算。 不能仅平衡将批次订单设置为生产的批次部分。

> [!NOTE]
> 不能先保存计算，以后再完成批次平衡流程。 如果关闭 **批次平衡** 页，则必须重新计算才能完成流程。

### <a name="confirm-and-release-the-formula"></a>确认和下达配方

计算了成分数量之后，可以确认并下达配方。 下达流程各不相同，具体取决于是否为仓库管理流程启用了产品：

- 如果为仓库管理流程启用了某个产品，将根据仓库管理流程的原则把配方行下达给仓库。 配方行按照匹配平衡数量的数量下达，并针对为有效成分选择的特定批次下达。

    > [!NOTE]
    > 配方行只能作为批次平衡流程的一部分下达给仓库。 尽管可通过其他选项将生产物料下达给仓库，但是那些选项不能用于配方行。

- 如果不为仓库管理流程启用产品，确认并下达配方时，将为产品创建生产领料单。

在单个配方中，可合并为仓库管理流程启用的产品和未为仓库管理流程启用的产品。 如果一个配方中同时包含这两种产品，将把为仓库管理流程启用的产品下达给仓库。 对于未为仓库管理流程启用的产品，将在确认并下达配方时创建领料单。

### <a name="batch-orders-that-arent-applicable-for-batch-balancing"></a>不适用批次平衡的批次订单

以下规则有两个例外：如果配方至少有一个配方行中的 **成分类型** 为 *有效*，则批次订单适用批次平衡。

1. 如果配方中包含为仓库管理流程启用的产品的有效成分，但批次号低于预留层次结构中的位置，则批次订单不适用批次平衡。
1. 如果配方度量单位与有效成分的库存度量单位不同，批次订单则不适用于批次平衡。

不适用批次平衡的批次订单将完成批次订单的常规流程周期。


[!INCLUDE[footer-include](../../includes/footer-banner.md)]