---
title: 工艺路线和工序
description: 本主题提供了有关工艺路线和工序的信息。
author: sorenva
manager: AnnBe
ms.date: 03/18/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: BOMDesigner, BOMDesignerRouteVersion, Route, RouteInventProd, RouteOpr, RouteOprTable
ms.author: sorenand
audience: Application User
ms.reviewer: josaw
ms.search.scope: Core, Operations
ms.custom: 268124
ms.assetid: f78d5836-3e71-42b7-a5d1-41f19228d9d2
ms.search.region: Global
ms.search.industry: Manufacturing
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 6ecdece43b9d609e70e385dc5c3ec70b82f582ab
ms.sourcegitcommit: 0099fb24f5f40ff442020b488ef4171836c35c48
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/23/2019
ms.locfileid: "2653663"
---
# <a name="routes-and-operations"></a>工艺路线和工序

[!include [banner](../includes/banner.md)]

本主题提供了有关工艺路线和工序的信息。 工艺路线定义生产产品或产品变型的流程。 它描述生产流程中的各步骤（工序）和这些步骤必须遵循的执行顺序。 对于每个步骤，工艺路线还定义所需工序资源、所需设置时间和运行时间，以及应如何计算成本。

<a name="overview"></a>概览
--------

工艺路线描述生产产品或产品变型所需工序顺序。 对于每道工序，工艺路线还定义所需工序资源、设置和执行工序所需时间，以及应如何计算成本。 您可以使用相同工艺路线生产多个产品，也可以为每个产品或产品变型定义不同工艺路线。 同一个产品甚至可以有多个工艺路线。 在这种情况下，使用的工艺路线根据必须生产的数量之类因素决定。 Supply Chain Management 中的工艺路线的定义包含四种不同元素，这些元素共同描述生产流程：

-   **工艺路线** – 工艺路线定义生产流程的结构。 换言之，它定义工序的顺序。
-    **工序** – 工序表示工艺路线中带名称的步骤，如**装配**。 同一工序可以在多个工艺路线中出现，并且可以有不同的工序编号。
-   **工序关系** – 工序关系定义工序的操作属性，例如设置时间和运行时间、成本类别、消耗量和资源要求。 工序关系让工序的操作属性多种多样，具体取决于工序的所用工艺路线或正在生产的产品。
-   **工艺路线版本** – 工艺路线版本定义用于生成产品或产品变型的工艺路线。 工艺路线版本让工艺路线可以在多个产品中重复使用，或者随着时间的推移而改变。 它们还让不同工艺路线可用于生成同一产品。 在这种情况下，使用的工艺路线取决于位置或必须生产的数量之类因素。

## <a name="routes"></a>工艺路线
工艺路线描述生产产品或产品变型所用工序顺序。 将为每道工序分配工序编号和后续工序。 工序顺序形成工艺路线网络，而工艺路线网络可通过带有方向且有一个或多个起点，但是只有一个终点的图表表示。 在 Supply Chain Management 中，根据结构类型区分工艺路线。 工艺路线有两种，即简单工艺路线和工艺路线网络。 在“生产控制参数”中，可以指定是否可以只使用简单的工艺路线，或者是否可以使用更复杂的工艺路线网络。

### <a name="simple-routes"></a>简单工艺路线

简单工艺路线具有连续性，并且只有一个起点。  

[![简单工艺路线](./media/routes-and-operations-1-simple-route.png)](./media/routes-and-operations-1-simple-route.png)  

如果您在“生产控制参数”中仅启用简单工艺路线，在您定义工艺路线时，Supply Chain Management 将自动生成工序编号（10、20、30，依此类推）。

### <a name="route-networks"></a>工艺路线网络

如果您在“生产控制参数”中启用更复杂的工艺路线网络，则可以定义多个起点和工序，并且这些工序可以并行运行。  

[![工艺路线网络](./media/routes-and-operations-2-route-network.png)](./media/routes-and-operations-2-route-network.png)  

> [!NOTE]
> -   每道工序只能有一个后续工序，而整个工艺路线只能在一道工序中结束。
> -   这不能确保具有相同后续工序的多道工序（前面的例子中为工序 30 和 40）真正会并行运行。 资源的可用性和产能可能会限制工序的安排方式。
> -   不能将 0（零）用作工序编号。 该编号已预留，用于指定工艺路线中最后一道工序无后续工序。

### <a name="parallel-operations"></a>并行工序

有时需要组合多个具有不同特征的工序资源，才能执行某道工序。 例如，装配工序可能要求为每两台机器配备一台机器、一个工具和一位工作人员，以便监督该工序。 可通过使用并行工序来建模，其中一道工序被指定为主工序，其他工序被指定为辅助工序。  

[![具有主工序和辅助工序的工艺路线](./media/routes-and-operations-3-parallel-operations.png)](./media/routes-and-operations-3-parallel-operations.png)  

主工序通常表示瓶颈资源，并指示辅助工序的运行时间。 但是，涉及有限产能的安排期间，同时为主工序和辅助工序安排的资源必须同时可用且拥有可用产品。  

主工序和辅助工序必须有相同的工序编号（前面的例子中为 30）。  

在前面的示例中，主工序 (30) 的资源需求是机器，而辅助工序（30" 和 30""）的资源要求是工具和工作人员。 50% 的负荷帮助确保安排的工作人员可以同时监督两台机器。

### <a name="approval-of-routes"></a>工艺路线审核

工艺路线必须先经过批准，然后才能在计划或制造流程中使用。 批准说明工艺路线的设计已完成。 发布的同一产品或产品变型可以具有多个批准的工艺路线。 通常，工艺路线的批准在第一个相关工艺路线版本获得批准时进行。 但是，在某些业务方案中，工艺路线和工艺路线版本的批准是单独的活动，可能涉及不同流程所有者。  

每个工艺路线可以单独地获得批准或取消批准。 但是请注意，如果工艺路线未获得批准，所有相关工艺路线版本也将未获得批准。 在“生产控制参数”中，可以指定工艺路线是否可以未获得批准，以及是否可更改已批准的工艺路线。  

如果必须保留日志以记录谁批准了每个工艺路线，可能需要电子签名才能批准工艺路线。 然后，用户必须通过使用[电子签名](../../fin-and-ops/organization-administration/electronic-signature-overview.md)确认其身份。

## <a name="operations"></a>Operations
工序是生产流程中的步骤。 每道工序有一个 ID 和一个简单描述。 下面的表显示机械车间中的典型工序示例。

| 工序  | 说明        |
|------------|--------------------|
| PipeCut    | 切管道       |
| TIGweld    | TIG 焊        |
| JigAssy    | Jig 装配       |
| 检查 | 质量检验 |

工序的操作属性（如设置时间和运行时间、资源要求、成本信息和消耗量计算）在工艺关系中指定。 （有关工序关系的详细信息，请参阅下一个部分。）

## <a name="operation-relations"></a>工序关系
工序的以下操作属性在工序关系中维护：

-   成本类别
-   消耗参数
-   处理时间
-   处理数量
-   资源要求
-   注释和说明

可以为同一个工序定义多个工序关系。 但是，每个工序关系特定于一道工序，并且存储特定于工艺路线、发布的产品或与物料组有关的一组产品的属性。 因此，可以在具有不同工艺属性的多个工艺路线中使用同一道工序。 此外，如果使用具有相同工艺属性的标准工艺，无论使用哪种工序和生产哪种产品，您都还可以轻松维护您的主数据。 工序关系的范围通过**物料代码**、**物料关系**、**工艺路线代码**和**工艺路线关系**属性定义，如下表中所示。

| 物料代码 | 物料关系         | 工艺路线代码 | 工艺路线关系   | 工序关系的范围                                                                                                                                                                                                                                                                              |
|-----------|-----------------------|------------|------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 表     | &lt;物料 ID&gt;       | 工艺路线      | &lt;工艺路线 ID&gt; | 当工序在**工艺路线编号**=&lt;工艺路线 ID&gt; 以生产**物料编号**=&lt;物料 ID&gt; 的所发布产品的工艺路线中使用时，工序的操作属性。                                                                                                                        |
| 表     | &lt;物料 ID&gt;       | 全部        |                  | 当工序用于生产**物料编号**=&lt;物料 ID&gt; 的所发布产品的时，工序的默认操作属性。 换言之，发布的产品无工艺路线特定的工序关系时应用这些操作属性。                                     |
| 组合     | &lt;物料组 ID&gt; | 工艺路线      | &lt;工艺路线 ID&gt; | 除非发布的产品有工艺路线特定的工序关系，否则当工序在**工艺路线编号**=&lt;工艺路线 ID&gt;中使用以生产与物料组&lt;物料组 ID&gt; 关联的所发布产品的工艺路线中使用时，工序的操作属性。                         |
| 组合     | &lt;物料组 ID&gt; | 全部        |                  | 除非存在特定的工序关系，否则当工序用于生产与物料组&lt;物料组 ID&gt; 关联的所发布产品时，工序的默认操作属性。                                                                                                  |
| 全部       |                       | 工艺路线      | &lt;工艺路线 ID&gt; | 工序在**工艺路线编号**=&lt;工艺路线 ID&gt; 的工艺路线中使用时，工序的默认操作属性。 换言之，特定于发布的产品或其关联物料组的此工艺路线无工序关系时，应用这些工序属性。 |
| 全部       |                       | 全部        |                  | 工序的默认操作属性。 不存在更特定的操作关系时，应用这些操作属性。                                                                                                                                                                |

您还可以指定工序关系特定于站点。 通过这种方式，工序的操作属性可根据工序的执行位置（即站点）决定。 对于配置的产品，还可以为每个产品配置指定不同的操作属性。  

工序关系让您在定义工艺路线时可以灵活多变。 此外，由于可以定义默认属性，所以有助于减少必须维护的主数据。 但是，这种灵活也意味着您必须了解修改工序关系的环境。  

> [!NOTE]
> 因为操作属性存储按照每个工艺路线的工序存储在工序关系中，所以同一道工序（如“装配”）的所有发生次数具有相同的设置时间、运行时间、资源要求。 因此，如果一道工序的两个发生次数必须在同一个工艺路线中发生，但是具有不同的运行时间，您必须创建两个不同的工序，如“装配1”和“装配2”。

### <a name="modifying-product-specific-routes"></a>修改产品特定的工艺路线

在您从**已发布产品详细信息**页打开**工艺路线**时，将显示与所选已发布产品关联的工艺路线版本。 在此环境中，Supply Chain Management 为各工序显示最符合工艺路线版本的工序关系中的操作属性。 您将注意到工序列表中包含工序关系内的**物料代码**和**工艺路线代码**。 因此，您可以确定显示的是哪个工序关系。  

在**工艺路线**页中，您可以修改工序的操作属性，如运行时间或成本类别。 您的更改存储在特定于当前工艺路线版本中引用的工艺路线和发布的产品的工艺关系中。 如果显示的工序关系不特定于该工艺路线和发布的产品，在存储您的更改之前，系统将创建此工序关系的副本。 此副本*的确*特定于该工艺路线和发布的产品。 因此，您的更改不影响其他工艺路线或发布的产品。 若要验证**工艺路线**页中正在修改哪个工序关系，请查看**物料代码**和**工艺路线代码**字段。  

还可以通过使用**复制和编辑关系**功能，手动创建特定于某个工艺路线和发布的产品的工序。  

> [!NOTE]
> 如果在**工艺路线**页中向工艺路线添加新工序，将仅为当前发布的产品创建工序关系。 因此，如果也将此工艺路线用于生产发布的其他产品，则这些发布的产品无适用的工序关系，并且不再将该工艺路线用于这些发布的产品。

### <a name="maintaining-operation-relations-per-route"></a>按工艺路线维护工序关系

在您从**工艺路线**列表页打开**工艺路线详细信息**时，将显示应用于所选工艺路线的所有工序关系的列表。 因此，可以轻松验证将哪些操作属性用于了哪些产品。 可以修改默认属性值和产品特定的属性值。  

如果**工艺路线详细信息**页中添加新工序关系，将把**工艺路线代码**字段自动设置为**工艺路线**，将**工艺路线关系**字段设置为当前工艺路线的工艺路线编号。

### <a name="maintaining-operation-relations-per-operation"></a>按工序维护工序关系

可以通过**工序**页打开**工序关系**页。 可以在该页中修改特定工序的所有工序关系。 甚至可以修改包含默认值的工序关系。  

如果贵企业使用标准工序，并且所有产品和流程之间的操作参数都相同，则可通过**工序关系**页轻松维护这些工序的默认操作属性。

### <a name="applying-operation-relations"></a>应用工序关系

在某些情况下，Supply Chain Management 必须找到某道工序的操作属性。 例如，在创建采购订单时，必须将每道工序的操作属性从工序关系复制到生产工艺路线。 在这些情况下，Supply Chain Management 搜索从最特定的组合到最不特定的组合一一搜索相关工序关系。  

在 Supply Chain Management 搜索与发布的产品关系最密切的工序关系时，匹配发布的产品的物料 ID 的工序关系的优先级高过匹配物料组 ID 的工序关系。 同样，匹配物料组 ID 的工序关系优先级高过默认工序关系。 搜索按以下顺序进行：

1.  **物料代码**=**表**和**物料关系**=&lt;物料 ID&gt;
2.  **物料代码**=**组**和**物料关系**=&lt;物料组 ID&gt;
3.  **物料代码**=**全部**
4.  **工艺路线代码**=**工艺路线**和**工艺路线关系**=&lt;工艺路线 ID&gt;
5.  **工艺路线代码**=**全部**
6.  **配置**=&lt;配置 ID&gt;
7.  **配置**=
8.  **站点**=&lt;站点 ID&gt;
9.  **站点**=

因此，工序只能为每个工艺路线使用一次。 如果工序在同一个工艺路线中出现多次，则该工序每次出现时都具有相同的工序关系，而您不能为该工序的每次出现设置不同属性（例如，运行时间）。

## <a name="route-versions"></a>工艺路线版本
工艺路线版本用于容纳生产产品时的各种变数，或使您更好地控制生产流程。 它们定义生产特定的已发布产品或已发布产品变型时应使用哪个工艺路线。 您可以使用以下约束来定义将哪个工艺路线用于发布的产品：

-   产品维度（尺寸、颜色、样式或配置）
-   生产数量
-   生产站点
-   生产日期

在特定站点以特定数量或特定期间生产产品时，可以将特定工艺路线版本指定为默认工艺路线版本。 但是请注意，一个给定已发布产品和一组给定约束只能有一个活动的工艺路线。  

在“生产控制参数”中，您可以要求始终指定工艺路线版本的有效期。

### <a name="approval-of-route-versions"></a>工艺路线版本的批准

工艺路线版本必须先经过批准，然后才能在计划或制造流程中使用。 批准工艺路线版本时，也将批准相关工艺路线。 但是请注意，仅当也批准了相关工艺路线，才可以批准工艺路线版本。

### <a name="activating-the-default-route-version"></a>激活默认工艺路线版本

在您激活工艺路线版本时，可以将其指定为主计划将使用或将用于创建生产订单的默认工艺路线版本。 一组给定约束（如期间、站点或数量）只能有一个活动工艺路线版本。 如果正在尝试激活的版本与已处于活动状态的版本冲突，您将收到错误消息。 为了防止不明确的激活，您随后必须停用冲突的版本或修改工艺路线版本中的版本约束。

### <a name="electronic-signatures"></a>电子签名

如果必须保留日志以记录谁批准和激活了每个工艺路线版本，这些任务可能需要电子签名。 然后，批准和激活工艺路线版本的用户必须通过使用[电子签名](../../fin-and-ops/organization-administration/electronic-signature-overview.md)确认自己的身份。

### <a name="product-change-that-uses-case-management"></a>使用案例管理的产品变更

适用于新的或已更改的工艺路线和工艺路线版本的产品变更案例提供了一个查看工艺路线版本约束的简单方法。 您也可以批准和激活与一道工序中的特定更改有关的所有工艺路线，并将结果记录到产品变更案例中。

## <a name="maintaining-routes"></a>维护工艺路线
根据您的业务要求，您可能可以减少维护流程定义所需的工作量。

### <a name="making-routes-independent-of-resources"></a>使工艺路线独立于资源

在许多系统中，必须在工艺路线中指定应执行工序的工序资源或资源组。 但是在 Supply Chain Management 中，可以定义一组要求，工序资源必须满足这组要求才能适用于工序。 因此，在真正安排工序之前，不必确定应使用的特定工序资源或资源组。 在您有大量工作人员或机器可以执行同一道工序时，此功能特别有用。  

例如，您指定某道工序需要有**冲压**能力为 20 吨的**机器**类型的工序资源。 安排此工序时，调度引擎将把这些要求解析为特定工序资源或资源组。 因为您可以仅指定这些要求，而不是将工序绑定到特定机器，所以您的灵活性更高。 此外，移动资源或添加新资源时，更容易维护。  

有关各种资源要求及其使用方法的详细信息，请参阅“工序资源要求”和[资源产能](resource-capabilities.md)。

### <a name="sharing-routes-across-sites"></a>跨站点共享工艺路线

如果您在多个生产站点生产同一个产品，并且该产品的生产步骤在所有站点都相同，通常可以设计跨所有生产站点使用的工序工艺路线。 要创建共享工艺路线，请勿在工艺路线本身中指定站点。  不过，您仍必须创建一个工艺路线版本，用于在各站点将共享工艺路线与该产品关联。  

还必须确保该工艺路线中各工序的资源要求不需要特定工序资源或资源组，而是以所需资源的特征的形式表达。 然后，调度引擎可以从安排了生产的站点分配相应的工序资源。 例如，如果运行时间稍有不同，或者特定工序的设置时间特定于站点，您可以通过为该站点再添加一个工序关系来指定此信息。  

若要充分利用共享工艺路线，还应使用相应物料清单 (BOM) 中的资源消耗量。 在您为物料清单行中的资源消耗量设置标志时原材料、消耗的原材料的来源仓库和位置将通过为工序安排的工序资源推断出来。 因此，真正安排生产之前，不必确定仓库和位置。 这样，您就可以让物料清单和工艺路线都独立于生产产品的实际位置。

### <a name="standard-operation-relations"></a>标准工序关系

如果贵企业在整个生产过程中均使用标准化工序，并且设置时间、运行时间、消耗量计算、成本计算等的变动很小或没有变动，您可以受益于为所有工序创建默认工序关系。 在这种情况下，请避免创建特定于任何工艺路线或发布的产品的工序关系。  

如果您还以技能和产能的形式表示资源需求，并让您的工艺路线独立于站点，则可以帮助让业务流程的持续维护保持在最低水平。  

在使用此方法时，**工序关系**页变为用于维护运行时间和其他属性的主要场所。

### <a name="resource-specific-process-times"></a>资源特定的处理时间

如果不为工序的资源要求指定工序资源或资源组，则适用的资源可能以不同速度操作。 因此，处理工序所需时间可能会有所不同。 为了解决此问题，您可以使用工序关系中的**公式**字段指定处理时间的计算方法。 选项如下：

-   **标准** -（默认选项）计算仅使用工序关系中的字段，并将指定的运行时间乘以订单数量。
-   **产能** – 计算包括工序资源中的**产能**字段。 因此，时间与资源相关。 在工序资源中指定的值是每小时的产能。 此值乘以订单数量和工序关系中的**系数**值。
-   **批次** – 批次产能通过使用工序关系中的信息来计算。 所以可以根据订单数量计算批次的数量和处理时间。
-   **资源批次** – 此选项基本与**批次**选项相同。 但是，计算中包含工序资源中的**批次产能**。 因此，时间与资源相关。

### <a name="set-up-route-groups"></a>设置工艺路线组

可以在**生产控制 > 设置 > 工艺路线 > 工艺路线组**下为其工艺路线或作业类型定义工艺路线组和设置。 对于工艺路线组中的工艺路线/作业类型，可以选择或清除以下选项：

- **激活** - 选择此选项可为所选作业类型启用计算和计划，并在您运行作业级排产时接收作业反馈。 需要选择此选项以启用作业类型，然后选择该作业类型的其他选项。 如果不选择激活，将不启用该作业类型，无论是否选择其他选项。 
- **作业管理** - 选择此选项可在运行作业级排产时在作业管理中包含作业类型。 
- **工作时间** - 选择此选项可根据为工序资源定义的工作日历计划作业类型，否则使用公历。 可以根据阳历或定义的工作时间日历来安排工作时间。 如果选择此选项，则计划基于定义的工作日历。 此外，作业类型的作业从定义为作业的开始日期的日期的午夜进行计划。
- **产能** - 选择此选项可在运行作业级排产时为作业类型预留产能。 如果您选择此选项，会在运行计划时为所选作业类型预留产能。 这可为您提供每个工艺路线组中的哪些作业类型使用工序资源的概览。 例如，在烘干滚筒等烘干资源（如干燥滚筒）是瓶颈资源的情况下，必须将这些资源指定为瓶颈。 分配给排队时间作业类型的烘干工序将预留烘干资源。 

对于每种作业类型，首先需要将其激活或停用。 如果停用，则不考虑任何其他设置（作业管理、工作时间、产能），因为该作业类型未处于活动状态。 

作业类型中包含“重叠”。 重叠允许同时执行不同作业。 作业重叠时，资源可以使用，但不能为特定作业保留。
因此，如果“激活”选择“重叠”，其余设置（作业管理、工作时间和产能）在工艺路线组中不会产生任何影响。 

> [!NOTE]
> 升级安保时，可能遇到以下错误：**调用计划编制引擎时出现 CLR 错误**。 如果遇到此错误，请转到**工艺路线组**页面，然后清除激活了**重叠**的所有工艺路线的**作业管理**、**工作时间**和**产能**选项。 

## <a name="additional-resources"></a>其他资源

- [物料清单和配方](bill-of-material-bom.md)

- [在生产工艺路线中使用的成本类别](../cost-management/cost-categories-used-production-routings.md)

- [资源功能](resource-capabilities.md)

- [电子签名概览](../../fin-and-ops/organization-administration/electronic-signature-overview.md)



