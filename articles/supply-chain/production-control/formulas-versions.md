---
title: 配方和配方版本
description: 此主题提供有关配方和配方版本的信息。 配方定义流程制造中的特定流程的物料、成分和结果。 配方用于计划和生产流程制造中的产品。
author: cvocph
manager: tfehr
ms.date: 09/12/2017
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: PlanActivity, ReqSupplyDemandSchedule, EcoResProductProdTypeFormulaNoActiveFormulaFormPart
audience: Application User
ms.reviewer: kamaybac
ms.search.scope: Core, Operations
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.search.industry: Manufacturing
ms.author: conradv
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 0ebe6228bdf94bbe7c8ffa282f9cd633ad25bc78
ms.sourcegitcommit: cde71bc7d14ea6cdff2c4e991057d39a6a0473d9
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/24/2020
ms.locfileid: "3886936"
---
# <a name="formulas-and-formula-versions"></a><span data-ttu-id="f10bd-105">配方和配方版本</span><span class="sxs-lookup"><span data-stu-id="f10bd-105">Formulas and formula versions</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="f10bd-106">配方定义流程制造中的特定流程的物料、成分和结果。</span><span class="sxs-lookup"><span data-stu-id="f10bd-106">A formula defines the materials, ingredients, and outcomes of a specific process in process manufacturing.</span></span> <span data-ttu-id="f10bd-107">配方与相应的工艺路线一起定义流程制造中的整个流程。</span><span class="sxs-lookup"><span data-stu-id="f10bd-107">Together with the corresponding route, the formula defines the whole process in process manufacturing.</span></span> <span data-ttu-id="f10bd-108">配方用于计划和生产流程制造中的产品。</span><span class="sxs-lookup"><span data-stu-id="f10bd-108">Formulas are used to plan and produce products in process manufacturing.</span></span>

<span data-ttu-id="f10bd-109">配方由生产特定数量的配方物料所需的成分和数量构成。</span><span class="sxs-lookup"><span data-stu-id="f10bd-109">A formula consists of the ingredients and quantities that are required in order to produce a specific quantity of a formula item.</span></span> <span data-ttu-id="f10bd-110">根据您执行的任务，可以从“库存和仓库管理”或“产品信息管理”中访问配方功能。</span><span class="sxs-lookup"><span data-stu-id="f10bd-110">Depending on the task that you perform, you can access formula functionality from Inventory and warehouse management or Product information management.</span></span>

## <a name="formulas-and-formula-lines"></a><span data-ttu-id="f10bd-111">配方和配方行</span><span class="sxs-lookup"><span data-stu-id="f10bd-111">Formulas and formula lines</span></span>
<span data-ttu-id="f10bd-112">配方由确定组成配方的成分或物料的一个或多个配方行构成。</span><span class="sxs-lookup"><span data-stu-id="f10bd-112">A formula consists of one or more formula lines that identify the ingredients or items that make up the formula.</span></span> <span data-ttu-id="f10bd-113">配方行可以包含物料清单 (BOM) 物料、配方物料、非定重物料、采购的物料、联产品或副产品。</span><span class="sxs-lookup"><span data-stu-id="f10bd-113">A formula line can contain Bill of materials (BOM) items, formula items, catch-weight items, purchased items, co-products, or by-products.</span></span> <span data-ttu-id="f10bd-114">由于许多物料在多个产品中使用，因此一个物料可以在多个配方中使用。</span><span class="sxs-lookup"><span data-stu-id="f10bd-114">Because many items are used in multiple products, an item can be used in more than one formula.</span></span>

<span data-ttu-id="f10bd-115">例如巧克力豆饼干的配方。</span><span class="sxs-lookup"><span data-stu-id="f10bd-115">An example of a formula is the formula for a chocolate chip cookie.</span></span> <span data-ttu-id="f10bd-116">此配方的成分使用多个行，如面粉、糖、鸡蛋、黄油和巧克力豆。</span><span class="sxs-lookup"><span data-stu-id="f10bd-116">The ingredients for this formula use multiple lines, such as flour, sugar, eggs, butter, and chocolate chips.</span></span> <span data-ttu-id="f10bd-117">巧克力豆饼干的配方包含的成分有可能在其他配方中使用。</span><span class="sxs-lookup"><span data-stu-id="f10bd-117">The formula for the chocolate chip cookie contains ingredients that are likely used in other formulas.</span></span> <span data-ttu-id="f10bd-118">当您制作巧克力豆饼干时，可能会有剩余物料，如饼干屑，或者有一些饼干可能烘烤过度或烘烤不足。</span><span class="sxs-lookup"><span data-stu-id="f10bd-118">While you make the chocolate chip cookies, there might be leftovers, such as crumbs, or some of the cookies might be overbaked or undercooked.</span></span> <span data-ttu-id="f10bd-119">可以根据生产工序将这些物料设置为联产品或副产品。</span><span class="sxs-lookup"><span data-stu-id="f10bd-119">These items can be set up as co-products or by-products, depending on the production operations.</span></span>

<span data-ttu-id="f10bd-120">当您创建配方行时，使用行类型指示系统在您运行主计划和生产批次订单时如何处理行。</span><span class="sxs-lookup"><span data-stu-id="f10bd-120">When you create a formula line, you use the line type to indicate how the system should handle the line when you run master planning and produce batch orders.</span></span> <span data-ttu-id="f10bd-121">每种行类型都提供不同的结果。</span><span class="sxs-lookup"><span data-stu-id="f10bd-121">Each line type gives a different result.</span></span> <span data-ttu-id="f10bd-122">下表介绍可以选择的行类型。</span><span class="sxs-lookup"><span data-stu-id="f10bd-122">The following table describes the line types that you can select.</span></span> 

| <span data-ttu-id="f10bd-123">行类型</span><span class="sxs-lookup"><span data-stu-id="f10bd-123">Line type</span></span>     | <span data-ttu-id="f10bd-124">说明</span><span class="sxs-lookup"><span data-stu-id="f10bd-124">Description</span></span>  |
|---------------|--------------|
| <span data-ttu-id="f10bd-125">项目</span><span class="sxs-lookup"><span data-stu-id="f10bd-125">Item</span></span>          | <span data-ttu-id="f10bd-126">在物料是从库存中领取的原材料或半成品时，或者在物料是服务时，选择**物料**。</span><span class="sxs-lookup"><span data-stu-id="f10bd-126">Select **Item** when the item is a raw material or a semi-finished item that is picked from inventory or when the item is a service.</span></span> |
| <span data-ttu-id="f10bd-127">虚拟</span><span class="sxs-lookup"><span data-stu-id="f10bd-127">Phantom</span></span>       | <span data-ttu-id="f10bd-128">当您想要展开在配方行上包含的任何更低级别的配方物料时，选择**虚拟**。</span><span class="sxs-lookup"><span data-stu-id="f10bd-128">Select **Phantom** when you want to explode any lower-level formula items that are contained on formula lines.</span></span> <span data-ttu-id="f10bd-129">当您估算批次订单，且展开配方物料时，构成物料在批次订单上被列为配方行。</span><span class="sxs-lookup"><span data-stu-id="f10bd-129">When you estimate the batch order, and the formula items are exploded, the component items are listed as formula lines on the batch order.</span></span> <span data-ttu-id="f10bd-130">此外，相应的工艺路线被添加到生产工艺路线中。</span><span class="sxs-lookup"><span data-stu-id="f10bd-130">Additionally, the corresponding routes are added to the production route.</span></span> <span data-ttu-id="f10bd-131">使用当前配置展开配方物料。</span><span class="sxs-lookup"><span data-stu-id="f10bd-131">Formula items are exploded by using the current configuration.</span></span> <span data-ttu-id="f10bd-132">使用**虚拟**行类型时，可以处理在不同配方级别发生的生产和测量配置。</span><span class="sxs-lookup"><span data-stu-id="f10bd-132">When you use the **Phantom** line type, you can handle production and measurement configurations that occur at different formula levels.</span></span> <span data-ttu-id="f10bd-133">如果为**已发布产品详细信息**页的**工程师**快速选项卡上的产品选择**虚拟**，然后在配方中使用该产品，则配方行的行类型更改为**虚拟**。</span><span class="sxs-lookup"><span data-stu-id="f10bd-133">If you select **Phantom** for a product on the **Engineer** FastTab of the **Released product details** page and then use this product in a formula, the line type of the formula line is changed to **Phantom**.</span></span> <span data-ttu-id="f10bd-134">不能为非定重物料或生产类型为**联产品**、**副产品**或**计划物料**的物料选择**虚拟**。</span><span class="sxs-lookup"><span data-stu-id="f10bd-134">You can't select **Phantom** for a catch-weight item, or for items where the production type is **Co-product**, **By-product**, or **Planning item**.</span></span> |
| <span data-ttu-id="f10bd-135">限定供应</span><span class="sxs-lookup"><span data-stu-id="f10bd-135">Pegged supply</span></span> | <span data-ttu-id="f10bd-136">选择**限定供应**为配方行中包含的成分创建批次订单、生产订单、看板、转移单或采购订单。</span><span class="sxs-lookup"><span data-stu-id="f10bd-136">Select **Pegged supply** to create a batch order, production order, kanban, transfer order, or purchase order for the ingredient that is contained on the formula line.</span></span> <span data-ttu-id="f10bd-137">相关订单基于默认订单设置和成分的生产类型予以确定，并且在您估算批次订单时创建。</span><span class="sxs-lookup"><span data-stu-id="f10bd-137">The related order is determined based on the default order settings and the production type of the ingredient, and is created when you estimate the batch order.</span></span> <span data-ttu-id="f10bd-138">为批次订单预留所需的成分数量。</span><span class="sxs-lookup"><span data-stu-id="f10bd-138">The required ingredient quantities are reserved for the batch order.</span></span> |
| <span data-ttu-id="f10bd-139">供应商</span><span class="sxs-lookup"><span data-stu-id="f10bd-139">Vendor</span></span>        | <span data-ttu-id="f10bd-140">如果生产流程使用分包商，且您希望为该分包商创建子生产或采购订单，则选择**供应商**。</span><span class="sxs-lookup"><span data-stu-id="f10bd-140">Select **Vendor** if the production process uses a subcontractor, and you want to create a sub-production or purchase order for the subcontractor.</span></span> <span data-ttu-id="f10bd-141">必须使用配方物料或服务项创建该分包商执行的服务或工作。</span><span class="sxs-lookup"><span data-stu-id="f10bd-141">The service or work that the subcontractor performs must be created by using a formula item or service item.</span></span> <span data-ttu-id="f10bd-142">您可以将该物料作为配方行附加到父物料。</span><span class="sxs-lookup"><span data-stu-id="f10bd-142">You can attach the item to the parent item as a formula line.</span></span> <span data-ttu-id="f10bd-143">工艺路线必须包含分配给转包商的运营资源。</span><span class="sxs-lookup"><span data-stu-id="f10bd-143">The route must contain an operation that is assigned to the subcontractor's operations resource.</span></span> <span data-ttu-id="f10bd-144">可以使用**操作号**将该操作附加到配方行。</span><span class="sxs-lookup"><span data-stu-id="f10bd-144">This operation is attached to the formula line by using the **Oper. No.**</span></span> <span data-ttu-id="f10bd-145">字段中），则将自动选中此复选框。</span><span class="sxs-lookup"><span data-stu-id="f10bd-145">field.</span></span> |

## <a name="formula-versions"></a><span data-ttu-id="f10bd-146">配方版本</span><span class="sxs-lookup"><span data-stu-id="f10bd-146">Formula versions</span></span>
<span data-ttu-id="f10bd-147">当您创建新配方时，必须先创建配方版本，然后才能添加配方行物料及其特定特性。</span><span class="sxs-lookup"><span data-stu-id="f10bd-147">When you create a new formula, you must first create a formula version before you add the formula line items and their specific characteristics.</span></span> <span data-ttu-id="f10bd-148">每个配方都必须至少有一个版本。</span><span class="sxs-lookup"><span data-stu-id="f10bd-148">Every formula must have at least one version.</span></span> <span data-ttu-id="f10bd-149">在成功保存了版本记录之后，对配方版本上的**审核**按钮将可用。</span><span class="sxs-lookup"><span data-stu-id="f10bd-149">The **Approved** button on a formula version becomes available only after a version record has been successfully saved.</span></span> <span data-ttu-id="f10bd-150">每个配方版本记录与一个或多个可以在生产成品时的联产品和副产品相关联。</span><span class="sxs-lookup"><span data-stu-id="f10bd-150">Each formula version record is associated with one or many co-products and by-products that can be produced as you produce the finished product.</span></span> <span data-ttu-id="f10bd-151">许多产品可由不同的批次规模、倍数或使用多个不同产出中相同的成分产出。</span><span class="sxs-lookup"><span data-stu-id="f10bd-151">Many products can be made from the same ingredients in different batch sizes, in multiples, or by using different yields.</span></span> <span data-ttu-id="f10bd-152">您可以创建所需数量的配方版本。</span><span class="sxs-lookup"><span data-stu-id="f10bd-152">You can create as many versions of a formula as you require.</span></span>

<span data-ttu-id="f10bd-153">若要管理多个有效配方版本，则使用有效日期范围或“起始”数量字段。</span><span class="sxs-lookup"><span data-stu-id="f10bd-153">To manage multiple active formula versions, use effective date ranges or "from" quantity fields.</span></span> <span data-ttu-id="f10bd-154">仅当日期范围和“起始”数量不重叠时，才能存在多个有效配方版本。</span><span class="sxs-lookup"><span data-stu-id="f10bd-154">Multiple active formula versions can exist only if the date range and "from" quantity don't overlap.</span></span>

<span data-ttu-id="f10bd-155">与 BOM 不同，一个 BOM 通常与许多 BOM 版本相关联，但每个配方通常只存在一个配方版本。</span><span class="sxs-lookup"><span data-stu-id="f10bd-155">Unlike BOMs, where one BOM is often associated with many BOM versions, only one formula version typically exists per formula.</span></span> <span data-ttu-id="f10bd-156">记住，只能为一个给定产品的覆盖范围维度和数量启用一个配方版本。</span><span class="sxs-lookup"><span data-stu-id="f10bd-156">Remember that only one formula version can be activated for the coverage dimensions and quantity for a given product.</span></span> <span data-ttu-id="f10bd-157">但是，可能因为其他原因存在许多配方版本，当您创建批次订单时，您可以手动选择它们。</span><span class="sxs-lookup"><span data-stu-id="f10bd-157">However, many formula versions might exist for other reasons, and you can manually select them when you create a batch order.</span></span>

## <a name="approve-and-activate-formulas-and-formula-versions"></a><span data-ttu-id="f10bd-158">审核和启用配方和配方版本</span><span class="sxs-lookup"><span data-stu-id="f10bd-158">Approve and activate formulas and formula versions</span></span>
<span data-ttu-id="f10bd-159">配方和配方版本在用于计划和生产之前必须已经过审核。</span><span class="sxs-lookup"><span data-stu-id="f10bd-159">Formulas and formula versions must be approved before they can be used for planning and production.</span></span> <span data-ttu-id="f10bd-160">配方通常在使用前启用。</span><span class="sxs-lookup"><span data-stu-id="f10bd-160">Formulas are usually activated before they are used.</span></span> <span data-ttu-id="f10bd-161">但是，在生产期间，可以选择已审核的配方版本，但该版本未启用。</span><span class="sxs-lookup"><span data-stu-id="f10bd-161">However, during production, you can select a formula version that is approved, but that isn't activated.</span></span>

<span data-ttu-id="f10bd-162">为了帮助获得配方或配方版本，您可以在**生产控制参数**页上设置**锁定编辑**和**锁定审核删除**参数。</span><span class="sxs-lookup"><span data-stu-id="f10bd-162">To help secure a formula or formula version, you can set the **Block editing** and **Block removal of approval** parameters on the **Production control parameters** page.</span></span>

<span data-ttu-id="f10bd-163">如果您选择**锁定编辑**，并且配方已审核，配方行的字段不能删除或编辑。</span><span class="sxs-lookup"><span data-stu-id="f10bd-163">If you select **Block editing**, and the formula is approved, no fields on the formula lines can be deleted or edited.</span></span> <span data-ttu-id="f10bd-164">但是，如果您撤销对配方的审核，您则可以修改和删除配方行。</span><span class="sxs-lookup"><span data-stu-id="f10bd-164">However, if you remove the approval of the formula, you can delete and modify the formula lines.</span></span> <span data-ttu-id="f10bd-165">您还可以创建新的配方和新的配方版本。</span><span class="sxs-lookup"><span data-stu-id="f10bd-165">You can also create new formulas and new formula versions.</span></span>

<span data-ttu-id="f10bd-166">如果您选择**锁定审核删除**，则不能删除已审核的配方或配方版本的审核。</span><span class="sxs-lookup"><span data-stu-id="f10bd-166">If you select **Block removal of approval**, you can't remove the approval of an approved formula or formula version.</span></span> <span data-ttu-id="f10bd-167">但是，您可以创建新的配方和新的配方版本，并且您可以删除配方版本的开始日期。</span><span class="sxs-lookup"><span data-stu-id="f10bd-167">However, you can create new formulas and new formula versions, and you can remove the activation of the formula version.</span></span>

<span data-ttu-id="f10bd-168">通过使用电子签名功能，您可以添加更多的控制级别。</span><span class="sxs-lookup"><span data-stu-id="f10bd-168">You can add more levels of control by using the electronic signature functionality.</span></span> <span data-ttu-id="f10bd-169">当用户设置为要求在审核配方时进行电子签名，则当启用配方时会显示**签名**页。</span><span class="sxs-lookup"><span data-stu-id="f10bd-169">When a user is set up so that an electronic signature is required at the time of formula approval, a **Signature** page appears when the formula is activated.</span></span> <span data-ttu-id="f10bd-170">用户必须获得授权才能进行电子签名，并且在提交更改前必须成功验证证书。</span><span class="sxs-lookup"><span data-stu-id="f10bd-170">The user must be authorized to sign electronically, and the certificate must be successfully validated before the change can be committed.</span></span> <span data-ttu-id="f10bd-171">如果无法对签名进行身份验证，则会拒绝审核或审核删除，并会使启动审核或审核删除的更改返回原始状态。</span><span class="sxs-lookup"><span data-stu-id="f10bd-171">If the signature can't be authenticated, the approval or removal of approval is denied, and the change that initiated the approval or removal of approval is returned to its original state.</span></span>

## <a name="use-the-scalable-feature"></a><span data-ttu-id="f10bd-172">使用可扩展的功能</span><span class="sxs-lookup"><span data-stu-id="f10bd-172">Use the Scalable feature</span></span>
<span data-ttu-id="f10bd-173">只有在配方中的所有物料构成设置为**可变消耗**时，可扩展字段才可用。</span><span class="sxs-lookup"><span data-stu-id="f10bd-173">The Scalable feature is available only if all the item components in the formula are set to **Variable consumption**.</span></span> <span data-ttu-id="f10bd-174">如果物料构成设置为**固定消耗量**或**步骤消耗量**，则此功能不可用。</span><span class="sxs-lookup"><span data-stu-id="f10bd-174">The feature isn't available if item components are set to **Fixed consumption** or **Step consumption**.</span></span> <span data-ttu-id="f10bd-175">使用可扩展功能时，如果您更改配方中的成分，则您选择的其他成分的数量会进行调整。</span><span class="sxs-lookup"><span data-stu-id="f10bd-175">When the Scalable feature is used, if you change an ingredient in a formula, the quantity of the other ingredients that you select is adjusted.</span></span> <span data-ttu-id="f10bd-176">还调整配方的范围。</span><span class="sxs-lookup"><span data-stu-id="f10bd-176">The size of the formula is also adjusted.</span></span> <span data-ttu-id="f10bd-177">同样，如果您更改配方大小，则所有可扩展成分的数量都会更改。</span><span class="sxs-lookup"><span data-stu-id="f10bd-177">Likewise, if you change the formula size, the quantity of all scalable ingredients is changed.</span></span> <span data-ttu-id="f10bd-178">此功能专门用于创建和维护配方。</span><span class="sxs-lookup"><span data-stu-id="f10bd-178">This feature is intended specifically for formula creation and maintenance.</span></span> <span data-ttu-id="f10bd-179">它并不指示批次订单上的成分的数量是否会按比例增加或减少。</span><span class="sxs-lookup"><span data-stu-id="f10bd-179">It doesn't indicate whether the quantity of an ingredient will be scaled up or down on a batch order.</span></span>

## <a name="use-step-consumption"></a><span data-ttu-id="f10bd-180">使用步骤消耗量</span><span class="sxs-lookup"><span data-stu-id="f10bd-180">Use Step consumption</span></span>
<span data-ttu-id="f10bd-181">步骤消耗量清除必须在**配方行**选项卡上输入成分数量的要求。</span><span class="sxs-lookup"><span data-stu-id="f10bd-181">Step consumption eliminates the requirement that you must enter a quantity on the **Formula line** tab for an ingredient.</span></span> <span data-ttu-id="f10bd-182">相反，将步骤消耗量配置为具有**开始系列**值和**数量**值。</span><span class="sxs-lookup"><span data-stu-id="f10bd-182">Instead, Step consumption is configured so that it has a **From series** value and a **Quantity** value.</span></span> <span data-ttu-id="f10bd-183">从每系列记录的步骤消耗量选择满足批次订单上的数量的信息。</span><span class="sxs-lookup"><span data-stu-id="f10bd-183">The information from the Step consumption per series record that satisfies the quantity on the batch order is selected.</span></span> <span data-ttu-id="f10bd-184">当消耗率与批次订单的大小不呈线性关系且仅增加满足特定数量阈值的要求时，步骤消耗量非常有用。</span><span class="sxs-lookup"><span data-stu-id="f10bd-184">Step consumption is useful when the consumption rate isn't linear with respect to the batch order size and only increases the requirement when a specific quantity threshold is met.</span></span> <span data-ttu-id="f10bd-185">若要对新配方启用此功能，在**消耗计算**组下，将适用成分的配方设置从**标准**更改为**步骤**。</span><span class="sxs-lookup"><span data-stu-id="f10bd-185">To enable this feature for a new formula, under the **Consumption calculation** group, change the formula setting for the applicable ingredient from **Standard** to **Step**.</span></span> <span data-ttu-id="f10bd-186">在**配方行**页的**设置**选项卡上指定此工作量法。</span><span class="sxs-lookup"><span data-stu-id="f10bd-186">You specify this consumption method on the **Setup** tab of the **Formula line** page.</span></span>
