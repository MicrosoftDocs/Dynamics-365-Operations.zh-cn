---
title: 加权平均日期
description: 加权平均日期是基于加权平均原则的库存模型，其中，来自库存的发货按照物料的平均价值进行估价，这些物料是在库存结转期间中的每一天接收到库存中的物料。
author: AndersGirke
ms.date: 10/25/2017
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: InventJournalLossProfit, InventMarking, InventModelGroup, SalesTable
audience: Application User
ms.reviewer: kamaybac
ms.custom: 28991
ms.assetid: 945d5088-a99d-4e54-bc42-d2bd61c61e22
ms.search.region: Global
ms.search.industry: Retail
ms.author: kamaybac
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 563fa291754f7f795fa64d530de49b9fe4083c56
ms.sourcegitcommit: 0e8db169c3f90bd750826af76709ef5d621fd377
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/01/2021
ms.locfileid: "5821289"
---
# <a name="weighted-average-date"></a>加权平均日期

[!include [banner](../includes/banner.md)]

加权平均日期是基于加权平均原则的库存模型。 对于加权平均原则，来自库存的发货按照物料的平均价值进行估价，这些物料是在库存结转期间中的每一天接收到库存中的物料。 

当您使用加权平均日期运行库存结转时，所有每日收货将根据虚拟发货结算。 此虚拟发货保留该日期的收货总量和值。 此虚拟发货具有对应的虚拟收货，并将根据此虚拟收货结算发货。 因此，所有发货都接收相同的平均成本。 虚拟发货和虚拟收货可以视为虚拟转移，称为 *加权平均库存结转转移*。 

如果只发生过一次收货或在该日期之前，则不必评估平均值。 因为所有发货从该收货结算，并且将不创建虚拟转移。 同样，如果在此日期只发生发货，则没有要估计平均价值的收货，并且将不创建虚拟转移。 当您使用加权平均日期时，您可以标记库存交易记录，以便根据指定发货结算指定物料收货。 在这种情况下，您不使用加权平均日期规则。 当您使用加权平均日期库存模型时，建议您使用每月库存结转。 

以下公式用于计算加权平均日期成本计算方法： 

加权平均 = (\[Q1 × P1\] + \[Q2 × P2\] + \[Q *n* × P *n*\]) ÷ (Q1 + Q2 + Q *n*) 

在库存结转期间，将通过如下图中所示的结转期间每天执行计算。 

![加权平均日期每日计算模型](./media/weightedaveragedatedailycalculationmodel.gif) 

脱离库存的库存交易记录，如销售订单、库存日志、采购贷方通知单和生产订单，将在过帐时按预估的成本价发生。 此预估成本价也称作移动平均成本价。 在库存结转时，此系统分析以前期间、前几天和当天的库存交易记录。 这一分析用于确定应使用以下哪些结转原则：

-   直接结算
-   汇总结算

结算是在结转日期时将发货调整为正确的加权平均的库存结转过帐。 

**注意：** 有关结算的详细信息，请参阅库存结转相关文章。 以下示例通过五个配置阐释对使用加权平均的影响：

-   不使用 **包括实际成本** 选项时的加权平均日期直接结算
-   不使用 **包括实际成本** 选项时的加权平均日期汇总结算
-   使用 **包括实际成本** 选项时的加权平均日期直接结算
-   使用 **包括实际成本** 选项时的加权平均日期汇总结算
-   使用标记时的加权平均日期

## <a name="weighted-average-date-direct-settlement-when-the-include-physical-value-option-isnt-used"></a>不使用包括实际成本选项时的加权平均日期直接结算
当前版本使用的直接结算原则与之前版本中加权平均使用的直接结算原则相同。 系统将直接在收货和发货之间进行结算。 此系统在特定情况下使用这一直接结算原则：

-   已在期间中过帐一个收货以及一个或若干发货。
-   在该期间中只过帐了发货，并且库存包含来自以前结转的现有物料。

在下面的场景中，已过帐财务上更新的收货和发货。 在库存结转期间，此系统将直接根据发货对收货进行结算，并且在发货时不需要对成本价进行调整。 

下图显示了这些交易记录：

-   1a. 为数量 5（单件成本为 USD 10.00）更新库存实际收货。
-   1b. 为数量 5（单件成本为 USD 10.00）更新库存财务收货。
-   2a. 为数量 2（单件成本为 USD 10.00）更新库存实际发货。
-   2b. 为数量 2（单件成本为 USD 10.00）更新库存财务发货。
-   3. 通过使用直接结算方法执行库存结转，以便结算对库存财务发货的库存财务收货。

![没有“包括实际成本”选项的加权平均日期直接结算](./media/weightedaveragedatedirectsettlementwithoutincludephysicalvalue.gif) 

**插图要点：**

-   库存交易记录用垂直箭头表示。
-   入库用时间线上的垂直箭头表示。
-   出库用时间线下的垂直箭头表示。
-   在每一垂直箭头之上（或之下），以 *数量*@*单位价格* 格式指定库存交易记录的值。
-   如果用括号括起来库存交易记录值，该库存交易记录实际过帐到库存中。
-   如果没用括号括起来库存交易记录值，该库存交易记录财务过帐到库存中。
-   每个新的收货或发货交易记录都用一个新标签标明。
-   每个垂直箭头用连续标识符标记，例如 *1a*。 这些标识符指示时间线中库存交易记录过帐的顺序。
-   库存结转用红色的垂直虚线以及 *“库存结转”* 标签表示。
-   由库存结转执行的结算用红色虚线箭头（沿对角方向从收货指向发货）表示。

## <a name="weighted-average-date-summarized-settlement-when-the-include-physical-value-option-isnt-used"></a>不使用包括实际成本选项时的加权平均日期汇总结算
加权平均基于年末结转期间内的所有收货都汇总到一个新的库存转移交易记录的原则。 此交易记录称作 *加权平均库存结转*。 该天的所有收货都根据新创建的库存转移交易记录的发货进行结算。 该天的所有发货都根据新的库存转移交易记录的收货进行结算。 如果在库存结转后，现有库存量为正值，则库存的现有库存量和值将汇总在新的库存转移交易记录收货上。 如果在库存结转后，现有库存量为负值，则库存的现有库存量和值将是尚未完全结算的各个单独发货之和。 

在下面的场景中，在该期间中，已过帐若干财务上更新的收货和发货。 在库存结转期间，此系统将对每一天进行评估，以便确定每一天是否应按结转处理。 

下图显示了这些交易记录： 

**第 1 天：**

-   1a. 为数量 3（单价 USD 15.00）更新库存实际收货。
-   1b. 为数量 3（单价 USD 15.00）更新库存财务收货。
-   2a. 数量 1（移动平均成本为 USD 15.00）的库存实际发货。
-   2a. 数量 1（移动平均成本为 USD 15.00）的库存财务发货。

系统将为第 1 天使用直接结算方法。 

**第 2 天：**

-   3a. 数量 1（移动平均成本为 USD 15.00）的库存实际发货
-   3b. 数量 1（移动平均成本为 USD 15.00）的库存财务发货

系统将为第 2 天使用直接结算方法。 

**第 3 天：**

-   4a. 数量 1（移动平均成本为 USD 15.00）的库存实际发货
-   4b. 数量 1（移动平均成本为 USD 15.00）的库存财务发货
-   5a. 为数量 1（单价 USD 17.00）的库存实际收货
-   5b. 为数量 1（单价 USD 17.00）的库存财务收货

执行库存结转。 必须使用直接结算，因为存在跨多天的多个收货。

-   7a. 为数量 2（单价 USD 32.00）创建加权平均库存结转交易记录财务发货，以便将所有库存财务收货的结算汇总到尚未结转的日期。
-   7b. 创建加权平均库存结转交易记录财务收货，作为对 7a 的抵消。

此系统将生成和过帐汇总的库存转移交易记录。 此外，此系统根据汇总的库存转移发货交易记录结算这天的所有收货和上一天的现有库存量。 该天的所有发货都根据汇总的库存转移收货交易记录进行结算。 该加权平均成本价计算为 USD 16.00。 该发货将具有 USD 1.00 的调整，以便将其调整到加权平均成本。 新的移动平均成本价是 USD 16.00。 

下图显示在使用了加权平均库存模型和汇总结算原则（但没有使用 **包括实际成本** 选项）的情况下此系列的交易记录。 

![没有“包括实际成本”选项的加权平均日期汇总结算](./media/weightedaveragedatesummarizedsettlementwithoutincludephysicalvalue.gif) 

**插图要点**

-   库存交易记录用垂直箭头表示。
-   入库用时间线上的垂直箭头表示。
-   出库用时间线下的垂直箭头表示。
-   在每一垂直箭头之上（或之下），以 *数量*@*单位价格* 格式指定库存交易记录的值。
-   如果用括号括起来库存交易记录值，该库存交易记录实际过帐到库存中。
-   如果没用括号括起来库存交易记录值，该库存交易记录财务过帐到库存中。
-   每个新的收货或发货交易记录都用一个新标签标明。
-   每个垂直箭头用连续标识符标记，例如 *1a*。 这些标识符指示时间线中库存交易记录过帐的顺序。
-   库存结转用红色的垂直虚线以及 *“库存结转”* 标签表示。
-   由库存结转执行的结算用红色虚线箭头（沿对角方向从收货指向发货）表示。
-   全红色对角箭头显示要结算到系统创建的发货交易记录的收货交易记录。
-   全绿色对角箭头表示最初过帐的发货交易记录结算到的抵消系统生成的收货交易记录

## <a name="weighted-average-date-direct-settlement-when-the-include-physical-value-option-is-used"></a>使用包括实际成本选项时的加权平均日期直接结算
当前版本使用的直接结算原则与之前版本中加权平均日期使用的直接结算原则相同。 系统将直接在收货和发货之间进行结算。 此系统在特定情况下使用这一直接结算原则：

-   已在期间中过帐一个收货以及一个或若干发货。
-   在该期间中只过帐了发货，并且库存包含来自以前结转的现有库存。

如果为 **物料模型组** 页面上的物料选中 **包括实际成本** 复选框，此系统将在计算估计的成本价或移动平均时使用实际更新的收货。 在期间中基于此估计的成本价过帐发货。 在库存结转期间，在加权平均计算时将只考虑财务更新的收货。

## <a name="weighted-average-date-summarized-settlement-when-the-include-physical-value-option-is-used"></a>使用包括实际成本选项时的加权平均日期汇总结算
如果为 **物料模型组** 页面上的物料选中 **包括实际成本** 复选框，此系统将在计算估计的成本价或移动平均时使用实际更新的收货。 在期间中基于此估计的成本价过帐发货。 在库存结转期间，在加权平均计算时将只考虑财务更新的收货。 加权平均结算基于结转期间内的收货都汇总到新的库存转移交易记录中的原则，此交易记录称作 *加权平均库存结转*。 该天的所有收货都根据新创建的库存转移交易记录的发货进行结算。 该天的所有发货都根据新的库存转移交易记录的收货进行结算。 如果在库存结转后，现有库存量为正值，则库存的现有库存量和值将汇总在新的库存转移交易记录（收货）上。 如果在库存结转后，现有库存量为负值，则库存的现有库存量和值将是尚未完全结算的各个单独发货之和。

## <a name="weighted-average-date-when-marking-is-used"></a>使用标记时的加权平均日期
标记是一个过程，您可以将某一发货交易记录链接到某一收货交易记录。 标记可以在过帐交易记录之前或之后发生。 如果您想要在过帐交易记录时或执行库存结转时确保库存的准确成本，则可以使用标记。 

例如，您的客户服务部接受了来自重要客户的一个紧急订单。 因为这是紧急订单，所以，您将需要为此物料支付更多成本以满足您的客户的请求。 您必须确定此库存物料的成本反映在此销售订单发票的毛利中或所售货物成本 (COGS) 中。 在过帐采购订单时，按 USD 120.00 的成本入库。 在装箱单或发票过帐之前，销售订单单据标记到采购订单。 然后，COGS 将是 USD 120.00 代替物料的当前移动平均成本。 如果在发生标记前过帐销售订单装箱单或发票，则将按移动平均成本价过帐 COGS。 在执行库存结转前，仍可以彼此标记这两个交易记录。 在将某一收货交易记录标记为发货交易记录时，将不考虑在该物料的物料模型组中定义的评估方法。 相反，此系统将彼此结算这些交易记录。 

在过帐交易记录前，您可以将某一发货交易记录标记到某一收货交易记录。 您可以从 **销售订单详细信息** 页上的销售订单行执行此操作。 您可以在 **标记** 页上查看未结收货交易记录。 在过帐交易记录后，您可以将某一发货交易记录标记到某一收货交易记录。 您可以匹配或标记已过帐库存调整日记帐的清查过物料的未结收货交易记录的发货交易记录。 下图显示了这些交易记录：

-   1a. 数量 1（单件成本价为 USD 10.00）的库存实际收货。
-   1b. 数量 1（单件成本价为 USD 10.00）的库存财务收货。
-   2a. 数量 1（单件成本价为 USD 20.00）的库存实际收货。
-   2b. 数量 1（单件成本价为 USD 20.00）的库存财务收货。
-   3a. 数量 1（单件成本价为 USD 25.00）的库存实际收货。
-   4a. 数量 1（单件成本价为 USD 30.00）的库存实际收货。
-   4b. 数量 1（单件成本价为 USD 30.00）的库存财务收货。
-   5a. 数量 1（单件成本价为 USD 21.25）的库存实际发货（财务和实际更新的交易记录的移动平均）。
-   5b. 在过帐交易记录前将数量为 1 的库存财务发货标记为库存收货 2b。 此交易记录按成本价 USD 20.00 过帐。
-   6a. 数量 1（单件成本价为 USD 21.25）的库存实际发货。
-   7. 执行库存结转。 因为财务更新的交易记录标记为现有收货，所以将彼此结算这些交易记录并且不进行调整。

新的移动平均成本价反映按 USD 27.50 的财务和实际更新的交易记录的平均价。 下图显示在使用加权平均日期库存模型和标记的情况下此系列的交易记录。

![具有标记的加权平均日期](./media/weightedaveragedatewithmarking.gif) 

**插图要点：**

-   库存交易记录用垂直箭头表示。
-   入库用时间线上的垂直箭头表示。
-   出库用时间线下的垂直箭头表示。
-   在每一垂直箭头之上（或之下），以 *数量*@*单位价格* 格式指定库存交易记录的值。
-   如果用括号括起来库存交易记录值，该库存交易记录实际过帐到库存中。
-   如果没用括号括起来库存交易记录值，该库存交易记录财务过帐到库存中。
-   每个新的收货或发货交易记录都用一个新标签标明。
-   每个垂直箭头用连续标识符标记，例如 *1a*。 这些标识符指示时间线中库存交易记录过帐的顺序。
-   库存结转用红色的垂直虚线以及 *“库存结转”* 标签表示。
-   由库存结转执行的结算用红色虚线箭头（沿对角方向从收货指向发货）表示。






[!INCLUDE[footer-include](../../includes/footer-banner.md)]