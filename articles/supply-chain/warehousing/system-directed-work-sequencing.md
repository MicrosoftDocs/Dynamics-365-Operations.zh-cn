---
title: 系统导向工作先后顺序
description: 本文提供有关系统导向工作先后顺序的信息。 此功能用于对系统提供给用户执行的工作订单排序和筛选。 其在以下场景中很有帮助：需要更多条件才能推动仓库领料流程。
author: Mirzaab
ms.date: 07/03/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: WHSRFSystemDirectedWorkSequenceQuery, WHSLocDirTable
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: mirzaab
ms.search.validFrom: 2020-07-03
ms.dyn365.ops.version: 10.0.7
ms.openlocfilehash: 88ea680b5b3e237d117b087978d703a7f6f09465
ms.sourcegitcommit: c98d55a4a6e27239ae6b317872332f01cbe8b875
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/02/2022
ms.locfileid: "9219679"
---
# <a name="system-directed-work-sequencing"></a>系统导向工作先后顺序

[!include [banner](../includes/banner.md)]

系统导向工作先后顺序功能用于对系统提供给用户执行的工作订单排序和筛选。 其在以下场景中很有帮助：需要更多条件（如装运时间、领料区、货位模板或各种条件的组合）来推动仓库领料流程。

此功能通过添加系统导向查询订单扩展现在的系统导向领料功能，因此，用户可以设置序列和一个或多个查询来评估创建的所有工作订单。 将仅捕获和提供满足移动设备菜单项的设置中指定的条件的工作订单。

因此，可通过此功能基于特定技能集、领料设备或其他要求进一步优化仓库领料流程，因为其可识别满足指定条件的工作订单，将其分配给正确的移动设备菜单项，然后将其提供给工作人员。

> [!NOTE]
> 如果需要其他条件，必须使用多个移动设备菜单项。

## <a name="turn-on-the-organization-wide-system-directed-work-sequencing-feature"></a>开启组织范围的系统导向工作先后顺序功能

系统导向工作先后顺序功能只有在系统中开启之后才能使用。 管理员可以使用[功能管理](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md)工作区检查功能状态和开启功能（如果需要）。 在那里，此功能以以下方式列出：

- **模块**：*仓库管理*
- **功能名称**：*组织范围内的系统导向工作先后顺序*

## <a name="setup"></a>设置

### <a name="make-demo-data-available"></a>提供演示数据

若要使用本文中提供的值完成此场景，使用的系统中必须已安装标准[演示数据](../../fin-ops-core/fin-ops/get-started/demo-data.md)。 此外，还必须选择 **USMF** 法人。 此场景使用演示数据中的仓库 *51*。

> [!IMPORTANT]
> 在将订单下达到仓库之前，请确保领料货位有满足所有订单上的所有物料的足够库存。
>
> 默认 USMF 数据应该会支持此场景。 如果不使用演示数据，请查看 **货位指令** 设置了解哪些领料货位用于销售订单领料的。 如果必须调整库存，可创建手动移动，使用补货，或使用其他任何流。

### <a name="set-up-a-mobile-device-menu-item"></a>设置移动设备菜单项

1. 转到 **仓库管理 \> 设置 \> 移动设备 \> 移动设备菜单项**。
1. 在移动设备菜单项列表中，选择 **销售领料 – 系统**。 应该已存在必需的菜单项。 
1. 确认以下设置：

    - **常规** 快速选项卡中的 **导向方式** 字段应设置为 *系统导向*。
    - **工作类** 快速选项卡应显示以下设置。

        | 工作类 ID | 工作订单类型 |
        |---|---|
        | 销售额 | 销售订单 |
        | SO 领料 | 销售订单 |

1. 在操作窗格上，选择 **系统导向工作序列查询**。
1. 选择 **编辑**。
1. 删除现有行，然后选择 **是** 确认操作。
1. 在“操作窗格”中，选择 **新建** 创建一行。
1. 在新行中，设置以下值：

    - **序列号**：*1*
    - **说明字段**：*工作数量低于 20 且排序方式为降序*

1. 选择 **保存**。
1. 在操作窗格上，选择 **编辑查询**。
1. 在 **联接** 选项卡上，展开联接层次结构显示 **工作行** 表。
1. 选择 **工作行** 表联接。
1. 选择 **添加表联接**。
1. 在显示的列表中，找到并选择采用以下设置的行：

    - **联接模式**：*n:1*
    - **关系**：*货位（货位）*

1. 选择 **选择**。

    将把货位添加到表联接。

1. 在 **排序** 选项卡中，选择 **添加** 添加一行。
1. 在新行中，设置以下值：

    - **表**：*工作行*
    - **派生表**：*工作行*
    - **字段**：*工作数量*（在显示的消息框中，选择 **是** 向此字段添加排序。）
    - **搜索方向**：*降序*

1. 选择 **范围** 选项卡。

    如果先后顺序中应仅包含特定各种条件，可以在 **范围** 选项卡中指定。在此示例中，只需包含数量少于 20 个（最低度量单位）的工作。

    请注意，已经包含一些行。 不应删除这些行。

1. 选择 **添加** 添加一行。
1. 在新行中，设置以下值：

    - **表**：*工作行*
    - **派生表**：*工作行*
    - **字段**：*库存工作数量*
    - **条件**：*\<20*（低于 20）

1. 选择 **添加** 再添加一行。
1. 在新行中，设置以下值：

    - **表**：*工作行*
    - **派生表**：*工作行*
    - **字段**：*工作类型*
    - **条件**：*领料*

1. 选择 **添加** 再添加一行。
1. 在新行中，设置以下值：

    - **表：** *位置*
    - **派生表**：*货位*
    - **字段：***位置模板 ID*
    - **条件**：*!STAGE*

        > [!IMPORTANT]
        > 务必在 *STAGE* 前面包含感叹号 (*!*)。

1. 选择 **确定** 保存并关闭设置。
1. 选择 **保存**。
1. 关闭页面回到 **移动设备菜单项** 页面。

> [!NOTE]
> 此步骤定义将用于向移动设备菜单项提供符合资格的工作的条件。 如果向查询添加更多条件行，系统将先使用序列号最小的查询行。 换句话说，将首先把序列号 1 的所有合格工作提供给用户，然后提供序列号 2 的所有工作。 因此，如果必须一起使用特定范围和排序，应该在同一个系统导向工作序列查询中指定。
>
> 此设置将捕获至少有一个行，并且该行中的数量小于 20 个的所有工作。 因此，如果工作有一行中数量正好是 20 个或超过 20 个，则该工作有效，前提是其还有至少一行中数量低于 20 个。

### <a name="location-directives"></a>位置指令

如果在使用默认 Contoso 数据，则不需要更改货位指令操作的查询。 但是，若要确保在非 Contoso 环境中应用此功能时，货位指令将捕获销售订单中的物料，请创建一个新的货位指令。 若要在演示环境中验证设置，请执行以下步骤。

1. 转到 **仓库管理** \> **设置** \> **货位指令**。
1. 在 **工作订单类型** 字段中，选择 *销售订单*。
1. 选择名称为 *51 Pick* 的货位指令。
1. 在 **货位指令操作** 快速选项卡上，选择 **领料** 操作的行。
1. 选择网格上方的 **编辑查询**。
1. 查看 **范围** 查询。

    1. 找到其中的 **字段** 字段设置为 *货位* 的行。
    2. 确保 **条件** 字段为空（即不限制）。

## <a name="scenario"></a>应用场景

### <a name="create-sales-order-picking-work"></a>创建销售订单领料工作

运行系统导向领料之前，应创建一些出库工作。 对于此场景，将创建四个基于指定的系统导向工作序列查询的销售订单。

将为每个销售订单预留库存数量。 因此，除非库存预留或部分库存预留已取消，否则不能从仓库中为其他订单提取预留库存。

然后将把每个销售订单下达到仓库以创建出库工作。

#### <a name="sales-order-1"></a>销售订单 1

1. 转到 **销售和营销 \> 销售订单 \> 所有销售订单**。
1. 在“操作窗格”中，选择 **新建** 创建销售订单 1。
1. 在 **创建销售订单** 对话框中，设置以下值：

    - 在 **客户** 部分中，将 **客户帐户** 字段设置为 *US-004*。
    - 在 **常规** 部分中，将 **仓库** 字段设置为 *51*。

1. 选择 **确定** 关闭对话框。 记下销售订单编号。
1. 在新销售订单中添加一行，并设置以下值：

    - **物料编号：***M9200*
    - **数量：** *20*

1. 在网格上方的 **库存** 菜单中，选择 **预留**。
1. 在 **预留** 页面中，选择 **预留批次** 预留库存。
1. 关闭 **预留** 页面。
1. 在“操作窗格”上的 **仓库** 选项卡上，选择 **发放到仓库** 为仓库创建工作。

    您将收到参考消息，其中显示为销售订单创建的波次 ID 和装运 ID。

#### <a name="sales-order-2"></a>销售订单 2

1. 在“操作窗格”中，选择 **新建** 创建销售订单 2。
1. 在 **创建销售订单** 对话框中，设置以下值：

    - **客户帐户**：*US-007*
    - **仓库：** *51*

1. 选择 **确定** 关闭对话框。 记下销售订单编号。
1. 在新销售订单中添加一行，并设置以下值：

    - **物料编号：***M9200*
    - **数量：** *5*

1. 选择 **添加行** 添加第二个行，然后设置以下值：

    - **物料编号：***M9201*
    - **数量：** *1*

1. 为两行预留库存。
1. 将订单下达到仓库。

#### <a name="sales-order-3"></a>销售订单 3

1. 在“操作窗格”中，选择 **新建** 创建销售订单 3。
1. 在 **创建销售订单** 对话框中，设置以下值：

    - **客户帐户**：*US-009*
    - **仓库：** *51*

1. 选择 **确定** 关闭对话框。 记下销售订单编号。
1. 在新销售订单中添加一行，并设置以下值：

    - **物料编号：***M9200*
    - **数量：** *7*

1. 选择 **添加行** 添加第二个行，然后设置以下值：

    - **物料编号：***M9202*
    - **数量：** *8*

1. 为两行预留库存。
1. 将订单下达到仓库。

#### <a name="sales-order-4"></a>销售订单 4

1. 在“操作窗格”中，选择 **新建** 创建销售订单 4。
1. 在 **创建销售订单** 对话框中，设置以下值：

    - **客户帐户**：*US-010*
    - **仓库：** *51*

1. 选择 **确定** 关闭对话框。 记下销售订单编号。
1. 在新销售订单中添加一行，并设置以下值：

    - **物料编号：***M9200*
    - **数量：** *25*

1. 选择 **添加行** 添加第二个行，然后设置以下值：

    - **物料编号：***M9202*
    - **数量：** *10*

1. 为两行预留库存。
1. 将订单下达到仓库。

### <a name="get-work-ids-for-the-work-that-was-created"></a>获取创建的工作的工作 ID

1. 转到 **仓库管理 \> 工作 \> 工作详细信息**。
1. 筛选 **仓库** 字段，以便仅显示仓库 *51* 的工作。
1. 应该已经创建了四个工作 ID。 记下每个销售订单的工作 ID。

    | 销售订单 ID | 工作 ID | 工作数量 |
    |---|---|---|
    | 销售订单 1 | 工作 ID 1 | 20 个 |
    | 销售订单 2 | 工作 ID 2 | 6 个（两行之和） |
    | 销售订单 3 | 工作 ID 3 | 15 个（两行之和） |
    | 销售订单 4 | 工作 ID 4 | 35 个（两行之和） |

在移动设备中运行流之前，请确保对于仓库 *51* 和 *销售订单* 工作订单类型，只有刚才创建的工作的状态才是 *未结*。 否则，测试结果可能不同，因为系统导向领料中将包含所有合格工作。

1. 转到 **仓库管理 \> 工作 \> 出库 \> 未结销售订单**。
1. 在 **未结销售工作** 网格中，筛选 **仓库** 字段，以便仅显示仓库 *51* 的工作。
1. 确认仅显示前面创建的四个工作 ID。
1. 关闭 **工作** 页面。

### <a name="mobile-device-flow-execution"></a>执行移动设备流

系统将根据设置提供从最大工作行数量到最小排序的用户工作。 每行中的数量将低于 20 个。

请注意，此设置将捕获至少有一个行，并且该行中的数量小于 20 个的所有工作。 因此，如果还有一行中的数量正好是 20 个或超过 20 个，该行也将有效。

#### <a name="mobile-app"></a>移动应用

1. 以仓库 *51* 用户身份登录仓库应用。
1. 转到 **出库 \> 销售领料 - 系统**。

    将提供工作 ID *4* 的领料步骤。 先提供此工作 ID 是因为系统导向查询订单的设置，在此设置中，应该根据降序工作行数量为工作排序。

1. 完成所需领料和放置以结束工作 ID。

    接下来，提供工作 ID *3*。 其工作行之一根据工作行数量是序列中的下一项。

1. 完成领料和放置以结束工作 ID。

    接下来，提供工作 ID *2*。 此工作的领料行是序列中的下一项。

1. 完成领料和放置以结束工作 ID。

    不应再向您提供任何工作。 工作 ID *1* 不符合此移动设备菜单项的资格，因为查询指定仅当工作行中的数量小于 20 个时，才考虑工作标题。

## <a name="tips"></a>提示

系统导向工作序列查询为 *包含*。 务必为某些设置记住这一点。 例如，您希望特定菜单项仅处理其工作单位为 *个* 的工作，并且在查询的 **范围** 选项卡中指定该限制。 在此情况下，将向工作人员提供至少有一个工作行的工作单位设置为 *个* 的所有工作。 因此，此工作还包括其工作行的工作单位不是 *个*（如 *箱* 或 *托盘*）的工作。 此查询将仅排除没有工作行的工作单位设置为 *个* 的工作。

因此，在此场景的示例中，查询还捕获了工作 ID *4*。 创建它时，添加了两行：一行为 25 个，另一行为 10 个。 仍然将此工作提供给了用户，因为至少有一个工作行的数量少于 20 个。

可以使用工作分解阻止此行为，具体取决于场景。


[!INCLUDE[footer-include](../../includes/footer-banner.md)]