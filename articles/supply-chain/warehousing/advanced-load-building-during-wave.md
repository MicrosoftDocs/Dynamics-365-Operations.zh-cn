---
title: 波次期间的高级负荷计划
description: 本主题介绍高级波次负荷计划功能，这会在波次执行期间自动为现有波次分配装运。 因此，可以创建有意义的负荷来表示卡车，而不必使用负荷计划工作台。
author: mirzaab
manager: tfehr
ms.date: 07/01/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: WHSPostMethod,WHSWaveTemplateTable,WHSLoadMixGroup,WHSLoadBuildTemplate, WHSWaveTableListPage, TMSLoadBuildTemplateApply, TMSLoadBuildTemplates
audience: Application User
ms.reviewer: kamaybac
ms.search.scope: Retail, Core, Operations
ms.search.region: Global
ms.author: mirzaab
ms.search.validFrom: 2020-07-01
ms.dyn365.ops.version: Release 10.0.9
ms.openlocfilehash: 7fb47498cfb3756b0e180fe9e5500255c7312a92
ms.sourcegitcommit: a36a4f9915ae3eb36bf8220111cf1486387713d9
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/16/2020
ms.locfileid: "4016324"
---
# <a name="advanced-load-building-during-wave"></a>波次期间的高级负荷计划

[!include [banner](../includes/banner.md)]

高级波次负荷计划功能在波次执行期间自动为现有波次分配装运。 因此，可以创建有意义的负荷来表示卡车，而不必使用负荷计划工作台。 对于希望使用负荷这个概念来跟踪和规划卡车/拖车中的货物的装运，但是不希望每天手动创建这些负荷的企业，此功能非常有用。

在波次处理期间，系统通常为尚未获得负荷的每个装运创建一个新装运。 但是，如果开启了高级波次负荷计划功能，系统将把每个未分配的装运分配给一个现有负荷（如果存在适合的负荷），并且仅在需要时才创建新负荷。 高级波次负荷计划功能根据您定义的条件自动创建新负荷。

若要使用此功能，必须按照下面的方法设置系统：

- 创建其中包含新的 **buildLoads** 方法的 *波次模板* 。 此方法让高级波次负荷计划功能可用于使用这些模板的波次。
- 设置 *负荷计划模板* ，这些模板中的每一个都链接到一个特定波次模板和方法。 负荷计划模板控制将正在分波次的负荷行添加到哪个（现有或新）负荷。 可以根据条件（如负荷行中的负荷模板、设备和其他值）合并或拆分装运。
- 定义 *负荷混合组* 以控制应该和不应该将哪些物料合并到单个负荷中。 也可以指定此限制应计划警告还是错误，以及是否应该评估负荷模板的体积限制。

## <a name="turn-on-advanced-wave-load-building-in-your-system"></a>在系统中开启高级波次负荷计划功能

必须先在系统中开启两项功能，才能使用高级波次负荷计划功能。 管理员可以使用[功能管理](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md)设置检查这些功能的状态，并在需要这些功能时将其开启。 在 **功能管理** 工作区中，这些功能按照下面的方式列出：

- 波次负荷计划功能：

    - **模块** ： *仓库管理*
    - **功能名称** ： *波次负荷计划功能*

- 组织范围内的波次步骤代码：

    - **模块** ： *仓库管理*
    - **功能名称** ： *组织范围内的波次步骤代码*

### <a name="make-sample-data-available"></a>提供示例数据

若要使用此处指定的示例记录和值完成此演示，使用的系统中必须已安装标准[演示数据](../../fin-ops-core/dev-itpro/deployment/deploy-demo-environment.md)。 此外，开始前，还必须选择 **USMF** 法人。

使用生产系统时，也可以将此演示用作使用此功能的指导。 但是，在此情况下，必须替换为您自己的值，而您可能会缺少标准演示数据提供的某些类型的必需记录。

### <a name="make-sure-that-the-scenario-setup-includes-enough-available-inventory"></a>确保场景设置中包含足够的可用库存

如果要使用 **USMF** 演示数据，必须先确保已将系统设置为每个相关货位有足够的库存。 对于此演示，预计仓库 *62* 中有以下库存：

- **物料 A0001：** 10 件
- **物料 A0002：** 10 件
- **物料 M9200：** 10 个

必须将物料 **M9200** 添加到该仓库。 完成以下小节中的过程以添加物料库存。

#### <a name="create-a-new-license-plate-id"></a>创建新的牌照 ID

1. 转到 **仓库管理** \> **设置** \> **仓库** \> **牌照** 。
1. 在操作窗格上，选择 **新建** 。
1. 在新行的 **牌照** 字段中，输入 *LP6203* 。
1. 选择 **保存** 。

#### <a name="create-a-standard-cost-for-item-m9200-in-site-6"></a>在地点 6 中为物料 M9200 创建标准成本

1. 转到 **产品信息管理** \> **产品** \> **已发布产品** 。
1. 搜索 **M9200** 。
1. 搜索行以查找该物料，然后在操作窗格中 **管理成本** 选项卡上 **设置** 组中，选择 **物料价格** 。
1. 在 **物料价格** 页中，选择 **未决价格** 选项卡。
1. 在操作窗格上，选择 **新建** 。
1. 在新行中，设置以下值：

    - **成本计算类型** ： *计划成本*
    - **价格类型** ： *成本*
    - **版本** ： *10*
    - **站点** ： *6*
    - **价格** ： *1.60*

1. 在操作窗格上，选择 **保存** 。
1. 在操作窗格上，选择 **激活未决价格** 。
1. 选择 **有效价格** 选项卡以验证是否已添加了地点 *6* 的新成本价。

#### <a name="create-inventory-in-warehouse-62"></a>创建仓库 62 中的库存

1. 转到 **库存管理** \> **日记帐条目** \> **物料** \> **库存调整** 。
1. 在操作窗格上，选择 **新建** 。
1. 在 **创建库存日记帐** 对话框中 **概览** 快速选项卡上的 **仓库** 字段中，输入 *62* 。 接受其他所有字段中的默认值。
1. 选择 **确定** 关闭对话框。
1. 将打开 **库存调整** 页。 在 **日记帐行** 快速选项卡上，选择 **新建** 添加行。
1. 在新行中，设置以下值。 接受其他所有字段中的默认值。

    - **物料编号：***M9200*
    - **货位** ： *bulk-003*
    - **数量：** 将值更改为 *10* 。

1. 在操作窗格上，选择 **保存** 。
1. 在操作窗格上，选择 **验证** 检查是否有错误。
1. 在 **检查日记帐** 对话框中，选择 **确定** 开始进行检查。 检查完成后，您会收到一条消息。
1. 在操作窗格上，选择 **过帐** 提交库存调整。
1. 在 **过帐日记帐** 对话框中，选择 **确定** 开始进行过帐。 过帐完成后，您会收到一条消息。

## <a name="set-up-advanced-wave-load-building"></a>设置高级波次负荷计划功能

### <a name="regenerate-wave-process-methods"></a>重新计划波次处理方法

可能必须重新计划波次处理方法，才能使用负荷计划方法 ( **buildLoads** )。

1. 转到 **仓库管理** \> **设置** \> **波次** \> **波次处理方法** 。
2. 验证列表中是否有 **buildLoads** 。 如果没有，请在操作窗格中选择 **重新计划方法** 添加该方法。

### <a name="set-up-wave-templates"></a>设置波次模板

每个相关 [波次模板](tasks/configure-wave-processing.md)中都必须包含 **buildLoads** 方法，才能利用高级波次负荷计划功能。

1. 转到 **仓库管理** \> **设置** \> **波次** \> **波次模板** 。
1. 选择一个波次模板。

    如果在使用 **USMF** 演示数据，请选择 **62 装运默认** 模板。

1. 在操作窗格上，选择 **编辑** 将页面设置为编辑模式。
1. 在 **方法** 快速选项卡上的 **其余方法** 网格中，选择 **buildLoads** 方法。
1. 选择向右箭头按钮将 **buildLoads** 方法移到 **已选定方法** 网格中。
1. 若要分配 **buildLoads** 方法的 **波次步骤代码** 值，首先必须在 **波次步骤代码** 页中创建一个代码。 可以使用所需的任何值，但请务必记下该值，因为后面需要该值。 执行以下步骤创建代码 **WSC2112** ：

    1. 在 **buildLoads** 方法的行中，右键单击 **波次步骤代码** 字段中的向下箭头，然后选择 **查看详细信息** 。
    1. 在 **波次步骤代码** 页的操作窗格中，选择 **新建** 。
    1. 在 **波次步骤代码** 字段中，输入 *WSC2112* 。
    1. 在 **波次步骤说明** 字段中，输入 *WSC2112* 。
    1. 在 **波次步骤类型** 字段中，选择 *负荷计划* 。

1. 选择 **保存** ，然后关闭页面。
1. 在 **buildLoads** 方法的行中 **波次步骤代码** 字段内，选择刚才创建的代码 ( **WSC2112** )。
1. 在操作窗格上，选择 **保存** 。

> [!NOTE]
> 波次步骤代码是用户可设置并用于将特定波次方法实例链接到相应模板的代码。 模板包括用于补货、集装化、标签打印、装载计划和排序的模板。
>
> 如果不使用波次步骤代码，用户必须输入普通文本才能引用来自波次方法实例的特定模板。 普通文本容易出错，因为用户必须确保其为波次模板中的特定波次步骤方法添加的波次步骤文本与目标模板中的波次步骤文本完全匹配。
>
> 特定波次步骤类型的波次步骤类型在单独页面中设置。 必须在下拉列表中为波次模板中每个需要波次步骤代码的波次步骤方法实例选择波次步骤代码。 在下拉列表中进行的选择将替换普通文本，因此有助于降低人为错误的风险和影响。 设置代码用于将波次模板中的波次步骤方法链接到该方法的目标模板。

### <a name="set-up-load-mix-groups"></a>设置负荷混合组

负荷混合组为可合并到一个负荷中的物料的类型建立规则。 可以根据需要设置任意数量的负荷混合组。 但是，若要利用高级波次负荷计划功能，必须至少有一个。 执行以下步骤创建负荷混合组。

1. 转到 **仓库管理** \> **设置** \> **负荷** \> **负荷混合组** 。
1. 在“操作窗格”中，选择 **新建** 创建负荷组。
1. 在 **负荷混合组 ID** 字段中，输入新组的名称。

    如果在使用 **USMF** 演示数据，请设置以下值：

    - **负荷混合组 ID** ： *TV*
    - **说明** ： *TV*

1. 在操作窗格上，选择 **保存** 启用 **负荷混合组条件** 快速选项卡。
1. 在 **负荷混合组条件** 快速选项卡上，选择 **新建** 向网格添加一行。
1. 在新行中，在每个字段中设置所需值。 这些值决定为负荷混合考虑的物料组。

    如果在使用 **USMF** 演示数据，请在 **物料组** 字段中选择 *TV&Video* 。

1. 在操作窗格上，选择 **保存** 启用 **负荷混合组约束** 快速选项卡。
1. 在 **负荷混合组约束** 快速选项卡上，选择 **新建** 向网格添加一行。
1. 在新行中，在每个字段中设置所需值。

    如果在使用 **USMF** 演示数据，请设置以下值：

    - **物料组** ： *CarAudio*
    - **负荷计划操作** ： *限制* （此值将阻止属于 **CarAudio** 物料组的物料与属于 **TV&Video** 物料组的物料位于同一个负荷中。）

1. 继续处理规则，直到添加了负荷混合组需要的所有条件和约束。

如果在使用 **USMF** 演示数据，说明已完成了此设置。

### <a name="set-up-load-build-templates"></a>设置负荷计划模板

可以根据需要设置任意数量的负荷计划模板。 但是，若要利用高级波次负荷计划功能，必须至少有一个。 请执行以下步骤创建负荷计划模板。

1. 转到 **仓库管理** \> **设置** \> **负荷** \> **波次负荷计划模板** 。
1. 在操作窗格上，选择 **新建** 向网格添加一行。
1. 在新行中，设置以下值。

    | 字段 | 说明 | USMF 演示数据中的值 |
    |---|---|---|
    | 序列号 | 模板的评估顺序。 | *1* |
    | 负荷构建模板名称 | 输入负荷计划模板的唯一标识符。 应该输入此设置中前面创建或更新的模板的名称。 | *62 装运默认* |
    | 波次步骤代码 | 输入要用于将模板链接到波次方法的波次步骤代码。 应该输入此设置前面设置波次模板时为 **buildLoads** 方法选择的代码。 | *WSC2112* |
    | 负荷模板 ID | 选择要在创建新负荷时使用和要在分配给现有负荷时对比的负荷模板。 负荷模板定义整个负荷允许的最大重量和体积。 | *标准负荷模板* |
    | 设备 | 要在分配到现有负荷和在创建的新负荷中输入时匹配的设备。 | 保持此字段为空。 |
    | 负荷混合组 ID | 选择当负荷中允许物料时要使用的负荷混合组。 混合组为可合并到一个负荷中的物料的类型建立规则。 应该选择此设置中前面创建的一个混合组。 | *TV* |
    | 使用未结负荷 | 选择是否应添加现有未结负荷。 选项如下：<ul><li>**无** – 不向任何现有负荷添加未结负荷。</li><li>**任何** – 向对此行有效的任何现有负荷添加未结负荷。</li><li>**已分配** – 向分配给波次的负荷添加未结负荷。</li></ul> | *任何* |
    | 创建负荷 | 指定当任何现有负荷均不符合条件时是否应创建新负荷。 | 已选择（= *是* ） |
    | 允许拆分装运行 | 指定如果一个负荷行整行超过负荷模板的最大产能时，是否允许跨多个负荷拆分该行。 | 已清除（= *否* ） |
    | 验证容量 | 指定负荷计划功能是否应在添加每个负荷行时检查重量和体积，以确保遵守负荷模板的体积限制。 | 已清除（= *否* ） |

1. 在操作窗格上，选择 **保存** 以启用 **编辑查询** 选项。
1. 在操作窗格上，选择 **编辑查询** 打开对话框编辑查询。
1. 在对话框的 **排序** 选项卡中，选择 **添加** 向网格添加一行。
1. 在新行中，定义要使用的排序规则。 例如，设置以下值，以便按订单编号以升序为搜索结果排序：

    - **表** ： *负荷详细信息*
    - **派生表** ： *负荷详细信息*
    - **字段** ： *订单编号*
    - **搜索方向** ： *升序*

1. 选择 **确定** 保存更改并关闭对话框。
1. 在 **拆分依据** 快速选项卡上，设置规则以控制如何拆分负荷。 通常可以拆分已延伸到负荷行的自定义字段，如 **工艺路线** 、 **导览** 或 **运行** 。 例如，若要为每个订单编号创建一个负荷，请选中具有以下值的行的 **拆分依据** 复选框：

    - **引用表名称** ： *负荷详细信息*
    - **参考字段名称** ： *订单编号*

## <a name="scenario"></a>应用场景

此场景显示在处理销售订单时，本主题前面介绍的设置如何影响仓库操作。 此场景使用 **USMF** 演示数据和这些设置说明中提供的其他演示值。

### <a name="create-sales-orders"></a>创建销售订单

1. 转到 **销售和营销** \> **销售订单** \> **所有销售订单** 。
1. 在操作窗格上，选择 **新建** 以打开 **创建销售订单** 对话框。
1. 在对话框中，设置以下值：

    - 在 **客户** 快速选项卡上，将 **客户帐户** 字段设置为 *US-007* 。
    - 在 **常规** 快速选项卡上，将 **仓库** 字段设置为 *62* 。

1. 选择 **确定** 创建销售订单，然后关闭对话框。
1. 将打开您的新销售订单。 **销售订单行** 快速选项卡上的网格中应包含一个新的空行。 在这个新行中，将 **物料编号** 字段设置为 *A0001* ，将 **数量** 字段设置为 *1* 。
1. 在网格上方的 **库存** 菜单中，选择 **预留** 。
1. 在 **预留** 页的操作窗格中，选择 **预留批次** 。
1. 选择页面右上角的 **关闭** 按钮 ( **X** ) 回到销售订单。
1. 在“操作窗格”上的 **仓库** 选项卡上，在 **操作** 组中，选择 **发放到仓库** 。 系统将创建一个装运，然后将其添加到新负荷，因为所有现有负荷中均不包含具有此订单编号的负荷行。

    您将收到指示为此订单创建的工作、波次和装运的参考消息。

1. 若要确认销售行中的负荷、装运和工作详细信息，请选择该行，然后在网格上方的 **仓库** 菜单中选择 **负荷详细信息** 、 **装运详细信息** 或 **工作详细信息** 。
1. 在刚才创建的销售订单中的 **销售订单行** 快速选项卡上，选择 **添加行** 再添加一行。
1. 在新行中，将 **物料编号** 字段设置为 *A0002* ，将 **数量** 字段设置为 *1* 。
1. 重复行 6 到 9 预留行并将其发放到仓库。 系统将为添加的行创建一个 **新** 装运。 但是，因为您在使用高级波次负荷计划功能，因此系统将把该装运和负荷行添加到现有波次。 如果您未在使用高级波次负荷计划功能，系统将为装运创建新负荷。
1. 在刚才创建的销售订单中的 **销售订单行** 快速选项卡上，选择 **添加行** 再添加一行。
1. 在新行中，将 **物料编号** 字段设置为 *M9200* ，将 **数量** 字段设置为 *1* 。
1. 重复行 6 到 9 预留行并将其发放到仓库。 就像前面一样，系统将为添加的行创建一个 **新** 装运。 但是，因为该物料来自 **CarAudio** 物料组，所以 **无法通过为负荷混合组设置的约束** 。 因此，将把其 **添加到新负荷** 。 如果尚未在负荷计划模板中指定负荷混合组，应该已将该装运添加到第一个负荷。
