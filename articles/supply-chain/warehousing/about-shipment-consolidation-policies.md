---
title: 装运合并政策
description: 此主题概述灵活配置装运合并策略的功能。
author: GarmMSFT
manager: tfehr
ms.date: 05/12/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: WHSShipConsolidationPolicy, WHSShipConsolidationWorkbench, WHSShipConsolidationError, WHSShipConsolidationSetShipment, WHSShipConsolidationPolicySelect, WHSShipPlanningListPage, TMSCarrierGroup, WHSShipConsolidationTemplate, WHSShipConsolidationTemplateApply, WHSShipConsolidationTemplateCreate
audience: Application User
ms.reviewer: kamaybac
ms.search.scope: Core, Operations
ms.search.region: Global
ms.author: kamaybac
ms.search.validFrom: 2020-05-01
ms.dyn365.ops.version: 10.0.3
ms.openlocfilehash: f895b13b2e11d4cb341f80b3cfeb40ed998ccfc4
ms.sourcegitcommit: d9bffbeae2ba14f06294dd275383077d4d65c4fa
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/01/2020
ms.locfileid: "4654212"
---
# <a name="shipment-consolidation-policies"></a><span data-ttu-id="a0922-103">装运合并政策</span><span class="sxs-lookup"><span data-stu-id="a0922-103">Shipment consolidation policies</span></span>

<span data-ttu-id="a0922-104">在自动和手动发放到仓库期间，可通过使用装运合并策略的装运合并流程自动合并装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-104">The shipment consolidation process that uses shipment consolidation policies allows for automated shipment consolidation during automated and manual release to the warehouse.</span></span> <span data-ttu-id="a0922-105">引入此功能前提供的自动化合并具有硬编码字段，并基于为仓库设置的 **发放到仓库时合并装运** 字段。</span><span class="sxs-lookup"><span data-stu-id="a0922-105">The automated consolidation that was available before this feature was introduced had hard-coded fields and was based on the **Consolidate shipment at release to warehouse** field that was set for a warehouse.</span></span>

<span data-ttu-id="a0922-106">装运合并策略用于以下功能：</span><span class="sxs-lookup"><span data-stu-id="a0922-106">Shipment consolidation policies are used for the following functionality:</span></span>

- <span data-ttu-id="a0922-107">自动化的发放到仓库批处理作业</span><span class="sxs-lookup"><span data-stu-id="a0922-107">The automated release-to-warehouse batch job</span></span>
- <span data-ttu-id="a0922-108">销售订单或转移单中的 **发放到仓库** 命令</span><span class="sxs-lookup"><span data-stu-id="a0922-108">The **Release to warehouse** command in a sales order or transfer order</span></span>
- <span data-ttu-id="a0922-109">专用的 **发放到仓库** 页面</span><span class="sxs-lookup"><span data-stu-id="a0922-109">The dedicated **Release to warehouse** page</span></span>
- <span data-ttu-id="a0922-110">**装载计划工作台** 页面中的 **发放到仓库** 命令</span><span class="sxs-lookup"><span data-stu-id="a0922-110">The **Release to warehouse** command on the **Load planning workbench** page</span></span>
- <span data-ttu-id="a0922-111">**合并装运** 和 **装运合并工作台** 页面中的手动合并装运</span><span class="sxs-lookup"><span data-stu-id="a0922-111">The manual consolidation of shipments on the **Consolidate shipments** and **Shipment consolidation workbench** pages</span></span>

<span data-ttu-id="a0922-112">引入装运合并策略之前，以仓库级设置存在的合并功能。</span><span class="sxs-lookup"><span data-stu-id="a0922-112">Before shipment consolidation policies were introduced, the consolidation function existed as a setting at the warehouse level.</span></span> <span data-ttu-id="a0922-113">单个仓库的所有客户的所有订单被视为具有相同的合并要求。</span><span class="sxs-lookup"><span data-stu-id="a0922-113">All orders for all customers from a single warehouse were treated as though they had the same consolidation requirements.</span></span> <span data-ttu-id="a0922-114">装运合并策略增加了对不同组织具有不同装运合并的方案的支持。</span><span class="sxs-lookup"><span data-stu-id="a0922-114">Shipment consolidation policies add support for scenarios where different organizations have different requirements for shipment consolidation.</span></span>

<span data-ttu-id="a0922-115">查询用于识别应用的装运合并策略，而一组可编辑字段则决定如何在装运级别为装载行分组。</span><span class="sxs-lookup"><span data-stu-id="a0922-115">Queries are used to identify the shipment consolidation policy that applies, and then an editable set of fields determines how the load lines are grouped at the shipment level.</span></span> <span data-ttu-id="a0922-116">（此模式类似波次模板采用的模式。）此外，还已经向每个策略添加了一个 **与现有装运合并** 选项。</span><span class="sxs-lookup"><span data-stu-id="a0922-116">(This pattern resembles the pattern that wave templates follow.) In addition, a **Consolidate with existing shipments** option has been added to each policy.</span></span> <span data-ttu-id="a0922-117">开启此选项后，*发放到仓库* 过程将通过在根据相同的合并策略创建的现有装运中进行搜索来查找要合并的装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-117">When this option is turned on, the *Release to warehouse* procedure finds shipments for consolidation by searching among existing shipments that were created based on the same consolidation policy.</span></span> <span data-ttu-id="a0922-118">在这种情况下，系统将选择现有装运或装载，而不是新建一个。</span><span class="sxs-lookup"><span data-stu-id="a0922-118">In this case, the system will select an existing shipment or load instead of creating a new one.</span></span> <span data-ttu-id="a0922-119">但是，系统将仅与状态为 *未结* 的现有装运合并；将不把属于状态为 *已发放* 或更高状态的波次发放的装运视为合并目标。</span><span class="sxs-lookup"><span data-stu-id="a0922-119">However, the system will only consolidate with existing shipments that have a status of *Open*; shipments that belong to a wave release with a status of *Released* or higher won't be considered as targets for consolidation.</span></span>

<span data-ttu-id="a0922-120">当装运合并策略可用时，将隐藏 **仓库** 设置页上以前提供的 **发放到仓库时合并装运** 设置。</span><span class="sxs-lookup"><span data-stu-id="a0922-120">When shipment consolidation policies are made available, the **Consolidate shipment at release to warehouse** setting that was previously available on the **Warehouses** setup page is hidden.</span></span> <span data-ttu-id="a0922-121">为了帮助您过渡到新装运合并功能，**装运合并策略** 页上的一项功能将创建一个默认策略，其中自动包含现有仓库的旧设置。</span><span class="sxs-lookup"><span data-stu-id="a0922-121">To help you transition to the new shipment consolidation feature, a function on the **Shipment consolidation policies** page creates a default policy that automatically includes the old setting for existing warehouses.</span></span> <span data-ttu-id="a0922-122">创建这个默认策略之后，将不再考虑 **仓库** 设置页中的 **发放到仓库时合并装运** 设置。</span><span class="sxs-lookup"><span data-stu-id="a0922-122">After that default policy is created, the **Consolidate shipment at release to warehouse** setting on the **Warehouses** setup page will no longer be considered.</span></span>

<span data-ttu-id="a0922-123">可使用 **发放到仓库** 页按照覆盖履行策略的相同方法手动覆盖适用的合并策略。</span><span class="sxs-lookup"><span data-stu-id="a0922-123">You can use the **Release to warehouse** page to manually override the applicable consolidation policy in the same way that you can override fulfillment policies.</span></span>

<span data-ttu-id="a0922-124">执行发放到仓库之前，可以使用 **装载计划工作台** 页中的 **发放 \> 发放到仓库** 命令创建基于销售订单和转移单行的出站装载。</span><span class="sxs-lookup"><span data-stu-id="a0922-124">You can use the **Release \> Release to warehouse** command on the **Load planning workbench** page to build outbound loads that are based on sales order and transfer order lines before you do the release to the warehouse.</span></span> <span data-ttu-id="a0922-125">这些装载使用的合并逻辑与合并装运策略时一起引入的相同。</span><span class="sxs-lookup"><span data-stu-id="a0922-125">These loads use the same consolidation logic that was introduced together with the consolidation of shipment policies.</span></span>

<span data-ttu-id="a0922-126">可使用 **装运合并工作台** 页合并尚未配置，但已经发放到仓库的现有装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-126">You can use the **Shipment consolidation workbench** page to consolidate existing shipments that haven't yet been confirmed but have already been released to the warehouse.</span></span> <span data-ttu-id="a0922-127">此功能支持以下方案：一天多次运行有自己的装运合并的自动化发放流程，但是配置过程中完成装运到承运人之前手动识别了潜在更多合并。</span><span class="sxs-lookup"><span data-stu-id="a0922-127">This functionality supports scenarios where the automated release process, which has its own shipment consolidation, is run multiple times a day, but potential additional consolidations are manually identified before the shipment to carriers is completed during the confirmation process.</span></span> <span data-ttu-id="a0922-128">可以在将装运发放到仓库之后，确认装运之前，随时使用此功能合并基于销售订单或转移单行创建的出站装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-128">This functionality lets you consolidate outbound shipments that are created from sales order or transfer order lines at any time after the shipments are released to the warehouse but before they are confirmed.</span></span>

<span data-ttu-id="a0922-129">**装运合并工作台** 页的功能类似装载生成工作台，可在此处同时访问多个装运，并为特定装运分配非合并订单。</span><span class="sxs-lookup"><span data-stu-id="a0922-129">The **Shipment consolidation workbench** page works like the load building workbench, where you can assess multiple shipments at the same time and assign a non-consolidated order to a specific shipment.</span></span> <span data-ttu-id="a0922-130">可以应用装运合并模板以多次评估建议的合并和确认。</span><span class="sxs-lookup"><span data-stu-id="a0922-130">You can apply shipment consolidation templates to assess proposed consolidations multiple times and confirm them.</span></span> <span data-ttu-id="a0922-131">将实施某些规则以阻止未经授权的合并和警示您可能的错误。</span><span class="sxs-lookup"><span data-stu-id="a0922-131">Some rules are implemented to prevent unauthorized consolidation and to warn you about possible errors.</span></span>

## <a name="overview-of-new-functionality"></a><span data-ttu-id="a0922-132">新功能概述</span><span class="sxs-lookup"><span data-stu-id="a0922-132">Overview of new functionality</span></span>

<span data-ttu-id="a0922-133">此部分介绍当您开启和使用 *装运合并策略* 功能时更改或添加的页面、命令和功能。</span><span class="sxs-lookup"><span data-stu-id="a0922-133">This section describes the pages, commands, and features that are changed or added when you turn on and use the *Shipment consolidation policies* feature.</span></span>

### <a name="shipment-consolidation-policies-page"></a><span data-ttu-id="a0922-134">装运合并策略页</span><span class="sxs-lookup"><span data-stu-id="a0922-134">Shipment consolidation policies page</span></span>

<span data-ttu-id="a0922-135">策略根据工作订单类型进行区分。</span><span class="sxs-lookup"><span data-stu-id="a0922-135">Policies are differentiated by work order type.</span></span> <span data-ttu-id="a0922-136">**销售订单** 类型代表 _销售订单_ 装运，而 **转移单** 类型则表示 _转移发放_ 装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-136">The **Sales orders** type represents _Sales order_ shipments, and the **Transfer orders** type represents _Transfer issue_ shipments.</span></span>

<span data-ttu-id="a0922-137">每个装运合并策略都有一个用于定义何时应用该策略的查询和一个用于确定执行顺序的序号。</span><span class="sxs-lookup"><span data-stu-id="a0922-137">Every shipment consolidation policy has a query that defines when it's applied and a sequence number that determines the execution order.</span></span> <span data-ttu-id="a0922-138">将为所选字段的每个唯一组合应用合并。</span><span class="sxs-lookup"><span data-stu-id="a0922-138">Consolidation is applied for each unique combination of the selected fields.</span></span> <span data-ttu-id="a0922-139">还提供了一个参数，用于与现有（未结）装运合并。</span><span class="sxs-lookup"><span data-stu-id="a0922-139">An additional parameter that is provided is used for consolidation with existing (open) shipments.</span></span> <span data-ttu-id="a0922-140">每次创建新装运时（在进行波次处理之前），将评估和应用策略。</span><span class="sxs-lookup"><span data-stu-id="a0922-140">The policies are evaluated and applied every time that a new shipment is created (before wave processing).</span></span>

<span data-ttu-id="a0922-141">如果策略缺少任何必需字段，或者包含任何禁止的字段，将在 **所选** 部分中把此策略标记为无效。</span><span class="sxs-lookup"><span data-stu-id="a0922-141">If a policy is missing any mandatory fields, or if it includes any prohibited fields, the policy is marked as not valid in the **Selected** section.</span></span> <span data-ttu-id="a0922-142">必填字段和禁止字段的列表硬编码，并且可以扩展。</span><span class="sxs-lookup"><span data-stu-id="a0922-142">The lists of mandatory and prohibited fields are hard-coded and can be extended.</span></span>

<span data-ttu-id="a0922-143">以下列表显示必需字段。</span><span class="sxs-lookup"><span data-stu-id="a0922-143">The following list shows the mandatory fields.</span></span> <span data-ttu-id="a0922-144">因为始终基于这些字段拆分装运，所以不能将这些字段的值不同的多个装运组合。</span><span class="sxs-lookup"><span data-stu-id="a0922-144">Because shipments are always split based on these fields, you can't group multiple shipments that have different values for these fields.</span></span>

- <span data-ttu-id="a0922-145">用于销售订单：</span><span class="sxs-lookup"><span data-stu-id="a0922-145">For sales orders:</span></span>

    - <span data-ttu-id="a0922-146">**帐号：**_WHSShipmentTable.AccountNum_</span><span class="sxs-lookup"><span data-stu-id="a0922-146">**Account number:** _WHSShipmentTable.AccountNum_</span></span>
    - <span data-ttu-id="a0922-147">**收货人：**_WHSShipmentTable.DeliveryName_</span><span class="sxs-lookup"><span data-stu-id="a0922-147">**Delivery recipient:** _WHSShipmentTable.DeliveryName_</span></span>
    - <span data-ttu-id="a0922-148">**邮寄地址 (RecId)：**_WHSShipmentTable.DeliveryPostalAddress_</span><span class="sxs-lookup"><span data-stu-id="a0922-148">**Postal address (RecId):** _WHSShipmentTable.DeliveryPostalAddress_</span></span>
    - <span data-ttu-id="a0922-149">**仓库：**_WHSShipmentTable.InventLocationId_</span><span class="sxs-lookup"><span data-stu-id="a0922-149">**Warehouse:** _WHSShipmentTable.InventLocationId_</span></span>

- <span data-ttu-id="a0922-150">对于转移单：</span><span class="sxs-lookup"><span data-stu-id="a0922-150">For transfer orders:</span></span>

    - <span data-ttu-id="a0922-151">**源仓库：**_InventTransferTable.InventLocationIdFrom_</span><span class="sxs-lookup"><span data-stu-id="a0922-151">**From warehouse:** _InventTransferTable.InventLocationIdFrom_</span></span>
    - <span data-ttu-id="a0922-152">**目标仓库：**_InventTransferTable.InventLocationIdTo_</span><span class="sxs-lookup"><span data-stu-id="a0922-152">**To warehouse:** _InventTransferTable.InventLocationIdTo_</span></span>

<span data-ttu-id="a0922-153">以下字段对所有文档类型不可用。</span><span class="sxs-lookup"><span data-stu-id="a0922-153">The following fields are unavailable for all document types.</span></span> <span data-ttu-id="a0922-154">这些字段在用户界面 (UI) 中不可见，不能用于合并。</span><span class="sxs-lookup"><span data-stu-id="a0922-154">These fields aren't visible in the user interface (UI), and they can't be used for consolidation.</span></span>

- <span data-ttu-id="a0922-155">**装运 ID：**_WHSShipmentTable.ShipmentId_</span><span class="sxs-lookup"><span data-stu-id="a0922-155">**Shipment ID:** _WHSShipmentTable.ShipmentId_</span></span>
- <span data-ttu-id="a0922-156">**状态：**_WHSShipmentTable.ShipmentStatus_</span><span class="sxs-lookup"><span data-stu-id="a0922-156">**Status:** _WHSShipmentTable.ShipmentStatus_</span></span>
- <span data-ttu-id="a0922-157">**装运合并策略：**_WHSShipmentTable.ShipConsolidationPolicyName_</span><span class="sxs-lookup"><span data-stu-id="a0922-157">**Shipment consolidation policy:** _WHSShipmentTable.ShipConsolidationPolicyName_</span></span>
- <span data-ttu-id="a0922-158">**工作交易类型：**_WHSShipmentTable.WorkTransType_</span><span class="sxs-lookup"><span data-stu-id="a0922-158">**Work transaction type:** _WHSShipmentTable.WorkTransType_</span></span>
- <span data-ttu-id="a0922-159">**波浪 ID：**_WHSShipmentTable.WaveId_</span><span class="sxs-lookup"><span data-stu-id="a0922-159">**Wave ID:** _WHSShipmentTable.WaveId_</span></span>
- <span data-ttu-id="a0922-160">**装载 ID：**_WHSShipmentTable.LoadId_</span><span class="sxs-lookup"><span data-stu-id="a0922-160">**Load ID:** _WHSShipmentTable.LoadId_</span></span>
- <span data-ttu-id="a0922-161">**装运 ID：**_WHSLoadLine.ShipmentId_</span><span class="sxs-lookup"><span data-stu-id="a0922-161">**Shipment ID:** _WHSLoadLine.ShipmentId_</span></span>
- <span data-ttu-id="a0922-162">**装载 ID：**_WHSLoadLine.LoadId_</span><span class="sxs-lookup"><span data-stu-id="a0922-162">**Load ID:** _WHSLoadLine.LoadId_</span></span>

<span data-ttu-id="a0922-163">默认情况下，创建策略时，将把必需字段集用作合并字段。</span><span class="sxs-lookup"><span data-stu-id="a0922-163">By default, when you create a policy, the set of mandatory fields is used as the consolidation fields.</span></span> <span data-ttu-id="a0922-164">但是，可以使用向左箭头和向右箭头按钮修改列表。</span><span class="sxs-lookup"><span data-stu-id="a0922-164">However, you can modify the list by using left arrow and right arrow buttons.</span></span> <span data-ttu-id="a0922-165">（此流程类似在波次模板中选择方法的流程。）</span><span class="sxs-lookup"><span data-stu-id="a0922-165">(The process resembles the process for selecting methods in wave templates.)</span></span>

<span data-ttu-id="a0922-166">将把用户为这些字段选择的值用于所有新建装运，或者在与这些装运合并时将其添加到现有装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-166">The values that users select for these fields will be used for all newly created shipments, or they will be added to existing shipments during consolidation with those shipments.</span></span> <span data-ttu-id="a0922-167">当为了合并两个装运而为其选择的某个字段的值相同时，将合并这两个装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-167">When two shipments have the same value for a field that is selected for consolidation of those shipments, the shipments are consolidated.</span></span> <span data-ttu-id="a0922-168">将把同一个主体应用于选择的所有后续合并字段。</span><span class="sxs-lookup"><span data-stu-id="a0922-168">The same principle applies for all subsequent consolidation fields that are selected.</span></span> <span data-ttu-id="a0922-169">如果值不同，将丢弃第二个装运，并为新装运选择。</span><span class="sxs-lookup"><span data-stu-id="a0922-169">If the values differ, the second shipment is discarded and will be selected for a new shipment.</span></span> <span data-ttu-id="a0922-170">自动化合并流程中包含为装运合并字段的值创建所有唯一组合，然后为相关组合分配装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-170">The automated consolidation process consists of creating all the unique combinations of values for the shipment consolidation fields and then assigning a shipment to the relevant combination.</span></span>

<span data-ttu-id="a0922-171">在合并过程中，将忽略未选择的字段。</span><span class="sxs-lookup"><span data-stu-id="a0922-171">Unselected fields are ignored during the consolidation process.</span></span> <span data-ttu-id="a0922-172">如果两个装运的某个未选择字段的值不同，将清除该字段（即设置为空）。</span><span class="sxs-lookup"><span data-stu-id="a0922-172">If two shipments have different values for an unselected field, the field is cleared (that is, it's set to blank).</span></span> <span data-ttu-id="a0922-173">如果两个装运的某个未选择字段的值相同，则填写该字段。</span><span class="sxs-lookup"><span data-stu-id="a0922-173">If both shipments have the same value for an unselected field, the field is filled in.</span></span>

<span data-ttu-id="a0922-174">将为合并字段（即值不同时将清除的字段）列表硬编码。</span><span class="sxs-lookup"><span data-stu-id="a0922-174">The list of consolidation fields (that is, fields that will be cleared if they have different values) is hard-coded.</span></span> <span data-ttu-id="a0922-175">此列表中包含在创建新装运时从销售订单或转移单行初始化的所有字段。</span><span class="sxs-lookup"><span data-stu-id="a0922-175">The list contains all fields that are initialized from a sales order or transfer order line when a new shipment is created.</span></span> <span data-ttu-id="a0922-176">换句话说，如果某个字段不是从销售订单或转移单行初始化的，向现有装运添加新数据时，将忽略该字段。</span><span class="sxs-lookup"><span data-stu-id="a0922-176">In other words, if a field isn't initialized from a sales order or transfer order line, it's ignored when new data is added to an existing shipment.</span></span>

### <a name="release-to-warehouse-page"></a><span data-ttu-id="a0922-177">发放到仓库页</span><span class="sxs-lookup"><span data-stu-id="a0922-177">Release to warehouse page</span></span>

- <span data-ttu-id="a0922-178">下方网格中的一个新字段显示应用的合并策略。</span><span class="sxs-lookup"><span data-stu-id="a0922-178">A new field in the lower grid shows the consolidation policy that was applied.</span></span>
- <span data-ttu-id="a0922-179">可通过一个新按钮手动选择和/或覆盖合并策略。</span><span class="sxs-lookup"><span data-stu-id="a0922-179">A new button lets you manually select and/or override the consolidation policy.</span></span>

### <a name="release-to-warehouse-command-on-the-load-planning-workbench-page"></a><span data-ttu-id="a0922-180">装载计划工作台页面中的发放到仓库命令</span><span class="sxs-lookup"><span data-stu-id="a0922-180">Release to warehouse command on the Load planning workbench page</span></span>

- <span data-ttu-id="a0922-181">已调整了逻辑，使其使用应用的合并策略。</span><span class="sxs-lookup"><span data-stu-id="a0922-181">The logic was adjusted so that it uses applied consolidation policies.</span></span>
- <span data-ttu-id="a0922-182">现在仅在一个装载中合并装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-182">Shipments are now consolidated only within a single load.</span></span>

### <a name="consolidate-shipments-page"></a><span data-ttu-id="a0922-183">合并装运页</span><span class="sxs-lookup"><span data-stu-id="a0922-183">Consolidate shipments page</span></span>

- <span data-ttu-id="a0922-184">更改了相似字段（即合并候选项）的搜索，使其使用在装运合并策略中选择的字段。</span><span class="sxs-lookup"><span data-stu-id="a0922-184">The search for similar shipments (that is, candidates for consolidation) was changed so that it uses fields that are selected in the shipment consolidation policy.</span></span>
- <span data-ttu-id="a0922-185">现在将在不同装运中的值不同的字段设置为空。</span><span class="sxs-lookup"><span data-stu-id="a0922-185">Fields that have different values in different shipments are now set to blank.</span></span> <span data-ttu-id="a0922-186">（以前使用所选“基础”装运的值。）</span><span class="sxs-lookup"><span data-stu-id="a0922-186">(Previously, the values from the selected "base" shipment were used.)</span></span>

### <a name="shipment-consolidation-workbench-page"></a><span data-ttu-id="a0922-187">装运合并工作台页</span><span class="sxs-lookup"><span data-stu-id="a0922-187">Shipment consolidation workbench page</span></span>

- <span data-ttu-id="a0922-188">新功能以更大规模复制手动合并流程。</span><span class="sxs-lookup"><span data-stu-id="a0922-188">New functionality replicates the process of manual consolidation on a larger scale.</span></span>
- <span data-ttu-id="a0922-189">现在可从 **仓库管理** 模块中的 **发放到仓库** 菜单打开此页。</span><span class="sxs-lookup"><span data-stu-id="a0922-189">You can now open this page from the **Release to warehouse** menu in the **Warehouse management** module.</span></span>
- <span data-ttu-id="a0922-190">此算法分析尚未装运的现有装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-190">The algorithm analyzes existing shipments that haven't yet been shipped.</span></span> <span data-ttu-id="a0922-191">然后根据合并策略中选择的字段建议合并。</span><span class="sxs-lookup"><span data-stu-id="a0922-191">It then proposes consolidation, based on fields that are selected in the consolidation policies.</span></span>

## <a name="comparison-of-functionality"></a><span data-ttu-id="a0922-192">功能比较</span><span class="sxs-lookup"><span data-stu-id="a0922-192">Comparison of functionality</span></span>

<span data-ttu-id="a0922-193">下表总结了不使用装运合并策略时和使用时，装运合并的工作方式。</span><span class="sxs-lookup"><span data-stu-id="a0922-193">The following table summarizes how shipment consolidation works when you don't use shipment consolidation policies and when you do use them.</span></span>

| <span data-ttu-id="a0922-194">不使用装运合并策略时</span><span class="sxs-lookup"><span data-stu-id="a0922-194">Without shipment consolidation policies</span></span> | <span data-ttu-id="a0922-195">使用装运合并策略时</span><span class="sxs-lookup"><span data-stu-id="a0922-195">With shipment consolidation policies</span></span> |
|---|----|
| <span data-ttu-id="a0922-196">不适用</span><span class="sxs-lookup"><span data-stu-id="a0922-196">Not applicable</span></span> | <span data-ttu-id="a0922-197">为合并选择的销售装运或转移装运必须与正在创建的装运的合并策略相同，或者必须将其分配给未结装运（当开启了 **与现有装运合并** 选项时）。</span><span class="sxs-lookup"><span data-stu-id="a0922-197">Sales or transfer shipments that are selected for consolidation must have the same consolidation policy as the shipment that is being created, or they must be assigned to an open shipment (when the **Consolidate with existing shipments** option is turned on).</span></span> |
| <span data-ttu-id="a0922-198">*发放到仓库* 过程不在现有装运中搜索以查找要合并的装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-198">The *Release to warehouse* procedure doesn't search among existing shipments to find a shipment for consolidation.</span></span> <span data-ttu-id="a0922-199">将仅把 *发放到仓库* 过程的当前实例创建的装运用于查找要合并的装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-199">Only shipments that are created by a current instance of the *Release to warehouse* procedure are used to find a shipment for consolidation.</span></span> | <span data-ttu-id="a0922-200">如果为当前正在使用的合并策略开启了 **与现有装运合并** 选项，*发放到仓库* 过程将在基于同一个合并策略创建的现有装运中搜索以查找要合并的装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-200">If the **Consolidate with existing shipments** option is turned on for a consolidation policy that is currently being used, the *Release to warehouse* procedure searches among existing shipments that were created based on the same consolidation policy to find a shipment for consolidation.</span></span> <span data-ttu-id="a0922-201">因此，如果您有两个策略，切勿将正在基于策略 2 创建的装运与基于策略 1 创建的装运合并。</span><span class="sxs-lookup"><span data-stu-id="a0922-201">Therefore, if you have two policies, a shipment that is being created based on policy 2 will never be consolidated with a shipment that was created based on policy 1.</span></span> |
| <span data-ttu-id="a0922-202">不适用</span><span class="sxs-lookup"><span data-stu-id="a0922-202">Not applicable</span></span> | <span data-ttu-id="a0922-203">如果合并策略字段列表为空，或者找不到策略，将为每个销售订单或转移单行创建新装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-203">If a list of consolidation policy fields is empty, or if a policy can't be found, a new shipment is created for each sales order or transfer order line.</span></span> |
| <span data-ttu-id="a0922-204">以下合并字段定义用于合并 *转移行* 的装运的值的唯一组合。</span><span class="sxs-lookup"><span data-stu-id="a0922-204">The following consolidation field defines the unique combination of values that is used to consolidate shipments for a *transfer line*.</span></span> <span data-ttu-id="a0922-205">（将忽略所有其他字段。）</span><span class="sxs-lookup"><span data-stu-id="a0922-205">(All other fields are ignored.)</span></span><ul><li><span data-ttu-id="a0922-206">订单号 (OrderNum)</span><span class="sxs-lookup"><span data-stu-id="a0922-206">Order number (OrderNum)</span></span></li></ul> | <span data-ttu-id="a0922-207">以下合并字段定义用于合并 *转移行* 的装运的值的唯一组合。</span><span class="sxs-lookup"><span data-stu-id="a0922-207">The following consolidation fields define the unique combination of values that is used to consolidate shipments for a *transfer line*.</span></span> <span data-ttu-id="a0922-208">（将忽略所有其他字段。）</span><span class="sxs-lookup"><span data-stu-id="a0922-208">(All other fields are ignored.)</span></span><ul><li><span data-ttu-id="a0922-209">订单号 (OrderNum)</span><span class="sxs-lookup"><span data-stu-id="a0922-209">Order number (OrderNum)</span></span></li><li><span data-ttu-id="a0922-210">收货人 (DeliveryName)</span><span class="sxs-lookup"><span data-stu-id="a0922-210">Delivery recipient (DeliveryName)</span></span></li><li><span data-ttu-id="a0922-211">邮寄地址 (DeliveryPostalAddress)</span><span class="sxs-lookup"><span data-stu-id="a0922-211">Postal address (DeliveryPostalAddress)</span></span></li><li><span data-ttu-id="a0922-212">ISO 国家/地区代码 (CountryRegionISOCode)</span><span class="sxs-lookup"><span data-stu-id="a0922-212">ISO country code (CountryRegionISOCode)</span></span></li><li><span data-ttu-id="a0922-213">地址 (Address)</span><span class="sxs-lookup"><span data-stu-id="a0922-213">Address (Address)</span></span></li><li><span data-ttu-id="a0922-214">站点 (InventSiteId)</span><span class="sxs-lookup"><span data-stu-id="a0922-214">Site (InventSiteId)</span></span></li><li><span data-ttu-id="a0922-215">仓库 (InventLocationId)</span><span class="sxs-lookup"><span data-stu-id="a0922-215">Warehouse (InventLocationId)</span></span></li><li><span data-ttu-id="a0922-216">装运承运人 (CarrierCode)</span><span class="sxs-lookup"><span data-stu-id="a0922-216">Shipping carrier (CarrierCode)</span></span></li><li><span data-ttu-id="a0922-217">承运人服务 (CarrierServiceCode)</span><span class="sxs-lookup"><span data-stu-id="a0922-217">Carrier service (CarrierServiceCode)</span></span></li><li><span data-ttu-id="a0922-218">交货方式 (ModeCode)</span><span class="sxs-lookup"><span data-stu-id="a0922-218">Mode of delivery (ModeCode)</span></span></li><li><span data-ttu-id="a0922-219">承运人组 (CarrierGroupCode)</span><span class="sxs-lookup"><span data-stu-id="a0922-219">Carrier group (CarrierGroupCode)</span></span></li><li><span data-ttu-id="a0922-220">交货期 (DlvTermId)</span><span class="sxs-lookup"><span data-stu-id="a0922-220">Delivery terms (DlvTermId)</span></span></li></ul><span data-ttu-id="a0922-221">创建新装运时，只有这些字段可用和初始化这些字段。</span><span class="sxs-lookup"><span data-stu-id="a0922-221">These fields are the only fields that are available and initialized when a new shipment is created.</span></span> |
| <span data-ttu-id="a0922-222">以下合并字段定义用于合并 *销售行* 的装运的值的唯一组合。</span><span class="sxs-lookup"><span data-stu-id="a0922-222">The following consolidation fields define the unique combination of values that is used to consolidate shipments for a *sales line*.</span></span> <span data-ttu-id="a0922-223">（将忽略所有其他字段。）</span><span class="sxs-lookup"><span data-stu-id="a0922-223">(All other fields are ignored.)</span></span><ul><li><span data-ttu-id="a0922-224">订单号 (OrderNum)</span><span class="sxs-lookup"><span data-stu-id="a0922-224">Order number (OrderNum)</span></span></li><li><span data-ttu-id="a0922-225">客户参考 (CustomerRef)</span><span class="sxs-lookup"><span data-stu-id="a0922-225">Customer reference (CustomerRef)</span></span></li><li><span data-ttu-id="a0922-226">客户申请 (CustomerReq)</span><span class="sxs-lookup"><span data-stu-id="a0922-226">Customer requisition (CustomerReq)</span></span></li><li><span data-ttu-id="a0922-227">交货期 (DlvTermId)</span><span class="sxs-lookup"><span data-stu-id="a0922-227">Delivery terms (DlvTermId)</span></span></li></ul> | <span data-ttu-id="a0922-228">以下合并字段定义用于合并 *销售行* 的装运的值的唯一组合。</span><span class="sxs-lookup"><span data-stu-id="a0922-228">The following consolidation fields define the unique combination of values that is used to consolidate shipments for a *sales line*.</span></span> <span data-ttu-id="a0922-229">（将忽略所有其他字段。）</span><span class="sxs-lookup"><span data-stu-id="a0922-229">(All other fields are ignored.)</span></span><ul><li><span data-ttu-id="a0922-230">订单号 (OrderNum)</span><span class="sxs-lookup"><span data-stu-id="a0922-230">Order number (OrderNum)</span></span></li><li><span data-ttu-id="a0922-231">帐号 (AccountNum)</span><span class="sxs-lookup"><span data-stu-id="a0922-231">Account number (AccountNum)</span></span></li><li><span data-ttu-id="a0922-232">收货人 (DeliveryName)</span><span class="sxs-lookup"><span data-stu-id="a0922-232">Delivery recipient (DeliveryName)</span></span></li><li><span data-ttu-id="a0922-233">邮寄地址 (DeliveryPostalAddress)</span><span class="sxs-lookup"><span data-stu-id="a0922-233">Postal address (DeliveryPostalAddress)</span></span></li><li><span data-ttu-id="a0922-234">ISO 国家/地区代码 (CountryRegionISOCode)</span><span class="sxs-lookup"><span data-stu-id="a0922-234">ISO country code (CountryRegionISOCode)</span></span></li><li><span data-ttu-id="a0922-235">地址 (Address)</span><span class="sxs-lookup"><span data-stu-id="a0922-235">Address (Address)</span></span></li><li><span data-ttu-id="a0922-236">站点 (InventSiteId)</span><span class="sxs-lookup"><span data-stu-id="a0922-236">Site (InventSiteId)</span></span></li><li><span data-ttu-id="a0922-237">仓库 (InventLocationId)</span><span class="sxs-lookup"><span data-stu-id="a0922-237">Warehouse (InventLocationId)</span></span></li><li><span data-ttu-id="a0922-238">装运承运人 (CarrierCode)</span><span class="sxs-lookup"><span data-stu-id="a0922-238">Shipping carrier (CarrierCode)</span></span></li><li><span data-ttu-id="a0922-239">承运人服务 (CarrierServiceCode)</span><span class="sxs-lookup"><span data-stu-id="a0922-239">Carrier service (CarrierServiceCode)</span></span></li><li><span data-ttu-id="a0922-240">交货方式 (ModeCode)</span><span class="sxs-lookup"><span data-stu-id="a0922-240">Mode of delivery (ModeCode)</span></span></li><li><span data-ttu-id="a0922-241">承运人组 (CarrierGroupCode)</span><span class="sxs-lookup"><span data-stu-id="a0922-241">Carrier group (CarrierGroupCode)</span></span></li><li><span data-ttu-id="a0922-242">代理人 ID (BrokerCode)</span><span class="sxs-lookup"><span data-stu-id="a0922-242">Broker ID (BrokerCode)</span></span></li><li><span data-ttu-id="a0922-243">方向 (LoadDirection)</span><span class="sxs-lookup"><span data-stu-id="a0922-243">Direction (LoadDirection)</span></span></li><li><span data-ttu-id="a0922-244">交货期 (DlvTermId)</span><span class="sxs-lookup"><span data-stu-id="a0922-244">Delivery terms (DlvTermId)</span></span></li><li><span data-ttu-id="a0922-245">客户参考 (CustomerRef)</span><span class="sxs-lookup"><span data-stu-id="a0922-245">Customer reference (CustomerRef)</span></span></li><li><span data-ttu-id="a0922-246">客户申请 (CustomerReq)</span><span class="sxs-lookup"><span data-stu-id="a0922-246">Customer requisition (CustomerReq)</span></span></li></ul><span data-ttu-id="a0922-247">创建新装运时，只有这些字段可用和初始化这些字段。</span><span class="sxs-lookup"><span data-stu-id="a0922-247">These fields are the only fields that are available and initialized when a new shipment is created.</span></span> |
| <span data-ttu-id="a0922-248">不适用</span><span class="sxs-lookup"><span data-stu-id="a0922-248">Not applicable</span></span> | <span data-ttu-id="a0922-249">以下合并字段是 *销售行* 的必需字段，不能删除：</span><span class="sxs-lookup"><span data-stu-id="a0922-249">The following consolidation fields are mandatory for a *sales line* and can't be removed:</span></span><ul><li><span data-ttu-id="a0922-250">帐号 (AccountNum)</span><span class="sxs-lookup"><span data-stu-id="a0922-250">Account number (AccountNum)</span></span></li><li><span data-ttu-id="a0922-251">收货人 (DeliveryName)</span><span class="sxs-lookup"><span data-stu-id="a0922-251">Delivery recipient (DeliveryName)</span></span></li><li><span data-ttu-id="a0922-252">邮寄地址 (DeliveryPostalAddress)</span><span class="sxs-lookup"><span data-stu-id="a0922-252">Postal address (DeliveryPostalAddress)</span></span></li><li><span data-ttu-id="a0922-253">仓库 (InventLocationId)</span><span class="sxs-lookup"><span data-stu-id="a0922-253">Warehouse (InventLocationId)</span></span></li></ul><span data-ttu-id="a0922-254">默认情况下，在创建新策略时分配这些字段。</span><span class="sxs-lookup"><span data-stu-id="a0922-254">By default, these fields will be assigned when a new policy is created.</span></span> <span data-ttu-id="a0922-255">不能删除它们。</span><span class="sxs-lookup"><span data-stu-id="a0922-255">They can't be removed.</span></span> |
| <span data-ttu-id="a0922-256">**装载计划工作台** 页面中的 *将装载发放到仓库* 过程使用自己的单独代码创建装运和波次。</span><span class="sxs-lookup"><span data-stu-id="a0922-256">The *Release of loads to warehouse* procedure on the **Load planning workbench** page uses its own separate code to create shipments and waves.</span></span> | <span data-ttu-id="a0922-257">将应用装运合并策略以确定应该为合并评估哪些字段。</span><span class="sxs-lookup"><span data-stu-id="a0922-257">Shipment consolidation policies are applied to determine which fields should be evaluated for consolidation.</span></span> <span data-ttu-id="a0922-258">仅在一个装载中合并装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-258">Shipments are consolidated only within a single load.</span></span> |
| <span data-ttu-id="a0922-259">请在 **所有装运** 页中手动选择 **合并装运**，然后选择目标“基础”装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-259">You manually select **Consolidate shipments** on the **All shipments** page and then select a target "base" shipment.</span></span> <span data-ttu-id="a0922-260">筛选器将推荐具有多个关键字段的匹配值的任何现有装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-260">The filter will suggest any existing shipments that have matching values for several key fields.</span></span> | <span data-ttu-id="a0922-261">请在 **所有装运** 页中手动选择 **合并装运**，然后选择目标“基础”装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-261">You manually select **Consolidate shipments** on the **All shipments** page and then select a target "base" shipment.</span></span> <span data-ttu-id="a0922-262">系统将通过匹配为相关装运合并策略配置的多个关键字段的值，建议其他现有装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-262">The system will suggest other existing shipments by matching the values of several key fields that are configured for the relevant shipment consolidation policies.</span></span> |
| <span data-ttu-id="a0922-263">**所有装运** 页中的 **合并装运** 命令只能用于一个装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-263">You can use the **Consolidate shipments** command on the **All shipments** page for only a single shipment.</span></span> | <span data-ttu-id="a0922-264">**装运合并工作台** 页可帮助您查找还不是已装运状态的一组装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-264">The **Shipment consolidation workbench** page helps you find a set of shipments that aren't yet in a shipped state.</span></span> <span data-ttu-id="a0922-265">将根据在装运合并策略中配置的多个关键字段分析这些装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-265">These shipments are analyzed based on several key fields that are configured in your shipment consolidation policies.</span></span> <span data-ttu-id="a0922-266">将建议合并这些字段的值匹配的任何装运。</span><span class="sxs-lookup"><span data-stu-id="a0922-266">Any shipments where the values of these fields match are suggested for consolidation.</span></span><p><span data-ttu-id="a0922-267">可以通过从建议合并删除装运和/或通过向其添加装运，手动维护合并。</span><span class="sxs-lookup"><span data-stu-id="a0922-267">You can manually maintain the consolidation by removing shipments from suggested consolidations and/or by adding shipments to them.</span></span> <span data-ttu-id="a0922-268">可能发生多种错误，但是可以覆盖其中的一部分。</span><span class="sxs-lookup"><span data-stu-id="a0922-268">Several types of errors can occur, but you can override some of them.</span></span></p> |
| <span data-ttu-id="a0922-269">**设计说明**：*将销售订单自动发放到仓库* 过程将销售行拆分为组。</span><span class="sxs-lookup"><span data-stu-id="a0922-269">**Design note:** The *Automatic release of sales orders to warehouse* procedure splits sales lines into groups.</span></span> <span data-ttu-id="a0922-270">每个组有自己的唯一 **ReleaseToWarehouseId** 值，并通过 *发放到仓库* 过程单独处理。</span><span class="sxs-lookup"><span data-stu-id="a0922-270">Each group has its own unique **ReleaseToWarehouseId** value and is processed separately by the *Release to warehouse* procedure.</span></span> <span data-ttu-id="a0922-271">无论如何设置工作分解，此过程都会产生新工作。</span><span class="sxs-lookup"><span data-stu-id="a0922-271">This procedure creates new work regardless of the work break setup.</span></span> | <span data-ttu-id="a0922-272">**设计说明**：*将销售订单自动发放到仓库* 过程为正在处理的所有销售行分配同一个 **ReleaseToWarehouseId** 值。</span><span class="sxs-lookup"><span data-stu-id="a0922-272">**Design note:** The *Automatic release of sales orders to warehouse* procedure assigns the same **ReleaseToWarehouseId** value to all sales lines that are being processed.</span></span> <span data-ttu-id="a0922-273">所有销售行由 *发放到仓库* 过程同时处理。</span><span class="sxs-lookup"><span data-stu-id="a0922-273">All sales lines are processed by the *Release to warehouse* procedure at the same time.</span></span> <span data-ttu-id="a0922-274">为了确保前面的行为，必须按装运 ID 配置工作分解。</span><span class="sxs-lookup"><span data-stu-id="a0922-274">To ensure the earlier behavior, you must configure work break per shipment ID.</span></span> |

## <a name="additional-resources"></a><span data-ttu-id="a0922-275">其他资源</span><span class="sxs-lookup"><span data-stu-id="a0922-275">Additional resources</span></span>

- [<span data-ttu-id="a0922-276">配置装运合并策略</span><span class="sxs-lookup"><span data-stu-id="a0922-276">Configure shipment consolidation policies</span></span>](configure-shipment-consolidation-policies.md)
