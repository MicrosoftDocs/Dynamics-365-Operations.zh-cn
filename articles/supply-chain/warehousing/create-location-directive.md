---
title: 创建货位指令
description: 本主题说明如何创建位置指令。 位置指令是帮助标识领料和使位置用于库存移动的用户定义的规则。
author: Mirzaab
manager: tfehr
ms.date: 07/28/2020
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: WHSLocDirTable, WHSLocDirHint, WHSLocDirTableUOM, WHSLocDirFailure
audience: Application User
ms.reviewer: kamaybac
ms.search.scope: Core, Operations
ms.search.region: Global
ms.author: mirzaab
ms.search.validFrom: 2020-07-28
ms.dyn365.ops.version: Release 10.0.9
ms.openlocfilehash: 4f634b7f526fd198b394af6d3870c43ee560813e
ms.sourcegitcommit: a36a4f9915ae3eb36bf8220111cf1486387713d9
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/16/2020
ms.locfileid: "4016762"
---
# <a name="create-location-directives"></a>创建货位指令

[!include [banner](../includes/banner.md)]

本主题说明如何创建位置指令。 位置指令是帮助标识领料和使位置用于库存移动的用户定义的规则。 例如，对于销售订单交易记录，位置指令决定在何处领取物料，及将领取的物料放置在何处。

> [!NOTE]
> 此主题适用于 **仓库管理** 模块中的功能。 它不适用于[库存管理](../inventory/inventory-home-page.md)模块中的功能。

您可以使用位置指令来执行以下任务：

- 存储传入物料。
- 领取和暂存出站交易记录的物料。
- 领取并放置生产的原材料。
- 补货位置。

## <a name="prerequisites"></a>先决条件

在创建位置指令之前，必须执行以下步骤来确保满足先决条件。

1. 转到 **仓库管理 \> 设置 \> 仓库 \> 仓库** 。
1. 创建仓库。
1. 在 **仓库** 快速选项卡上，将 **使用仓库管理流程** 选项设置为 *是* 。
1. 创建位置、位置类型、位置配置文件和位置格式。 有关详细信息，请参阅[配置启用了 WMS 的仓库中的位置](https://docs.microsoft.com/dynamics365/supply-chain/warehousing/tasks/configure-locations-wms-enabled-warehouse)。
1. 创建站点、区域和区域组。 有关详细信息，请参阅[仓库设置](https://docs.microsoft.com/dynamics365/commerce/channels-setup-warehouse)和[配置启用了 WMS 的仓库中的位置](https://docs.microsoft.com/dynamics365/supply-chain/warehousing/tasks/configure-locations-wms-enabled-warehouse)。

## <a name="setup"></a>设置

### <a name="create-location-directives"></a>创建货位指令

要创建位置指令，请遵循以下步骤。

1. 转到 **库存管理 \> 设置 \> 位置指令** 。
1. 在列表窗格中，将 **工作订单类型** 字段设置为要为其创建位置指令的库存交易记录的类型。
1. 在“操作窗格”中，选择 **新建** 创建位置指令。
1. 对于新的位置指令，如下表所述设置字段。

    | 字段 | 说明 |
    |---|---|
    | 序列号 | 输入指示位置指令的序列位置的整数。 序列位置确定何时为所选工作订单类型处理每个位置指令。 |
    | 姓名 | 为位置指令输入名称。 | 
    | 工作类型 | 选择应该执行的工作类型。 值列表取决于您在 **工作订单类型** 字段中选择的库存交易记录的类型。 可能提供以下值：<ul><li>**放置** – 位置指令将尝试找到最佳位置，通过接收、生产或库存调整放置或定位进入系统的库存。 此位置指令还用于定义出站流中的放到暂存位置或最终的货架门装运位置。</li><li>**领料** – 此位置指令将尝试找到从中实际预留库存（创建工作）的最佳位置。 即使工作未完成，也可以完成领料（即可关闭领料工作行）。 用户可以完成实际领料。 在系统中，该操作是一个选择步骤。 用户之后可以通过移动设备取消，以后再完成工作（例如，放置）。 但是，如果最终放置已完成，将首先关闭此工作标题。</li><li>**盘点** 、 **调整** 、 **自定义** 、 **库存状态更改** 、 **牌照生成** 、 **打印** 、 **状态更改** 和 **打包到嵌套的牌照** – 这些值不能在任何位置指令设置中使用。</li></ul> |
    | 站点 | 选择应在其中完成该工作的站点。 |
    | 存放地点 | 选择应在其中完成该工作的仓库位置。 |
    | 指令代码 | 选择指令代码以指导如何选择与为其分配了此代码的工作模板放置行有关的位置指令。 在 **指令代码** 页面上，您可以创建可用于将工作模板连接到位置指令的新代码。 还可以使用该页面建立任何工作模板行与位置指令（如货架门或暂存库位）之间的链接。 有关如何使用工作模板配置指令代码的信息，请参阅[使用工作模板和位置指令控制仓库工作](control-warehouse-location-directives.md)。<p>如果设置了指令代码，在必须生成工作时，系统将按指令代码而不是按序列搜索位置指令。 这样，您可以更精确地了解用于工作模板中特定步骤（如暂存材料的步骤）的位置模板。</p> |
    | 处置代码 | 选择处置代码，以重定向将接收物料放入位置的储存。 （有关详细信息，请参阅 [设置处置代码](tasks/set-up-dispositions-codes.md)。）仅当 **工作订单类型** 字段设置为 *采购订单* 、 *退货单* 或 *成品储存* 时，此字段才可用。 |
    | 多个 SKU | 将此选项设置为 *是* 可以在一个位置上使用多个库存单位 (SKU)。 例如，此选项对货架门必须设置为 *是* 。<p>如果 **多个 SKU** 选项设置为 *是* ，放置位置将在工作中指定（预期）。 但是，仅当工作包含必须领取和放置的不同 SKU 时，放置位置才能够处理多个物料的放置，当工作仅包含一个必须放置的 SKU 时则不行。</p><p>如果 **多个 SKU** 选项设置为 *否* ，则仅当放置只有一种 SKU 时才指定放置位置。</p><p>要同时使用这两种方法，必须指定两个具有相同结构和设置的行，但其中之一的 **多个 SKU** 选项设置为 *是* ，另一行设置为 *否* 。 换言之，即使您不必在工作 ID 中区分单个 SKU 和多个 SKU，放置操作也需要两个相同的位置指令。 如果您的订单中有多个物料，则还必须为领料设置位置指令。</p><p>**注意：** 如果将 *放置* 工作类型的位置指令的 **多个 SKU** 选项设置为 *是* ，系统将始终选择第一个位置指令行，而不考虑行中创建的其他限制。</p> |

1. 可选：在操作窗格上，选择 **编辑查询** 选择位置或指定在您选择特定位置指令时应用的任何限制。
1. 在 **行** 快速选项卡上，创建一个或更多行来指定单位，并在仓库中定位或预留数量。
1. 在每个新行上，如下表所述设置字段。

    | 字段 | 说明 |
    |---|---|
    | 序列号 | 输入指示位置指令的序列位置的整数。 序列位置确定何时为所选工作类型处理每个位置指令。 |
    | 起始数量 | 在应选择中网格序列时指定开始数量范围。 以在 **单位** 字段中选择的度量单位指定数量。 |
    | 目标数量 | 在应选择中网格序列时指定结束数量范围。 以在 **单位** 字段中选择的度量单位指定数量。 |
    | 单位 | 选择物料的度量单位。<p>您可以指定指令应该应用的最小数量和最大数量。 您还可以指定指令应该用于特定的库存单位。 **单位** 字段仅用于评估数量。</p><p>为确定是否应用位置指示行，系统将使用行上指定的 **单位** 值来评估数量。 只要访问位置指令行，系统都将尝试把需求单位转换为该行中指定的单位。 如果不存在单位转换，系统将移到下一行。</p> |
    | 查找数量 | 仅当您尝试在仓库中放置或查找数量时，此字段才有效。 换言之，它仅对 *放置* 工作有效。 选择用于评估数量是否处在 **起始数量** 和 **截止数量** 字段中设定的范围内的方法。 如果位置指令为入货交易记录，请请选择以下选项之一：<ul><li>**照牌照数** ─ 要评估数量是否在目标数量范围内，使用所接收到的照牌上的数量。</li><li>**统一的数量** ─ 要评估数量是否在目标数量范围内，使用交易期间统一的数量。 例如，在仓库中如果您接收 1,000 数量，并将其分为 10 个牌照，每个牌照数量为 100，您可使用 1,000 物料数量，而不是 100 牌照数量。</li><li>**剩余数量** ─ 要评估数量是否在目标数量范围内，使用当前正在签入的采购订单行上剩余要接收的数量。</li><li>**预期数量** ─ 要评估数量是否在目标数量范围内，使用采购订单行的总数量，不考虑已收到的数量。</li></ul> |

1. 可选：在 **行** 快速选项卡上，您可以设置以下其他字段。

    | 字段 | 说明 |
    |---|---|
    | 按单位施加的限制 | 选中此复选框可以限制被视为位置指令行的有效选择条件的度量单位。 指定度量单位后，只有此单位至少与为单位序列组定义的一个单位匹配的物料会被视为对行选择有效。<p>例如，单位仅限于托盘，并且物料与包含 *托盘* 单位的单位序列组相关联。 在这种情况下，物料将被视为位置指令的有效选项。</p><p>但是， **按单位施加限制** 复选框不会控制工作行上应用的一个或多个单位。 单位限制仅应用于通过单位序列组提供的单位。</p><p>例如，物料与同时包含 *托盘* 和 *件* 单位的单位序列组相关联。 度量单位已定义：1 托盘 = 100 件，位置指令仅对托盘使用 **按单位施加限制** 功能。 此外，定义了一个工作模板，限制工作标题创建为 50 件。 在这种情况下，将创建 50 件的工作行。</p><p>若要指定用于限制的度量单位，请按照下列步骤操作</p><ol><li>在 **行** 快速选项卡上，选择 **按单位施加限制** 。 仅在选中行上的 **按单位施加限制** 复选框并选择 **保存** 后，此按钮才可用。</li><li>在 **单位** 字段中，选择用于限制领料和储存流程的度量单位。</li></ol> |
    | 进位到单位 | 选择此选项以指示原材料领取应舍入为在 **按单位施加限制** 字段中指定的处理单位的倍数。 此字段仅适用于类型为 *领料* 的原材料领料和位置指令。 |
    | 查找包装数量  | 如果在 **销售订单** 页中指定领料单位数量，则选择此复选框。 如果选择此复选框，则仅可选择具有此领料单位数量的位置。 |
    | 允许拆分 | 选择此复选框以拆分跨多个位置的数量。 |
    | 即时补货模板 | 创建与补货模板之间的连接，以在未分配物料时立即开始补货。 如果将此字段保留为空，则处理完位置指令的所有行之前，不开始执行物料补货。<p>此字段仅在允许补货的选定工作订单类型上可用，如 *销售订单* 和 *原材料领料* 。</p> |

1. 在 **位置指令操作** 快速选项卡上，选择 **新建** 选择位置或位置范围。
1. **序列号** 字段显示将针对所选工作类型处理位置指令的顺序。 您可以修改此序列。 但是，请注意位置指示操作的序列号，因为位置指示操作将始终按此序列运行。
1. 在 **名称** 字段中，输入位置指令操作的名称。 请提供相对具体的名称，以说明是什么操作。
1. 可选：选择 **编辑查询** 修改仓库位置和其他条件。
1. 可选：您可以为位置指令设置以下其他字段。

    | 字段 | 说明 |
    |---|---|
    | 固定货位使用情况 | 选择位置指令应该考虑哪些位置：<ul><li>**固定位置和非固定位置** – 位置指令将考虑所有位置。</li><li>**仅产品的固定位置** – 位置指令将仅考虑产品的固定位置。</li><li>**仅产品变型的固定位置** – 位置指令将仅考虑产品变型的固定位置。</li></ul> |
    | 允许负库存 | 选择此复选框，以允许在指定仓库位置的负库存。 |
    | 批处理已启用 | 选择此复选框，以使用批次启动的物料的批次策略。 如果选中此复选框，并且 **策略** 字段设置为 *无* ，系统将移至下一个操作行。 |
    | 战略 | 选择位置指令应使用的策略：<ul><li>**无** – 不使用任何策略。</li><li>**匹配包装数量** – 此策略检查领料位置是否具有指定的包装数量。 此策略仅在将 **工作类型** 字段设置为 *领料* 时有效。</li><li>**合并** – 在已有相似物料时，此策略合并特定位置的物料。 此策略仅在将 **工作类型** 字段设置为 *放置* 时有效。 在典型的放置设置中，系统会尝试在第一个操作行上合并，然后在第二个操作行上尝试不合并的放置。 合并货物可以提高后续领料的效率。</li><li>**先到期先出 (FEFO) 批次预留** – 此策略在使用批次到期日期定位库存时使用，并且会分配给批次预留。 当使用除到期日期之外的批次最佳使用日期查找库存时，也将使用先到期先出 (FEFO) 批次预留策略。 您只能将此策略用于支持批处理的物料。 此策略仅在将 **工作类型** 字段设置为 *领料* 时有效。 选择此策略时，将覆盖对所应用批处理号进行的所有查询排序。</li><li>**进位到全部牌照** – 此策略舍入库存数量，以使其匹配分配给必须领取的物料的牌照数量。 此策略只能用于位置指令的补货类型，并且只能在 **工作类型** 字段设置为 *领料* 时使用。</li><li>**没有传入工作的空位置** – 此策略用于查找空位置。 如果某个位置没有实际库存和预期的传入工作，该位置将被视为空位置。 此策略仅在将 **工作类型** 字段设置为 *放置* 时有效。</li></ul> |

## <a name="example-of-the-use-of-location-directives"></a>库位指令使用示例

对于本示例，请注意采购订单流程，在此流程中库位指令必须为已在收货台登记的库存物料在仓库内查找可用容量。 首先，需要通过与现有库存量合并来在仓库内查找可用容量。 如果合并是不可能的，然后需要查找空库位。

对于此情况，必须定义两个库位指令操作。 序列中的第一个操作必须使用 **合并** 策略，第二个应使用 **没有传入工作的空库位** 策略。 除非定义第三个操作来处理溢出情况，否则在仓库中没有更多容量时，有两个可能的结果：即使未定义库位也可以创建工作，或者创建工作流程可能失败。 结果将由 **库位指令失败** 页上的设置确定，在此页面您可以决定是否为每个工作订单类型选择 **在库位指令失败时停止工作** 选项。

## <a name="next-step"></a>后续步骤

在创建位置指令后，您可使各指令代码与工作创建的工作模板代码关联。 有关详细信息，请参阅[使用工作模板和位置指令控制仓库工作](https://docs.microsoft.com/dynamics365/supply-chain/warehousing/control-warehouse-location-directives)。

## <a name="technical-information-for-system-admins"></a>系统管理员技术信息

如果您无权访问用于完成此任务的页面，请联系系统管理员，并提供下表中显示的信息。

| 类别 | 必备项 |
|---|---|
| Configuration Keys | 转到 **系统管理 \> 设置 \> 许可证配置** 。 扩展 **贸易** 许可证密钥，然后选择 **仓库和运输管理** 配置键。 |
