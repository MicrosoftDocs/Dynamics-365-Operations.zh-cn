---
title: 使用库位指令
description: 本主题介绍如何使用库位指令。 位置指令是帮助标识领料和使位置用于库存移动的用户定义的规则。
author: Mirzaab
ms.date: 11/13/2020
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: WHSLocDirTable, WHSLocDirHint, WHSLocDirTableUOM, WHSLocDirFailure
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: mirzaab
ms.search.validFrom: 2020-11-13
ms.dyn365.ops.version: 10.0.15
ms.openlocfilehash: 77e3139f62ca73f461ff4a4b5114f5e7ba181d3b
ms.sourcegitcommit: 3b87f042a7e97f72b5aa73bef186c5426b937fec
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/29/2021
ms.locfileid: "7575235"
---
# <a name="work-with-location-directives"></a>使用库位指令

[!include [banner](../includes/banner.md)]

库位指令是帮助标识领料和使位置用于库存移动的规则。 例如，在销售订单交易记录中，位置指令决定在何处领物料，及将已领的物料放置在何处。 库位指令包含标题和关联的行。 它们创建用于特定的 *工作订单类型*。

> [!NOTE]
> 此主题适用于 **仓库管理** 模块中的功能。 它不适用于[库存管理](../inventory/inventory-home-page.md)模块中的功能。

您可以使用位置指令来执行以下任务：

- 存储传入物料。
- 领取和暂存出站交易记录的物料。
- 领取并放置生产的原材料。
- 补货位置。

## <a name="prerequisites"></a>先决条件

在创建位置指令之前，必须执行以下步骤来确保满足先决条件。

1. 确保所需的许可证密钥已打开。 转到 **系统管理 \> 设置 \> 许可证配置**，展开 **贸易** 许可证密钥，然后选择 **仓库和运输管理** 配置密钥。 请注意，此步骤需要管理员访问权限。
1. 转到 **仓库管理 \> 设置 \> 仓库 \> 仓库**。
1. 创建仓库。
1. 在 **仓库** 快速选项卡上，将 **使用仓库管理流程** 选项设置为 *是*。
1. 创建位置、位置类型、位置配置文件和位置格式。 有关详细信息，请参阅[配置启用了 WMS 的仓库中的位置](./tasks/configure-locations-wms-enabled-warehouse.md)。
1. 创建站点、区域和区域组。 有关详细信息，请参阅[仓库设置](../../commerce/channels-setup-warehouse.md)和[配置启用了 WMS 的仓库中的位置](./tasks/configure-locations-wms-enabled-warehouse.md)。

## <a name="work-order-types-for-location-directives"></a>库位指令的工作订单类型

可为库位指令设置的许多字段通用于所有工作订单类型。 但是，其他字段特定于特定的工作订单类型。

![库位指令工作订单类型。](media/Location_Directives_Work_Order_Types.png "库位指令工作订单类型")

> [!NOTE]
> 系统仅使用两种工作订单类型：*已取消工作* 和 *周期盘点*。 无法为这些工作订单类型创建库位指令。

以下小节中的表列出了在设置库位指令时可用的特定于工作人员订单类型的常见字段。

### <a name="fields-that-are-common-to-all-work-order-types"></a>通用于所有工作订单类型的字段

下表列出了通用于所有工作订单类型的字段。

| 快速选项卡 | 字段 |
|---|---|
| 位置指令 | 工作类型 |
| 位置指令 | 站点 |
| 位置指令 | 仓库 |
| 位置指令 | 指令代码 |
| 位置指令 | 多个 SKU |
| 路线 | 序列号 |
| 路线 | 起始数量 |
| 路线 | 目标数量 |
| 路线 | 单位 |
| 路线 | 查找数量 |
| 路线 | 按单位施加的限制 |
| 路线 | 进位到单位 |
| 路线 | 查找包装数量  |
| 路线 | 允许拆分 |
| 位置指令操作 | 序列号 |
| 位置指令操作 | 姓名 |
| 位置指令操作 | 固定库位使用情况 |
| 位置指令操作 | 允许负库存 |
| 位置指令操作 | 批处理已启用 |
| 位置指令操作 | 战略 |

### <a name="fields-that-are-specific-to-work-order-types"></a><a name="fields-specific-types"></a>特定于工作订单类型的字段

下表列出了特定于特定工作订单类型的字段。

| 快速选项卡 | 字段 | 工作订单类型 |
|---|---|---|
| 位置指令 | 查找依据 | 采购订单 |
| 位置指令 | 适用的处置代码 | 采购订单 |
| 位置指令 | 处置代码 | 采购订单 |
| 位置指令 | 适用的处置代码 | 成品储存 |
| 位置指令 | 处置代码 | 成品储存 |
| 位置指令 | 适用的处置代码 | 退货单 |
| 位置指令 | 处置代码 | 退货单 |
| 位置指令 | 适用的处置代码 | 看板储存 |
| 位置指令 | 适用的处置代码 | 看板领料 |
| 路线 | 即时补货模板 | 销售订单 |
| 路线 | 即时补货模板 | 原材料领取 |
| 路线 | 即时补货模板 | 转移问题 |
| 路线 | 即时补货模板 | 看板领料 |

## <a name="open-the-location-directives-page"></a>打开库位指令页面

若要打开 **库位指令** 页面，请转到 **仓库管理 \> 设置 \> 库位指令**。

在这里，您可以使用操作窗格上的命令查看、创建和编辑库位指令。 有关如何使用页面上可用的所有字段的信息，请参阅本主题的剩余部分。

## <a name="action-pane"></a>操作窗格

**库位指令** 页面上的操作窗格包含可用于创建、编辑和删除指令的按钮（**编辑**、**新建** 和 **删除**）。 它还包含以下按钮，这些按钮使您可以调整处理库位指令的顺序，并配置定义用于应用库位指令的条件的查询：

- **上移** – 按顺序向上移动选定的库位指令。 例如，您可以将其从序列号 4 移动到序列号 3。
- **下移** – 按顺序向下移动选定的库位指令。 例如，您可以将其从序列号 4 移动到序列号 5。
- **编辑查询** – 打开一个对话框，您可以在其中定义处理选定库位指令所遵循的条件。 例如，您可能希望它仅应用于特定的仓库。

## <a name="location-directives-header"></a>库位指令标题

库位指令标题包括库位指令的序列号和描述性名称的以下字段：

- **序列号** – 该字段指示系统尝试为选定工作订单类型应用每个库位指令的序列。 首先应用较小的编号。 您可以使用操作窗格上的 **上移** 和 **下移** 按钮更改顺序。
- **名称** – 输入库位指令的描述性名称。 此名称应有助于标识指令的常规用途。 例如，输入 *仓库 24 中的销售订单领料*。

## <a name="location-directives-fasttab"></a>库位指令快速选项卡

**库位指令** 快速选项卡上的字段特定于在列表窗格中的 **工作订单类型** 字段中选择的工作订单类型。

- **工作类型** – 选择必须执行的工作类型。 可用值取决于您在 **工作订单类型** 字段中选择的库存交易的类型。 选择以下值之一：

    - **放置** – 库位指令将尝试找到最理想的库位，通过接收、生产或库存调整放置或定位进入系统的库存。 也可用于定义到暂存库位或最终货架门装运库位的放置。
    - **领料** – 此库位指令将尝试找到从中实际预留库存（即创建工作）的最理想库位。 即使工作未完成，也可以完成领料（即可关闭领料工作行）。 用户可以完成实际领料。 在系统中，该操作是一个选择步骤。 然后，用户可通过移动设备取消，以后再完成工作。 但是，如果最终放置已完成，将首先关闭此工作标题。

    > [!IMPORTANT]
    > **工作类型** 字段中的其他值与库位指令无关。 它们之所以出现，仅是因为未对字段进行筛选以匹配选定的工作订单类型。

- **站点** – 此字段是必填字段，因为库位指令必须能够确定站点和站点的有效仓库。
- **仓库** – 此字段是必填字段，因为库位指令必须能够确定站点和站点的有效仓库。
- **指令代码** – 选择要与工作模板或补货模板关联的指令代码。 在 **指令代码** 页面上，您可以创建可用于将工作模板或补货模板连接到库位指令的新代码。 指令代码还可用于建立任何工作模板行与库位指令（如货架门或暂存库位）之间的链接。

    > [!TIP]
    > 如果设置了指令代码，在必须生成工作时，系统将不会按序列号搜索库位指令。 相反，它将按指令代码进行搜索。 这样，您可以更具体地了解用于工作模板中特定步骤（例如暂存物料的步骤）的库位指令。

- **多个 SKU** – 将此选项设置为 *是* 以在一个库位上启用多个要使用的库存单位 (SKU)。 例如，必须为货架门库位启用多个 SKU。 如果启用多个 SKU，将按预期在工作中指定放置库位。 但是，放置库位将只能处理多物料放置（如果工作包括必须领料和放置的不同 SKU）。 它将无法处理单个 SKU 放置。 如果将此选项设置为 *否*，则仅在您的放置只有一种 SKU 时才指定放置库位。

    > [!IMPORTANT]
    > 为了能够同时进行多物料放置和单个 SKU 放置，您必须指定两个具有相同结构和设置的行，但必须将一行的 **多个 SKU** 选项设置为 *是*，将另一行的此选项设置为 *否*。 因此，对于放置工序，您必须具有两个相同的库位指令，即使无法在工作 ID 上区分单个 SKU 和多个 SKU。 通常，如果您未同时设置这两个库位指令，应用的库位指令将产生意外的业务流程库位。 如果您需要处理包括多个 SKU 的订单，必须使用 **工作类型** 为 *领料* 的库位指令的类似设置。

    针对处理多个物料编号的工作行使用 **多个 SKU** 选项。 （物料编号在工作详细信息中将为空白，并在仓库管理移动应用中的处理页面上显示为 **多个**。）

    在典型的示例场景中，设置工作模板，以便它具有多个领料/放置对。 在这种情况下，您可能需要搜索特定的暂存库位以用于 **工作类型** 为 *放置* 的行。

    > [!NOTE]
    > 如果 **多个 SKU** 选项设置为 *是*，您无法在操作窗格上选择 **编辑查询**，因为当有多个物料时，查询无法在物料级别进行评估。 若要确保选择所需的库位指令，请使用 **指令代码** 字段以指导选择与放置行（该指令代码在工作模板中分配）相关的库位指令。

    除非您始终使用单个物料或混合物料工序，否则为 *放置* 工作类型定义两个库位指令很重要：一个的 **多个 SKU** 选项设置为 *是*，另一个的此选项设置为 *否*。

- **适用处置代码** – 指定库位指令的处置代码是否必须与接收物料时应用的处置代码匹配，或者是否可以根据任何处置代码选择库位指令。 如果选择 *完全匹配*，并且 **处置代码** 字段为空，则仅为此库位指令考虑空白处置代码。

    > [!NOTE]
    > 该字段仅适用于允许补货的选定工作订单类型。 有关完整列表，请参阅本主题前面的[特定于工作订单类型的字段](#fields-specific-types)部分。

- **查找依据** – 指定储存数量在牌照上是否应该为全部数量，以及它是否应该采用逐个物料形式。 使用此字段帮助确保牌照上的所有内容都放置在一个库位中，并且系统不建议您将内容拆分为多个库位以用于 **ASN**（牌照接收）、**混合牌照** 接收和 **群集** 接收流程。 （**群集** 接收流程要求打开 *群集储存功能*。）库位指令查询、行和库位指令操作的行为将有所不同，具体取决于您选择的值。 仅在 **查找依据** 设置为 *物料* 时才使用 **行** 快速选项卡。

    > [!NOTE]
    > 该字段仅适用于允许补货的选定工作订单类型。 有关完整列表，请参阅[特定于工作订单类型的字段](#fields-specific-types)部分。

- **处置代码** – 该字段用于工作订单类型为 *采购订单*、*成品储存* 或 *退货单*，以及工作类型为 *放置* 的库位指令。 使用它指导流以使用特定库位指令，具体取决于工作人员在仓库管理移动应用中选择的处置代码。 例如，您可以将退回的货物直接送至检查库位，然后再退回到存货。 处置代码可以链接到库存状态。 这样，它可以用于更改库存状态作为接收流程的一部分。 例如，您有库存状态设置为 *QA* 的处置代码 *QA*。 然后，您可以使用单独的库位指令将库存移至检验库位。

    > [!NOTE]
    > 该字段仅适用于允许补货的选定工作订单类型。 有关完整列表，请参阅[特定于工作订单类型的字段](#fields-specific-types)部分。

## <a name="lines-fasttab"></a>行快速选项卡

使用 **行** 快速选项卡建立用于应用在 **库位指令操作** 快速选项卡上指定的相关操作的条件。 对于每个行，您可以指定操作应该应用的最小数量和最大数量。 您还可以指定操作应该应用于特定的库存单位。

- **序列号** – 输入应针对所选工作类型处理每个库位指令行的顺序。 您可以使用工具栏上的 **上移** 和 **下移** 按钮根据需要更改顺序。
- **起始数量** – 指定该行适用的数量范围的起点。 以在 **单位** 字段中选择的度量单位指定数量。
- **目标数量** – 指定该行适用的数量范围的结束。 以在 **单位** 字段中选择的度量单位指定数量。
- **单位** – 选择物料的度量单位。 您可以指定该指令应该用于的最小数量和最大数量，并且，您可以指定该指令应该针对特定库存单位。 **单位** 字段 *仅* 用于数量评估。 若要确定库位指令行是否完全适用，系统将使用在该行上指定的单位中的数量。 只要它达到库位指令行，系统都会尝试将需求单位转换为在行上指定的单位。 如果不存在度量单位转换，系统将移到下一行。
- **查找数量** – 仅在尝试在仓库中放置或查找物料期间才使用此字段。 （因此，它仅在将 **工作类型** 字段设置为 *放置* 时才适用）。 选择以下值之一以指定用于评估数量是否在 **起始数量** 和 **目标数量** 范围内的数量：

    - **牌照数量** – 使用收到的牌照数量。
    - **统一的数量** – 使用交易期间使用的数量。 例如，您在仓库中收到的数量为 1,000，并将其分成 10 个牌照，每个牌照的数量为 100。 在这种情况下，您可以使用 1,000 个数量的物料，而不是 100 个数量的牌照。
    - **剩余数量** – 使用仍必须在正在处理的采购订单行上接收的数量。
    - **预计数量** – 使用采购订单行的总数量，无论已收到多少。

- **按单位施加限制** – 通过此复选框，您可以使库位指令行特定于一个或多个度量单位。 选中它以限制视为库位指令行的有效选择条件的度量单位。 此功能仅适用于 **工作类型** 字段设置为 *领料* 的库位指令。

    例如，当您预留数量时，您只想预留来自一组特定库位的托盘。 在这种情况下，这些行会将顺序限制到托盘，这样就不会为库位指令选择少于托盘的任何数量。

    请注意，**按单位施加限制** 复选框不会控制工作行上应用的一个或多个单位。 单位限制仅应用于通过单位序列组提供的单位。 例如，物料与同时包含 *托盘* 单位和 *件* 单位的单位序列组相关联。 度量单位已定义：1 托盘 = 100 件，库位指令仅对托盘使用 **按单位施加限制** 功能。 此外，定义了一个工作模板，限制工作标题创建为 50 件。 在这种情况下，将创建 50 件的工作行。 若要指定用于限制的度量单位，请按照下列步骤操作：

    1. 在 **行** 快速选项卡上，在工具栏上选择 **按单位施加限制**。 （仅在选中行上的 **按单位施加限制** 复选框并选择 **保存** 后，此按钮才可用。）
    1. 在 **按单位施加限制** 页面上，在 **单位** 字段中，选择针对领料和放置流程施加限制所依据的度量单位。

- **进位到单位** – 此字段与 **按单位施加限制** 复选框一起使用。 例如，如果在库位指令行上选择 **按单位施加限制** 和 **进位到单位**，通过指令为原材料领料生成的工作应进位到一个处理单位（在 **按单位施加限制** 中指定）的倍数。

    > [!NOTE]
    > 此 **进位到单位** 设置仅适用于 *原材料领料* 工作订单类型，并且仅适用于 **工作类型** 字段设置为 *领料* 的库位指令。

- **查找包装数量** – 如果您在销售订单、转移单或生产订单上指定包装数量，您可以使用此复选框对系统施加限制，以便它只能选择至少具有该包装数量的库位。

    > [!NOTE]
    > 此功能仅适用于 *领料* 类型的库位指令。

- **允许拆分** – 指定库位指令是否可以拆分在多个仓库库位中接收或预留的数量，或者是否必须将整个数量都放到一个库位中或在一个库位中预留才能创建工作。
- **即时补货模板** – 使用此字段创建与补货模板之间的连接，以在未分配物料时立即开始补货。 如果将此字段保留为空，则处理完位置指令的所有行之前，不开始执行物料补货。

    > [!NOTE]
    > 该字段仅适用于允许补货的选定工作订单类型。 有关完整列表，请参阅[特定于工作订单类型的字段](#fields-specific-types)部分。

## <a name="location-directive-actions-fasttab"></a>库位指令操作快速选项卡

您可以为每个行定义多个库位指令操作。 同样，序列号用于确定在其中评估操作的订单。 在此级别，您可以设置查询以定义如何找到仓库中的最佳库位。 您还可以使用预定义的 **策略** 值查找最佳库位。

- **序列号** – 此字段显示针对所选工作类型处理操作的顺序。 您可以使用工具栏上的 **上移** 和 **下移** 按钮更改顺序。
- **名称** – 输入库位指令操作的名称。 请提供相对具体的名称，以便说明执行什么操作。
- **固定库位使用情况** – 指定库位指令应考虑的库位。 选择以下值之一：

    - **固定位置和非固定位置** – 位置指令将考虑所有位置。
    - **仅产品的固定位置** – 位置指令将仅考虑产品的固定位置。
    - **仅产品变型的固定位置** – 位置指令将仅考虑产品变型的固定位置。

- **允许负库存** – 选择此复选框以在库位指令中允许指定仓库库位的库存为负。
- **批处理已启用** – 选择此复选框以针对启用了批处理的物料使用批处理策略。 请务必针对以下流程选中此复选框：使用库位指令查找要从中领取批处理号跟踪的物料的库位。 这样，将包括搜索保留批处理号跟踪的物料的库位。 如果选中此复选框，并且 **策略** 字段设置为 *无*，系统将移至下一个操作行。
- **策略** – 为了更方便、更快地定义与每个库位指令行关联的操作，您可以选择以下预定义策略之一：

    - **无** – 不使用任何策略。
    - **匹配包装数量** – 此策略验证领料位置是否具有指定的包装数量。 此策略仅在将 **工作类型** 字段设置为 *领料* 时有效。
    - **合并** – 在已有相似物料时，此策略合并特定位置的物料。 此策略仅在将 **工作类型** 字段设置为 *放置* 时有效。 典型的放置设置尝试在第一个操作行上合并，然后在第二个行上尝试不合并的放置。 合并货物可以提高后续领料的效率。
    - **FEFO 批次预留** – 此策略使用先到期先出 (FEFO) 批次预留。 在使用批次到期日期找到库存并为批次预留分配库存时使用此策略。 您只能将此策略用于支持批处理的物料。 它仅在将 **工作类型** 字段设置为 *领料* 时有效。
    - **进位到全部牌照和 FEFO 批次** – 此策略结合了 *FEFO 批次预留* 和 *进位到全部牌照* 策略的元素。 它仅对启用了批处理的物料和工作类型为 *领料* 的库位指令有效。 该行必须启用了批处理才能使用 *FEFO 批次预留* 策略，*进位到全部牌照* 策略只能用于补货。 如果将此策略与库位库存限制一起配置，则可能导致所选的储存库位过载，并且忽略库存限制。
    - **进位到全部牌照** – 此策略用于进位库存数量，以使其匹配分配给必须领取的物料的牌照数量。 此策略只能用于 *领料* 类型的补货库位指令。 如果将此策略与库位库存限制一起配置，则可能导致所选的储存库位过载，并且忽略库存限制。
    - **牌照引导** – 当您将订单发放到仓库以创建领料和放置工作时，使用此策略。 您可以针对多个牌照使用此方法。 此策略将尝试针对具有与转移单行关联的所请求牌照的库位预留和创建领料工作。 但是，如果无法完成这些操作，但您仍想创建领料工作，则应回退到库位指令操作的另一个策略。 根据您的业务流程要求，您可能还需要在仓库的另一个区域搜索库存。
    - **没有传入工作的空库位** – 使用此策略查找空库位。 如果某个位置没有实际库存和预期的传入工作，该位置将被视为空位置。 此策略只能用于工作类型为 *上架* 的位置指令。
    - **库位帐龄 FIFO** – 使用先进先出 (FIFO) 策略根据库存进入仓库的日期来装运批处理跟踪的物料和非批处理跟踪的物料。 此功能对于无法使用到期日期进行排序的非批处理跟踪库存特别有用。 FIFO 策略查找包含最早帐龄日期的库位，然后根据该帐龄日期分配领料。
    - **库位帐龄 LIFO** – 使用后进后出 (LIFO) 策略根据库存进入仓库的日期来装运批处理跟踪的物料和非批处理跟踪的物料。 此功能对于无法使用到期日期进行排序的非批处理跟踪库存特别有用。 LIFO 策略查找包含最新帐龄日期的库位，然后根据该帐龄日期分配领料。

## <a name="example-using-location-directives"></a>示例：使用库位指令

对于本示例，请注意采购订单流程，在此流程中库位指令必须为已在收货台登记的库存物料在仓库内查找可用容量。 首先，需要通过与现有库存量合并来在仓库内查找可用容量。 如果合并是不可能的，然后需要查找空库位。

对于此情况，必须定义两个库位指令操作。 序列中的第一个操作必须使用 *合并* 策略，第二个应使用 *没有传入工作的空库位* 策略。 除非定义第三个操作来处理溢出情况，否则在仓库中没有更多容量时，有两个可能的结果：即使未定义库位也可以创建工作，或者创建工作流程可能失败。 结果将由 **库位指令失败** 页面上的设置确定，您可以在此页面中选择是否为每个工作订单类型选择 **在库位指令失败时停止工作** 选项。

## <a name="next-step"></a>后续步骤

在创建位置指令后，您可使各指令代码与工作创建的工作模板代码关联。 有关详细信息，请参阅[使用工作模板和位置指令控制仓库工作](./control-warehouse-location-directives.md)。

## <a name="additional-resources"></a>其他资源

- 视频：[仓库管理配置深入探索](https://community.dynamics.com/365/b/techtalks/posts/warehouse-management-configuration-deep-dive-october-14-2020)
- 帮助主题：[使用工作模板和库位指令控制仓库的工作](control-warehouse-location-directives.md)


[!INCLUDE[footer-include](../../includes/footer-banner.md)]