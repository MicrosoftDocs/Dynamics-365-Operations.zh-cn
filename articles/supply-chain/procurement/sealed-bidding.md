---
title: 询价的密封投标
description: 本主题介绍如何设置密封投标，以在采购人员解封密封投标之前对供应商投标回复保密。
author: Henrikan
ms.date: 08/02/2021
ms.topic: article
ms.search.form: ''
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: henrikan
ms.search.validFrom: 2021-08-02
ms.dyn365.ops.version: 10.0.21
ms.openlocfilehash: 96549b6053ba75f2d5b9a85bcd5b7feb006f0f1b
ms.sourcegitcommit: 3b87f042a7e97f72b5aa73bef186c5426b937fec
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 09/29/2021
ms.locfileid: "7578072"
---
# <a name="sealed-bidding-for-rfqs"></a>询价的密封投标

[!include [banner](../includes/banner.md)]

密封投标可以在采购人员解封密封投标之前对供应商投标回复保密。 与询价 (RFQ) 相关的所有出价都可以在出价到期时首先解封。 在解封投标之前，只有具有专门用户角色且代表供应商的用户才能访问它。

> [!IMPORTANT]
> 修改或扩展窗体，或者创建新窗体或业务逻辑可能会破坏 Microsoft 为密封出价提供的保护。 您将承担使用任何修改、扩展、新窗体或业务逻辑的风险，或因此类修改、扩展、新窗体或业务逻辑而无法使用密封出价功能的风险。  对于因窗体的任何修改或扩展，或者您创建的或第三方为您创建的任何新窗体或业务逻辑，造成的任何损害，Microsoft 概不负责。 Microsoft 不为您或代表您的任何第三方进行的任何修改、扩展、创建的新窗体或业务逻辑提供技术或其他支持。 您完全负责遵守有关密封出价的所有适用法律或法规。

## <a name="how-bids-are-kept-secure"></a>如何保证投标的安全

密封投标采用非对称加密对投标加密密钥 (KEK) 进行加密，采用对称加密对实际投标进行加密。 此系统与 Microsoft Azure 密钥保管库集成，以生成和管理用于对密封投标进行加密的加密密钥。 每个投标都有其自己的加密密钥。 此加密在运行 Dynamics 365 Supply Chain Management 的组织负责的密钥保管库中保持安全。 每当需要加密和解密时，系统都会按需访问密钥保管库。

## <a name="setup-and-configuration"></a>设置和配置

本节描述在发出需要密封投标的询价之前必须具备的先决条件。

### <a name="step-1-set-up-user-access-to-sealed-bidding"></a>第 1 步：设置用户对密封投标的访问权限

当您使用密封投标时，只有被设置为供应商联系人的用户才能查看、编辑和提交该供应商的投标，直到投标期到期。 这些用户必须具有 **供应商（外部）** 角色，并且必须将它们设置为供应商帐户的联系人。 联系人还必须具有执行供应商协作的权限，如[设置和维护供应商协作](set-up-maintain-vendor-collaboration.md)中所述。

由于具有相应权限且已设置为供应商联系人的用户可以访问供应商的密封投标，因此必须跟踪这些用户的身份。 设置用户和安全角色的系统管理员负责将密封投标的访问权限只提供给真正被允许查看密封投标的用户。

### <a name="step-2-enable-the-sealed-bidding-feature"></a>第 2 步：启用密封投标功能

在开始设置或使用此功能之前，必须确保它在系统中可用。 管理员可以使用 **[功能管理](../../fin-ops-core/fin-ops/get-started/feature-management/feature-management-overview.md)** 工作区检查此功能的状态和开启此功能。 在 **功能管理** 工作区中，此功能按照下面的方式列出：

- **模块**：*采购任务*
- **功能名称**：*询价的密封投标*

### <a name="step-3-set-up-azure-key-vault"></a>第 3 步：设置 Azure 密钥保管库

Supply Chain Management 使用加密密钥保护所有密封投标并将其保密，直至适当时间。 它利用密钥保管库的功能生成和管理必需的密钥。 因此，您必须设置从 Supply Chain Management 到密钥保管库的连接才能启用系统。

> [!IMPORTANT]
> 您用于已密封投标的密钥保管库必须满足以下要求：
>
> - 如果您使用沙箱进行开发和测试，那么您必须有一个用于沙箱的专用密钥保管库和一个用于生产的单独密钥保管库。
> - 必须在由您的组织负责的 Azure 订阅（而不是您正在运行 Supply Chain Management 所用的订阅）中创建每个密钥保管库。
> - 每个密钥保管库必须仅用于密封投标。 您不得将密封投标密钥保管库用于任何其他目的。

每个投标都会检索其自己的密钥。 每次用户查看、更新或解封投标时都会使用此密钥。

当供应商在供应商协作界面中选择 **投标** 时，密钥保管库将生成用于检索机密的密钥。 然后，该密钥会在采购经理在 Supply Chain Management 的 **采购参数** 页上设置的固定时间之后过期。 密钥过期后，任何人都无法查看、编辑或解封投标。 因此，请务必配置密钥到期时间，以便有足够的时间完成投标流程。

在接下来的三个步骤中，您将设置与密钥保管库的连接。 首先，您将设置要用于密封投标的密钥保管库。 接下来，您将配置 Supply Chain Management 以与密钥保管库进行通信。 最后，您将为密钥设置到期时间。

### <a name="step-4-set-up-a-key-vault-to-use-with-sealed-bidding"></a>第 4 步：设置要用于密封投标的密钥保管库

要设置您的密钥保管库，请按照以下步骤操作： 步骤顺序非常重要。

1. 如果尚未设置与运行 Supply Chain Management 的所用订阅不同的 Azure 订阅，请设置它。
1. 在单独的 Azure 存储中设置密钥保管库。 有关详细信息，请参阅[维护 Azure 密钥保管库存储](https://support.microsoft.com/help/4040294/maintaining-azure-key-vault-storage)。
1. 设置 Supply Chain Management 应用以充当密钥保管库的客户端。 有关详细信息，请参阅[设置 Azure 密钥保管库客户端](https://support.microsoft.com/help/4040305/setting-up-azure-key-vault-client)。

### <a name="step-5-configure-key-vault-parameters-in-supply-chain-management"></a>第 5 步：在 Supply Chain Management 中配置密钥保管库参数

要配置 Supply Chain Management 以在密封投标期间与密钥保管库通信，请按照以下步骤操作。

1. 登录到 Supply Chain Management，然后转到 **系统管理 \> 设置 \> 密钥保管库参数**。
1. 选择 **新建** 以创建记录，并为其设置以下字段：

    - **名称** - 输入名称。
    - **描述** - 输入描述。
    - **密钥保管库 URL** - 输入密钥保管库的默认 URL。
    - **密钥保管库客户端** - 输入与身份验证密钥保管库关联的 Active Directory 应用程序的交互式客户端 ID。
    - **密钥保管库密钥** - 输入证书的密钥引用。
    - **针对密封投标已启用** - 将此选项设置为 *是*。

![密钥保管库参数页](media/sealed-bidding-key-vault-param.png "密钥保管库参数页")

> [!NOTE]
> 一次只能为密封投标启用一个密钥保管库配置。 在禁用现有密钥保管库配置之前，您必须确保使用它的所有密封投标都已解封。 检查 *已密封* 类型的每个询价案例，并确保其所有回复均已解封。

### <a name="step-6-set-the-key-expiration-time"></a>第 6 步：设置密钥到期时间

若要设置应用于为每个新投标生成的密钥的到期时间，请按照以下步骤操作。

1. 转至 **采购参数 \> 设置 \> 采购参数**。
1. 在 **询价** 选项卡上的 **偏置天数** 字段中，输入询价期间应持续的天数。 创建询价后，您在此处输入的天数将添加到系统日期以定义询价的默认到期日期。
1. 在 **加密密钥到期日偏置** 字段中，输入每个加密密钥在发出后应保持有效的天数。 加密密钥过期后，任何人都无法查看、编辑或解封使用此密钥的投标。

> [!TIP]
> **加密密钥到期日偏置** 字段的值不应小于 **偏置天数** 字段的值。

### <a name="step-7-set-the-default-bid-type"></a><a name="set-default-bid-type"></a>第 7 步：设置默认投标类型

每个询价案例都有投标类型。 该投标类型定义询价案例是提供公开投标还是密封投标。

#### <a name="rfq-cases-that-dont-have-a-solicitation-type"></a>没有申请类型的询价案例

若要设置分配给在创建申请类型时未分配的新询价案例的默认投标类型，请按照以下步骤操作。

1. 转至 **采购参数 \> 设置 \> 采购参数**。
1. 在 **询价** 选项卡上，将 **投标类型** 字段设置为 *密封*。

#### <a name="rfq-cases-that-have-a-solicitation-type"></a>具有申请类型的询价案例

若要设置分配给在创建申请类型时分配的新询价案例的默认投标类型，请按照以下步骤操作。

1. 转到 **采购 \> 设置 \> 询价 \> 申请类型**。
1. 创建新申请类型，或选择要在其中使用 *密封* 投标类型的现有申请类型。
1. 将 **投标类型** 字段设置为 *密封*。
1. 针对您要实现密封投标的每个附加申请类型重复这些步骤。

> [!TIP]
> 创建新询价时，不必分配申请类型。 如果分配了申请类型，则询价的默认投标类型可以检索它。 否则，可以使用在采购参数中定义的默认申请类型。

## <a name="the-sealed-bidding-process"></a>密封出价流程

密封投标遵循的流程与[询价 (RFQ) 概览](request-quotations.md)中描述的流程几乎相同。 主要区别在于，在解封投标之前，投标数据及其附件将保持加密状态。

> [!IMPORTANT]
> [调查表](/dynamicsax-2012/appuser-itpro/view-and-respond-to-questionnaires)未加密，不应用于收集敏感信息

下面是流程的概述：

1. 您创建询价并将其发送到一个或多个供应商。
1. 供应商通过提交密封投标来做出响应。
1. 您将在投标条目到期时间后解封投标。
1. 投标变得可见，您可以对其进行评估和比较。
1. 接受投标后，您将生成采购订单、生成采购协议或更新采购申请。

### <a name="create-an-rfq-case-that-uses-sealed-bidding"></a>创建使用密封投标的询价案例

为密封投标创建询价案例的流程与非密封投标的相应流程几乎相同。 有关如何创建这两种类型的询价案例的信息，请参阅[创建询价](tasks/create-request-quotation.md)。 此节突出显示当您为密封投标创建询价时的一些重要注意事项。

密封投标的询价案例的 **投标类型** 值必须为 *密封*。 将此值分配给询价案例的方法有三种：

- 创建后直接在询价案例上设置该值。
- 将密封投标定义为采购参数中所有询价案例的默认投标类型。 （请参阅本主题中前面的[设置默认投标类型](#set-default-bid-type)部分。）
- 创建新询价案例时，请选择为密封投标设置的申请类型。 （请参阅[设置默认出价类型](#set-default-bid-type)部分。）

对于密封投标，询价案例的 **到期日期和时间** 值将确定可以解封已提交投标的时间。 每行上的 **到期日期和时间** 值将与标题上的值匹配。

发送询价案例后，您无法更改投标类型。

### <a name="vendors-respond-to-an-rfq"></a>供应商响应询价

响应密封投标的供应商将使用他们响应公开投标所使用的相同过程，如[在供应商投标工作区中使用询价](vendor-collaboration-work-customers-dynamics-365-operations.md#working-with-rfqs-in-the-vendor-bidding-workspace)中所述。 有关如何同时处理公开投标和密封投标的详细说明，请参阅[输入并比较询价投标和决标合同](tasks/enter-compare-rfq-bids-award-contracts.md)。 处理密封投标和处理公开投标的唯一区别在于，在投标期间到期之前，采购专业人员无法打开供应商的密封投标。 只有供应商的联系人才能打开该供应商的密封投标。

> [!IMPORTANT]
> 对于密封投标，供应商只能上传 PDF 格式的附件。 将不接受其他格式。

注册的供应商用户对密封投标询价选择 **投标** 后，他们可以输入其投标数据，并且数据将保持安全。 供应商可以在准备投标时保存其工作，并根据需要经常返回，然后在准备就绪后提交。 供应商也可以在提交投标后查看其投标。 如果供应商在提交投标后必须更改其投标，则他们可以在投标期到期之前随时撤回、更新并重新提交投标。

以下条件在密封投标期间适用：

- 在密封投标期间，系统将创建 *询价* 日记帐。
- 当供应商提交投标时，将创建没有行但有密封价格的询价日记帐。
- 解封案例后，将创建具有价格和金额的询价日记帐。 您可以通过在 **所有询价** 页面上选择 **询价日记帐** 来访问此日记帐。
- 系统会存储用户对密封投标执行的每个操作的日志。 这些操作包括查看、编辑和保存投标。 供应商和有权访问投标的采购专业人员都可以看到此日志。
- 随着投标的进行，采购专业人员可以查看其状态。 状态将为 *供应商正在更新* 或 *供应商已提交*。
- 在解封投标之前，密封投标中的行状态仍然为 *已发送*。
- 如果供应商选择拒绝投标，则投标的 **回复进度** 状态为 *被供应商拒绝*。 采购人员将可以看到此状态。
- 调查表中的回答 **未** 存储在数据库内的加密窗体中。 因此，它们未密封。 但是，在解封案例之前，它们不会在询价用户界面中显示。

### <a name="all-sealed-bid-activities-are-logged"></a>所有密封的投标活动均已记录

详细日志记录了所有用户活动和投标操作。 活动日志使组织能够确定谁在其生命周期内更新了投标，以及更新的内容。 它还使组织能够确认只有经过授权的人才能访问密封投标。 活动日志在每个投标的 **活动** 页面上都可用。

### <a name="review-rfq-activity"></a>查看询价活动

每次投标互动都被记录下来，并且可以在 **活动** 页面上查看。 下图显示了一个示例。

![“活动”页面的示例](media/sealed-bidding-rfq-activity.png "“活动”页面的示例")

供应商可以通过在 **询价密封投标** 页上选择 **活动** 来访问 **活动** 页面。 采购工作人员可以通过在 **询价** 页面上选择 **活动** 来访问它。 活动日志为供应商和已访问投标的采购人员提供完全可见性。 因此，它可以显示任何未经授权的访问。

### <a name="unseal-sealed-bids"></a>解封密封投标

为密封投标询价案例配置的 **到期日期和时间** 值已过后，**解封** 按钮将变得可用。 选择 **解封** 以解封所选询价案例的所有投标。 然后，所有投标数据和附件都会变得可见，以便可以管理对案例的回复。 此外，将创建包含已提交的投标数据的日记帐。

解封事件会被记录下来，并且可以在 **活动** 页面上查看。

### <a name="process-accepted-bids"></a>处理已接受的投标

比较和审核以前密封的投标的流程与公开投标的相应流程相同。 有关如何评分、比较、拒绝和接受解封投标的信息，请参阅[输入并比较询价投标和决标合同](tasks/enter-compare-rfq-bids-award-contracts.md)。

## <a name="the-rfq-activity-log-can-never-be-deleted"></a>无法删除询价活动日志

任何人都无法编辑或删除询价活动日志，甚至连管理员和 Microsoft 支持人员也不能。 此限制有助于确保密封投标流程的公平性。 它还有助于确保维护准确的审核线索。
