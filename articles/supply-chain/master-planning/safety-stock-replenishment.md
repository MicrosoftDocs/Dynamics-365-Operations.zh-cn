---
title: 物料的安全存货履行
description: 此主题讨论安全存货履行以及如何设置物料的安全存货数量。
author: roxanadiaconu
manager: AnnBe
ms.date: 11/27/2017
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: ReqSafetyKey, ReqItemTableSetup, ReqItemJournalName, ReqItemTable, EcoResProductDetailsExtended
audience: Application User, IT Pro
ms.reviewer: josaw
ms.search.scope: Core, Operations
ms.custom: ''
ms.assetid: ''
ms.search.region: global
ms.search.industry: ''
ms.author: roxanad
ms.dyn365.ops.version: 7.2999999999999998
ms.search.validFrom: 2017-12-31
ms.openlocfilehash: 147cc3984e6dc641209beefdb3545615b42767a2
ms.sourcegitcommit: 9d4c7edd0ae2053c37c7d81cdd180b16bf3a9d3b
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/15/2019
ms.locfileid: "1558588"
---
# <a name="safety-stock-fulfillment-for-items"></a>物料的安全存货履行

[!include [banner](../includes/banner.md)]

安全存货是指为了降低物料库存不足的风险，在库存中应该持有该物料的额外数量。 安全存货用于当接到销售订单且供应商无法交付满足客户要求装运日期的额外物料时的缓冲存货。 当使用安全存货履行销售订单时，安全存货将减少。 您可以使用主计划自动使库存恢复到安全水平。    

## <a name="set-up-safety-stock-levels-for-items"></a>设置物料的安全存货水平

安全存货作为物料覆盖范围的一部分在**物料覆盖范围**页的**已发放产品** > **计划** > **覆盖范围**下进行设置。

在**最小值**字段中，输入您要对该物料维持的安全存货水平。 该值以库存单位表示。 如果将此字段保留为空，默认值将为零。 在**覆盖范围代码**列表中选择**期间**、**需求**或**最小值/最大值**后，此字段可用。 存货水平限制适用于可用库存，也就是说，在实际数量低于指定的最低水平时，预留和标记可以触发安全存货补货。

> [!NOTE]
> 您必须首先定义所有其他计划的覆盖范围维度，然后才能定义**最小值**字段。 这样可以避免在主计划期间使用无效的记录。 例如，如果某一维度组用其他计划的覆盖范围维度扩展，但没有为此维度定义最小和最大库存数量，则可能会发生使用无效记录的情况。

您可以使用最小键处理需求的季节性变化。 例如，在淡季时可降低物料的最低库存水平，并在其他月份逐渐提高该物料的最低库存水平。 转到**主计划** > **设置** > **覆盖范围** > **最小/最大键**可以创建最小键。 在**物料覆盖范围**页的**最小键**字段中可以指定最小键，以便按季节调整安全存货水平。 

## <a name="example-minimum-key"></a>示例：最小键
如果您要设置在春季和夏季期间增加季节性需求的最小键，请转到**主计划** > **设置** > **覆盖范围** > **最小/最大键**，并执行以下步骤。

1. 创建 12 行，然后在**更改**字段中按从 1 到 12 的顺序给这些行编号。
2. 在**单位**字段中，选择**月**。
3. 在**系数**字段中，输入以下表中描述的值。

|线形|输入此值|结果|
|---|---|---|
|1-3 次|1|最小库存量基于**物料覆盖范围**页上 1 月到 3 月的设置。|
|4-5|2|为 4 月到 5 月，将最小库存量乘以系数 2。|
|6-8|2.5|为 6 月到 8 月，将最小库存量乘以系数 2.5。|
|9-12|1|为 9 月到 12 月，最小库存量还原为**物料覆盖范围**页上的设置。|

如果覆盖范围代码是**最小值/最大值**，您还可以指定要为物料维持的**最大**库存数量。 该值也以库存单位表示。 如果计划的可用库存低于最小数量，主计划将生成一个计划订单，以履行所有未满足的需求并将可用库存提升到指定的最大数量。 正如您设置**最小值**一样，必须首先定义所有其他计划的覆盖范围维度，然后才能定义**最大值**字段。

## <a name="example-minmax-coverage-code"></a>示例：最小值/最大值覆盖范围代码
最小数量是 10，最大数量是 15。 当前的现有库存量为 4。 这使得最小数量需求为 6。 不过，由于最大数量是 15，所以主计划生成的计划订单中的数量将为 11。

对于遵循季节需求的物料，可能需要维持不同的最大值水平。 为此，需转到**主计划** > **设置** > **覆盖范围** > **最小/最大键**，定义**最大键**。 填写**物料覆盖范围**页上的**最大键**字段。 您可以查看有关安全存货水平的信息，该水平通过**物料覆盖范围**页上的**最小值/最大值**选项卡上的最小键进行定义。 您需确保在特定期间的最小值和最大值保持同步。

## <a name="safety-stock-fulfillment"></a>安全存货履行 

**最小完成量**参数用于选择库存水平必须满足您在**最小值**字段指定的数量的日期或期间。 在**覆盖范围代码**列表中选择**期间**、**需求**或**最小值/最大值**后，此字段可用。

如果使用**最小键**，则选择**最小期间**复选框以完成在最小键中设置的所有期间的最低库存水平。 如果清除该复选框，则仅完成当前期间的最小库存量。

以下方案演示此参数如何工作以及它的不同值之间的区别。

> [!NOTE]
> 在此主题中的所有图示中，x 轴表示库存，y 轴表示天数，条形表示库存水平，箭头表示交易记录，例如销售订单行、采购订单行或计划订单。

[![安全存货履行的常见方案](./media/Scenario1.png)](./media/Scenario1.png)**最小完成量**参数可具有以下值：
### <a name="todays-date"></a>今天的日期 
运行主计划时满足当天的指定最小数量。 系统尝试尽快履行安全存货限制，即使因为提前期的原因而不现实。 
[![今日日期的需求](./media/TodayReq.png)](./media/TodayReq.png)针对今天的日期创建计划订单 P1，以便将该日期的可用库存提升到安全存货水平以上。 销售订单行 S1 至 S3 继续降低库存水平。 主计划生成计划订单 P2 至 P4，以便在每个销售订单需求后将库存水平恢复至安全限制。
使用**需求**覆盖范围代码时，创建多个计划订单。 针对频繁需求的物料和材料使用**期间**或**最小值/最大值**覆盖范围来绑定补货始终是一个不错的方法。 下图显示覆盖范围代码**期间**的一个示例。
[![期间。今日日期](./media/TodayPeriod.png)](./media/TodayPeriod.png)下图显示覆盖范围代码**最小值/最大值**的一个示例。
[![MinMax. 今日日期](./media/TodayMinMax.png)](./media/TodayMinMax.png)
### <a name="todays-date--procurement-time"></a>今日日期 + 采购时间 
在运行主计划的日期满足指定的最小数量，以及采购或生产提前期。 此时间包括任何安全宽限期。 如果物料实行贸易协议，并且在**主计划参数**页上选择了**查找贸易协议**复选框，将不考虑贸易协议中的交货提前期。 而考虑来自物料覆盖范围设置或物料的提前期。
该履行模式将创建具有更短延迟和更少计划订单的计划，不考虑在物料上设置的覆盖范围组。 下图显示覆盖范围代码为**需求**或**期间**时的计划结果。  
[![需求。期间。今日日期和提前期](./media/TodayPLTReq.png)](./media/TodayPLTReq.png)下图显示覆盖范围代码为**最小值/最大值**时的计划结果。  
[![MinMax. 今日日期和提前期](./media/TodayPLTMinMax.png)](./media/TodayPLTMinMax.png)
### <a name="first-issue"></a>第一次发货 
在可用库存低于最低水平的当天满足指定的最小数量，如下图所示。 在运行主计划的当天，即使可用库存低于最低水平，在下一次需求进入前，**第一次发货**也不会尝试覆盖它。
下图显示覆盖范围代码**需求**的一个示例。
[![使用**需求**覆盖代码和**第一次发货**履行计划物料](./media/FirstIssueReq.png)](./media/FirstIssueReq.png)下图显示覆盖范围代码**期间**的一个示例。
[![使用**期间**覆盖代码和**第一次发货**履行计划物料](./media/FirstIssuePeriod.png)](./media/FirstIssuePeriod.png)下图显示覆盖范围代码**最小值/最大值**的一个示例。
[![使用 **MinMax** 覆盖代码和**第一次发货**履行计划物料](./media/FirstIssueMinMax.png)](./media/FirstIssueMinMax.png)在运行主计划的当天，如果可用库存已经低于安全存货限制，**今日日期**和**今日日期 + 采购时间**将立即触发补货。 **第一次发货**将等待，直到出现另一个针对该物料的发货交易记录，例如销售订单和物料清单行需求，之后它将在该交易记录的当天触发补货。 在运行主计划的当天，如果可用库存不低于安全存货限制，**今日日期**和**第一次发货**将提供完全相同的结果，如下图中所示。 

[![NotUnderLimit](./media/ReqFirstIssue.png)](./media/ReqFirstIssue.png) 在运行主计划的当天，如果可用库存不低于安全存货限制，**今日日期 + 采购时间**将提供以下结果，因为它将履行延迟到采购提前期结束时。
![使用**需求**覆盖范围代码和**第一次发货**履行计划物料](./media/ReqTodayLT.png)
### <a name="coverage-time-fence"></a>覆盖时限
在**覆盖时限**字段指定的期间内满足指定的最低数量。 当主计划不允许将可用库存用于实际订单（例如销售或转移）来试图维持安全水平时，此选项有用。 但在未来的版本中，此补货模式将不再需要，且此选项将被弃用。
## <a name="plan-safety-stock-replenishment-for-first-expired-first-out-fefo-items"></a>为先过期先出 (FEFO) 物料计划安全存货补货
在任何时间点，具有最新到期日期的库存收货将用于安全存货，以允许按照 FEFO（先过期先出）的顺序履行实际需求，如销售行或物料清单行。
要演示其工作方式，请考虑以下方案。
[![FEFOScenario](./media/FEFOScenario.png)](./media/FEFOScenario.png) 在运行计划时，它将涵盖来自现在的现有库存量的第一个销售订单和一个用于剩余数量的额外采购订单。
[![FEFO1](./media/FEFO1.png)](./media/FEFO1.png) 创建一个计划订单，以确保可用库存恢复至安全限制。
[![FEFO2](./media/FEFO2.png)](./media/FEFO2.png) 在计划第二个销售订单时，使用之前创建的涵盖安全存货的计划订单涵盖此数量。 因此，安全存货在持续滚动。
[![FEFO3](./media/FEFO3.png)](./media/FEFO3.png) 最后创建另一个计划订单以涵盖安全存货。
[![FEFO4](./media/FEFO4.png)](./media/FEFO4.png) 所有批次相应到期，并创建计划订单以便在到期后重填安全存货。

## <a name="how-master-planning-handles-the-safety-stock-constraint"></a>主计划如何处理安全存货约束

安全存货在系统中作为需求类型进行跟踪，与销售行或物料清单需求类似。 如果您删除**需求类型**列上的默认筛选器，可以看到**净需求**页上的安全存货需求行。

如果系统确定履行安全存货需求交易将导致延迟履行实际需求（例如销售行、物料清单行、转移需求或需求预测行），将降低履行安全存货需求交易的优先级。 否则，确保可用库存高于安全存货数量具有与任何其他需求类型相同的优先级。 这将确保实际交易不会延迟，且有助于防止安全存货过度补货和过早补货。

在主计划的覆盖范围阶段，不再降低安全存货补货的优先级。 现有库存量可以在任何其他需求类型前使用。 在延迟计算过程中，将添加新的逻辑来检查延迟的销售行、物料清单行需求以及所有其他需求类型，以确定在使用安全存货的前提下是否可以按时交付。 如果系统确定使用安全存货可以最大程度地减少延迟，则销售行或物料清单行将使用安全存货替代其初始覆盖范围，并且系统将改为针对安全存货触发补货。

如果没有为延迟计算设置计划或物料，则安全存货约束将具有与任何其他需求类型相同的优先级。 这意味着在其他需求类型前存在现有和其他可用库存的预留。
