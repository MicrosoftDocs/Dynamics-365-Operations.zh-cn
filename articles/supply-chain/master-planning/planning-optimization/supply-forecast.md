---
title: 具有供应预测的主计划
description: 本文介绍在主计划期间如何考虑供应预测。
author: t-benebo
ms.date: 09/21/2022
ms.topic: article
ms.search.form: ''
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: benebotg
ms.search.validFrom: 2022-09-21
ms.dyn365.ops.version: 10.0.30
ms.openlocfilehash: 2bac9355bb1ac00f697ec459f494a64553e0eacc
ms.sourcegitcommit: 491ab9ae2b6ed991b4eb0317e396fef542d3a21b
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/03/2022
ms.locfileid: "9740133"
---
# <a name="master-planning-with-supply-forecasts"></a>具有供应预测的主计划

[!include [banner](../../includes/banner.md)]

供应预测可让您指定您预计在某个未来期间需要的供应。 通常，您将根据上一年的销售历史记录进行估算，然后将预测用于预算目的。 您还可以将主计划设置为在计划期间考虑预测。

## <a name="set-up-a-master-plan-to-consider-supply-forecasts"></a>将主计划设置为考虑供应预测

您可以指定每个主计划在运行时是否应考虑预测。 使用以下过程为每个计划设置预测选项。

1. 转到 **主计划 \> 设置 \> 计划 \> 主计划**。
1. 在列表窗格中选择一个现有主计划，或在操作窗格上选择 **新建** 来创建新的主计划。
1. 在 **常规** 快速选项卡上，设置以下字段：

    - **预测模型** – 选择包含主计划应考虑的供应和/或需求预测的模型。
    - **包括供应预测** – 如果主计划应考虑供应预测，将此选项设置为 *是*。
    - **包括需求预测** – 如果主计划应考虑需求预测，将此选项设置为 *是*。 虽然此设置独立于 **包括供应预测** 设置，但页面上的其他一些设置同时适用于供应预测和需求预测。 有关考虑需求预测的计划的更多信息，请参阅[具有需求预测的主计划](demand-forecast.md)。
    - **用于减少预测需求的方法** – 选择在主计划期间用于减少预测需求的方法：

        - *无* – 在主计划期间不会减少预测需求。
        - *百分比 - 缩减参数* – 根据缩减参数中定义的百分比和时段来减少预测需求。
        - *交易 – 缩减参数* – 按照在缩减参数中定义的时段内发生的交易来减少预测需求。
        - *交易 – 动态期间* – 按动态期间内发生的订单交易减少预测需求。 动态期间包括当前预测日期，在下一预测开始时结束。 *交易 – 动态期间* 方法不使用或不需要缩减参数，当您使用此方法时，以下条件适用：

            - 如果完全缩减预测，则当前预测的预测需求变为 0（零）。
            - 如果没有将来的预测，则最后一个输入的预测的预测需求会缩减。
            - 时限包括在缩减预测计算中。
            - 正天数包括在缩减预测计算中。
            - 如果实际订单交易记录超过预测的需求，则其余的交易记录不会前进到下一预测期间。

        > [!NOTE]
        > 如果您为主计划启用了需求预测，**用于减少预测需求的方法** 设置也适用于需求预测，会以类似的方式影响需求预测。 有关详细信息，请参阅[具有需求预测的主计划](demand-forecast.md)。

## <a name="set-reduction-options-for-coverage-groups"></a>为覆盖范围组设置减少选项

要设置选项以控制覆盖范围组如何减少使用基于交易的减少的主计划的预测需求，请执行以下步骤。

1. 转到 **主计划 \> 设置 \> 计划 \> 覆盖范围组**。
1. 在列表窗格中选择一个现有覆盖范围组，或在操作窗格上选择 **新建** 来创建新的覆盖范围组。
1. 对于 **用于减少预测需求的方法** 字段设置为 *交易 - 缩减参数* 或 *交易 - 动态期间* 的主计划，在 **其他** 快速选项卡上，在 **预测减少依据** 字段中，指定应如何减少覆盖范围组中物料的供应预测需求。 选择以下值之一：

    - *所有交易* – 所有交易都应减少预测。
    - *订单* – 仅相同类型的订单应减少预测。

    例如，一个物料的默认订单设置表明它应该被生产。 有一个数量为 50 的供应预测行，一个数量为 20 的现有采购订单。 如果 **预测减少依据** 字段设置为 *订单*，将创建数量为 50 的计划生产订单。 如果设置为 *所有交易*，计划生产订单的数量将减少到 30。

    此设置也适用于需求预测减少。 有关详细信息，请参阅[具有需求预测的主计划](demand-forecast.md)。

## <a name="enter-a-supply-forecast-for-a-product"></a>为产品输入供应预测

要为产品输入供应预测，请按照以下步骤操作。

1. 转到 **产品信息管理 \> 产品 \> 已发布产品**。
1. 选择要为其输入预测的产品。
1. 在操作窗格上，在 **计划** 选项卡上，选择 **供应预测**。
1. 在 **供应预测** 页面的操作窗格上，选择 **新建** 将预测添加到网格中。
1. 根据需要在新行上输入信息来指定您的预测。

## <a name="plan-for-an-item-with-supply-forecast-lines"></a>使用供应预测行计划物料

当您运行包含存在供应预测的物料的主计划时，系统将为已输入的供应行创建采购订单。 该物料的默认订单设置继续有效。 如果这些默认订单设置指定了 *采购订单* 的 **默认订单类型** 值，但在供应预测行上未指定供应商帐户，系统将使用该物料的默认供应商。

## <a name="check-whether-a-planned-order-is-a-supply-forecast-order"></a>检查计划订单是否是供应预测订单

使用以下过程了解是否因供应预测创建了计划订单。

1. 转到 **主计划 \> 主计划 \> 计划订单**。
1. 打开要检查的计划订单。
1. 在 **常规** 快速选项卡上，查看 **供应预测** 字段的值。 如果创建了订单来覆盖供应预测，此字段将设置为 *是*。

## <a name="examples-of-master-planning-with-supply-forecasts"></a>具有供应预测的主计划的示例

本节提供了几个示例来说明供应预测如何影响主计划。

### <a name="example-1-supply-forecast-for-an-item"></a>示例 1：物料的供应预测

您有一个物料，其默认订单类型为 *采购订单*，默认供应商为 *US-002*。 它具有以下供应预测行。

| 模型    | 日期     | 供应商帐户 | 供应商组 | Quantity | 单位 | 站点 | 仓库 |
|----------|----------|----------------|--------------|----------|------|------|-----------|
| CurrentF | 10/10/22 |                |              | 35       | 件   | 1    | 11        |

运行主计划时，将为供应商 *US-002* 的 *35 件* 创建计划采购订单。

### <a name="example-2-several-supply-forecast-lines-with-and-without-a-vendor"></a>示例 2：多个供应预测行，有和没有供应商

您有一个物料，其默认订单类型为 *采购订单*，默认供应商为 *US-002*。 它具有以下供应预测行。

| 模型    | 日期     | 供应商帐户 | 供应商组 | Quantity | 单位 | 站点 | 仓库 |
|----------|----------|----------------|--------------|----------|------|------|-----------|
| CurrentF | 10/10/22 |                |              | 35       | 件   | 1    | 11        |
| CurrentF | 10/10/22 | US-101         |              | 25       | 件   | 1    | 11        |

在这种情况下，系统将未指定供应商的行视为一般预测，假定应从一般预测中减去指定供应商的行。 因此，主计划将为物料创建以下计划采购订单：

- 为供应商 *US-101* 的数量 *25 件* 创建计划采购订单（使用预测行中指定的供应商和数量）
- 为供应商 *US-002* 的数量 *10 件* 创建计划采购订单（因为没有在其他预测行上指定供应商，所以使用默认供应商，此预测行的数量要减去供应商特定预测行的数量。）

### <a name="example-3-plans-that-use-the-transactions---dynamic-period-reduction-method-in-a-single-forecast-period"></a>示例 3：在单个预测期间使用“交易 - 动态期间”减少方法的计划

对于使用 *交易 - 动态期间* 作为预测减少方法的主计划，如果存在与这些供应特征匹配的现有交易，主计划将减少预测数量。

例如，您有一个默认订单类型为 *采购订单* 的物料。 它具有以下供应预测行。

| 模型    | 日期     | 供应商帐户 | 供应商组 | Quantity | 单位 | 站点 | 仓库 |
|----------|----------|----------------|--------------|----------|------|------|-----------|
| CurrentF | 10/10/22 | US-101         |              | 25       | 件   | 1    | 11        |

由于只有一个供应预测行，所以只有一个预测期间。

运行设置为使用 *交易 – 动态期间* 作为减少方法的主计划时，可能会出现以下结果之一：

- 如果供应商 *US-101* 有采购订单，数量为 *10 件*，**供应预测** 字段设置为 *是*，主计划将为剩余数量 *10 件* 创建新的计划采购订单。 预测行将减少，因为供应商与现有采购订单匹配。
- 如果供应商 *US-102* 有采购订单，站点为 *1*，仓库为 *11*，数量为 *10 件*，**供应预测** 字段设置为 *是*，主计划将为全部数量 *25 件* 创建新的计划采购订单。 预测行无法减少，因为它的供应商与现有采购订单不同。

> [!NOTE]
> 计划采购订单可能会出现这种情况，因为供应商与它们相关联。 但是，对于转移单和生产订单，供应预测金额始终会减去现有订单，因为没有为这些类型的订单指定供应商。

### <a name="example-4-plans-that-use-the-transactions---dynamic-period-reduction-method-over-several-forecast-periods"></a>示例 4：在多个预测期间使用“交易 - 动态期间”减少方法的计划

您有一个默认订单类型为 *采购订单* 的物料。 它具有以下供应预测行。

| 模型    | 日期     | 供应商帐户 | 供应商组 | Quantity | 单位 | 站点 | 仓库 |
|----------|----------|----------------|--------------|----------|------|------|-----------|
| CurrentF | 10/10/22 | US-101         |              | 25       | 件   | 1    | 11        |
| CurrentF | 10/15/22 | US-101         |              | 25       | 件   | 1    | 11        |

在此示例中，有两个预测行，每个行有不同的日期。 因此，日期会确定预测期间的边界。 第一个期间是从 2022 年 10 月 10 日到 10 月 14 日 (10/10/22–10/14/22)。 第二个期间是从 2022 年 10 月 15 日 (10/15/22) 起。

供应商 *US-101* 有一个现有采购订单，数量为 *10 件*，日期为 *10/12/22*（2022 年 10 月 12 日）。 运行设置为使用 *交易 – 动态期间* 作为减少方法的主计划时，它将创建以下订单：

- 数量为 *15 件*、日期为 *10/10/22* 的计划订单（数量要减去日期在同一预测期间内的现有采购订单。）
- 数量为 *25 件*、日期为 *10/15/22* 的计划订单（数量是预测的全部数量。）

### <a name="example-5-plans-that-use-no-reduction"></a>示例 5：不使用减少的计划

运行预测减少方法为 *无* 的计划时，主计划将始终为所有供应预测行创建计划供应。 在该计划供应获得批准后，它将减少未来的计划订单。 但是，采购订单不会减少供应预测行。

例如，您有一个默认订单类型为 *采购订单* 的物料。 它具有以下供应预测行。

| 模型    | 日期     | 供应商帐户 | 供应商组 | Quantity | 单位 | 站点 | 仓库 |
|----------|----------|----------------|--------------|----------|------|------|-----------|
| CurrentF | 10/10/22 | US-101         |              | 25       | 件   | 1    | 11        |

供应商 *US-101* 有一个现有采购订单，站点为 *1*，仓库为 *11*，数量为 *25 件*，日期为 *10/10/22*。 

当您运行设置为使用 *无* 作为减少方法的主计划时，它将为供应商 *US-101*、站点 *1*、仓库 *11*、数量 *25 件* 和日期 *10/10/22* 创建计划采购订单。 换言之，现有采购订单不会减少，因为预测减少方法是 *无*。

您现在编辑在上次计划运行后创建的计划采购订单并将数量更改为 *15 件*。 然后批准订单。 下一次您运行主计划时，它将为供应商 *US-101*、站点 *1*、仓库 *11*、数量 *10 件* 和日期 *10/10/22* 创建计划采购订单。 这次，数量将减少以反映先前计划运行中现有的已批准订单的数量。

## <a name="differences-between-planning-optimization-and-the-deprecated-master-planning-engine"></a>计划优化与已弃用的主计划引擎之间的差异

供应预测的工作方式略有不同，具体取决于您使用的计划引擎（计划优化或已弃用的主计划引擎）。 本节介绍这些差异。

### <a name="vendor-groups"></a>供应商组

添加预测行时，您可以指定供应商和供应商组。 在已弃用的主计划引擎中，创建的计划订单按供应商和供应商组值的组合分组。 在计划优化中，计划订单按供应商分组。

下表提供了物料的供应预测行的一些示例。

| 模型    | 日期     | 供应商帐户 | 供应商组 | Quantity | 单位 | 站点 | 仓库 |
|----------|----------|----------------|--------------|----------|------|------|-----------|
| CurrentF | 10/10/22 |                | VendorGroupA | 5        | 件   | 1    | 11        |
| CurrentF | 10/10/22 |                | VendorGroupA | 6        | 件   | 1    | 11        |
| CurrentF | 10/10/22 |                |              | 7        | 件   | 1    | 11        |

供应商 *VendorA* 是供应商组 *VendorGroupA* 的默认供应商。 同时还是物料的默认供应商。

已弃用的主计划引擎将创建以下订单：

- 供应商 *VendorA*、供应商组 *VendorGroupA* 和数量 *11* 的计划采购订单
- 供应商 *VendorA* 和数量 *7* 的计划采购订单

计划优化会只创建一个订单：

- 供应商 *VendorA*、供应商组 *VendorGroupA* 和数量 *18* 的计划采购订单

### <a name="reduction-of-general-forecasts-by-more-specific-forecasts"></a>按更具体的预测减少一般预测

在已弃用的主计划引擎中，如果某些预测有供应商而其他预测没有，结果将不可预测。

在计划优化中，一般预测始终是按更具体的预测减少，如以下示例所示。

下表提供了物料的供应预测行的一些示例。

| 日期       | Quantity | 供应商   | 供应商组  |
|------------|----------|----------|---------------|
| 2022 年 11 月 2 日 | 5.00     | Vendor-A | VendorGroup-A |
| 2022 年 11 月 2 日 | 6.00     | Vendor-A | VendorGroup-A |
| 2022 年 11 月 2 日 | 15.00    |          |               |

一般预测（15.00 件）按更具体的预测（5.00 + 6.00 = 11.00 件）减少。 剩余数量分配给默认供应商。 下表显示了计划订单。

| 日期       | Quantity | 供应商   | 供应商组  |
|------------|----------|----------|---------------|
| 2022 年 11 月 2 日 | 11.00    | Vendor-A | VendorGroup-A |
| 2022 年 11 月 2 日 | 4.00     | Vendor-A | VendorGroup-A |

### <a name="respect-for-default-order-settings-when-planned-orders-are-generated"></a>生成计划订单时继续使用默认订单设置

每个物料都可以有默认订单设置，如最小采购订单数量。 已弃用的主计划引擎会忽略这些设置，因此将预测转换为具有相同数量的计划订单。 当从供应预测生成计划订单时，计划优化会继续使用这些设置。 

### <a name="aggregation-of-planned-orders-as-a-result-of-reduction-by-approved-orders"></a>因减掉已批准订单而发生的计划订单合并

已弃用的主计划引擎会假定只有一个订单会减少现有的供应预测。 因此，如果多个订单与供应预测行匹配，只有第一个订单会减少此数量。 在计划优化中，所有与供应预测行匹配的订单都会减少此数量。

### <a name="reduction-of-forecasts-by-matching-vendors-only"></a>仅按匹配的供应商减少预测

当已弃用的主计划引擎按现有的已下达采购订单减少预测时，无法确保采购订单上的供应商与预测中的供应商匹配。 计划优化只按在供应商字段中具有匹配值的采购订单来减少预测。

对于转移单和生产订单，供应商字段始终会被忽略，因为它与那些订单类型无关。

### <a name="reduction-of-forecasts-by-transfer-orders"></a>按转移单减少预测

如果物料的默认订单类型是 *转移*，只能按现有的计划转移单来减少预测。 但是，对于生产订单和采购订单，只有已下达订单会减少供应预测。

已弃用的主计划引擎会根据所有转移单状态减少预测，而计划优化只按处于 *已下达* 状态的转移单减少预测。
