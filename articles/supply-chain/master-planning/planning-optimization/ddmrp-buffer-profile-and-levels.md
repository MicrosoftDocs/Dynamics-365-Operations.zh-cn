---
title: 缓冲区配置文件和级别
description: 本文提供有关缓冲区配置文件和级别的信息，这些信息确定应该为每个分离点保留的最小和最大库存级别。
author: t-benebo
ms.date: 06/30/2022
ms.topic: article
ms.search.form: EcoResProductDetailsExtended, ReqItemDecoupledLeadTime
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: benebotg
ms.search.validFrom: 2022-06-30
ms.dyn365.ops.version: 10.0.28
ms.openlocfilehash: d254b949d31d0b15141646503c64760062b77fc7
ms.sourcegitcommit: 3e04f7e4bc0c29c936dc177d5fa11761a58e9a02
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 10/18/2022
ms.locfileid: "9689136"
---
# <a name="buffer-profile-and-levels"></a>缓冲区配置文件和级别

[!include [banner](../../includes/banner.md)]
[!INCLUDE [preview-banner](../../includes/preview-banner.md)]
<!-- KFM: Preview until further notice -->

在标识分离点（您将战略性地保留在存货中的关键物料）后，您必须决定每个分离点的库存量（缓冲区）。 此任务是需求驱动材料资源计划 (DDMRP) 的第二步。

## <a name="buffer-levels-and-zones"></a>缓冲区级别和区域

在 DDMRP 中，使用以下三个值定义每个存货缓冲区：最小数量、最大数量和再订购点。 这些值建立三个差异区域，这些区域由以下颜色代码标识：

- **红色区域** - 低于最小数量的区域。 最小数量也称为“红色顶部”，您的计划策略应设计为确保库存水平始终高于此点。
- **黄色区域** - 最小数量与再订购点之间的区域。 再订购点也称为“黄色顶部”。 达到此点后，系统应再订购。
- **绿色区域** - 再订购点与最大数量之间的区域。 最大数量也称为“绿色顶部”。 此点是库存将补货到的最大水平。

下图显示了三个彩色区域及其与最小数量、最大数量和再订购点的关系。

![DDMRP 缓冲区和级别。](media/ddmrp-buffer-levels.png "DDMRP 缓冲区和级别")

## <a name="calculating-the-buffer-zones"></a>计算缓冲区

此节解释如何计算每个缓冲区的高度。

通常先计算黄色区域。 此区域表示您从订购到订单到达这段时间使用的数量。 换言之，这是补货提前期内的预期消耗量。 它是通过使用以下等式计算的：

- **黄色区域** = *每日平均使用量 (ADU)* × *分离的提前期*

*分离的提前期* 表示生产或接收物料所需的时间（如果分离点始终有库存）。 它通常比主计划中一贯使用的 *累积提前期* 短得多。 正确的缓冲区设置是确保分离点始终实际有库存但不会积压库存的关键。

此红色区域是使用以下方程式计算的：

- **红色基数** = *ADU* × *分离的提前期* × *提前期系数*
- **红色安全** = *红色基数* × *可变性系数*
- **红色区域** = *红色基数* + *红色安全*

将绿色区域计算为以下三个方程式的最大结果：

- *最小订单数量*
- *ADU* × *订单周期*
- *ADU* × *分离的提前期* × *提前期系数*

## <a name="calculating-average-daily-usage"></a>计算平均每日使用量

系统使用三种方法之一来计算您每天使用的数量：

- **平均每日使用量（过去）**- 此方法基于过去的实际消耗量。
- **平均每日使用量（将来）**- 此方法基于预测的将来消耗量。
- **平均每日使用量（混合）**- 此方法基于过去和预测消耗量的加权组合。

### <a name="average-daily-usage-past"></a>平均每日使用量（过去）

通过添加指定过去天数每天使用的数量，然后将总计除以天数，来计算过去的 ADU 作为平均值。 下图显示了当计算回顾过去三天时此方法的工作原理。

![平均每日使用量（过去）图表。](media/ddmrp-adu-past.png "平均每日使用量（过去）图表")

在上图中，如果今天是 6 月 11 日上午，则前三天（6 月 8 日、9 日和 10 日）的 ADU 为 21。

- **ADU（过去）** = (29 + 11 + 23) ÷ 3 = 21

计算平均每日使用量（过去）时会考虑以下交易：

- 减少物料数量的交易（在数量小于零的 `inventtrans` 表中）
- 状态为 *在单*、*订购预留*、*实际预留*、*已领料*、*已扣除* 或 *已售出* 的交易
- 所选回溯期间内的交易（过去期间的平均每日使用量）
- 仓库工作、隔离、销售报价单或对帐单以外的交易（`WHSWork`、`WHSQuarantine`、`SalesQuotation` 或 `Statement`）
- 同一覆盖范围维度内的除转移日记帐以外的交易

### <a name="average-daily-usage-forward"></a>平均每日使用量（将来）

对于新产品，您可能没有任何过去的使用数据。 因此，您以后可能会改用预测的 ADU（例如，基于预测的需求）。 下图显示了当计算展望未来三天（包括今天）时此方法的工作原理。

![平均每日使用量（将来）图表。](media/ddmrp-adu-forward.png "平均每日使用量（将来）图表")

在上图中，如果今天是 6 月 11 日上午，则接下来三天（6 月 11 日、12 日和 13 日）的 ADU 为 21.66。

- **ADU（将来）** = (18 + 18 + 29) ÷ 3 = 21.66

计算平均每日使用量（将来）时会考虑以下交易：

- 在主计划中选择了预测的物料的预测交易
- 所选将来期间内的交易（将来期间的平均每日使用量）

### <a name="average-daily-usage-blended"></a>平均每日使用量（混合）

混合 ADU 结合了平均过去使用量和平均将来使用量，如下图所示。

![平均每日使用量（混合）图表。](media/ddmrp-adu-blended.png "平均每日使用量（混合）图表")

在上图中，如果今天是 6 月 11 日上午，则前三天和后三天（6 月 8 日至 13 日）的混合 ADU 为 21.33。

- **混合 ADU** =（*过去的 ADU* + *将来的 ADU*）÷ 2<br>= (21 + 21.66) ÷ 2<br>= 21.33

## <a name="buffer-calculation-factors"></a>缓冲区计算系数

对于每个物料，您可以定义两个系数来调整红色和绿色区域应有的大小。 这样，您可以补偿预期的提前期和需求可变性。

![提前期和可变性系数。](media/ddmrp-zone-factors.png "提前期和可变性系数")

第一个系数是 *提前期系数*。 该值是从 0 到 1 的小数值。 提前期越长，值应越低。 需求驱动研究所推荐以下范围：

- **长提前期：** 0.20–0.40
- **中等提前期：** 0.41-0.60
- **短提前期：** 0.61-1.00

第二个系数是 *可变性系数*。 该值是从 0 到 1 的小数值。 需求可变性越高，值应越低。 需求驱动研究所推荐以下范围：

- **低可变性：** 0.20-0.40
- **中等可变性：** 0.41-0.60
- **高可变性：** 0.61-1.00

## <a name="buffer-calculation-examples"></a>缓冲区计算示例

此示例继续[库存定位](ddmrp-inventory-positioning.md)中提供的枕头生产示例。 在该示例中，您选择了将提前期从 21 天缩短到 5 天的分离点，如以下说明中所示。

![分离的提前期示例。](media/ddmrp-bom-decoupled-lead-time-example.png "分离的提前期示例")

对于此示例，假设 ADU 已被计算为 23 件，如上图所示，分离的提前期为 5 天。 通过使用这些值，您可以使用以下方程式来计算黄色区域：

- **黄色区域** = *ADU* × *分离的提前期* = 115

![黄色区域计算的示例。](media/ddmrp-example-calc-yellow.png "黄色区域计算的示例")

红色区域计算与黄色区域计算相似，但它针对可变性和提前期进行了填充。 对于此示例，假设您观察到中等提前期（系数 = 0.50）和高需求可变性（系数 = 0.8）。 通过将这些值与黄色区域方程中的组成部分一起使用，您可以使用以下方程计算红色区域：

- **红色基数** = *ADU* × *分离的提前期* × *提前期系数* = 57.5
- **红色安全** = *红色基数* × *可变性系数* = 46
- **红色区域** = *红色基数* + *红色安全* = 103.5

系统会将红色区域舍入为 104 件 (ea)，因为用整数计数了件数。

![红色区域计算的示例。](media/ddmrp-example-calc-red.png "红色区域计算的示例")

绿色区域计算还包括黄色区域方程中的组成部分，但它允许使用最小订单规模、订单周期和交货时间系数。 对于此示例，假设没有订单周期（因此，您对订购的频率没有任何时间限制），最小订购数量为 10 件。 然后，将绿色区域计算为以下三个方程式的最大结果：

- *最小订单数量* = 10
- *ADU* × *订单周期* = 0
- *ADU* × *分离的提前期* × *提前期系数* = 57.5

系统会将绿色区域舍入为 58 件 (ea)，因为用整数计数了件数。

![绿色区域计算的示例。](media/ddmrp-example-calc-green.png "绿色区域计算的示例")

下图使用 DDMRP 中经常使用的漏斗图总结了这些区域计算结果。

![区域计算结果摘要。](media/ddmrp-example-calc-summary.png "区域计算结果摘要")

## <a name="dynamic-adjustments"></a><a name="dynamic-adjustments"></a>动态调整

利用动态调整，您可以在高需求或低需求期间应用 *需求调整系数*。 在所选期间的所有计算中，该系数会乘以 ADU。 然后依次修改缓冲区。 您通常会在生成初始缓冲区值后应用此系数，以便您可以随着时间的推移对它们进行微调并响应不断变化的条件。 此任务是 DDMRP 的第三步。

例如，由于人们外出度假，因此，8 月份的枕头产品需求可能更大。 因此，预计销售额将更高。 在这种情况下，您可以对 8 月中的所有周将产品的 **需求调整系数** 值更改为 *1.5*。

这样，您可以计算一段时间内的缓冲值，然后根据系统提供的更多信息对其进行调整。 在完全 DDMRP 实现中，您将每天通过批处理作业计算新的缓冲区值，并自动接受这些值。 然后，您将运行批处理作业形式的计划并每天审核计划订单以重新填充缓冲区。

## <a name="implement-buffers-in-supply-chain-management"></a>在 Supply Chain Management 中实现缓冲区

本节介绍如何在 Microsoft Dynamics 365 Supply Chain Management 中实施缓冲区策略。 它假定您已经完成了本文前半部分概述的分析和计算。

### <a name="set-up-buffers-for-a-decoupling-point-item"></a><a name="set-up-buffers"></a>设置分离点物料的缓冲区

按照这些步骤设置分离点的缓冲区值。

1. 转到 **产品信息管理 \> 产品 \> 已发布产品**。
1. 选择设置为分离点的已发布物料。 （有关详细信息，请参阅[库存定位](ddmrp-inventory-positioning.md)。）
1. 在操作窗格上，在 **计划** 选项卡上，选择 **物料覆盖范围**。
1. 在 **物料覆盖范围** 页面上，选择创建分离点的物料覆盖范围记录。 （此记录将显示为创建分离点而设置的覆盖范围组的名称。）
1. 选择 **常规** 选项卡。
1. 如果您希望系统根据销售历史记录、预测和覆盖范围组设置每天或每周重新计算缓冲区值，请按照以下步骤操作：

    1. 将 **一段时间的缓冲区值** 选项设置为 *是*。
    1. 消息框通知您，如果继续，将重置手动缓冲区设置（**最小值**、**再订购点** 和 **最大值**）。 选择 **是** 以保留新设置。

    或者，如果您喜欢只计算或输入一次缓冲区设置，请按照以下步骤操作：

    1. 将 **一段时间的缓冲区值** 选项设置为 *否*。
    1. 将 **最小值**、**再订购点** 和 **最大值** 字段设置为您为物料计算的缓冲区值，如本文前面所述。

1. 设置以下字段以完成物料的 DDMRP 计算设置：

    - **订单周期** - 指定必须在物料采购订单之间经过的天数。 如果不存在订单限制，则将值设置为 *0*（零）。 此字段影响最大数量缓冲区，如本文中先前讨论的一样。
    - **平均每日使用量** - 您可以有选择性地为物料输入估计的 ADU。 此字段仅供参考。 通常，该值是作为缓冲区计算的一部分自动计算的。
    - **订单峰值阈值** - 指定适合作为销售峰值（异常高的需求）的物料的最低每日销售额。 系统使用此字段在高需求期间增加计划订单的再订购数量。 有关详细信息，请参阅[需求驱动的计划](ddmrp-planning.md)。

### <a name="calculate-or-enter-decoupled-lead-times"></a><a name="calc-lead-time"></a>计算或输入分离的提前期

对于您选择允许系统[自动计算缓冲区](#set-up-buffers)的物料，请按照这些步骤计算或输入分离点物料的分离提前期。

1. 打开分离点物料的 **物料覆盖范围** 页面。 （有关详细信息，请参阅[设置分离点物料的缓冲区](#set-up-buffers)。）
1. 选择创建分离点的物料覆盖范围记录。
1. 选择 **缓冲区值** 选项卡。
1. 如果网格中、操作窗格上、**缓冲区值** 选项卡上没有显示时段，请选择 **添加时段**。 系统用每个每日或每周时段的行填充网格，具体取决于 [覆盖范围组](ddmrp-inventory-positioning.md)的 **最小、最大和再订购点期间** 字段被设置为 *每日* 还是 *每周*。 系统将添加足够的行以达到为分配给物料的覆盖范围组指定的时限。
1. 选择计算分离提前期所要处于的时段。 （通常，此时段是包括今天日期的期间。）
1. 在操作窗格上，在 **缓冲区值** 选项卡上，选择 **计算分离的提前期**。
1. 在 **计算分离的提前期** 对话框中，设置以下字段：

    - **物料清单** - 选择运行计算所要针对的物料清单。
    - **日期** - 选择运行计算所要针对的日期。 将筛选一组可用物料清单，以便仅显示对所选日期有效的物料清单。
    - **数量** – 输入要运行计算所针对的数量。 将筛选一组可用物料清单，以便仅显示适用于指定数量的物料清单。

1. 选择 **确定** 以运行计算并关闭 **计算分离的提前期** 对话框。 所选时段的 **分离的提前期** 列现在显示计算出的值。

### <a name="calculate-or-enter-average-daily-usage"></a><a name="calc-adu"></a>计算或输入平均每日使用量

对于您选择允许系统[自动计算缓冲区](#set-up-buffers)的物料，请按照这些步骤计算或输入分离点物料的 ADU。

1. 打开分离点物料的 **物料覆盖范围** 页面。 （有关详细信息，请参阅[设置分离点物料的缓冲区](#set-up-buffers)。）
1. 选择创建分离点的物料覆盖范围记录。
1. 选择 **缓冲区值** 选项卡。
1. 如果网格中、操作窗格上、**缓冲区值** 选项卡上没有显示时段，请选择 **添加时段**。 系统用每个每日或每周时段的行填充网格，具体取决于 [覆盖范围组](ddmrp-inventory-positioning.md)的 **最小、最大和再订购点期间** 字段被设置为 *每日* 还是 *每周*。 此外，将从覆盖范围组中获取 **提前期系数** 和 **可变性系数** 字段的默认值。 您可以根据需要编辑每行的这些值。
1. 选择要计算 ADU 的时段。
1. 在操作窗格上，在 **缓冲区值** 选项卡上，选择 **计算平均每日使用量**。 系统尝试收集为[覆盖范围组](ddmrp-inventory-positioning.md)定义的 ADU 计算所需的数据。
1. 按以下步骤之一：

    - 如果所需数据可用，则计算结果将添加到 **平均每日使用量** 列中。 在这种情况下，无需执行任何操作。
    - 如果所需数据不可用，则不会自动添加值。 在这种情况下，请手动输入打算计算缓冲区值的每个行的估计值。

### <a name="calculate-and-apply-buffer-values"></a>计算并应用缓冲区值

对于您选择允许系统[自动计算缓冲区](#set-up-buffers)的物料，您可以按照以下步骤手动触发缓冲区值的计算。

1. 对于相关的分离点物料，[配置缓冲区计算](#set-up-buffers)，[计算或输入分离的提前期](#calc-lead-time)，并[计算或输入所有相关时间段的平均每日用量](#calc-adu)，如本文中前面所述。
1. 打开分离点物料的 **物料覆盖范围** 页面。
1. 选择 **缓冲区值** 选项卡，该选项卡应已显示时段列表。
1. 选择要计算缓冲区值的时段。 （通常，此时段将是包括今天在内的期间。）您选择的行在 **平均每日使用量** 和 **分离的提前期** 列中必须已经具有非零值。
1. 根据需要编辑一行或多行的 **需求调整系数** 字段。 在所有使用该值的缓冲区计算中，系统会将此系数应用于 **平均每日使用量** 值。 利用此系数，您可以调整需求按日期波动的方式（例如，假日或季节性物料）。
1. 在操作窗格的 **缓冲区值** 选项卡上，选择 **计算最小、最大和再订购点数量**。 系统将在 **物料覆盖范围** 页的网格中计算并填写 **计算的最小值**、**计算的再订购点** 和 **计算的最大值** 列。
1. 查看完计算的值后，必须应用它们。 否则，它们将不会产生任何影响。 当您对一行或多行应用计算时，**计算的最小值**、**计算的再订购点** 和 **计算的最大值** 字段中的值将分别复制到 **最小值**、**再订购点** 和 **最大值** 列中。 在操作窗格的 **缓冲区值** 选项卡上，在 **采取操作** 组中，选择以下按钮之一：

    - **接受所有计算** - 应用网格中的所有计算值。
    - **接受所选行的计算** - 仅对所选行应用计算值。
    - **放弃所有计算** - 放弃网格中最小数量、最大数量和再订购点的所有计算值。
    - **放弃所选行的计算** - 放弃所选行的最小数量、最大数量和再订购点的所有计算值。

### <a name="schedule-automatic-buffer-value-calculations"></a>计划自动缓冲区值计算

在您完全设置好 DDMRP 设置并确认它们如期正常工作后，您可能需要设置一个批处理作业，以根据实际消耗量数据和/或更新的预测，按需定期重新计算 ADU 和相关缓冲区值。 此过程仅适用于您选择允许系统[自动计算缓冲区](#set-up-buffers)的物料。

按照这些步骤计划自动缓冲区值计算。

1. 转到 **主计划 \> 主计划 \> DDMRP \> 计算缓冲区值**。
1. 在 **计算缓冲区值** 对话框中，设置以下字段：

    - **计算平均每日使用量** – 将此选项设置为 *是*，以在每次作业运行时重新计算分离点物料的 ADU。 将其设置为 *否* 以跳过此计算。 通常，您应将此选项设置为 *是*。
    - **计算分离的提前期** - 将此选项设置为 *是*，以在每次作业运行时重新计算分离的提前期。 将其设置为 *否* 以跳过此计算。 通常，您应将此选项设置为 *是*。
    - **计算缓冲区值** - 将此选项设置为 *是*，以在每次作业运行时重新计算缓冲区值。 将其设置为 *否* 以跳过此计算。 通常，您应将此选项设置为 *是*。
    - **接受最小、最大和重订购点的计算** - 将此选项设置为 *是*，以在每次作业运行时自动审核并应用重新计算的缓冲区值。 将其设置为 *否* 以撤销应用重新计算的值。 在这种情况下，重新计算的值将不会生效，除非稍后有人从每个产品的 **物料覆盖范围** 页面手动应用这些值。 通常，您应将此选项设置为 *是*。
    - **主计划** - 选择包含将受计算影响的物料的主计划。 该计算将应用于计划筛选器中的所有物料，这将受此对话框中的 **筛选器** 设置的进一步限制。

1. 要限制此批处理作业运行所应针对的记录集，请在 **要包括的记录** 快速选项卡上选择 **筛选器** 以打开 **查询** 对话框。 此对话框的工作方式与其用于 Supply Chain Management 中其他类型的[后台作业](../../../fin-ops-core/dev-itpro/sysadmin/batch-processing-overview.md)时一样。
1. 在 **在后台运行** 快速选项卡上，指定对所选物料应执行所选计算的方式、时间和频率。 这些字段的工作方式与它们用于 Supply Chain Management 中其他类型的[后台作业](../../../fin-ops-core/dev-itpro/sysadmin/batch-processing-overview.md)时一样。
1. 选择 **确定** 以将新作业添加到要执行的批处理队列。

### <a name="review-and-recalculate-decoupled-lead-times-for-all-items"></a>查看并重新计算所有物料的分离提前期

按照这些步骤查看和重新计算您的法人（公司）中可用的所有分离提前期。

1. 转到 **主计划 \> 主计划 \> DDMRP \> 分离的提前期**。
1. 在 **分离的提前期** 页面上，根据需要浏览和筛选列表以查找您要查找的信息。 若要查看物料的更多信息，请在 **物料编号** 列中选择其链接。
1. 如果您要重新计算任何物料的分离提前期，请选择该物料，然后在操作窗格中选择 **计算分离的提前期**。 此时将显示 **计算分离的提前期** 对话框。 此对话框的使用方式就像您在 **物料覆盖率** 页面上为同一物料[计算分离的提前期](#calc-lead-time)时的使用方式一样。
