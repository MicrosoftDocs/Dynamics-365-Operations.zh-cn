---
title: 有限保质期的产品的主计划
description: 本文介绍如何设置和使用考虑易腐产品保质期的计划功能。
author: t-benebo
ms.date: 08/10/2022
ms.topic: article
ms.search.form: ReqPlanSched, CustTable, EcoResProductDetailsExtended, InventModelGroup
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: benebotg
ms.search.validFrom: 2020-08-10
ms.dyn365.ops.version: 10.0.28
ms.openlocfilehash: 95c905cbcc3c057dbccf2b7d6e894b1e99ddfba5
ms.sourcegitcommit: 203c8bc263f4ab238cc7534d4dd902fd996d2b0f
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/23/2022
ms.locfileid: "9337123"
---
# <a name="master-planning-for-products-with-limited-shelf-life"></a>有限保质期的产品的主计划

[!include [banner](../../includes/banner.md)]

保质期是产品可以储存到不能再使用或销售的时间。 对于保质期有限的产品，您可能会使用先到期先出 (FEFO) 仓库策略，根据剩余保质期确定商品使用和销售的优先级。 此仓储策略适用于食品、药品和其他以短存储时间为特征的商品。 根据 FEFO，仓库中的商品就像超市货架上的货物一样存放：保质期长的产品被放在货架深处，让剩余保质期较短的产品先发货。

## <a name="using-shelf-life-in-master-planning"></a>在主计划中使用保质期

本节说明主计划如何建议保质期商品的供应。

当您运行主计划时，它会生成建议的计划订单（供应），以满足您的需求并最大限度地减少延迟。 如果您的计划包括保质期有限的物品，计划计算会变得更加复杂，因为计划不仅要尽量减少延误，还要在到期前使用现有供应。 计划必须尝试在较晚到期的供应之前使用最接近到期日期的供应。 因此，主计划会试图按以下顺序实现以下目标：

1. 尽量减少延迟总和。
1. 最大化 FEFO 供应总量。
1. 尽量减少库存补货。

在某些情况下，前两个目标之间可能存在冲突，必须做出选择：您是要延迟装运，还是要使用较晚到期的供应而不是较早到期的供应？ 为在主计划期间解决此冲突，系统会优先考虑最大限度地减少延迟，而不是用完即将到期的供应。 通常，当可能存在按期间延迟和覆盖时，就会发生此类冲突。 因此，我们建议您使用比商品的保质期更短的覆盖期。 其他类型的覆盖（如要求）不太可能遇到此类冲突。

## <a name="set-up-shelf-life"></a>设置保质期

### <a name="configure-each-master-plan-to-consider-shelf-life"></a>配置每个主计划以考虑保质期

默认情况下，主计划不考虑保质期。 使用以下过程为需要的每个主计划启用保质期计算。

1. 转到 **主计划 \> 设置 \> 计划 \> 主计划**。
1. 在列表窗格中选择现有计划或创建新计划。
1. 在 **常规** 快速选项卡上，将 **使用保质期日期** 选项设置为 *是*。

### <a name="configure-tracking-dimension-groups-to-track-the-batch-dimension"></a>配置跟踪维度组以跟踪批次维度

只有在批次维度跟踪商品时，才能跟踪商品的保质期。 换句话说，批次引用和所需日期必须在收货或制造时，通过商品的每个库存交易记录进行记录。 要管理此选项，设置一个或多个跟踪维度组来执行所需的跟踪，然后根据需要将相关商品分配给这些组。

使用以下过程设置跟踪维度组来跟踪批次维度。

1. 转到 **产品信息管理 \> 设置 \> 维度和变型组 \> 跟踪维度组**。
1. 按以下步骤之一：

    - 在“操作窗格”中，选择 **新建** 创建新跟踪维度组。 输入名称和描述，然后在操作窗格上选择 **保存**。
    - 在列表窗格中，选择要设置以跟踪批次维度的现有跟踪维度组。

1. 在 **跟踪维度** 快速选项卡的 **批号** 行中，选中 **有效** 和 **实际库存** 列中的复选框。

### <a name="set-up-shelf-life-for-a-product"></a>设置产品的保质期

使用以下过程为产品设置保质期。

1. 转到 **产品信息管理 \> 产品 \> 已发布产品**。
1. 创建或打开要设置的产品。
1. 要使用保质期设置，在 **常规** 快速选项卡上，将 **跟踪维度组** 字段设置为被设置为跟踪批次维度的跟踪维度组。 只有在首次创建产品时才能设置此字段。 无法更改现有产品的值。
1. 在 **管理库存** 快速选项卡上，设置以下字段：

    - **建议保质期（天）** – 指定检查此产品的一个批次以确保其适合使用或转售的期限（以天为单位）。 此字段的值将被添加到批次的 *制造日期* 来确定其 *建议保质期*。 您可以将系统配置为在批次接近建议保质期时生成质检订单。
    - **保质期（天）** – 指定此产品的一个批次到期前的天数。 此值将被添加到 *制造日期* 以确定 *到期日期*。 批次在此日期之后将被视为不可用。
    - **最佳使用期限（天）** – 指定此产品的一个批次被视为仍可销售但不能再保留其某些原始特性的期限（以天为单位）。 此值将被添加到 *制造日期* 以确定 *最佳使用日期*。 您可以运行报表来识别已过最佳使用日期的库存。 

### <a name="set-a-sellable-days-rule-for-each-customer"></a>为每个客户设置适售期规则

*适售期* 功能可确保不会将即将到期的批次的产品发给客户。 此外，它还确保在将产品发给客户时，交货后仍有足够的适售期天数。

要使用适售期功能，您必须为每个客户定义应用于每个产品（或产品组）的适售期天数。 您必须手动完成此过程，因为它没有数据实体。

使用以下过程为每个客户设置每个产品的适售期。

1. 转到 **销售和市场营销 \> 客户 \> 所有客户**。
1. 查找并选择您要设置的客户。
1. 在操作窗格的 **销售** 选项卡的 **设置** 组中，选择 **销售 \> 适售期**。
1. 在 **客户的适售期** 页面上，网格将列出每个产品或产品组的现有适售期规则。 根据需要使用操作窗格上的按钮在网格中添加或编辑行。 提供了一个 **筛选器** 来帮助您查找现有行。
1. 对于每一行，设置以下字段：

    - **物料代码** – 选择以下值之一以指定将受影响的物料范围：

        - *表* – 此行适用于特定物料。
        - *组* – 此行适用于特定物料组。
        - *全部* – 此行适用于全部物料。

    - **物料关系** – 如果将 **物料代码** 字段设置为 *表*，选择特定物料。 如果将 **物料代码** 字段设置为 *组*，选择物料组。 如果将 **物料代码** 字段设置为 *全部*，此字段不可用。
    - **适售期** – 输入客户必须在批次到期之前销售匹配产品的最短天数。 适售期值基于销售订单上匹配产品的要求收货日期（或确认收货日期，如果已定义）。
    - *（其他产品维度）* – 要进一步限制行的范围，根据需要指定其他维度值（如 **尺寸** 和 **颜色**）。 要控制在网格中显示哪些维度，在操作窗格上选择 **显示维度**。

### <a name="set-up-all-relevant-products-so-that-they-are-fefo-date-controlled"></a>设置所有相关产品，使其受 FEFO 日期控制

要使适售期发挥作用，每个相关商品必须属于选中 **受先过期先出日期控制** 复选框的物料模型组。

使用以下过程设置物料模型组，让它支持适售期功能。

1. 转到 **库存管理 \> 设置 \> 库存 \> 物料模型组**。
1. 在列表窗格中选择一个现有组，或者在操作窗格上选择 **新建** 创建一个新组。
1. 在 **库存策略** 快速选项卡上，选中 **受先过期先出日期控制** 复选框。
1. 根据需要为组设置其他字段。

使用以下过程查看或设置产品所属的物料模型组。

1. 转到 **产品信息管理 \> 产品 \> 已发布产品**。
1. 打开要检查或编辑的产品。
1. 在 **常规** 快速选项卡上，将 **物料模型组** 字段设置为选中 **受先过期先出日期控制** 复选框的组。

## <a name="example-1-simple-fefo-10-day-period-zero-days-of-lead-time"></a>示例 1：简单的 FEFO，10 天期限，零天提前期

此示例显示了保质期的基本示例：在供应订单和需求之间进行挂钩是为了满足系统的以下目标：

- 尽量减少延迟总和。
- 最大化 FEFO 供应总量。
- 尽量减少库存补货。

系统具有以下物料和主计划设置：

- **覆盖范围代码（补货策略）：** 期间 
- **覆盖期间：** 10 天（等于保质期）
- **保质期：** 10 天
- **适售期：** 0 天
- **提前期：** 0 天
- **负天数：** 0 天
- **计划订单类型（物料的默认订单设置）：** 采购订单

系统中存在物料的以下销售订单：

- **SO1：** 数量 (qty) = 2，要求交货日期 = 今天 + 1 天
- **SO2：** 数量 = 1，要求交货日期 = 今天 + 4 天
- **SO3：** 数量 = 1，要求交货日期 = 今天 + 5 天

所有这些销售订单都会为物料创造需求。

物料存在以下供应：

- **现有库存量：** 数量 = 1，到期日期 = 今天 + 5 天
- **采购订单 1（PO1）：** 收货日期 = 今天 + 2 天，数量 = 1，到期日期 = 今天 + 4 天

系统创建一个可以满足此需求的供应列表，按到期日期对列表进行排序（使用 FEFO）。

主计划在供应和需求之间创建所需的挂钩。 另外还根据供应列表创建任何所需的需求（使用 FEFO），考虑可用性日期。

- SO1 可以按现有数量履行，但不能按 PO1 履行，因为 PO1 的可用性日期比 SO1 要求的晚一天。 因此，SO1 生成一个商品单位的需求。
- SO2 可以被 PO1 覆盖，因为 PO1 会在要求的时间前到达，到期日期仍然有效。 因此，SO2 要求完全由 PO1 覆盖。
- SO3 未被覆盖，因为资源不可用。 因此，SO3 生成一个商品单位的需求。

为了覆盖所有其余要求，系统必须创建以下计划采购订单：

- **PPO1：** 收货日期 = 今天，数量 = 2，到期日期 = 今天 + 10 天

下表汇总了此结果。

| 需求量 | 限定标准 |
|---|---|
| **SO1：** 交货日期 = 今天 + 1 天，数量 = 2 | <p>**现有量：** 数量 = 1，到期日期 = 今天 + 5 天</p><p>**PPO1：** 收货日期 = 今天，数量 = 1，到期日期 = 今天 + 10 天</p> |
| **SO2：** 交货日期 = 今天 + 4 天，数量 = 1 | **PO1：** 收货日期 = 今天 + 2 天，数量 1，到期日期 = 今天 + 4 天 |
| **SO3：** 交货日期 = 今天 + 5 天，数量 = 1 | **PPO1：** 收货日期 = 今天，数量 = 2，到期日期 = 今天 + 10 天 |

下图显示此示例的时间线。

![示例 1：简单的 FEFO，10 天期限，零天提前期。](media/fefo-example-1.png "示例 1：简单的 FEFO，10 天期限，零天提前期")

## <a name="example-2-simple-fefo-requirement-three-days-of-lead-time"></a>示例 2：简单的 FEFO，要求，提前三天

此示例显示系统试图最小化延迟有时会导致过度订购的情况。

系统具有以下物料和主计划设置：

- **覆盖范围代码（补货策略）：** 要求
- **保质期：** 10 天
- **适售期：** 0 天
- **提前期：** 按以下供应商贸易协议建立：

    - **贸易协议 1：** 如果数量 = 1，提前期 = 4
    - **贸易协议 2：** 如果数量 = 2，提前期 = 3

- **负天数：** 0 天
- **计划订单类型（物料的默认订单设置）：** 采购订单

系统中存在以下销售订单：

- **SO1：** 数量 = 2，要求交货日期 = 今天 + 3 天

此需求由现有供应和已确认的采购订单覆盖：

- **现有库存量：** 可用 = 今天，数量 = 1，到期日期 = 今天 + 2 天
- **PO1：** 收货日期 = 今天 + 3 天，数量 = 1，到期日期 = 今天 + 4 天

SO1 不能由现有库存量履行，因为库存到期日期早于装运日期。 PO1 只需数量为 1 即可覆盖 SO1 要求。 因此，SO1 生成一个商品单位的需求。 为覆盖此要求，系统会创建计划采购订单 (PPO1)。

系统有两个贸易协议（一个针对数量 = 1，提前期 = 4 天，一个针对数量 = 2，提前期 = 3 天）。 因此，系统将尝试通过创建满足第二个贸易协议的计划采购订单 (PPO1) 来最大限度地减少延迟。 结果是超交（数量 = 2，到期日期 = 今天 + 10 天）。

下表汇总了此结果。

| 需求量 | 限定标准 |
|---|---|
| **SO1：** 交货日期 = 今天 + 3 天，数量 = 2 | <p>**PO1：** 收货日期 = 今天 + 3 天，数量 = 1，到期日期 = 今天 + 4 天</p><p>**PPO1：** 收货日期 = 今天 + 3 天，数量 = 1，到期日期 = 今天 + 10 天</p> |

下图显示此示例的时间线。

![示例 2：简单的 FEFO，要求，提前三天。](media/fefo-example-2.png "示例 2：简单的 FEFO，要求，提前三天")

## <a name="example-3-simple-fefo-requirement-three-days-of-lead-time-five-sellable-days"></a>示例 3：简单的 FEFO，要求，提前三天，五天适售期

此示例显示了为商品添加适售期时保质期的工作原理。

系统具有以下物料和主计划设置：

- **覆盖范围代码（补货策略）：** 要求
- **保质期：** 10 天
- **适售期：** 5 天
- **提前期：** 5 天
- **负天数：** 0 天
- **计划订单类型（物料的默认订单设置）：** 采购订单

系统中存在以下销售订单：

- **SO1：** 数量 = 2，要求交货日期 = 今天 + 2 天
- **SO2：** 数量 = 1，要求交货日期 = 今天 + 3 天
- **SO3：** 数量 = 1，要求交货日期 = 今天 + 5 天

此需求可由现有供应和已确认的采购订单覆盖：

- **现有库存量：** 可用 = 今天，数量 = 1，到期日期 = 今天 + 6 天
- **PO1：** 收货日期 = 今天 + 2 天，数量 = 3，到期日期 = 今天 + 10 天

系统根据供应 (FEFO) 列表和可用性日期创建挂钩候选者列表。 因此，SO1 无法通过现有库存量履行，因为该库存在客户要求的适售期（要求收货日期 + 5 天）结束之前到期。 PO1 可以用两个单位覆盖 SO1 要求，用一个单位覆盖 SO2 要求。 因此，只有 SO3 仍然有未覆盖的一个商品单位的需求。 为覆盖此要求，系统会创建以下计划采购订单：

- **PP01：** 收货日期 = 今天 + 5 天，数量 = 1，到期日期 = 今天 + 10 天

下表汇总了此结果。

| 需求量 | 限定标准 |
|---|---|
| **SO1：** 交货日期 = 今天 + 2 天，数量 = 2 | **PO1：** 收货日期 = 今天 + 2 天，数量 = 2，到期日期 = 今天 + 10 天 |
| **SO2：** 交货日期 = 今天 + 3 天，数量 = 1 | **PO1：** 收货日期 = 今天 + 2 天，数量 = 1，到期日期 = 今天 + 10 天 |
| **SO3：** 交货日期 = 今天 + 5 天，数量 = 1 | **PPO1：** 收货日期 = 今天 + 5 天，数量 = 1，到期日期 = 今天 + 10 天 |

下图显示此示例的时间线。

![示例 3：简单的 FEFO，要求，提前三天，五天适售期。](media/fefo-example-3.png "示例 3：简单的 FEFO，要求，提前三天，五天适售期")

## <a name="example-4-simple-fefo-period-lead-time-depends-on-the-quantity"></a>示例 4：简单的FEFO，期限，提前期取决于数量

此示例显示系统试图最小化延迟有时会导致过度订购的情况。

系统具有以下物料和主计划设置：

- **覆盖范围代码（补货策略）：** 期间
- **覆盖期间：** 10 天（等于保质期）
- **保质期：** 10 天
- **适售期：** 0 天
- **提前期：** 按以下供应商贸易协议建立：

    - **贸易协议 1：** 如果数量 = 1，提前期 = 5
    - **贸易协议 2：** 如果数量 = 2，提前期 = 0

- **负天数：** 0 天
- **计划订单类型（物料的默认订单设置）：** 采购订单

系统中存在以下销售订单：

- **SO1：** 数量 = 1，要求交货日期 = 今天
- **SO2：** 数量 = 1，要求交货日期 = 今天 + 6 天

此需求部分可以由以下已确认采购订单的现有供应覆盖：

- **PO1：** 收货日期 = 今天 + 1 天，数量 = 1，到期日期 = 今天 + 2 天
- **PO2：** 收货日期 = 今天 + 3 天，数量 = 1，到期日期 = 今天 + 7 天

系统有两个贸易协议（一个针对数量 = 1，提前期 = 5 天，一个针对数量 = 2，提前期 = 0 天）。 因此，系统将尝试通过创建以下满足第二个贸易协议的计划采购订单来最大限度地减少延迟：

- **PP01：** 收货日期 = 今天，数量 = 2，到期日期 = 今天 + 10 天

SO1 将由 PPO1 的一个单位覆盖。 SO2 将由 PO2 覆盖，因为 PO2 的到期时间早于 PPO1。

下表汇总了此结果。

| 需求量 | 限定标准 |
|---|---|
| **SO1：** 交货日期 = 今天，数量 = 1 | **PPO1：** 收货日期 = 今天，数量 = 1，到期日期 = 今天 + 10 天 |
| **SO2：** 交货日期 = 今天 + 6 天，数量 = 1 | **PO2：** 收货日期 = 今天 + 3 天，数量 = 1，到期日期 = 今天 + 7 天 |

> [!NOTE]
> 未使用 PO1，因为它对于 S01 来说到达时间太晚，并且在 S02 交货前到期。 根据贸易协议 2，PPO1 超额订购了一个单位，以使提前期为 0（零）。

下图显示此示例的时间线。

![示例 4：简单的FEFO，期限，提前期取决于数量。](media/fefo-example-4.png "示例 4：简单的FEFO，期限，提前期取决于数量")

## <a name="example-5-simple-fefo-requirement-10-negative-days"></a>示例 5：简单的 FEFO，要求，负 10 天

<!-- KFM: This is more of a negative days example than a shelf life example. We should point out more explicitly how shelf life affects this situation (or maybe otherwise remove this example). -->

此示例显示了为商品添加大量负天数时保质期的工作原理。 负数天数是在订购负库存商品的补货前您愿意等待的天数。 除非超过负天数，否则系统不会创建供应。

系统具有以下物料和主计划设置：

- **覆盖范围代码（补货策略）：** 要求
- **提前期：** 0 天
- **负天数：** 10 天
- **计划订单类型（物料的默认订单设置）：** 采购订单

系统中存在以下销售订单：

- **SO1：** 数量 = 1，要求交货日期 = 今天

此需求可以由以下已确认采购订单的现有供应覆盖：

- **PO1：** 收货日期 = 今天 + 3 天，数量 = 1，到期日期 = 今天 + 5 天

由于系统配置为允许负 10 天，因此使用 PO1 覆盖 SO1 的需求，即使结果将延迟三天，因为 SO1 会在 PO1 到达之前创建负库存。 不创建计划采购订单，即使提前期为 0（零）并且创建计划采购订单会减少延迟。

下表汇总了此结果。

| 需求量 | 限定标准 |
|---|---|
| **SO1：** 交货日期 = 今天，数量 = 1 | **PO1：** 收货日期 = 今天 + 3 天，数量 = 1，到期日期 = 今天 + 5 天 |

下图显示此示例的时间线。

![示例 5：简单的 FEFO，要求，负 10 天。](media/fefo-example-5.png "示例 5：简单的 FEFO，要求，负 10 天")

## <a name="example-6-simple-fefo-requirement-five-negative-days"></a>示例 6：简单的 FEFO，要求，负 5 天

此示例显示了当商品的负天数少于其保质期时保质期的工作原理。

系统具有以下物料和主计划设置：

- **覆盖范围代码（补货策略）：** 要求
- **适售期：** 0 天
- **提前期：** 0 天
- **负天数：** 5 天
- **计划订单类型（物料的默认订单设置）：** 采购订单

系统中存在以下销售订单：

- **SO1：** 数量 = 2，要求交货日期 = 今天

此需求可以由以下已确认采购订单的现有供应覆盖：

- **PO1：** 收货日期 = 今天，数量 = 1，到期日期 = 今天 + 1 天
- **PO2：** 收货日期 = 今天 + 2 天，数量 = 1，到期日期 = 今天 + 3 天

但是，系统必须遵守装运商品在装运时不能过期的限制。 因此，PO2 和 PO1 不能同时用于 SO1，因为 PO1 将在 PO2 到达之前过期。 系统会创建以下计划采购订单来覆盖 SO1 的需求：

- **PPO1：** 收货日期 = 今天，数量 = 1，到期日期 = 今天 + 10 天

系统可以利用负五天，使用 PO2 和 PPO1 覆盖 SO1。 但是，此方法会导致交货延迟到 PO2 到达，同时 PO1 也会过期。 因此，系统使用 PPO1 和 PO1 覆盖 SO1。

下表汇总了此结果。

| 需求量 | 限定标准 |
|---|---|
| **SO1：** 交货日期 = 今天，数量 = 2 | <p>**PO1：** 收货日期 = 今天，数量 = 1，到期日期 = 今天 + 1 天</p><p>**PPO1：** 收货日期 = 今天，数量 = 1，到期日期 = 今天 + 10 天</p> |

下图显示此示例的时间线。

![示例 6：简单的 FEFO，要求，负 5 天。](media/fefo-example-6.png "示例 6：简单的 FEFO，要求，负 5 天")
