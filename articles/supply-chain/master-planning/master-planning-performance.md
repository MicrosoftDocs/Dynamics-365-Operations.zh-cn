---
title: 改进主计划绩效
description: 本主题介绍可帮助您提高主计划绩效或诊断问题的各种选项。
author: t-benebo
manager: tfehr
ms.date: 12/18/2019
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: ReqCreatePlanWorkspace
audience: Application User
ms.reviewer: kamaybac
ms.custom: ''
ms.assetid: ''
ms.search.region: Global
ms.search.industry: Manufacturing
ms.author: benebotg
ms.search.validFrom: 2019-05-31
ms.dyn365.ops.version: AX 10.0.0
ms.openlocfilehash: 380329cbeaa1fc2a2691c8165bc57483d1420aa1
ms.sourcegitcommit: 38d40c331c8894acb7b119c5073e3088b54776c1
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 01/15/2021
ms.locfileid: "5005069"
---
# <a name="improve-master-planning-performance"></a><span data-ttu-id="dbc24-103">改善主计划性能</span><span class="sxs-lookup"><span data-stu-id="dbc24-103">Improve master planning performance</span></span>

[!include [banner](../includes/banner.md)]

<span data-ttu-id="dbc24-104">本主题介绍可帮助您提高主计划绩效或诊断问题的各种选项。</span><span class="sxs-lookup"><span data-stu-id="dbc24-104">This topic explains the various options that can help you improve the performance of master planning or troubleshoot issues.</span></span> <span data-ttu-id="dbc24-105">包括有关参数、设置，以及建议的配置和操作的信息。</span><span class="sxs-lookup"><span data-stu-id="dbc24-105">It includes information about parameters and settings, as well as recommended configurations and actions.</span></span> <span data-ttu-id="dbc24-106">另外还包括需要执行长时间运行的主计划作业时应考虑的所有重要参数的摘要。</span><span class="sxs-lookup"><span data-stu-id="dbc24-106">Also included is a summary of all the important parameters that you should consider when you have long-running master planning jobs.</span></span>

<span data-ttu-id="dbc24-107">本主题面向有能力进行故障诊断的系统管理员或 IT 用户。</span><span class="sxs-lookup"><span data-stu-id="dbc24-107">This topic is intended for system admins or IT users who have the capability to troubleshoot.</span></span> <span data-ttu-id="dbc24-108">也面向生产或供应规划员，因为其中包含有关与业务计划需求有关的参数的信息。</span><span class="sxs-lookup"><span data-stu-id="dbc24-108">It's also intended for production or supply planners because it includes information about parameters that are related to business planning requirements.</span></span> 

## <a name="parameters-related-to-master-planning-performance"></a><span data-ttu-id="dbc24-109">与主计划绩效有关的参数</span><span class="sxs-lookup"><span data-stu-id="dbc24-109">Parameters related to master planning performance</span></span>

<span data-ttu-id="dbc24-110">许多参数会影响主计划的运行时间，因此应加以注意。</span><span class="sxs-lookup"><span data-stu-id="dbc24-110">Various parameters influence the running time of master planning and should be considered.</span></span>

### <a name="number-of-threads"></a><span data-ttu-id="dbc24-111">线程数</span><span class="sxs-lookup"><span data-stu-id="dbc24-111">Number of threads</span></span>

<span data-ttu-id="dbc24-112">可通过 **线程数** 参数调整主计划编制流程，以便在使用特定数据集时改善效果。</span><span class="sxs-lookup"><span data-stu-id="dbc24-112">The **Number of threads** parameter lets you adjust the master scheduling process to help improve performance on the specific data set.</span></span> <span data-ttu-id="dbc24-113">此参数指定将用于运行主计划的线程总数。</span><span class="sxs-lookup"><span data-stu-id="dbc24-113">This parameter specifies the total number of threads that will be used to run master planning.</span></span> <span data-ttu-id="dbc24-114">它会导致主计划运行并行化，这有助于缩短运行时间。</span><span class="sxs-lookup"><span data-stu-id="dbc24-114">It causes parallelization of the master planning run, which helps decrease the running time.</span></span> 

<span data-ttu-id="dbc24-115">可设置 **主计划运行** 对话框中的 **线程数** 参数。</span><span class="sxs-lookup"><span data-stu-id="dbc24-115">You can set the **Number of threads** parameter in the **Master planning run** dialog box.</span></span> <span data-ttu-id="dbc24-116">若要打开此对话框，请转到 **主计划 \> 主计划 \> 运行 \> 主计划**，或在 **主计划** 工作区中选择 **运行**。</span><span class="sxs-lookup"><span data-stu-id="dbc24-116">To open this dialog box, go to **Master planning \> Master planning \> Run \> Master planning**, or select **Run** in the **Master planning** workspace.</span></span> <span data-ttu-id="dbc24-117">若要确定此参数的最佳值，必须依赖试错流程。</span><span class="sxs-lookup"><span data-stu-id="dbc24-117">To determine the best value for this parameter, you will have to rely on a trial-and-error process.</span></span> <span data-ttu-id="dbc24-118">但是，可使用以下公式计算初始值：</span><span class="sxs-lookup"><span data-stu-id="dbc24-118">However, you can use the following formulas to calculate an initial value:</span></span>

- <span data-ttu-id="dbc24-119">**如果您的行业是制造业：**（线程数）=（计划订单数 ÷ 1,000）</span><span class="sxs-lookup"><span data-stu-id="dbc24-119">**If your industry is manufacturing:** (Number of threads) = (Number of planned orders ÷ 1,000)</span></span>
- <span data-ttu-id="dbc24-120">**否则：**（线程数）=（物料数 ÷ 1,000）</span><span class="sxs-lookup"><span data-stu-id="dbc24-120">**Otherwise:** (Number of threads) = (Number of items ÷ 1,000)</span></span>

<span data-ttu-id="dbc24-121">主计划期间使用的帮助程序数必须小于或等于批处理服务器上允许的最大线程数。</span><span class="sxs-lookup"><span data-stu-id="dbc24-121">The number of helpers used during master planning must be less than or equal to the maximum number of threads that are allowed on the batch server.</span></span> <span data-ttu-id="dbc24-122">如果帮助程序数超过了批处理服务器上的线程数，多余线程不起任何作用。</span><span class="sxs-lookup"><span data-stu-id="dbc24-122">If the number of helpers exceeds the number of threads on the batch server, the extra threads won't do any work.</span></span>

> [!NOTE]
> <span data-ttu-id="dbc24-123">将 **线程数** 参数设置为 **0**（零）会增加主计划运行时间。</span><span class="sxs-lookup"><span data-stu-id="dbc24-123">Setting the **Number of threads** parameter to **0** (zero) increases the master planning running time.</span></span> <span data-ttu-id="dbc24-124">因此，建议设置的值始终大于 0。</span><span class="sxs-lookup"><span data-stu-id="dbc24-124">Therefore, we recommend that you always set a value that is more than 0.</span></span>

### <a name="number-of-tasks-in-helper-task-bundle"></a><span data-ttu-id="dbc24-125">帮助程序任务捆绑中的任务数</span><span class="sxs-lookup"><span data-stu-id="dbc24-125">Number of tasks in helper task bundle</span></span>

<span data-ttu-id="dbc24-126">通过更改 **任务捆绑中的任务数** 设置（即捆绑大小），可能能够缩短运行时间。</span><span class="sxs-lookup"><span data-stu-id="dbc24-126">By changing the **Number of tasks in task bundle** setting (that is, the bundle size), you might be able to decrease the running time.</span></span> <span data-ttu-id="dbc24-127">此设置控制一个帮助程序一起计划的物料的数量。</span><span class="sxs-lookup"><span data-stu-id="dbc24-127">This setting controls the number of items that are planned together by a single helper.</span></span>

<span data-ttu-id="dbc24-128">可设置 **主计划参数** 页（**主计划 \> 设置 \> 主计划参数**）的 **常规** 选项卡上 **绩效** 部分中的 **任务捆绑中的任务数** 参数。</span><span class="sxs-lookup"><span data-stu-id="dbc24-128">You can set the **Number of tasks in task bundle** parameter in the **Performance** section on the **General** tab of the **Master planning parameters** page (**Master planning \> Setup \> Master planning parameters**).</span></span> <span data-ttu-id="dbc24-129">此参数的最佳值取决于您的数据。</span><span class="sxs-lookup"><span data-stu-id="dbc24-129">The best value for this parameter depends on your data.</span></span> <span data-ttu-id="dbc24-130">因此，建议您从值 **1** 开始，然后通过试错流程确定您的设置的最佳值。</span><span class="sxs-lookup"><span data-stu-id="dbc24-130">Therefore, we recommend that you start with a value of **1**, and then use a trial-and-error process to determine the best value for your setup.</span></span>

<span data-ttu-id="dbc24-131">我们通常建议您在物料数极大（成千上万）时增加任务数。</span><span class="sxs-lookup"><span data-stu-id="dbc24-131">In general, we recommend that you increase the number of tasks when the number of items is very large (in the hundreds of thousands).</span></span> <span data-ttu-id="dbc24-132">否则，应减少任务数。</span><span class="sxs-lookup"><span data-stu-id="dbc24-132">Otherwise, you should decrease the number of tasks.</span></span> <span data-ttu-id="dbc24-133">对于以下特定行业，请考虑以下建议：</span><span class="sxs-lookup"><span data-stu-id="dbc24-133">For the following specific industries, consider these recommendations:</span></span>

- <span data-ttu-id="dbc24-134">在零售和配送行业，独立物料很多，请使用大量帮助程序，因为物料之间不存在依赖关系。</span><span class="sxs-lookup"><span data-stu-id="dbc24-134">In the retail and distribution industries where there are many independent items, use many helpers because there is no dependency between items.</span></span> 
- <span data-ttu-id="dbc24-135">在制造行业，物料清单 (BOM) 和共用子组件很多，请使用较少帮助程序，因为物料之间的依赖关系可能会导致等待时间。</span><span class="sxs-lookup"><span data-stu-id="dbc24-135">In the manufacturing industry where there are many bills of materials (BOMs) and shared subcomponents, use fewer helpers because dependencies between items might cause waiting times.</span></span>

> [!TIP]
> <span data-ttu-id="dbc24-136">如果遇到了性能问题，建议将 **任务捆绑中的帮助程序数** 设置减少为 **1**。</span><span class="sxs-lookup"><span data-stu-id="dbc24-136">If you have performance issues, we recommend that you reduce the **Number of helpers in task bundle** setting to **1**.</span></span> <span data-ttu-id="dbc24-137">然后可以开始执行试错流程，以便找到您的设置的最佳值。</span><span class="sxs-lookup"><span data-stu-id="dbc24-137">You can then start the trial-and-error process to find the best value for your setup.</span></span> <span data-ttu-id="dbc24-138">一般来说，一个物料的处理时间比其余物料长时，通常会出现性能问题。</span><span class="sxs-lookup"><span data-stu-id="dbc24-138">In general, performance issues occur when one item takes longer to process than the remaining items.</span></span> <span data-ttu-id="dbc24-139">在此情况下，您会发现主计划运行中两个状态为 **覆盖** 的后续任务所用运行时间量相差很大。</span><span class="sxs-lookup"><span data-stu-id="dbc24-139">In this case, you will see that two subsequent tasks that have a status of **Coverage** in the master planning run take significantly different amounts of time to run.</span></span> <span data-ttu-id="dbc24-140">极端情况下，相差可能高达 30 分钟。</span><span class="sxs-lookup"><span data-stu-id="dbc24-140">In extreme cases, this difference might be as much as 30 minutes.</span></span> <span data-ttu-id="dbc24-141">可以通过查看每个任务的持续时间推导运行任务所用时间量。</span><span class="sxs-lookup"><span data-stu-id="dbc24-141">You can infer the amount of time that tasks take to run by looking at the duration of each task.</span></span>

### <a name="use-of-cache"></a><span data-ttu-id="dbc24-142">暂存区的使用</span><span class="sxs-lookup"><span data-stu-id="dbc24-142">Use of cache</span></span>

<span data-ttu-id="dbc24-143">可通过 **暂存区的使用** 参数调整主计划编制流程，以便在使用特定数据集时效果更出色。</span><span class="sxs-lookup"><span data-stu-id="dbc24-143">The **Use of cache** parameter lets you adjust the master scheduling process to help it perform better on the specific data set.</span></span> <span data-ttu-id="dbc24-144">例如，可通过调整此参数实现以下结果：</span><span class="sxs-lookup"><span data-stu-id="dbc24-144">For example, you can adjust it to achieve the following results:</span></span>

- <span data-ttu-id="dbc24-145">完成的缓存越多，数据存储器中收集的数据越多。</span><span class="sxs-lookup"><span data-stu-id="dbc24-145">If more caching is done, more data is collected in data memory.</span></span> <span data-ttu-id="dbc24-146">预计以后会再次使用这些数据。</span><span class="sxs-lookup"><span data-stu-id="dbc24-146">The expectation is that the data will be used again later.</span></span> <span data-ttu-id="dbc24-147">如果数据在存储器中，可以节约一些数据库请求。</span><span class="sxs-lookup"><span data-stu-id="dbc24-147">If the data is in memory, you might save some database requests.</span></span> <span data-ttu-id="dbc24-148">但是，完成的缓存越多，需要的存储器越大。</span><span class="sxs-lookup"><span data-stu-id="dbc24-148">However, if more caching is done, memory requirements increase.</span></span>
- <span data-ttu-id="dbc24-149">如果完成的缓存越少，可能必须从数据库访存相同数据的频率越高。</span><span class="sxs-lookup"><span data-stu-id="dbc24-149">If less caching is done, the same data might have to be fetched from the database more often.</span></span> <span data-ttu-id="dbc24-150">此外，应用程序对象服务器 (AOS) 在整个流程中存储到内存中的数据越少。</span><span class="sxs-lookup"><span data-stu-id="dbc24-150">Additionally, Application Object Server (AOS) stores little data in memory throughout the process.</span></span>

<span data-ttu-id="dbc24-151">很难预测哪个选项更好，因为每种情况都不仅依赖数据，还依赖硬件。</span><span class="sxs-lookup"><span data-stu-id="dbc24-151">It's difficult to predict which option will be better because each case depends not only on the data but also on the hardware.</span></span> <span data-ttu-id="dbc24-152">例如，因为缓存越少，对数据库服务器造成的负载就越大，所以如果数据库服务器已过载，则不太适合使用该选项。</span><span class="sxs-lookup"><span data-stu-id="dbc24-152">For example, because less caching causes additional load on the database server, it probably isn't a good idea to use that option if your database server is already overloaded.</span></span>

<span data-ttu-id="dbc24-153">可设置 **主计划参数** 页（**主计划 \> 设置 \> 主计划参数**）的 **常规** 选项卡上 **绩效** 部分中的 **暂存区的使用** 参数。</span><span class="sxs-lookup"><span data-stu-id="dbc24-153">You can set the **Use of cache** parameter in the **Performance** section on the **General** tab of the **Master planning parameters** page (**Master planning \> Setup \> Master planning parameters**).</span></span> <span data-ttu-id="dbc24-154">缓存的效果很大程度依赖于客户数据。</span><span class="sxs-lookup"><span data-stu-id="dbc24-154">The effectiveness of caching depends heavily on the customer data.</span></span> <span data-ttu-id="dbc24-155">例如，如果从不需要缓存数据，则将数据存储到计划编制流程结束为止只会浪费内存。</span><span class="sxs-lookup"><span data-stu-id="dbc24-155">For example, if cached data is never needed, you just waste memory if you store data until the end of the scheduling process.</span></span> <span data-ttu-id="dbc24-156">在此情况下，如果配置的缓存较少，性能可能上升，因为 AOS 需要的内存较少，并且会释放服务器资源供其他任务使用。</span><span class="sxs-lookup"><span data-stu-id="dbc24-156">In this case, if you configure less caching, performance might increase because AOS requires less memory and server resources are freed up for other tasks.</span></span>

> [!TIP]
> <span data-ttu-id="dbc24-157">总之，建议将 **暂存区的使用** 参数设置为 **最大值**，因为该参数应该是一项性能增强功能。</span><span class="sxs-lookup"><span data-stu-id="dbc24-157">In general, we recommend that you set the **Use of cache** parameter to **Maximum**, because the parameter is intended as a performance enhancing feature.</span></span> <span data-ttu-id="dbc24-158">如果在本地部署上运行，并且内存有限（大约 2 \[GB\]），则建议将此参数设置为 **最小值**。</span><span class="sxs-lookup"><span data-stu-id="dbc24-158">We recommend that you set the parameter to **Minimum** if you run on premises and have limited memory (approximately 2 gigabytes \[GB\]).</span></span>

### <a name="number-of-orders-in-firming-bundle"></a><span data-ttu-id="dbc24-159">固定捆绑销售中的订单数</span><span class="sxs-lookup"><span data-stu-id="dbc24-159">Number of orders in firming bundle</span></span>

<span data-ttu-id="dbc24-160">**固定捆绑销售中的订单数** 参数指定每个线程/批处理同时处理的订单总数。</span><span class="sxs-lookup"><span data-stu-id="dbc24-160">The **Number or orders in firming bundle** parameter specifies the total number of orders that will be processed at a time by each thread/batch.</span></span> <span data-ttu-id="dbc24-161">这会导致自动确定流程并行化。</span><span class="sxs-lookup"><span data-stu-id="dbc24-161">It causes parallelization of the autofirming process.</span></span>

<span data-ttu-id="dbc24-162">可设置 **主计划参数** 页（**主计划 \> 设置 \> 主计划参数**）的 **常规** 选项卡上 **绩效** 部分中的 **固定捆绑销售中的订单数** 参数。</span><span class="sxs-lookup"><span data-stu-id="dbc24-162">You can set the **Number or orders in firming bundle** parameter in the **Performance** section on the **General** tab of the **Master planning parameters** page (**Master planning \> Setup \> Master planning parameters**).</span></span> <span data-ttu-id="dbc24-163">自动确认流程的并行化基于必须一起处理的订单。</span><span class="sxs-lookup"><span data-stu-id="dbc24-163">Parallelization of the autofirming process is based on the orders that must be processed together.</span></span> <span data-ttu-id="dbc24-164">例如，如果此参数设置为 **50**，则每个线程或批处理一次性选取 50 个订单并一起处理。</span><span class="sxs-lookup"><span data-stu-id="dbc24-164">For example, if this parameter is set to **50**, each thread or batch task will pick up 50 orders at a time and process them together.</span></span> <span data-ttu-id="dbc24-165">建议通过试错流程找到最佳值。</span><span class="sxs-lookup"><span data-stu-id="dbc24-165">We recommend that you use a trial-and-error process to find the best value.</span></span> <span data-ttu-id="dbc24-166">但是，可使用以下公式计算初始值：</span><span class="sxs-lookup"><span data-stu-id="dbc24-166">However, you can use the following formula to calculate an initial value:</span></span>

<span data-ttu-id="dbc24-167">（每个捆绑销售的订单数）=（需求物料数 ÷ 线程数）</span><span class="sxs-lookup"><span data-stu-id="dbc24-167">(Number of orders per bundle) = (Number of demand items ÷ Number of threads)</span></span>

> [!NOTE]
> <span data-ttu-id="dbc24-168">如果将 **固定捆绑销售中的订单数** 参数设置为 **0**（零），则不会并行化自动确认流程。</span><span class="sxs-lookup"><span data-stu-id="dbc24-168">If you set the **Number of orders in firming bundle** parameter to **0** (zero), no parallelization of the autofirming process will occur.</span></span> <span data-ttu-id="dbc24-169">整个流程将对一个批处理任务运行，并且会具有累计运行时间。</span><span class="sxs-lookup"><span data-stu-id="dbc24-169">The whole process will run on a single batch task and have a cumulative running time.</span></span> <span data-ttu-id="dbc24-170">因此，主计划的运行时间将增加。</span><span class="sxs-lookup"><span data-stu-id="dbc24-170">Therefore, the running time of your master planning will increase.</span></span> <span data-ttu-id="dbc24-171">所以建议您将此参数设置为大于 **0**（零）的值。</span><span class="sxs-lookup"><span data-stu-id="dbc24-171">For this reason, we recommend that you set this parameter to a value that is more than **0** (zero).</span></span>

### <a name="time-fences"></a><span data-ttu-id="dbc24-172">时限</span><span class="sxs-lookup"><span data-stu-id="dbc24-172">Time fences</span></span>

<span data-ttu-id="dbc24-173">时限指定主计划计算将来多长时间范围内的计算和其他需求。</span><span class="sxs-lookup"><span data-stu-id="dbc24-173">Time fences specify how far in the future the calculations and other requirements must be calculated by master planning.</span></span> <span data-ttu-id="dbc24-174">时限越大，主计划的运行时间越久。</span><span class="sxs-lookup"><span data-stu-id="dbc24-174">The larger the time fence is, the longer it will take master planning to run.</span></span> <span data-ttu-id="dbc24-175">因此，请根据您的业务要求设置时限。</span><span class="sxs-lookup"><span data-stu-id="dbc24-175">Therefore, set the time fences according to your business requirements.</span></span> <span data-ttu-id="dbc24-176">有关时限的详细信息，请参阅[设置主计划](master-planning-setup.md)。</span><span class="sxs-lookup"><span data-stu-id="dbc24-176">For more information about time fences, see [Set up master planning](master-planning-setup.md).</span></span>

### <a name="actions"></a><span data-ttu-id="dbc24-177">行为</span><span class="sxs-lookup"><span data-stu-id="dbc24-177">Actions</span></span>

<span data-ttu-id="dbc24-178">还可以在时限中找到 **行动消息** 参数。</span><span class="sxs-lookup"><span data-stu-id="dbc24-178">Among the time fences, you can also find the **Action message** parameter.</span></span> <span data-ttu-id="dbc24-179">计算行动消息会导致主计划的运行时间更长。</span><span class="sxs-lookup"><span data-stu-id="dbc24-179">The calculation of action messages causes a longer running time for master planning.</span></span> <span data-ttu-id="dbc24-180">如果不定期（每天、每周等）分析和采用行动消息，请考虑在主计划运行期间关闭计算。</span><span class="sxs-lookup"><span data-stu-id="dbc24-180">If action messages aren't regularly analyzed and applied (daily, weekly, and so on), consider turning off the calculation during the master planning run.</span></span> <span data-ttu-id="dbc24-181">若要关闭计算，请在 **主计划** 页（**主计划 \> 设置 \> 计划 \> 主计划**）上，将 **行动消息** 时限设置为 **0**（零）。</span><span class="sxs-lookup"><span data-stu-id="dbc24-181">To turn off the calculation, on the **Master plans** page (**Master planning \> Setup \> Plans \> Master plans**), set the **Action message** time fence to **0** (zero).</span></span> <span data-ttu-id="dbc24-182">并确保为所有覆盖范围组关闭 **行动消息** 设置。</span><span class="sxs-lookup"><span data-stu-id="dbc24-182">Also make sure that the **Action message** setting is turned off for all the coverage groups.</span></span>

### <a name="futures"></a><span data-ttu-id="dbc24-183">预期</span><span class="sxs-lookup"><span data-stu-id="dbc24-183">Futures</span></span>

<span data-ttu-id="dbc24-184">计算预期会导致主计划的运行时间更长。</span><span class="sxs-lookup"><span data-stu-id="dbc24-184">The calculation of futures causes a longer running time for master planning.</span></span> <span data-ttu-id="dbc24-185">如果不计划 BOM，或者计划期间不必将延迟从供应传播到需求，请考虑在主计划期间关闭预期计算。</span><span class="sxs-lookup"><span data-stu-id="dbc24-185">If you aren't planning BOMs, or if delays don't have to be propagated from supply to demand during planning, consider turning off futures calculations during master planning.</span></span> <span data-ttu-id="dbc24-186">若要关闭这些计算，请将正在运行的主计划的 **预期** 时限设置为 **0**（零）。</span><span class="sxs-lookup"><span data-stu-id="dbc24-186">To turn off the calculations, set the **Futures** time fence to **0** (zero) for the master plan that you're running.</span></span> <span data-ttu-id="dbc24-187">并确保为所有覆盖范围组关闭 **预期** 设置。</span><span class="sxs-lookup"><span data-stu-id="dbc24-187">Also make sure that the **Futures** setting is turned off for all the coverage groups.</span></span>

## <a name="one-heavy-routine-at-a-time"></a><span data-ttu-id="dbc24-188">一次一个重大例程</span><span class="sxs-lookup"><span data-stu-id="dbc24-188">One heavy routine at a time</span></span>

<span data-ttu-id="dbc24-189">安排主计划时，请勿同时安排其他任何批处理作业。</span><span class="sxs-lookup"><span data-stu-id="dbc24-189">When you schedule master planning, don't schedule any other batch job at the same time.</span></span> <span data-ttu-id="dbc24-190">请务必小心，不要同时安排其他任何重大例程，如库存结转。</span><span class="sxs-lookup"><span data-stu-id="dbc24-190">Be especially careful that you don't schedule any other heavy routines, such as inventory close, at the same time.</span></span>

## <a name="review-the-session-log"></a><span data-ttu-id="dbc24-191">检查会话日志</span><span class="sxs-lookup"><span data-stu-id="dbc24-191">Review the session log</span></span>

<span data-ttu-id="dbc24-192">系统可收集有关主计划期间运行的任务的其他信息。</span><span class="sxs-lookup"><span data-stu-id="dbc24-192">The system can collect additional information about the tasks that run during master planning.</span></span> <span data-ttu-id="dbc24-193">若要让系统收集此信息，请开启 **主计划运行** 对话框中的 **跟踪处理时间** 设置。</span><span class="sxs-lookup"><span data-stu-id="dbc24-193">To have the system collect this information, turn on the **Track processing time** setting in the **Master planning run** dialog box.</span></span> <span data-ttu-id="dbc24-194">收集的信息可帮助您找到运行中的瓶颈。</span><span class="sxs-lookup"><span data-stu-id="dbc24-194">The information that is collected can help you find bottlenecks in the run.</span></span> <span data-ttu-id="dbc24-195">例如，如果 **帮助程序任务捆绑中的任务数** 参数设置为 **1**，则可识别运行时间最长的物料。</span><span class="sxs-lookup"><span data-stu-id="dbc24-195">For example, when the **Number of tasks in helper task bundle** parameter is set to **1**, you can identify the item that has the longest running time.</span></span> <span data-ttu-id="dbc24-196">也可以比较状态为 **覆盖** 的大量线程的运行时间，以及比较每个任务的持续时间。</span><span class="sxs-lookup"><span data-stu-id="dbc24-196">You can also compare the running times for the various threads that have a status of **Coverage** and compare the duration for each task.</span></span>

<span data-ttu-id="dbc24-197">若要查看系统的主计划运行，请执行以下步骤之一。</span><span class="sxs-lookup"><span data-stu-id="dbc24-197">To review the master planning runs of your system, follow one of these steps.</span></span>

- <span data-ttu-id="dbc24-198">在 **主计划** 工作区的下拉字段中选择一个主计划，然后在 **主计划** 磁贴中选择 **历史记录**。</span><span class="sxs-lookup"><span data-stu-id="dbc24-198">In the **Master planning** workspace, select a master plan in the drop-down field, and then on the **Master planning** tile, select **History**.</span></span> <span data-ttu-id="dbc24-199">选择一个作业，在快速选项卡上选择 **查询**，然后选择 **流程任务持续时间**。</span><span class="sxs-lookup"><span data-stu-id="dbc24-199">Select a job, select **Inquiries** on the FastTab, and then select **Process task duration**.</span></span>
- <span data-ttu-id="dbc24-200">在 **主计划** 页的左窗格中选择一个计划，然后在快速选项卡上选择 **历史记录**。</span><span class="sxs-lookup"><span data-stu-id="dbc24-200">On the **Master plans** page, select a plan in the left pane, and then select **History** on the FastTab.</span></span> <span data-ttu-id="dbc24-201">选择一个作业，在快速选项卡上选择 **查询**，然后选择 **流程任务持续时间**。</span><span class="sxs-lookup"><span data-stu-id="dbc24-201">Select a job, select **Inquiries** on the FastTab, and then select **Process task duration**.</span></span>

<span data-ttu-id="dbc24-202">查看会话日志时，请注意以下几点：</span><span class="sxs-lookup"><span data-stu-id="dbc24-202">When you review the session log, consider the following:</span></span>

- <span data-ttu-id="dbc24-203">**更新** 应该不用太长时间（通常应该最多 30 分钟），但是单线程的。</span><span class="sxs-lookup"><span data-stu-id="dbc24-203">**Update** should not take a long time (in general, it should take up to 30 minutes), however, it's single-threaded.</span></span>
- <span data-ttu-id="dbc24-204">**复制计划** 应该不用太长时间（应该大约一分钟）。</span><span class="sxs-lookup"><span data-stu-id="dbc24-204">**Copy plan** should not take a long time (it should take about one minute).</span></span>
- <span data-ttu-id="dbc24-205">**自动固定** 所用时间通常大约 30 分钟。</span><span class="sxs-lookup"><span data-stu-id="dbc24-205">**Auto firming** usually takes about 30 minutes.</span></span> <span data-ttu-id="dbc24-206">但是，可以高达数小时，具体取决于订单数量和物料的复杂程度。</span><span class="sxs-lookup"><span data-stu-id="dbc24-206">However, it can take up to multiple hours, depending on the number of orders and the complexity of the items.</span></span>
- <span data-ttu-id="dbc24-207">**自动固定** 的时间应该低于 **覆盖**。</span><span class="sxs-lookup"><span data-stu-id="dbc24-207">**Auto firming** should take less time than **Coverage**.</span></span>
- <span data-ttu-id="dbc24-208">**覆盖** 所用时间相对其他操作应该最长。</span><span class="sxs-lookup"><span data-stu-id="dbc24-208">**Coverage** should take the longest time relative to the rest.</span></span>
- <span data-ttu-id="dbc24-209">**行动** 和 **预期消息** 所用时间可能很长，具体取决于数据和 BOM 数量。</span><span class="sxs-lookup"><span data-stu-id="dbc24-209">**Action** and **Future message** can take a long time, depending on the data and the number of BOMs.</span></span>

## <a name="filtering-of-items"></a><span data-ttu-id="dbc24-210">筛选物料</span><span class="sxs-lookup"><span data-stu-id="dbc24-210">Filtering of items</span></span>

<span data-ttu-id="dbc24-211">**主计划运行** 对话框中的筛选器会影响主计划运行的持续时间。</span><span class="sxs-lookup"><span data-stu-id="dbc24-211">Filters that are applied in the **Master planning run** dialog box affect the duration of the master planning run.</span></span> <span data-ttu-id="dbc24-212">转到 **主计划 \> 主计划 \> 运行 \> 主计划**，或在 **主计划** 工作区中选择 **运行**。</span><span class="sxs-lookup"><span data-stu-id="dbc24-212">Go to **Master planning \> Master planning \> Run \> Master planning**, or select **Run** in the **Master planning** workspace.</span></span> <span data-ttu-id="dbc24-213">若要从运行中排除物料，建议按物料的生命周期状态（而不是按物料编号）进行筛选。</span><span class="sxs-lookup"><span data-stu-id="dbc24-213">To exclude items from the run, we recommend that you filter by the lifecycle state of the item (not by item numbers).</span></span> <span data-ttu-id="dbc24-214">按生命周期状态筛选所用时间比按物料编号筛选所用时间短。</span><span class="sxs-lookup"><span data-stu-id="dbc24-214">When you filter by lifecycle state, the update process will take less time than when you filter by item numbers.</span></span>

## <a name="automatically-filter-by-items-with-direct-demand"></a><span data-ttu-id="dbc24-215">根据直接需求按物料自动筛选</span><span class="sxs-lookup"><span data-stu-id="dbc24-215">Automatically filter by items with direct demand</span></span>

<span data-ttu-id="dbc24-216">为了缩短主计划运行时间，您可以选择仅包含有直接需求的物料。</span><span class="sxs-lookup"><span data-stu-id="dbc24-216">To improve the master planning run time, you can choose to only include items with direct demand.</span></span> <span data-ttu-id="dbc24-217">整个主计划运行只能使用此筛选器，**要包括的记录** 字段不应用其他筛选器。</span><span class="sxs-lookup"><span data-stu-id="dbc24-217">This filter can only be used for a complete master planning run with no other filters applied in the **Records to include** field.</span></span> <span data-ttu-id="dbc24-218">具有筛选器的主计划运行将忽略 **根据直接需求按物料自动筛选** 设置。</span><span class="sxs-lookup"><span data-stu-id="dbc24-218">A master planning run with filters will ignore the **Automatically filter by items with direct demand** setting.</span></span>

<span data-ttu-id="dbc24-219">**根据直接需求按物料自动筛选** 字段位于 **主计划参数** 页，可以与预处理和后处理设置一起使用。</span><span class="sxs-lookup"><span data-stu-id="dbc24-219">The **Automatically filter by items with direct demand** field is found on the **Master planning parameters** page and can be used with both pre-processing and post-processing settings.</span></span>

### <a name="pre-processing"></a><span data-ttu-id="dbc24-220">预处理</span><span class="sxs-lookup"><span data-stu-id="dbc24-220">Pre-processing</span></span>
<span data-ttu-id="dbc24-221">**预处理: 根据直接需求按物料自动筛选** 参数确保主计划的预处理阶段仅包含至少满足以下条件之一的物料：</span><span class="sxs-lookup"><span data-stu-id="dbc24-221">The **Pre-processing: Automatically filter by items with direct demand** parameter ensures that the pre-processing phase of master planning only includes items that fulfill at least one of the following conditions:</span></span>
  - <span data-ttu-id="dbc24-222">物料具有按预期的收货或发货，例如采购订单、销售订单、报价单、转移单或生产订单。</span><span class="sxs-lookup"><span data-stu-id="dbc24-222">The item has an expected receipt or issue, such as a purchase order, sales order, quote, transfer order, or production order.</span></span> 
  - <span data-ttu-id="dbc24-223">物料具有设有安全存货的物料覆盖范围（最小现有库存量）。</span><span class="sxs-lookup"><span data-stu-id="dbc24-223">The item has item coverage with safety stock (minimum on-hand inventory).</span></span>
  - <span data-ttu-id="dbc24-224">物料存在今天以后的预测需求。</span><span class="sxs-lookup"><span data-stu-id="dbc24-224">Forecast demand after today exists for the item.</span></span>
  - <span data-ttu-id="dbc24-225">物料存在今天以后的预测供应。</span><span class="sxs-lookup"><span data-stu-id="dbc24-225">Forecast supply after today exists for the item.</span></span>
  - <span data-ttu-id="dbc24-226">物料包括尚未创建的呼叫中心模块的所有连续性行。</span><span class="sxs-lookup"><span data-stu-id="dbc24-226">The item includes any continuity lines from the call center module yet to be created.</span></span>

> [!NOTE]
> <span data-ttu-id="dbc24-227">具有实际可用现有库存量的物料不会显示需求交易记录，因为没有针对物料的需求。</span><span class="sxs-lookup"><span data-stu-id="dbc24-227">An item that has physically available on-hand inventory will not show a requirement transaction because there is no demand for the item.</span></span>

### <a name="post-processing"></a><span data-ttu-id="dbc24-228">后处理</span><span class="sxs-lookup"><span data-stu-id="dbc24-228">Post-processing</span></span>
<span data-ttu-id="dbc24-229">**后处理: 根据直接需求按物料自动筛选** 选项仅在您在覆盖范围组中设置了 **物料清单版本要求** 时才有作用。</span><span class="sxs-lookup"><span data-stu-id="dbc24-229">The **Post-processing: Automatically filter by items with direct demand** option is only relevant if you set **BOM version requirement** in your coverage groups.</span></span> <span data-ttu-id="dbc24-230">否则，您无需启用此参数。</span><span class="sxs-lookup"><span data-stu-id="dbc24-230">Otherwise, you do not need to enable the parameter.</span></span> 

<span data-ttu-id="dbc24-231">在覆盖步骤开始之前，有一个预覆盖步骤，在此步骤中，覆盖范围设置 **物料清单版本要求** 启用的物料将被重新处理。</span><span class="sxs-lookup"><span data-stu-id="dbc24-231">Before the coverage step starts, there is a pre-coverage step during which items with the coverage setting **BOM version requirement** enabled will be reprocessed.</span></span> <span data-ttu-id="dbc24-232">这样做是为了确保已计划所需物料清单版本的物料。</span><span class="sxs-lookup"><span data-stu-id="dbc24-232">This is done to ensure that items from the required BOM version are planned.</span></span> <span data-ttu-id="dbc24-233">在预处理期间被认为有需求的物料不再有需求，因此应将其从计划运行中排除。</span><span class="sxs-lookup"><span data-stu-id="dbc24-233">Items that are considered to have demand during pre-processing no longer have any demand and therefore should be excluded from the planning run.</span></span>

## <a name="performance-checklist-summary"></a><span data-ttu-id="dbc24-234">绩效核对清单摘要</span><span class="sxs-lookup"><span data-stu-id="dbc24-234">Performance checklist summary</span></span>

- <span data-ttu-id="dbc24-235">**线程数** – 设置为大于 **0**（零）的值。</span><span class="sxs-lookup"><span data-stu-id="dbc24-235">**Number of threads** – Set to a value that is more than **0** (zero).</span></span>
- <span data-ttu-id="dbc24-236">**帮助程序任务捆绑中的任务数** – 设置为大于 **0**（零）的值。</span><span class="sxs-lookup"><span data-stu-id="dbc24-236">**Number of tasks in helper task bundle** – Set to a value that is more than **0** (zero).</span></span> <span data-ttu-id="dbc24-237">（请使用本主题前面提供的公式。）</span><span class="sxs-lookup"><span data-stu-id="dbc24-237">(Use the formulas that are given earlier in this topic.)</span></span>
- <span data-ttu-id="dbc24-238">**暂存区的使用** – 除非系统的内存较低，否则设置为 **最大值**。</span><span class="sxs-lookup"><span data-stu-id="dbc24-238">**Use of cache** – Set to **Maximum** unless your system is low on memory.</span></span>
- <span data-ttu-id="dbc24-239">**固定捆绑销售中的订单数** – 设置为大于 **0**（零）的值。</span><span class="sxs-lookup"><span data-stu-id="dbc24-239">**Number of orders in firming bundle** – Set to a value that is more than **0** (zero).</span></span> <span data-ttu-id="dbc24-240">（请使用本主题前面提供的公式。）</span><span class="sxs-lookup"><span data-stu-id="dbc24-240">(Use the formula that is given earlier in this topic.)</span></span>
- <span data-ttu-id="dbc24-241">**时限** – 根据您的业务需要调整。</span><span class="sxs-lookup"><span data-stu-id="dbc24-241">**Time fences** – Adjust to your business needs.</span></span>
- <span data-ttu-id="dbc24-242">**操作和先期备货** – 如果不使用操作和先期备货，请禁用。</span><span class="sxs-lookup"><span data-stu-id="dbc24-242">**Actions and futures** – Disable actions and future if you don't use them.</span></span>
- <span data-ttu-id="dbc24-243">**一次一个重大例程** – 请勿将主计划与其他任何重大例程一起运行。</span><span class="sxs-lookup"><span data-stu-id="dbc24-243">**One heavy routine at a time** – Don't run master planning together with any other heavy routine.</span></span>
- <span data-ttu-id="dbc24-244">**检查会话日志。**</span><span class="sxs-lookup"><span data-stu-id="dbc24-244">**Review the session log.**</span></span>
- <span data-ttu-id="dbc24-245">**筛选物料** – 使用生命周期状态从主计划运行中排除物料。</span><span class="sxs-lookup"><span data-stu-id="dbc24-245">**Filtering of items** – Use the lifecycle state to exclude items from the master planning run.</span></span> <span data-ttu-id="dbc24-246">（请勿使用物料编号。）</span><span class="sxs-lookup"><span data-stu-id="dbc24-246">(Don't use the item numbers.)</span></span>
