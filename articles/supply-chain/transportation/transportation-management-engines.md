---
title: 运输管理引擎
description: 运输管理引擎定义用于生成和处理运输管理中的运输费率的逻辑。
author: MarkusFogelberg
manager: AnnBe
ms.date: 06/20/2017
ms.topic: article
ms.prod: ''
ms.service: dynamics-ax-applications
ms.technology: ''
ms.search.form: TMSFreightBillType, TMSGenericEngine, TMSMileageEngine, TMSRateEngine, TMSTransitTimeEngine, TMSZoneEngine
audience: Application User
ms.reviewer: josaw
ms.search.scope: Core, Operations
ms.custom: 12234
ms.assetid: b878478c-0e04-4a1e-a037-6fdbb345a9a3
ms.search.region: Global
ms.author: mafoge
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: dff811723e25952b4c5af20262010ff4b910be7f
ms.sourcegitcommit: 9d4c7edd0ae2053c37c7d81cdd180b16bf3a9d3b
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/15/2019
ms.locfileid: "1553991"
---
# <a name="transportation-management-engines"></a>运输管理引擎

[!include [banner](../includes/banner.md)]

运输管理引擎定义用于生成和处理运输管理中的运输费率的逻辑。 

运输管理引擎计算任务，例如载体的运输费率。 发动机系统允许在运行期间基于在 Microsoft Dynamics 365 for Finance and Operations 中的数据更改计算策略。 运输管理引擎类似于与特定合同承运人相关的插件。

## <a name="what-engines-are-available"></a>有哪些可用引擎？
下表显示了 Microsoft Dynamics 365 for Finance and Operations 中可得到的运输管理引擎。

| 运输管理引擎 | 说明                                                                                                                                                                                                                                                                                                                 |
|----------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **费率引擎**                  | 计算费率。                                                                                                                                                                                                                                                                                                           |
| **通用引擎**               | 被其他引擎使用的简单辅助引擎无需来自 Microsoft Dynamics 365 for Finance and Operations 的数据，例如，分摊引擎。 分摊引擎用于减少特定订单和航线的最终运输费用，它是基于维度，例如数量和重量。 |
| **里程引擎**               | 计算运输距离。                                                                                                                                                                                                                                                                                     |
| **运输时间引擎**          | 计算从出发地到目的地所需的行程时间。                                                                                                                                                                                                                                       |
| **区域引擎**                  | 计算出当前地址所在区域，并计算出为了从 A 地址到达 B 地址所需跨越的区域数量。                                                                                                                                                                    |
| **货运帐单类型**            | 标准化货票和货运单线用于自动化货运单匹配。                                                                                                                                                                                                                |


<a name="what-engines-must-be-configured-to-rate-a-shipment"></a>必须配置什么引擎来评价一次装运？
---------------------------------------------------

若要评价某个特定承运人的装运，您必须配置多个运输管理引擎。 需要**费率引擎**，不过，可能需要其他运输管理引擎以支持**费率引擎**。 例如，**费率引擎**可用于从**里程引擎**中检索数据以基于源地点和目的地点之间的里程计算费率。

## <a name="whats-required-to-initialize-a-transportation-management-engine"></a>初始化运输管理引擎需要哪些步骤？
运输管理引擎要求您设置初始化数据来以指定方式行使功能。 该设置可能包括以下类型数据：
-   其他运输管理引擎的引用。 有关详细信息，请参阅本节中的配置示例。
-   运输到管理引擎使用的 .NET 类型的引用。
-   简单的配置数据。

在大多数情况下，您可以单击运输管理引擎设置表单里的**参数**按钮配置初始化数据。 **引用里程引擎的费率引擎的配置示例**以下示例显示了费率引擎所需的设置，费率引擎是基于 .NET 引擎类型以及 Microsoft.Dynamics.Ax.Tms.Bll.MileageRateEngine 并引用了里程引擎。

|          参数           |                                                                                  描述                                                                                  |
|------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  <em>RateBaseAssigner</em>   | 它是表明在特定模式下的费率基数分配数据的 .NET 类型。 参数值的语法由两部分组成，它们被竖线 (|) 分割 |
|  <em>MileageEngineCode</em>  |                       里程引擎代码标识 Microsoft Dynamics 365 for Finance and Operations 数据库中的里程引擎记录。                        |
| <em>ApportionmentEngine</em> |                        通用引擎代码标识 Microsoft Dynamics 365 for Finance and Operations 数据库中的分摊引擎。                        |

<a name="how-is-metadata-used-in-transportation-management-engines"></a>元数据如何用在运输管理引擎？
----------------------------------------------------------

依赖于定义在 Dynamics 365 for Finance and Operations 中的数据的运输管理引擎可能使用不同的数据模式。 运输管理系统允许不同的运输管理引擎使用相同的通用物理数据库表。 为了确保运行期间引擎数据的解读正确，您可以定义数据库表的元数据。 因为其他表和表单结构无需存在于 Operations 中，这减小了构建新的运输管理引擎的代价。

## <a name="what-can-be-used-as-search-data-in-rate-calculations"></a>在费率计算中哪些可以被用作搜索数据？
您计算 Microsoft Dynamics 365 for Finance and Operations 中的费率所使用的数据受元数据配置控制。 例如，如果您要基于邮政编码搜索费率，您必须基于查找类型为邮政编码来设置元数据。

## <a name="do-all-engine-configurations-require-metadata"></a>是否所有引擎配置都需要元数据？
不是这样，用于检索来自外部系统的费率计算所需数据的运输管理引擎不需要元数据。 这些引擎的费率数据可以从外部运输承运人系统检索，通常通过 Web 服务。 例如，可以使用直接从必应地图检索数据的里程引擎，这样您就无需此引擎的元数据。

| **注意**                                                                                                                                                                                                                                                                                                                                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 和 Microsoft Dynamics Finance and Operations 一起传递的运输管理引擎依赖于从应用程序中检索的数据。 连接到外部系统的引擎不包含在 Operations 中。 但是，基于引擎的延伸性模型允许您使用 Microsoft Dynamics 365 for Finance and Operations Visual Studio 工具创建扩展。 |

## <a name="how-do-i-configure-metadata-for-a-transportation-management-engine"></a>如何配置运输管理引擎的元数据？
不同类型的运输管理引擎的元数据配置各不相同。

| 运输管理引擎               | 元数据配置                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **费率引擎**                                | 需要**基本费率类型**。 费率基数类型包含费率基数数据和费率基数分配数据的元数据。 费率基数元数据结构取决于费率引擎类型。 费率基数分配元数据的结构取决于与费率引擎关联的费率基数分配器的类型。 您在**费率引擎**页和**费率主数据**页上设置费率引擎的基本费率类型。 |
| **区域引擎**                                | 需要在主区域上直接设置元数据。                                                                                                                                                                                                                                                                                                                                                                                                          |
| **运输时间引擎**和**里程引擎** | 直接从里程引擎的配置设置窗体检索元数据。                                                                                                                                                                                                                                                                                                                                                                                  |

  **费率引擎的元数据示例**运输管理引擎需要源地址标识、目标州/国家/地区和装运的起点和终点。 通过使用这些需求，元数据将如下表数据所示。 该表还包括所需输入的数据类型的信息。
-   在**基本费率类型**页的**运输管理** &gt; **设置**中定义此信息。

| 序列 | 姓名                          | 字段类型 | 数据类型 | 查找类型    | 必需 |
|----------|-------------------------------|------------|-----------|----------------|-----------|
| 1        | 原始邮政编码            | 分配 | 字符串    | 邮政编码    | 已选择  |
| 2        | 目的州             | 分配 | 字符串    | 省/市/自治区          |           |
| 3        | 目的地起始邮政编码 | 分配 | 字符串    | 邮政编码    | 已选择  |
| 4        | 目的地终点邮政编码   | 分配 | 字符串    | 邮政编码    | 已选择  |
| 5        | 目标国家           | 分配 | 字符串    | 国家/地区 |           |





